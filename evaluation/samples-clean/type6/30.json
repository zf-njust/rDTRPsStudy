{
  "code": "def testReducerNoInitialZeroDims(self, name, rng_factory, shape, dtype, axis,\n                                   keepdims, inexact):\n    np_op = getattr(np, name)\n    jnp_op = getattr(jnp, name)\n    rng = rng_factory(self.rng())\n    is_bf16_nan_test = dtype == jnp.bfloat16 and rng_factory.__name__ == 'rand_some_nan'\n    @jtu.ignore_warning(category=RuntimeWarning,\n                        message=\"Degrees of freedom <= 0 for slice.*\")\n    @jtu.ignore_warning(category=np.ComplexWarning)\n    def np_fun(x):\n      x = np.asarray(x)\n      if inexact:\n        x = x.astype(dtypes.to_inexact_dtype(x.dtype))\n      x_cast = x if not is_bf16_nan_test else x.astype(np.float32)\n      res = np_op(x_cast, axis, keepdims=keepdims)\n      res = res if not is_bf16_nan_test else res.astype(jnp.bfloat16)\n      return res.astype(_reducer_output_dtype(name, x.dtype))\n\n    jnp_fun = lambda x: jnp_op(x, axis, keepdims=keepdims)\n    jnp_fun = jtu.ignore_warning(category=jnp.ComplexWarning)(jnp_fun)\n    args_maker = lambda: [rng(shape, dtype)]\n    tol = {jnp.bfloat16: 3E-2}\n    self._CheckAgainstNumpy(np_fun, jnp_fun, args_maker, rtol=tol)\n    self._CompileAndCheck(jnp_fun, args_maker)",
  "smell": [
    {
      "smell_id": 6,
      "line_no": 4,
      "description": "The attribute is visited based on a dynamically determined name."
    }
  ]
}