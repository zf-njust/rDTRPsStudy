{
    "code": "def tamper(payload, **kwargs):\n    \"\"\"\n    Replaces each keyword character with random case value\n\n    Tested against:\n        * Microsoft SQL Server 2005\n        * MySQL 4, 5.0 and 5.5\n        * Oracle 10g\n        * PostgreSQL 8.3, 8.4, 9.0\n\n    Notes:\n        * Useful to bypass very weak and bespoke web application firewalls\n          that has poorly written permissive regular expressions\n        * This tamper script should work against all (?) databases\n\n    >>> import random\n    >>> random.seed(0)\n    >>> tamper('INSERT')\n    'INseRt'\n    \"\"\"\n\n    retVal = payload\n\n    if payload:\n        for match in re.finditer(r\"[A-Za-z_]+\", retVal):\n            word = match.group()\n\n            if word.upper() in kb.keywords:\n                while True:\n                    _ = \"\"\n\n                    for i in xrange(len(word)):\n                        _ += word[i].upper() if randomRange(0, 1) else word[i].lower()\n\n                    if len(_) > 1 and _ not in (_.lower(), _.upper()):\n                        break\n\n                retVal = retVal.replace(word, _)\n\n    return retVal",
    "smell": []
}