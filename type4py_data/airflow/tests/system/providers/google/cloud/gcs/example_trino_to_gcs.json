{"error": null, "response": {"classes": [], "funcs": [{"docstring": {"func": "Remove invalid characters for filename", "long_descr": null, "ret": null}, "fn_lc": [[49, 0], [53, 43]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "safe_name", "params": {"s": "builtins.str"}, "params_descr": {"s": ""}, "params_occur": {"s": [["re", "sub", "s"]]}, "params_p": {"args": [], "kwargs": [], "s": [["str", 1.0]]}, "q_name": "safe_name", "ret_exprs": ["return re.sub(\"[^0-9a-zA-Z_]+\", \"_\", s)"], "ret_type": "builtins.str", "ret_type_p": [["str", 0.6257494685350526], ["Union[str, bytes]", 0.09652971740754797]], "variables": {}, "variables_p": {}}], "imports": ["__future__", "annotations", "os", "re", "datetime", "datetime", "airflow", "models", "airflow", "providers", "google", "cloud", "operators", "bigquery", "BigQueryCreateEmptyDatasetOperator", "BigQueryCreateExternalTableOperator", "BigQueryDeleteDatasetOperator", "BigQueryInsertJobOperator", "airflow", "providers", "google", "cloud", "operators", "gcs", "GCSCreateBucketOperator", "GCSDeleteBucketOperator", "airflow", "providers", "google", "cloud", "transfers", "trino_to_gcs", "TrinoToGCSOperator", "airflow", "utils", "trigger_rule", "TriggerRule", "tests", "system", "utils", "watcher", "watcher", "tests", "system", "utils", "get_test_run"], "mod_var_ln": {"DAG_ID": [[39, 0], [39, 6]], "DATASET_NAME": [[43, 0], [43, 12]], "ENV_ID": [[38, 0], [38, 6]], "GCP_PROJECT_ID": [[41, 0], [41, 14]], "GCS_BUCKET": [[42, 0], [42, 10]], "SOURCE_CUSTOMER_TABLE": [[46, 0], [46, 21]], "SOURCE_SCHEMA_COLUMNS": [[45, 0], [45, 21]], "create_bucket": [[72, 4], [72, 17]], "create_dataset": [[63, 4], [63, 18]], "create_external_table_many_chunks": [[152, 4], [152, 37]], "create_external_table_multiple_types": [[97, 4], [97, 40]], "delete_bucket": [[74, 4], [74, 17]], "delete_dataset": [[65, 4], [65, 18]], "read_data_from_gcs_many_chunks": [[184, 4], [184, 34]], "read_data_from_gcs_multiple_types": [[129, 4], [129, 37]], "test_run": [[232, 0], [232, 8]], "trino_to_gcs_basic": [[77, 4], [77, 22]], "trino_to_gcs_csv": [[197, 4], [197, 20]], "trino_to_gcs_many_chunks": [[141, 4], [141, 28]], "trino_to_gcs_multiple_types": [[86, 4], [86, 31]]}, "mod_var_occur": {"DAG_ID": [["GCS_BUCKET", "DAG_ID", "ENV_ID"], ["DATASET_NAME", "DAG_ID", "ENV_ID"], ["models", "DAG", "dag_id", "DAG_ID", "schedule", "start_date", "datetime", "catchup", "False", "tags", "dag"]], "DATASET_NAME": [["create_dataset", "BigQueryCreateEmptyDatasetOperator", "task_id", "dataset_id", "DATASET_NAME"], ["delete_dataset", "BigQueryDeleteDatasetOperator", "task_id", "dataset_id", "DATASET_NAME", "delete_contents", "True", "trigger_rule", "TriggerRule", "ALL_DONE"], ["create_external_table_multiple_types", "BigQueryCreateExternalTableOperator", "task_id", "bucket", "GCS_BUCKET", "table_resource", "GCP_PROJECT_ID", "DATASET_NAME", "safe_name", "SOURCE_SCHEMA_COLUMNS", "GCS_BUCKET", "safe_name", "SOURCE_SCHEMA_COLUMNS", "source_objects", "safe_name", "SOURCE_SCHEMA_COLUMNS", "schema_object", "safe_name", "SOURCE_SCHEMA_COLUMNS"], ["read_data_from_gcs_multiple_types", "BigQueryInsertJobOperator", "task_id", "configuration", "GCP_PROJECT_ID", "DATASET_NAME", "safe_name", "SOURCE_SCHEMA_COLUMNS", "False"], ["create_external_table_many_chunks", "BigQueryCreateExternalTableOperator", "task_id", "bucket", "GCS_BUCKET", "table_resource", "GCP_PROJECT_ID", "DATASET_NAME", "safe_name", "SOURCE_CUSTOMER_TABLE", "GCS_BUCKET", "safe_name", "SOURCE_CUSTOMER_TABLE", "source_objects", "safe_name", "SOURCE_CUSTOMER_TABLE", "schema_object", "safe_name", "SOURCE_CUSTOMER_TABLE"], ["read_data_from_gcs_many_chunks", "BigQueryInsertJobOperator", "task_id", "configuration", "GCP_PROJECT_ID", "DATASET_NAME", "safe_name", "SOURCE_CUSTOMER_TABLE", "False"]], "ENV_ID": [["GCS_BUCKET", "DAG_ID", "ENV_ID"], ["DATASET_NAME", "DAG_ID", "ENV_ID"]], "GCP_PROJECT_ID": [["create_external_table_multiple_types", "BigQueryCreateExternalTableOperator", "task_id", "bucket", "GCS_BUCKET", "table_resource", "GCP_PROJECT_ID", "DATASET_NAME", "safe_name", "SOURCE_SCHEMA_COLUMNS", "GCS_BUCKET", "safe_name", "SOURCE_SCHEMA_COLUMNS", "source_objects", "safe_name", "SOURCE_SCHEMA_COLUMNS", "schema_object", "safe_name", "SOURCE_SCHEMA_COLUMNS"], ["read_data_from_gcs_multiple_types", "BigQueryInsertJobOperator", "task_id", "configuration", "GCP_PROJECT_ID", "DATASET_NAME", "safe_name", "SOURCE_SCHEMA_COLUMNS", "False"], ["create_external_table_many_chunks", "BigQueryCreateExternalTableOperator", "task_id", "bucket", "GCS_BUCKET", "table_resource", "GCP_PROJECT_ID", "DATASET_NAME", "safe_name", "SOURCE_CUSTOMER_TABLE", "GCS_BUCKET", "safe_name", "SOURCE_CUSTOMER_TABLE", "source_objects", "safe_name", "SOURCE_CUSTOMER_TABLE", "schema_object", "safe_name", "SOURCE_CUSTOMER_TABLE"], ["read_data_from_gcs_many_chunks", "BigQueryInsertJobOperator", "task_id", "configuration", "GCP_PROJECT_ID", "DATASET_NAME", "safe_name", "SOURCE_CUSTOMER_TABLE", "False"]], "GCS_BUCKET": [["create_bucket", "GCSCreateBucketOperator", "task_id", "bucket_name", "GCS_BUCKET"], ["delete_bucket", "GCSDeleteBucketOperator", "task_id", "bucket_name", "GCS_BUCKET"], ["trino_to_gcs_basic", "TrinoToGCSOperator", "task_id", "sql", "SOURCE_SCHEMA_COLUMNS", "bucket", "GCS_BUCKET", "filename", "safe_name", "SOURCE_SCHEMA_COLUMNS"], ["trino_to_gcs_multiple_types", "TrinoToGCSOperator", "task_id", "sql", "SOURCE_SCHEMA_COLUMNS", "bucket", "GCS_BUCKET", "filename", "safe_name", "SOURCE_SCHEMA_COLUMNS", "schema_filename", "safe_name", "SOURCE_SCHEMA_COLUMNS", "gzip", "False"], ["create_external_table_multiple_types", "BigQueryCreateExternalTableOperator", "task_id", "bucket", "GCS_BUCKET", "table_resource", "GCP_PROJECT_ID", "DATASET_NAME", "safe_name", "SOURCE_SCHEMA_COLUMNS", "GCS_BUCKET", "safe_name", "SOURCE_SCHEMA_COLUMNS", "source_objects", "safe_name", "SOURCE_SCHEMA_COLUMNS", "schema_object", "safe_name", "SOURCE_SCHEMA_COLUMNS"], ["trino_to_gcs_many_chunks", "TrinoToGCSOperator", "task_id", "sql", "SOURCE_CUSTOMER_TABLE", "bucket", "GCS_BUCKET", "filename", "safe_name", "SOURCE_CUSTOMER_TABLE", "schema_filename", "safe_name", "SOURCE_CUSTOMER_TABLE", "approx_max_file_size_bytes", "gzip", "False"], ["create_external_table_many_chunks", "BigQueryCreateExternalTableOperator", "task_id", "bucket", "GCS_BUCKET", "table_resource", "GCP_PROJECT_ID", "DATASET_NAME", "safe_name", "SOURCE_CUSTOMER_TABLE", "GCS_BUCKET", "safe_name", "SOURCE_CUSTOMER_TABLE", "source_objects", "safe_name", "SOURCE_CUSTOMER_TABLE", "schema_object", "safe_name", "SOURCE_CUSTOMER_TABLE"], ["trino_to_gcs_csv", "TrinoToGCSOperator", "task_id", "sql", "SOURCE_SCHEMA_COLUMNS", "bucket", "GCS_BUCKET", "filename", "safe_name", "SOURCE_SCHEMA_COLUMNS", "schema_filename", "safe_name", "SOURCE_SCHEMA_COLUMNS", "export_format"]], "SOURCE_CUSTOMER_TABLE": [["trino_to_gcs_many_chunks", "TrinoToGCSOperator", "task_id", "sql", "SOURCE_CUSTOMER_TABLE", "bucket", "GCS_BUCKET", "filename", "safe_name", "SOURCE_CUSTOMER_TABLE", "schema_filename", "safe_name", "SOURCE_CUSTOMER_TABLE", "approx_max_file_size_bytes", "gzip", "False"], ["create_external_table_many_chunks", "BigQueryCreateExternalTableOperator", "task_id", "bucket", "GCS_BUCKET", "table_resource", "GCP_PROJECT_ID", "DATASET_NAME", "safe_name", "SOURCE_CUSTOMER_TABLE", "GCS_BUCKET", "safe_name", "SOURCE_CUSTOMER_TABLE", "source_objects", "safe_name", "SOURCE_CUSTOMER_TABLE", "schema_object", "safe_name", "SOURCE_CUSTOMER_TABLE"], ["read_data_from_gcs_many_chunks", "BigQueryInsertJobOperator", "task_id", "configuration", "GCP_PROJECT_ID", "DATASET_NAME", "safe_name", "SOURCE_CUSTOMER_TABLE", "False"]], "SOURCE_SCHEMA_COLUMNS": [["trino_to_gcs_basic", "TrinoToGCSOperator", "task_id", "sql", "SOURCE_SCHEMA_COLUMNS", "bucket", "GCS_BUCKET", "filename", "safe_name", "SOURCE_SCHEMA_COLUMNS"], ["trino_to_gcs_multiple_types", "TrinoToGCSOperator", "task_id", "sql", "SOURCE_SCHEMA_COLUMNS", "bucket", "GCS_BUCKET", "filename", "safe_name", "SOURCE_SCHEMA_COLUMNS", "schema_filename", "safe_name", "SOURCE_SCHEMA_COLUMNS", "gzip", "False"], ["create_external_table_multiple_types", "BigQueryCreateExternalTableOperator", "task_id", "bucket", "GCS_BUCKET", "table_resource", "GCP_PROJECT_ID", "DATASET_NAME", "safe_name", "SOURCE_SCHEMA_COLUMNS", "GCS_BUCKET", "safe_name", "SOURCE_SCHEMA_COLUMNS", "source_objects", "safe_name", "SOURCE_SCHEMA_COLUMNS", "schema_object", "safe_name", "SOURCE_SCHEMA_COLUMNS"], ["read_data_from_gcs_multiple_types", "BigQueryInsertJobOperator", "task_id", "configuration", "GCP_PROJECT_ID", "DATASET_NAME", "safe_name", "SOURCE_SCHEMA_COLUMNS", "False"], ["trino_to_gcs_csv", "TrinoToGCSOperator", "task_id", "sql", "SOURCE_SCHEMA_COLUMNS", "bucket", "GCS_BUCKET", "filename", "safe_name", "SOURCE_SCHEMA_COLUMNS", "schema_filename", "safe_name", "SOURCE_SCHEMA_COLUMNS", "export_format"]], "create_bucket": [["create_dataset", "create_bucket", "trino_to_gcs_basic", "trino_to_gcs_multiple_types", "trino_to_gcs_many_chunks", "trino_to_gcs_csv", "create_external_table_multiple_types", "create_external_table_many_chunks", "read_data_from_gcs_multiple_types", "read_data_from_gcs_many_chunks", "delete_dataset", "delete_bucket"]], "create_dataset": [["create_dataset", "create_bucket", "trino_to_gcs_basic", "trino_to_gcs_multiple_types", "trino_to_gcs_many_chunks", "trino_to_gcs_csv", "create_external_table_multiple_types", "create_external_table_many_chunks", "read_data_from_gcs_multiple_types", "read_data_from_gcs_many_chunks", "delete_dataset", "delete_bucket"]], "create_external_table_many_chunks": [["create_dataset", "create_bucket", "trino_to_gcs_basic", "trino_to_gcs_multiple_types", "trino_to_gcs_many_chunks", "trino_to_gcs_csv", "create_external_table_multiple_types", "create_external_table_many_chunks", "read_data_from_gcs_multiple_types", "read_data_from_gcs_many_chunks", "delete_dataset", "delete_bucket"]], "create_external_table_multiple_types": [["create_dataset", "create_bucket", "trino_to_gcs_basic", "trino_to_gcs_multiple_types", "trino_to_gcs_many_chunks", "trino_to_gcs_csv", "create_external_table_multiple_types", "create_external_table_many_chunks", "read_data_from_gcs_multiple_types", "read_data_from_gcs_many_chunks", "delete_dataset", "delete_bucket"]], "delete_bucket": [["create_dataset", "create_bucket", "trino_to_gcs_basic", "trino_to_gcs_multiple_types", "trino_to_gcs_many_chunks", "trino_to_gcs_csv", "create_external_table_multiple_types", "create_external_table_many_chunks", "read_data_from_gcs_multiple_types", "read_data_from_gcs_many_chunks", "delete_dataset", "delete_bucket"]], "delete_dataset": [["create_dataset", "create_bucket", "trino_to_gcs_basic", "trino_to_gcs_multiple_types", "trino_to_gcs_many_chunks", "trino_to_gcs_csv", "create_external_table_multiple_types", "create_external_table_many_chunks", "read_data_from_gcs_multiple_types", "read_data_from_gcs_many_chunks", "delete_dataset", "delete_bucket"]], "read_data_from_gcs_many_chunks": [["create_dataset", "create_bucket", "trino_to_gcs_basic", "trino_to_gcs_multiple_types", "trino_to_gcs_many_chunks", "trino_to_gcs_csv", "create_external_table_multiple_types", "create_external_table_many_chunks", "read_data_from_gcs_multiple_types", "read_data_from_gcs_many_chunks", "delete_dataset", "delete_bucket"]], "read_data_from_gcs_multiple_types": [["create_dataset", "create_bucket", "trino_to_gcs_basic", "trino_to_gcs_multiple_types", "trino_to_gcs_many_chunks", "trino_to_gcs_csv", "create_external_table_multiple_types", "create_external_table_many_chunks", "read_data_from_gcs_multiple_types", "read_data_from_gcs_many_chunks", "delete_dataset", "delete_bucket"]], "test_run": [], "trino_to_gcs_basic": [["create_dataset", "create_bucket", "trino_to_gcs_basic", "trino_to_gcs_multiple_types", "trino_to_gcs_many_chunks", "trino_to_gcs_csv", "create_external_table_multiple_types", "create_external_table_many_chunks", "read_data_from_gcs_multiple_types", "read_data_from_gcs_many_chunks", "delete_dataset", "delete_bucket"]], "trino_to_gcs_csv": [["create_dataset", "create_bucket", "trino_to_gcs_basic", "trino_to_gcs_multiple_types", "trino_to_gcs_many_chunks", "trino_to_gcs_csv", "create_external_table_multiple_types", "create_external_table_many_chunks", "read_data_from_gcs_multiple_types", "read_data_from_gcs_many_chunks", "delete_dataset", "delete_bucket"]], "trino_to_gcs_many_chunks": [["create_dataset", "create_bucket", "trino_to_gcs_basic", "trino_to_gcs_multiple_types", "trino_to_gcs_many_chunks", "trino_to_gcs_csv", "create_external_table_multiple_types", "create_external_table_many_chunks", "read_data_from_gcs_multiple_types", "read_data_from_gcs_many_chunks", "delete_dataset", "delete_bucket"]], "trino_to_gcs_multiple_types": [["create_dataset", "create_bucket", "trino_to_gcs_basic", "trino_to_gcs_multiple_types", "trino_to_gcs_many_chunks", "trino_to_gcs_csv", "create_external_table_multiple_types", "create_external_table_many_chunks", "read_data_from_gcs_multiple_types", "read_data_from_gcs_many_chunks", "delete_dataset", "delete_bucket"]]}, "no_types_annot": {"D": 2, "I": 0, "U": 20}, "session_id": "SScyxnrM9BIUmScaA4qYP3_TGn0qq09Im3sh912sq00", "set": null, "tc": [false, null], "type_annot_cove": 0.09, "typed_seq": "", "untyped_seq": "", "variables": {"DAG_ID": "", "DATASET_NAME": "", "ENV_ID": "", "GCP_PROJECT_ID": "", "GCS_BUCKET": "", "SOURCE_CUSTOMER_TABLE": "", "SOURCE_SCHEMA_COLUMNS": "", "create_bucket": "", "create_dataset": "", "create_external_table_many_chunks": "", "create_external_table_multiple_types": "", "delete_bucket": "", "delete_dataset": "", "read_data_from_gcs_many_chunks": "", "read_data_from_gcs_multiple_types": "", "test_run": "", "trino_to_gcs_basic": "", "trino_to_gcs_csv": "", "trino_to_gcs_many_chunks": "", "trino_to_gcs_multiple_types": ""}, "variables_p": {"DAG_ID": [["int", 0.5076305909840522], ["str", 0.09868445304095413]], "DATASET_NAME": [["str", 0.9999999999999999]], "ENV_ID": [["int", 0.0852876693796992]], "GCP_PROJECT_ID": [["str", 1.0]], "GCS_BUCKET": [["int", 0.6397320245568556], ["Set[str]", 0.14775222342867098], ["str", 0.1198546694127729], ["Dict[str, Union[datetime.timedelta, str]]", 0.09266108260170054]], "SOURCE_CUSTOMER_TABLE": [["str", 0.5052562288193311], ["List[str]", 0.18350674951822282], ["Optional[str]", 0.09950446010956737]], "SOURCE_SCHEMA_COLUMNS": [["str", 0.8122450498014717], ["ClassVar[str]", 0.0969384141966206]], "create_bucket": [["str", 0.9102720458130388], ["int", 0.08972795418696122]], "create_dataset": [["str", 0.27462818028293], ["int", 0.20579592102852703], ["datetime.datetime", 0.19175002893044973], ["Type[prm.journals.models.moods.Mood]", 0.11182053666078703], ["datetime.timedelta", 0.10374692395281447]], "create_external_table_many_chunks": [["str", 0.6079283305298834], ["List[Pattern[str]]", 0.12058079408996863], ["List[float]", 0.09485296687890545], ["Dict[str, Any]", 0.08691203846820549]], "create_external_table_multiple_types": [["str", 0.696929534198646], ["int", 0.10562475164551442], ["List[Tuple[str, str]]", 0.09750947027748594]], "delete_bucket": [["str", 0.711097855424978], ["Dict[str, str]", 0.10090311012199245], ["int", 0.09701680452952777]], "delete_dataset": [["str", 0.6425684006660075], ["List[Pattern[str]]", 0.16658695967936982], ["Pattern[str]", 0.09818952042013027]], "read_data_from_gcs_many_chunks": [["str", 0.5688437307569093], ["dict", 0.23118125832944308], ["Dict[str, Union[int, str]]", 0.1999750109136474]], "read_data_from_gcs_multiple_types": [["str", 0.22411422439515], ["Dict[str, Union[int, str]]", 0.10732695844325614], ["Dict[str, str]", 0.09602649992871949], ["Dict[str, Any]", 0.09283659113526267], ["dict", 0.08699445775487905]], "test_run": [["int", 0.4999999998760807], ["bool", 0.4999999998358487], ["str", 2.480259286043124e-10], ["list", 4.00446876512944e-11]], "trino_to_gcs_basic": [["str", 0.49549431364716756], ["int", 0.09757736935650721], ["Pattern[str]", 0.09214337644084114]], "trino_to_gcs_csv": [["str", 0.49549431364716756], ["int", 0.09757736935650721], ["Pattern[str]", 0.09214337644084114]], "trino_to_gcs_many_chunks": [["str", 0.49549431364716756], ["int", 0.09757736935650721], ["Pattern[str]", 0.09214337644084114]], "trino_to_gcs_multiple_types": [["str", 0.2051371187369079], ["int", 0.1921153165122046], ["Type[Dict[str, Any]]", 0.10397351860567301], ["Pattern[str]", 0.10223263027657457], ["Dict[str, str]", 0.10067687937987903]]}}}