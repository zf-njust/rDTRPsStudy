{"error": null, "response": {"classes": [], "funcs": [{"docstring": {"func": "Fixture that provides a SQLAlchemy session", "long_descr": null, "ret": null}, "fn_lc": [[35, 0], [38, 21]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "session", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "session", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[42, 0], [50, 20]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "clear_db", "params": {"session": ""}, "params_descr": {"session": ""}, "params_occur": {"session": [["session", "query", "TaskInstance", "delete"], ["session", "query", "Trigger", "delete"], ["session", "query", "Job", "delete"], ["session", "query", "TaskInstance", "delete"], ["session", "query", "Trigger", "delete"], ["session", "query", "Job", "delete"], ["session", "commit"]]}, "params_p": {"args": [], "kwargs": [], "session": [["session.HexpySession", 0.09858184854423477], ["grouper.models.user.User", 0.09246565701009446], ["grouper.models.base.session.Session", 0.09246565701009446], ["sqlalchemy.orm.session.Session", 0.08790583595057491]]}, "q_name": "clear_db", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Tests that unused triggers (those with no task instances referencing them)", "long_descr": "are cleaned out automatically.", "ret": null}, "fn_lc": [[53, 0], [85, 57]], "fn_var_ln": {"fake_task": [[76, 4], [76, 13]], "id": [[64, 4], [64, 15]], "state": [[78, 4], [78, 23]], "task_instance": [[77, 4], [77, 17]], "trigger1": [[59, 4], [59, 12]], "trigger2": [[61, 4], [61, 12]], "trigger3": [[63, 4], [63, 12]], "trigger_id": [[79, 4], [79, 28]]}, "fn_var_occur": {"fake_task": [["fake_task", "EmptyOperator", "task_id", "dag", "task_instance", "task", "dag"], ["task_instance", "TaskInstance", "task", "fake_task", "run_id", "task_instance", "run_id"]], "id": [["trigger1", "id"], ["trigger2", "id"], ["trigger3", "id"], ["task_instance", "trigger_id", "trigger1", "id"], ["task_instance", "trigger_id", "trigger2", "id"], ["session", "query", "Trigger", "one", "id", "trigger1", "id"]], "state": [["task_instance", "create_task_instance", "session", "session", "task_id", "state", "State", "DEFERRED", "execution_date", "timezone", "utcnow"], ["task_instance", "state", "State", "SUCCESS"]], "task_instance": [["task_instance", "create_task_instance", "session", "session", "task_id", "state", "State", "DEFERRED", "execution_date", "timezone", "utcnow"], ["task_instance", "trigger_id", "trigger1", "id"], ["session", "add", "task_instance"], ["fake_task", "EmptyOperator", "task_id", "dag", "task_instance", "task", "dag"], ["task_instance", "TaskInstance", "task", "fake_task", "run_id", "task_instance", "run_id"], ["task_instance", "state", "State", "SUCCESS"], ["task_instance", "trigger_id", "trigger2", "id"], ["session", "add", "task_instance"]], "trigger1": [["trigger1", "Trigger", "classpath", "kwargs"], ["trigger1", "id"], ["session", "add", "trigger1"], ["task_instance", "trigger_id", "trigger1", "id"], ["session", "query", "Trigger", "one", "id", "trigger1", "id"]], "trigger2": [["trigger2", "Trigger", "classpath", "kwargs"], ["trigger2", "id"], ["session", "add", "trigger2"], ["task_instance", "trigger_id", "trigger2", "id"]], "trigger3": [["trigger3", "Trigger", "classpath", "kwargs"], ["trigger3", "id"], ["session", "add", "trigger3"]], "trigger_id": [["task_instance", "trigger_id", "trigger1", "id"], ["task_instance", "trigger_id", "trigger2", "id"]]}, "name": "test_clean_unused", "params": {"create_task_instance": "", "session": ""}, "params_descr": {"create_task_instance": "", "session": ""}, "params_occur": {"create_task_instance": [["task_instance", "create_task_instance", "session", "session", "task_id", "state", "State", "DEFERRED", "execution_date", "timezone", "utcnow"]], "session": [["session", "add", "trigger1"], ["session", "add", "trigger2"], ["session", "add", "trigger3"], ["session", "commit"], ["session", "query", "Trigger", "count"], ["task_instance", "create_task_instance", "session", "session", "task_id", "state", "State", "DEFERRED", "execution_date", "timezone", "utcnow"], ["session", "add", "task_instance"], ["session", "add", "task_instance"], ["session", "commit"], ["session", "query", "Trigger", "one", "id", "trigger1", "id"]]}, "params_p": {"args": [], "create_task_instance": [["raiden.utils.ChannelID", 0.1091497984164289], ["asgard.models.accounAccount", 0.1024484976864113], ["asgard.models.user.User", 0.1024484976864113], ["zam_repondeur.models.Dossier", 0.09511398940867034], ["users.models.JustfixUser", 0.0940906383725848], ["models.User", 0.09253456007234467], ["models.RepoInterface", 0.09253456007234467]], "kwargs": [], "session": [["abilian.core.models.subjects.User", 0.1373585026255399], ["sqlalchemy.orm.session.Session", 0.08425301922970213]]}, "q_name": "test_clean_unused", "ret_exprs": [], "ret_type": "", "variables": {"fake_task": "", "id": "", "state": "", "task_instance": "", "trigger1": "", "trigger2": "", "trigger3": "", "trigger_id": ""}, "variables_p": {"fake_task": [["taskiapplication.models.task.Task", 0.2645810095957469], ["kippo.tasks.models.KippoTask", 0.22477770025642332]], "id": [["int", 0.7806117653020812], ["str", 0.12936608619631557]], "state": [["str", 0.22319394176027071], ["Optional[raiden.utils.TokenNetworkAddress]", 0.22144754636642427], ["Optional[raiden.utils.TokenNetworkID]", 0.19199003516920699], ["Optional[raiden.transfer.state.TokenNetworkState]", 0.17530572121329438], ["grpy.core.models.User", 0.09891742435353626], ["pytz.BaseTzInfo", 0.08914533113726729]], "task_instance": [["khetha.models.Task", 0.19454038540222363], ["dict", 0.09161781998121371], ["raiden.transfer.state.HopState", 0.09137868305540929]], "trigger1": [["int", 0.16516756819710948], ["app.models.Tweet", 0.10413611488175023], ["buza.models.Subject", 0.09499278894078211], ["bytearray", 0.07851346495310299]], "trigger2": [["int", 0.4295030720415547], ["app.models.Tweet", 0.188189766926042], ["notifications.models.Notification", 0.07097798226738014]], "trigger3": [["datetime.datetime.datetime", 0.12174140873703049], ["abilian.core.models.subjects.User", 0.10777629670899741], ["List[Dict[str, Any]]", 0.10597909267061545], ["dict", 0.10188655021347207], ["Type[ddionrails.workspace.models.baskeBasket]", 0.10084563638124902], ["Tuple[Any, Any]", 0.08870410892488803], ["str", 0.08275281965219679], ["list", 0.08152638243397456]], "trigger_id": [["int", 0.32850498883291507], ["Optional[str]", 0.0888006947128447], ["Optional[int]", 0.08187004755435273]]}}, {"docstring": {"func": "Tests that events submitted to a trigger re-wake their dependent", "long_descr": "task instances.", "ret": null}, "fn_lc": [[88, 0], [113, 81]], "fn_var_ln": {"id": [[95, 4], [95, 14]], "next_kwargs": [[103, 4], [103, 29]], "task_instance": [[99, 4], [99, 17]], "trigger": [[94, 4], [94, 11]], "trigger_id": [[102, 4], [102, 28]], "updated_task_instance": [[111, 4], [111, 25]]}, "fn_var_occur": {"id": [["trigger", "id"], ["task_instance", "trigger_id", "trigger", "id"], ["Trigger", "submit_event", "trigger", "id", "TriggerEvent", "session", "session"]], "next_kwargs": [["task_instance", "next_kwargs", "True"], ["updated_task_instance", "next_kwargs", "True"]], "task_instance": [["task_instance", "create_task_instance", "session", "session", "execution_date", "timezone", "utcnow", "state", "State", "DEFERRED"], ["task_instance", "trigger_id", "trigger", "id"], ["task_instance", "next_kwargs", "True"]], "trigger": [["trigger", "Trigger", "classpath", "kwargs"], ["trigger", "id"], ["session", "add", "trigger"], ["task_instance", "trigger_id", "trigger", "id"], ["Trigger", "submit_event", "trigger", "id", "TriggerEvent", "session", "session"]], "trigger_id": [["task_instance", "trigger_id", "trigger", "id"]], "updated_task_instance": [["updated_task_instance", "session", "query", "TaskInstance", "one"], ["updated_task_instance", "state", "State", "SCHEDULED"], ["updated_task_instance", "next_kwargs", "True"]]}, "name": "test_submit_event", "params": {"create_task_instance": "", "session": ""}, "params_descr": {"create_task_instance": "", "session": ""}, "params_occur": {"create_task_instance": [["task_instance", "create_task_instance", "session", "session", "execution_date", "timezone", "utcnow", "state", "State", "DEFERRED"]], "session": [["session", "add", "trigger"], ["session", "commit"], ["task_instance", "create_task_instance", "session", "session", "execution_date", "timezone", "utcnow", "state", "State", "DEFERRED"], ["session", "commit"], ["Trigger", "submit_event", "trigger", "id", "TriggerEvent", "session", "session"], ["session", "flush"], ["session", "expunge_all"], ["updated_task_instance", "session", "query", "TaskInstance", "one"]]}, "params_p": {"args": [], "create_task_instance": [["models.User", 0.1043062820576157], ["models.RepoInterface", 0.1043062820576157], ["zam_repondeur.models.Dossier", 0.10182952803858378], ["str", 0.09596527267627054], ["raiden.utils.ChannelID", 0.09074415227497282]], "kwargs": [], "session": [["Dict[str, Any]", 0.1128755587861595], ["utils.clienClient", 0.09551105708561225], ["asgard.models.job.ScheduledJob", 0.09051315505634444]]}, "q_name": "test_submit_event", "ret_exprs": [], "ret_type": "", "variables": {"id": "", "next_kwargs": "", "task_instance": "", "trigger": "", "trigger_id": "", "updated_task_instance": ""}, "variables_p": {"id": [["int", 0.17046970169665915], ["str", 0.12057383810498475], ["models.File", 0.0976620515946905]], "next_kwargs": [["dict", 0.2832401332114221], ["str", 0.19648355701863301], ["Dict[str, str]", 0.09098690216314771]], "task_instance": [["bytes", 0.11246432411033978], ["dict", 0.10396034484923285]], "trigger": [["int", 0.2978086761508114], ["app.models.Tweet", 0.1383348690168334], ["buza.models.Subject", 0.09802247301597153]], "trigger_id": [["str", 0.4739789679572085], ["Set[int]", 0.19954043240037003], ["taxonomy.db.models.base.EnumField", 0.11409993820306556], ["int", 0.11082081806680841]], "updated_task_instance": [["int", 0.20492444809032972], ["List[List[int]]", 0.18355233662262538], ["str", 0.08581201272314731], ["legistar.models.MatterStatus", 0.08041725672641908], ["List[str]", 0.07931198809328498]]}}, {"docstring": {"func": "Tests that failures submitted to a trigger fail their dependent", "long_descr": "task instances.", "ret": null}, "fn_lc": [[116, 0], [137, 58]], "fn_var_ln": {"id": [[123, 4], [123, 14]], "task_instance": [[127, 4], [127, 17]], "trigger": [[122, 4], [122, 11]], "trigger_id": [[130, 4], [130, 28]], "updated_task_instance": [[135, 4], [135, 25]]}, "fn_var_occur": {"id": [["trigger", "id"], ["task_instance", "trigger_id", "trigger", "id"], ["Trigger", "submit_failure", "trigger", "id", "session", "session"]], "task_instance": [["task_instance", "create_task_instance", "task_id", "execution_date", "timezone", "utcnow", "state", "State", "DEFERRED"], ["task_instance", "trigger_id", "trigger", "id"]], "trigger": [["trigger", "Trigger", "classpath", "kwargs"], ["trigger", "id"], ["session", "add", "trigger"], ["task_instance", "trigger_id", "trigger", "id"], ["Trigger", "submit_failure", "trigger", "id", "session", "session"]], "trigger_id": [["task_instance", "trigger_id", "trigger", "id"]], "updated_task_instance": [["updated_task_instance", "session", "query", "TaskInstance", "one"], ["updated_task_instance", "state", "State", "SCHEDULED"], ["updated_task_instance", "next_method"]]}, "name": "test_submit_failure", "params": {"create_task_instance": "", "session": ""}, "params_descr": {"create_task_instance": "", "session": ""}, "params_occur": {"create_task_instance": [["task_instance", "create_task_instance", "task_id", "execution_date", "timezone", "utcnow", "state", "State", "DEFERRED"]], "session": [["session", "add", "trigger"], ["session", "commit"], ["session", "commit"], ["Trigger", "submit_failure", "trigger", "id", "session", "session"], ["updated_task_instance", "session", "query", "TaskInstance", "one"]]}, "params_p": {"args": [], "create_task_instance": [["utils.pluginmgr.Command", 0.09409840170848507]], "kwargs": [], "session": [["app.models.Game", 0.10515069751383731], ["core.models.Grouping", 0.0894887863759644], ["estimark.application.domain.models.Entity", 0.08389160435570042], ["core.models.Recipe", 0.08094604671715264]]}, "q_name": "test_submit_failure", "ret_exprs": [], "ret_type": "", "variables": {"id": "", "task_instance": "", "trigger": "", "trigger_id": "", "updated_task_instance": ""}, "variables_p": {"id": [["int", 0.3455125419338443], ["str", 0.14637186839922173]], "task_instance": [["khetha.models.Task", 0.10138606185516034], ["List[Tuple[Any, str]]", 0.08919719457595116], ["Set[str]", 0.08643384637796857], ["Dict[str, Any]", 0.0769736836843354], ["List[str]", 0.0732875458874446], ["Dict[str, Dict[str, int]]", 0.06987102664500014]], "trigger": [["Optional[magic.models.deck.Deck]", 0.19040216049153372], ["list", 0.1095496562784911], ["Dict[str, str]", 0.10749251560344428], ["int", 0.10019484887058182], ["str", 0.08892322826565911]], "trigger_id": [["str", 0.4739789679572085], ["Set[int]", 0.19954043240037003], ["taxonomy.db.models.base.EnumField", 0.11409993820306556], ["int", 0.11082081806680841]], "updated_task_instance": [["int", 0.3516042685596781], ["List[List[int]]", 0.18606614131731852], ["str", 0.08870754824000003], ["List[str]", 0.08862967248377843]]}}, {"docstring": {"func": "Tests that unassigned triggers of all appropriate states are assigned.", "long_descr": null, "ret": null}, "fn_lc": [[140, 0], [188, 5]], "fn_var_ln": {"end_date": [[147, 4], [147, 31]], "finished_triggerer": [[145, 4], [145, 22]], "healthy_triggerer": [[150, 4], [150, 21]], "id": [[166, 4], [166, 38]], "new_triggerer": [[154, 4], [154, 17]], "trigger_on_healthy_triggerer": [[159, 4], [159, 32]], "trigger_on_killed_triggerer": [[162, 4], [162, 31]], "trigger_unassigned_to_triggerer": [[165, 4], [165, 35]], "triggerer_heartrate": [[144, 4], [144, 23]], "triggerer_id": [[164, 4], [164, 44]]}, "fn_var_occur": {"end_date": [["finished_triggerer", "end_date", "timezone", "utcnow", "datetime", "timedelta", "hours"]], "finished_triggerer": [["finished_triggerer", "Job", "heartrate", "triggerer_heartrate", "state", "State", "SUCCESS"], ["TriggererJobRunner", "finished_triggerer"], ["finished_triggerer", "end_date", "timezone", "utcnow", "datetime", "timedelta", "hours"], ["session", "add", "finished_triggerer"], ["finished_triggerer", "is_alive"], ["trigger_on_killed_triggerer", "triggerer_id", "finished_triggerer", "id"]], "healthy_triggerer": [["healthy_triggerer", "Job", "heartrate", "triggerer_heartrate", "state", "State", "RUNNING"], ["TriggererJobRunner", "healthy_triggerer"], ["session", "add", "healthy_triggerer"], ["healthy_triggerer", "is_alive"], ["trigger_on_healthy_triggerer", "triggerer_id", "healthy_triggerer", "id"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_healthy_triggerer", "id", "one", "triggerer_id", "healthy_triggerer", "id"]], "id": [["trigger_on_healthy_triggerer", "id"], ["trigger_on_healthy_triggerer", "triggerer_id", "healthy_triggerer", "id"], ["trigger_on_killed_triggerer", "id"], ["trigger_on_killed_triggerer", "triggerer_id", "finished_triggerer", "id"], ["trigger_unassigned_to_triggerer", "id"], ["Trigger", "assign_unassigned", "new_triggerer", "id", "session", "session", "heartrate", "triggerer_heartrate"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_killed_triggerer", "id", "one", "triggerer_id", "new_triggerer", "id"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_unassigned_to_triggerer", "id", "one", "triggerer_id", "new_triggerer", "id"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_healthy_triggerer", "id", "one", "triggerer_id", "healthy_triggerer", "id"]], "new_triggerer": [["new_triggerer", "Job", "heartrate", "triggerer_heartrate", "state", "State", "RUNNING"], ["TriggererJobRunner", "new_triggerer"], ["session", "add", "new_triggerer"], ["new_triggerer", "is_alive"], ["Trigger", "assign_unassigned", "new_triggerer", "id", "session", "session", "heartrate", "triggerer_heartrate"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_killed_triggerer", "id", "one", "triggerer_id", "new_triggerer", "id"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_unassigned_to_triggerer", "id", "one", "triggerer_id", "new_triggerer", "id"]], "trigger_on_healthy_triggerer": [["trigger_on_healthy_triggerer", "Trigger", "classpath", "kwargs"], ["trigger_on_healthy_triggerer", "id"], ["trigger_on_healthy_triggerer", "triggerer_id", "healthy_triggerer", "id"], ["session", "add", "trigger_on_healthy_triggerer"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_healthy_triggerer", "id", "one", "triggerer_id", "healthy_triggerer", "id"]], "trigger_on_killed_triggerer": [["trigger_on_killed_triggerer", "Trigger", "classpath", "kwargs"], ["trigger_on_killed_triggerer", "id"], ["trigger_on_killed_triggerer", "triggerer_id", "finished_triggerer", "id"], ["session", "add", "trigger_on_killed_triggerer"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_killed_triggerer", "id", "one", "triggerer_id", "new_triggerer", "id"]], "trigger_unassigned_to_triggerer": [["trigger_unassigned_to_triggerer", "Trigger", "classpath", "kwargs"], ["trigger_unassigned_to_triggerer", "id"], ["trigger_unassigned_to_triggerer", "triggerer_id", "None"], ["session", "add", "trigger_unassigned_to_triggerer"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_unassigned_to_triggerer", "id", "one", "triggerer_id", "new_triggerer", "id"]], "triggerer_heartrate": [["finished_triggerer", "Job", "heartrate", "triggerer_heartrate", "state", "State", "SUCCESS"], ["healthy_triggerer", "Job", "heartrate", "triggerer_heartrate", "state", "State", "RUNNING"], ["new_triggerer", "Job", "heartrate", "triggerer_heartrate", "state", "State", "RUNNING"], ["Trigger", "assign_unassigned", "new_triggerer", "id", "session", "session", "heartrate", "triggerer_heartrate"]], "triggerer_id": [["trigger_on_healthy_triggerer", "triggerer_id", "healthy_triggerer", "id"], ["trigger_on_killed_triggerer", "triggerer_id", "finished_triggerer", "id"], ["trigger_unassigned_to_triggerer", "triggerer_id", "None"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_killed_triggerer", "id", "one", "triggerer_id", "new_triggerer", "id"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_unassigned_to_triggerer", "id", "one", "triggerer_id", "new_triggerer", "id"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_healthy_triggerer", "id", "one", "triggerer_id", "healthy_triggerer", "id"]]}, "name": "test_assign_unassigned", "params": {"create_task_instance": "", "session": ""}, "params_descr": {"create_task_instance": "", "session": ""}, "params_occur": {"create_task_instance": [], "session": [["session", "add", "finished_triggerer"], ["session", "add", "healthy_triggerer"], ["session", "add", "new_triggerer"], ["session", "commit"], ["session", "add", "trigger_on_healthy_triggerer"], ["session", "add", "trigger_on_killed_triggerer"], ["session", "add", "trigger_unassigned_to_triggerer"], ["session", "commit"], ["session", "query", "Trigger", "count"], ["Trigger", "assign_unassigned", "new_triggerer", "id", "session", "session", "heartrate", "triggerer_heartrate"], ["session", "expire_all"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_killed_triggerer", "id", "one", "triggerer_id", "new_triggerer", "id"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_unassigned_to_triggerer", "id", "one", "triggerer_id", "new_triggerer", "id"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_healthy_triggerer", "id", "one", "triggerer_id", "healthy_triggerer", "id"]]}, "params_p": {"args": [], "create_task_instance": [["bool", 0.23033050661140594], ["str", 0.09656248978109086]], "kwargs": [], "session": [["abilian.core.models.subjects.User", 0.13347611017960795], ["users.models.JustfixUser", 0.0886931166382902]]}, "q_name": "test_assign_unassigned", "ret_exprs": [], "ret_type": "", "variables": {"end_date": "", "finished_triggerer": "", "healthy_triggerer": "", "id": "", "new_triggerer": "", "trigger_on_healthy_triggerer": "", "trigger_on_killed_triggerer": "", "trigger_unassigned_to_triggerer": "", "triggerer_heartrate": "", "triggerer_id": ""}, "variables_p": {"end_date": [["datetime.datetime", 0.30172398276441104], ["Dict[Any, List[str]]", 0.1657022025817988], ["datetime.datetime.datetime", 0.11353099875010662], ["int", 0.09611116052628649], ["list", 0.07613845271758597], ["datetime.date", 0.07374543935814368]], "finished_triggerer": [["str", 0.20650069580430902], ["dict", 0.19349529310899716], ["Dict[Union[bool, str], Any]", 0.11491022588631658], ["bool", 0.09732303283036108]], "healthy_triggerer": [["meeshkan.core.job.jobs.SageMakerJob", 0.1950508619733149], ["python.jobs.Job", 0.0841103315221198]], "id": [["str", 0.3043677063310447], ["Type[projecbetting.models.Odd]", 0.1215156985421254], ["int", 0.09276688044582883], ["Pattern[Any]", 0.0894079994754718]], "new_triggerer": [["Dict[str, Union[int, str]]", 0.1056715281544427], ["deeplearning.ml4pl.models.log_database.RunLogs", 0.09338367964563132]], "trigger_on_healthy_triggerer": [["int", 0.21699823474862306]], "trigger_on_killed_triggerer": [["int", 0.21699823474862306]], "trigger_unassigned_to_triggerer": [["dict", 0.19627044782508848], ["int", 0.11968813691011614], ["DefaultDict[Any, List[Any]]", 0.11002832326969242], ["list", 0.0932675175197719], ["float", 0.09283435884984786]], "triggerer_heartrate": [["str", 0.20722694649256185]], "triggerer_id": [["str", 0.5330538001132429], ["Type[projecbetting.models.Odd]", 0.09690578778156893], ["int", 0.09538750123119726]]}}, {"docstring": {"func": "Tests that the triggers assigned to a dead triggers are considered as unassigned", "long_descr": "and they are  assigned to an alive triggerer.", "ret": null}, "fn_lc": [[192, 0], [243, 102]], "fn_var_ln": {"block_triggerer_heartrate": [[199, 4], [199, 29]], "first_triggerer": [[201, 8], [201, 23]], "id": [[214, 8], [214, 38]], "second_triggerer": [[205, 8], [205, 24]], "trigger_on_first_triggerer": [[210, 8], [210, 34]], "trigger_on_second_triggerer": [[213, 8], [213, 35]], "triggerer_id": [[215, 8], [215, 48]], "triggers_ids": [[220, 8], [220, 20]]}, "fn_var_occur": {"block_triggerer_heartrate": [["first_triggerer", "Job", "heartrate", "block_triggerer_heartrate", "state", "State", "RUNNING"], ["second_triggerer", "Job", "heartrate", "block_triggerer_heartrate", "state", "State", "RUNNING"]], "first_triggerer": [["first_triggerer", "Job", "heartrate", "block_triggerer_heartrate", "state", "State", "RUNNING"], ["TriggererJobRunner", "first_triggerer"], ["session", "add", "first_triggerer"], ["first_triggerer", "is_alive"], ["trigger_on_first_triggerer", "triggerer_id", "first_triggerer", "id"], ["triggers_ids", "first_triggerer", "id", "second_triggerer", "id", "first_triggerer", "id", "second_triggerer", "id", "first_triggerer", "id", "second_triggerer", "id", "second_triggerer", "id", "second_triggerer", "id"]], "id": [["trigger_on_first_triggerer", "id"], ["trigger_on_first_triggerer", "triggerer_id", "first_triggerer", "id"], ["trigger_on_second_triggerer", "id"], ["trigger_on_second_triggerer", "triggerer_id", "second_triggerer", "id"], ["triggers_ids", "first_triggerer", "id", "second_triggerer", "id", "first_triggerer", "id", "second_triggerer", "id", "first_triggerer", "id", "second_triggerer", "id", "second_triggerer", "id", "second_triggerer", "id"], ["Trigger", "assign_unassigned", "second_triggerer", "id", "session", "session", "heartrate", "check_triggerer_heartrate"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_first_triggerer", "id", "one", "triggerer_id", "triggers_ids", "i"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_second_triggerer", "id", "one", "triggerer_id", "triggers_ids", "i"]], "second_triggerer": [["second_triggerer", "Job", "heartrate", "block_triggerer_heartrate", "state", "State", "RUNNING"], ["TriggererJobRunner", "second_triggerer"], ["session", "add", "second_triggerer"], ["second_triggerer", "is_alive"], ["trigger_on_second_triggerer", "triggerer_id", "second_triggerer", "id"], ["triggers_ids", "first_triggerer", "id", "second_triggerer", "id", "first_triggerer", "id", "second_triggerer", "id", "first_triggerer", "id", "second_triggerer", "id", "second_triggerer", "id", "second_triggerer", "id"], ["Trigger", "assign_unassigned", "second_triggerer", "id", "session", "session", "heartrate", "check_triggerer_heartrate"], ["second_triggerer", "latest_heartbeat", "datetime", "timedelta", "seconds", "check_triggerer_heartrate"]], "trigger_on_first_triggerer": [["trigger_on_first_triggerer", "Trigger", "classpath", "kwargs"], ["trigger_on_first_triggerer", "id"], ["trigger_on_first_triggerer", "triggerer_id", "first_triggerer", "id"], ["session", "add", "trigger_on_first_triggerer"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_first_triggerer", "id", "one", "triggerer_id", "triggers_ids", "i"]], "trigger_on_second_triggerer": [["trigger_on_second_triggerer", "Trigger", "classpath", "kwargs"], ["trigger_on_second_triggerer", "id"], ["trigger_on_second_triggerer", "triggerer_id", "second_triggerer", "id"], ["session", "add", "trigger_on_second_triggerer"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_second_triggerer", "id", "one", "triggerer_id", "triggers_ids", "i"]], "triggerer_id": [["trigger_on_first_triggerer", "triggerer_id", "first_triggerer", "id"], ["trigger_on_second_triggerer", "triggerer_id", "second_triggerer", "id"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_first_triggerer", "id", "one", "triggerer_id", "triggers_ids", "i"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_second_triggerer", "id", "one", "triggerer_id", "triggers_ids", "i"]], "triggers_ids": [["triggers_ids", "first_triggerer", "id", "second_triggerer", "id", "first_triggerer", "id", "second_triggerer", "id", "first_triggerer", "id", "second_triggerer", "id", "second_triggerer", "id", "second_triggerer", "id"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_first_triggerer", "id", "one", "triggerer_id", "triggers_ids", "i"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_second_triggerer", "id", "one", "triggerer_id", "triggers_ids", "i"]]}, "name": "test_assign_unassigned_missing_heartbeat", "params": {"check_triggerer_heartrate": "", "create_task_instance": "", "session": ""}, "params_descr": {"check_triggerer_heartrate": "", "create_task_instance": "", "session": ""}, "params_occur": {"check_triggerer_heartrate": [["Trigger", "assign_unassigned", "second_triggerer", "id", "session", "session", "heartrate", "check_triggerer_heartrate"], ["t", "shift", "datetime", "timedelta", "seconds", "check_triggerer_heartrate"], ["second_triggerer", "latest_heartbeat", "datetime", "timedelta", "seconds", "check_triggerer_heartrate"]], "create_task_instance": [], "session": [["session", "add", "first_triggerer"], ["session", "add", "second_triggerer"], ["session", "commit"], ["session", "add", "trigger_on_first_triggerer"], ["session", "add", "trigger_on_second_triggerer"], ["session", "commit"], ["session", "query", "Trigger", "count"], ["Trigger", "assign_unassigned", "second_triggerer", "id", "session", "session", "heartrate", "check_triggerer_heartrate"], ["session", "expire_all"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_first_triggerer", "id", "one", "triggerer_id", "triggers_ids", "i"], ["session", "query", "Trigger", "filter", "Trigger", "id", "trigger_on_second_triggerer", "id", "one", "triggerer_id", "triggers_ids", "i"]]}, "params_p": {"args": [], "check_triggerer_heartrate": [["float", 0.11950976865082757], ["server.models.bike.Bike", 0.11950976865082757], ["server.models.Rental", 0.11950976865082757], ["str", 0.09011818533758259], ["zerver.models.UserProfile", 0.08984855218201346], ["zerver.models.UserGroup", 0.08903022158681521], ["List[zerver.models.UserProfile]", 0.08903022158681521], ["raiden.utils.Address", 0.08585460826895946]], "create_task_instance": [["bool", 0.23033050661140594], ["str", 0.09656248978109086]], "kwargs": [], "session": [["abilian.core.models.subjects.User", 0.1395865547746269], ["users.models.JustfixUser", 0.09216074937527405], ["List[zerver.models.UserProfile]", 0.0912511526916744]]}, "q_name": "test_assign_unassigned_missing_heartbeat", "ret_exprs": [], "ret_type": "", "variables": {"block_triggerer_heartrate": "", "first_triggerer": "", "id": "", "second_triggerer": "", "trigger_on_first_triggerer": "", "trigger_on_second_triggerer": "", "triggerer_id": "", "triggers_ids": ""}, "variables_p": {"block_triggerer_heartrate": [["Tuple[Any, Any, Any, Any, Any]", 0.10692174581982683], ["int", 0.10556016790282302]], "first_triggerer": [["meeshkan.core.job.jobs.SageMakerJob", 0.09043899195298864]], "id": [["str", 0.3043677063310447], ["Type[projecbetting.models.Odd]", 0.1215156985421254], ["int", 0.09276688044582883], ["Pattern[Any]", 0.0894079994754718]], "second_triggerer": [["meeshkan.core.job.jobs.SageMakerJob", 0.09043899195298864]], "trigger_on_first_triggerer": [["int", 0.21699823474862306]], "trigger_on_second_triggerer": [["int", 0.21699823474862306]], "triggerer_id": [["str", 0.38856515016313525], ["models.File", 0.11532755446690571], ["int", 0.09956021098105891], ["Optional[int]", 0.09122862316341426]], "triggers_ids": [["str", 0.3104017946843456], ["int", 0.18800421474159407]]}}, {"docstring": {"func": "Tests that triggers are sorted by the creation_date.", "long_descr": null, "ret": null}, "fn_lc": [[246, 0], [273, 44]], "fn_var_ln": {"id": [[265, 4], [265, 18]], "trigger_ids_query": [[271, 4], [271, 21]], "trigger_new": [[258, 4], [258, 15]], "trigger_old": [[250, 4], [250, 15]]}, "fn_var_occur": {"id": [["trigger_old", "id"], ["trigger_new", "id"]], "trigger_ids_query": [["trigger_ids_query", "Trigger", "get_sorted_triggers", "capacity", "alive_triggerer_ids", "session", "session"]], "trigger_new": [["trigger_new", "Trigger", "classpath", "kwargs", "created_date", "datetime", "datetime", "tzinfo", "pytz", "timezone"], ["trigger_new", "id"], ["session", "add", "trigger_new"]], "trigger_old": [["trigger_old", "Trigger", "classpath", "kwargs", "created_date", "datetime", "datetime", "tzinfo", "pytz", "timezone"], ["trigger_old", "id"], ["session", "add", "trigger_old"]]}, "name": "test_get_sorted_triggers", "params": {"create_task_instance": "", "session": ""}, "params_descr": {"create_task_instance": "", "session": ""}, "params_occur": {"create_task_instance": [], "session": [["session", "add", "trigger_old"], ["session", "add", "trigger_new"], ["session", "commit"], ["session", "query", "Trigger", "count"], ["trigger_ids_query", "Trigger", "get_sorted_triggers", "capacity", "alive_triggerer_ids", "session", "session"]]}, "params_p": {"args": [], "create_task_instance": [["bool", 0.08061991377162069], ["core.models.Recipe", 0.07732066007160691]], "kwargs": [], "session": [["abilian.core.models.subjects.User", 0.12981854840304466], ["app.models.Game", 0.10021809954734345], ["app.models.User", 0.09177456955821017]]}, "q_name": "test_get_sorted_triggers", "ret_exprs": [], "ret_type": "", "variables": {"id": "", "trigger_ids_query": "", "trigger_new": "", "trigger_old": ""}, "variables_p": {"id": [["int", 0.2640522182397213], ["dict", 0.20070168129904248], ["Optional[Mapping[str, Any]]", 0.10227576211833743], ["str", 0.08961995588297673], ["Optional[int]", 0.08529279803944859], ["Optional[List[Any]]", 0.08405179328644057]], "trigger_ids_query": [["list", 0.30493882579366627], ["int", 0.12471398781701415], ["List[str]", 0.09849114355405099], ["Dict[str, str]", 0.09625800178547307], ["str", 0.09313117277930014], ["Tuple[List[Any], List[Any]]", 0.09229527088787794]], "trigger_new": [["str", 0.2662492868402947], ["datetime.datetime.datetime", 0.15853025389919329], ["datetime.date.time.date", 0.11720927523617196], ["datetime.date.time.timedelta", 0.11110352278342395], ["int", 0.09752603712076487], ["list", 0.08566443847834287], ["datetime.date", 0.08557581488491699], ["Union[pytz._DstTzInfo, pytz._StaticTzInfo, pytz._UTCclass]", 0.0781413707568914]], "trigger_old": [["str", 0.25251046046999265], ["datetime.datetime.datetime", 0.23865458642219706], ["datetime.date", 0.1846718408985852], ["datetime.date.time.timedelta", 0.1216854584675251], ["datetime.datetime.time", 0.10611513619192228], ["datetime.datetime", 0.09636251754977752]]}}], "imports": ["__future__", "annotations", "datetime", "pytest", "pytz", "airflow", "jobs", "job", "Job", "airflow", "jobs", "triggerer_job_runner", "TriggererJobRunner", "airflow", "models", "TaskInstance", "Trigger", "airflow", "operators", "empty", "EmptyOperator", "airflow", "triggers", "base", "TriggerEvent", "airflow", "utils", "timezone", "airflow", "utils", "session", "create_session", "airflow", "utils", "state", "State", "time_machine"], "mod_var_ln": {}, "mod_var_occur": {}, "no_types_annot": {"D": 0, "I": 0, "U": 63}, "session_id": "vX-YY-BA2JSJzkZcACOYv2wn1BvXUx6Q9BwfE1XgNiM", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {}, "variables_p": {}}}