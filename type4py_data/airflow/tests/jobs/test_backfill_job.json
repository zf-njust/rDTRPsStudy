{"error": null, "response": {"classes": [{"cls_lc": [[83, 0], [2092, 19]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[85, 4], [89, 24]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "clean_db", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.clean_db", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[92, 4], [98, 45]], "fn_var_ln": {"dagbag": [[95, 8], [95, 19]], "parser": [[94, 8], [94, 19]]}, "fn_var_occur": {"dagbag": [["self", "dagbag", "dag_bag"], ["self", "dagbag", "dags", "values"]], "parser": [["self", "parser", "cli_parser", "get_parser"]]}, "name": "set_instance_attrs", "params": {"dag_bag": "", "self": ""}, "params_descr": {"dag_bag": "", "self": ""}, "params_occur": {"dag_bag": [["self", "dagbag", "dag_bag"]], "self": [["self", "clean_db"], ["self", "parser", "cli_parser", "get_parser"], ["self", "dagbag", "dag_bag"], ["self", "dagbag", "dags", "values"]]}, "params_p": {"args": [], "dag_bag": [["bool", 0.5], ["float", 0.30000000000000004]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.set_instance_attrs", "ret_exprs": [], "ret_type": "", "variables": {"dagbag": "", "parser": ""}, "variables_p": {"dagbag": [["str", 0.390140404636254], ["int", 0.3404659137678828], ["Dict[str, List[str]]", 0.09221315064559184], ["float", 0.08859026547513563], ["tuple", 0.08859026547513563]], "parser": [["Dict[str, Union[Any, Any]]", 0.09984435457208517]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[100, 4], [112, 18]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "_get_dummy_dag", "params": {"dag_id": "", "dag_maker_fixture": "", "kwargs": "", "max_active_tis_per_dag": "", "pool": "", "self": "", "task_id": ""}, "params_descr": {"dag_id": "", "dag_maker_fixture": "", "kwargs": "", "max_active_tis_per_dag": "", "pool": "", "self": "", "task_id": ""}, "params_occur": {"dag_id": [["dag_maker_fixture", "dag_id", "dag_id", "schedule", "kwargs", "dag"]], "dag_maker_fixture": [["dag_maker_fixture", "dag_id", "dag_id", "schedule", "kwargs", "dag"]], "kwargs": [["dag_maker_fixture", "dag_id", "dag_id", "schedule", "kwargs", "dag"]], "max_active_tis_per_dag": [["EmptyOperator", "task_id", "task_id", "pool", "pool", "max_active_tis_per_dag", "max_active_tis_per_dag"]], "pool": [["EmptyOperator", "task_id", "task_id", "pool", "pool", "max_active_tis_per_dag", "max_active_tis_per_dag"]], "self": [], "task_id": [["EmptyOperator", "task_id", "task_id", "pool", "pool", "max_active_tis_per_dag", "max_active_tis_per_dag"]]}, "params_p": {"args": [], "dag_id": [["int", 0.09280037676946044], ["List[int]", 0.09147458843261513]], "dag_maker_fixture": [["int", 0.09280037676946044], ["List[int]", 0.09147458843261513]], "kwargs": [], "max_active_tis_per_dag": [["int", 0.20048643225980087], ["str", 0.11167713015960665], ["List[int]", 0.08702773504563682], ["Optional[int]", 0.08350248417402574]], "pool": [["int", 0.20048643225980087], ["str", 0.11167713015960665], ["List[int]", 0.08702773504563682], ["Optional[int]", 0.08350248417402574]], "self": [], "task_id": [["int", 0.20048643225980087], ["str", 0.11167713015960665], ["List[int]", 0.08702773504563682], ["Optional[int]", 0.08350248417402574]]}, "q_name": "TestBackfillJob._get_dummy_dag", "ret_exprs": ["return dag"], "ret_type": "", "ret_type_p": [["str", 0.19999999999999998], ["bool", 0.09999999999999999]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[114, 4], [119, 20]], "fn_var_ln": {"count": [[115, 8], [115, 13]]}, "fn_var_occur": {"count": []}, "name": "_times_called_with", "params": {"class_": "", "method": "", "self": ""}, "params_descr": {"class_": "", "method": "", "self": ""}, "params_occur": {"class_": [["isinstance", "args", "class_"]], "method": [["method", "call_args_list"]], "self": []}, "params_p": {"args": [], "class_": [["Optional[str]", 0.2626162590360266], ["Dict[str, Any]", 0.05412063827882838]], "kwargs": [], "method": [["Optional[Iterable[Any]]", 0.13461091141806636], ["types.ModuleType", 0.12147138877960682], ["str", 0.10449987402043695], ["list", 0.10148197817842657], ["bool", 0.07610927951217486], ["int", 0.07518152594815243]], "self": []}, "q_name": "TestBackfillJob._times_called_with", "ret_exprs": ["return count"], "ret_type": "", "ret_type_p": [["IO[str]", 0.09341697703264394], ["Dict[str, Any]", 0.09341697703264394], ["str", 0.09341697703264394]], "variables": {"count": ""}, "variables_p": {"count": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[121, 4], [137, 44]], "fn_var_ln": {"dag": [[122, 8], [122, 11]], "dag_run": [[123, 8], [123, 15]], "job": [[125, 8], [125, 11]], "job_runner": [[126, 8], [126, 18]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dummy_dag", "dag_maker"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "ignore_first_depends_on_past", "True"]], "dag_run": [["dag_run", "dag_maker", "create_dagrun", "state", "None"], ["job_runner", "_set_unfinished_dag_runs_to_failed", "dag_run"], ["dag_run", "refresh_from_db"], ["State", "FAILED", "dag_run", "state"]], "job": [["job", "Job", "executor", "MockExecutor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "ignore_first_depends_on_past", "True"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "ignore_first_depends_on_past", "True"], ["job_runner", "_set_unfinished_dag_runs_to_failed", "dag_run"]]}, "name": "test_unfinished_dag_runs_set_to_failed", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dummy_dag", "dag_maker"], ["dag_run", "dag_maker", "create_dagrun", "state", "None"]], "self": [["dag", "self", "_get_dummy_dag", "dag_maker"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_unfinished_dag_runs_set_to_failed", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_run": "", "job": "", "job_runner": ""}, "variables_p": {"dag": [["list", 0.33076155108603833], ["str", 0.18893748296824406], ["List[Union[Any, Any, Any, Any]]", 0.10172108738368804], ["bool", 0.09468381132345867]], "dag_run": [["bytes", 0.20804949992058253], ["Tuple[int, int]", 0.11025669258600716], ["Optional[object]", 0.09933635122117544], ["Type[str]", 0.08675407691247976], ["str", 0.08325453534810802]], "job": [["str", 0.12863963198751818], ["Optional[List[Any]]", 0.12341893238771337], ["dict", 0.08634432236839679]], "job_runner": [["Dict[Any, str]", 0.12033544224407712], ["Sequence[str]", 0.08281924180205968]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[139, 4], [158, 45]], "fn_var_ln": {"dag": [[140, 8], [140, 11]], "dag_run": [[141, 8], [141, 15]], "job": [[146, 8], [146, 11]], "job_runner": [[147, 8], [147, 18]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dummy_dag", "dag_maker"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "ignore_first_depends_on_past", "True"]], "dag_run": [["dag_run", "dag_maker", "create_dagrun", "state", "None"], ["dag_run", "get_task_instances"], ["job_runner", "_set_unfinished_dag_runs_to_failed", "dag_run"], ["dag_run", "refresh_from_db"], ["State", "SUCCESS", "dag_run", "state"]], "job": [["job", "Job", "executor", "MockExecutor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "ignore_first_depends_on_past", "True"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "ignore_first_depends_on_past", "True"], ["job_runner", "_set_unfinished_dag_runs_to_failed", "dag_run"]]}, "name": "test_dag_run_with_finished_tasks_set_to_success", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dummy_dag", "dag_maker"], ["dag_run", "dag_maker", "create_dagrun", "state", "None"]], "self": [["dag", "self", "_get_dummy_dag", "dag_maker"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_dag_run_with_finished_tasks_set_to_success", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_run": "", "job": "", "job_runner": ""}, "variables_p": {"dag": [["list", 0.33076155108603833], ["str", 0.18893748296824406], ["List[Union[Any, Any, Any, Any]]", 0.10172108738368804], ["bool", 0.09468381132345867]], "dag_run": [["bytes", 0.19303688160346355], ["str", 0.14641058847958746], ["Tuple[int, int]", 0.09698446487673162]], "job": [["str", 0.12863963198751818], ["Optional[List[Any]]", 0.12341893238771337], ["dict", 0.08634432236839679]], "job_runner": [["Dict[Any, str]", 0.12033544224407712], ["Sequence[str]", 0.08281924180205968]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[161, 4], [184, 34]], "fn_var_ln": {"dag": [[162, 8], [162, 11]], "dag_run": [[179, 8], [179, 15]], "job": [[169, 8], [169, 11]], "job_runner": [[170, 8], [170, 18]], "target_dag": [[163, 8], [163, 18]], "target_dag_run": [[166, 8], [166, 22]], "task_instances_list": [[182, 8], [182, 27]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_first_depends_on_past", "True"], ["dag_run", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "dag", "dag_id", "one_or_none"], ["task_instances_list", "job_runner", "_task_instances_for_dag_run", "dag", "dag", "dag_run", "dag_run"]], "dag_run": [["dag_run", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "dag", "dag_id", "one_or_none"], ["dag_run", "None"], ["task_instances_list", "job_runner", "_task_instances_for_dag_run", "dag", "dag", "dag_run", "dag_run"]], "job": [["job", "Job", "executor", "MockExecutor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_first_depends_on_past", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_first_depends_on_past", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"], ["task_instances_list", "job_runner", "_task_instances_for_dag_run", "dag", "dag", "dag_run", "dag_run"]], "target_dag": [["target_dag", "self", "dagbag", "get_dag"], ["target_dag", "sync_to_db"], ["target_dag_run", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "target_dag", "dag_id", "one_or_none"]], "target_dag_run": [["target_dag_run", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "target_dag", "dag_id", "one_or_none"], ["target_dag_run", "None"]], "task_instances_list": [["task_instances_list", "job_runner", "_task_instances_for_dag_run", "dag", "dag", "dag_run", "dag_run"]]}, "name": "test_trigger_controller_dag", "params": {"self": "", "session": ""}, "params_descr": {"self": "", "session": ""}, "params_occur": {"self": [["dag", "self", "dagbag", "get_dag"], ["target_dag", "self", "dagbag", "get_dag"]], "session": [["target_dag_run", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "target_dag", "dag_id", "one_or_none"], ["dag_run", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "dag", "dag_id", "one_or_none"]]}, "params_p": {"args": [], "kwargs": [], "self": [], "session": [["sqlalchemy.orm.session.Session", 0.16837609483300522], ["yawasscanner.session.Session", 0.12046567507062814], ["Mapping", 0.08931687281197974], ["grouper.settings.Settings", 0.08277392251373109]]}, "q_name": "TestBackfillJob.test_trigger_controller_dag", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_run": "", "job": "", "job_runner": "", "target_dag": "", "target_dag_run": "", "task_instances_list": ""}, "variables_p": {"dag": [["dict", 0.1072434004714834], ["Sequence[str]", 0.10538737443216332], ["Tuple[Any, Any, Any, Any, Any, Any, Any, Any, Any, Any]", 0.10351035044012256], ["Dict[Any, str]", 0.09341087044150327]], "dag_run": [["int", 0.14885164934359485], ["Dict[str, str]", 0.1089382300800349], ["Callable(json.dumps)[[Named(obj, Any), KeywordOnly(skipkeys, bool, default), KeywordOnly(ensure_ascii, bool, default), KeywordOnly(check_circular, bool, default), KeywordOnly(allow_nan, bool, default), KeywordOnly(cls, Optional[Any], default), KeywordOnly(indent, Union[None, int, str], default), KeywordOnly(separators, Optional[Any], default), KeywordOnly(default, Optional[Any], default), KeywordOnly(sort_keys, bool, default), Keywords(Any)], str]", 0.10078196037897783], ["Dict[str, Optional[str]]", 0.09706554829691144], ["o2a.converter.task.Task", 0.0951463802080352], ["Dict[str, Dict[str, Any]]", 0.09293822600591457], ["legistar.models.MatterStatus", 0.08956752052322037]], "job": [["str", 0.12863963198751818], ["Optional[List[Any]]", 0.12341893238771337], ["dict", 0.08634432236839679]], "job_runner": [["Dict[Any, str]", 0.11445898598751932]], "target_dag": [["int", 0.37825095587459967], ["Dict[str, Union[float, str]]", 0.08786482649162002]], "target_dag_run": [["str", 0.30159409256505954], ["dict", 0.1956983344693245], ["list", 0.10810909153434281], ["Dict[int, str]", 0.10479663013761496], ["List[int]", 0.09719371629828828]], "task_instances_list": [["List[Tuple[Any, str]]", 0.12191218507478263], ["str", 0.10955881455229463], ["golem.task.taskcomputer.TaskComputer", 0.10622455909351763], ["Dict[str, Any]", 0.09862962945157001], ["nufb.task.Task", 0.09611657985639084], ["List[int]", 0.09309061665451475]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[187, 4], [232, 23]], "fn_var_ln": {"dag": [[188, 8], [188, 11]], "drs": [[224, 8], [224, 11]], "end_date": [[190, 8], [190, 16]], "executor": [[192, 8], [192, 16]], "expected_execution_order": [[204, 8], [204, 32]], "job": [[193, 8], [193, 11]], "job_runner": [[194, 8], [194, 18]], "session": [[223, 8], [223, 15]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "end_date", "ignore_first_depends_on_past", "True"], ["dag", "dag_id", "task_id", "when", "isoformat", "State", "SUCCESS", "None", "task_id", "when", "expected_execution_order", "executor", "sorted_tasks"], ["drs", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "dag", "dag_id", "order_by", "DagRun", "execution_date", "all"], ["dag", "clear"]], "drs": [["drs", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "dag", "dag_id", "order_by", "DagRun", "execution_date", "all"], ["drs", "execution_date", "DEFAULT_DATE"], ["drs", "state", "State", "SUCCESS"], ["drs", "execution_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["drs", "state", "State", "SUCCESS"]], "end_date": [["end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "end_date", "ignore_first_depends_on_past", "True"], ["expected_execution_order", "DEFAULT_DATE", "DEFAULT_DATE", "DEFAULT_DATE", "end_date", "end_date", "end_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "end_date"]], "executor": [["executor", "MockExecutor", "parallelism"], ["job", "Job", "executor", "executor"], ["dag", "dag_id", "task_id", "when", "isoformat", "State", "SUCCESS", "None", "task_id", "when", "expected_execution_order", "executor", "sorted_tasks"]], "expected_execution_order": [["expected_execution_order", "DEFAULT_DATE", "DEFAULT_DATE", "DEFAULT_DATE", "end_date", "end_date", "end_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "end_date"], ["dag", "dag_id", "task_id", "when", "isoformat", "State", "SUCCESS", "None", "task_id", "when", "expected_execution_order", "executor", "sorted_tasks"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "end_date", "ignore_first_depends_on_past", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "end_date", "ignore_first_depends_on_past", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "session": [["session", "settings", "Session"], ["drs", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "dag", "dag_id", "order_by", "DagRun", "execution_date", "all"], ["session", "close"]]}, "name": "test_backfill_multi_dates", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["dag", "self", "dagbag", "get_dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_multi_dates", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "drs": "", "end_date": "", "executor": "", "expected_execution_order": "", "job": "", "job_runner": "", "session": ""}, "variables_p": {"dag": [["dict", 0.11539679163688087], ["str", 0.10189947972688694], ["Tuple[Any, Any, Any, Any, Any, Any, Any, Any, Any, Any]", 0.09979256164928518], ["Sequence[str]", 0.09291540023167541]], "drs": [["int", 0.44667678967047064], ["lists.models.Todo", 0.09698677213655513], ["set", 0.08550042929085241], ["str", 0.08500991145890563], ["list", 0.0817407004623493]], "end_date": [["datetime.datetime", 0.301493589661724], ["datetime.date.time.date", 0.21286069648123832], ["datetime.date", 0.1807606047512561], ["datetime.datetime.datetime", 0.12936251708686897], ["Dict[Any, List[str]]", 0.08644701848881536]], "executor": [["str", 0.3051723445831046], ["threading.Semaphore", 0.11243744361420266], ["Dict[str, Union[Any, str]]", 0.09573850574004274]], "expected_execution_order": [["Type[datetime.date]", 0.3129267926462275], ["datetime.timezone", 0.1837690546090634], ["datetime.timedelta", 0.12184944162252719], ["List[Tuple[Any, Any]]", 0.09705997355416132], ["str", 0.09694556083173286], ["datetime.datetime.timezone", 0.09654665278687109], ["datetime.datetime", 0.09090252394941659]], "job": [["list", 0.2804904031598412], ["dict", 0.11333847419435909], ["server.openslides.users.models.Group", 0.10260709108301021], ["guillotina.db.interfaces.ITransaction", 0.09340945446173977]], "job_runner": [["Dict[Any, str]", 0.11644406140551947]], "session": [["raiden.transfer.state.HopState", 0.19581228858648683], ["dict", 0.1412387802691479], ["legistar.models.MatterStatus", 0.0977022022415662]]}}, {"docstring": {"func": "Test backfilling example dags", "long_descr": "Try to backfill some of the example dags. Be careful, not all dags are suitable\nfor doing this. For example, a dag that sleeps forever, or does not have a\nschedule won't work here since you simply can't backfill them.", "ret": null}, "fn_lc": [[274, 4], [299, 34]], "fn_var_ln": {"dag": [[282, 8], [282, 11]], "executor": [[285, 8], [285, 16]], "job": [[286, 8], [286, 11]], "job_runner": [[287, 8], [287, 18]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["logger", "info", "dag", "dag_id"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_first_depends_on_past", "True"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"], ["dag_id", "task_id", "DEFAULT_DATE", "isoformat", "State", "SUCCESS", "None", "task_id", "expected_execution_order", "executor", "sorted_tasks"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_first_depends_on_past", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_first_depends_on_past", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]]}, "name": "test_backfill_examples", "params": {"dag_id": "", "expected_execution_order": "", "self": ""}, "params_descr": {"dag_id": "", "expected_execution_order": "", "self": ""}, "params_occur": {"dag_id": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["logger", "info", "dag", "dag_id"], ["dag_id", "task_id", "DEFAULT_DATE", "isoformat", "State", "SUCCESS", "None", "task_id", "expected_execution_order", "executor", "sorted_tasks"]], "expected_execution_order": [["dag_id", "task_id", "DEFAULT_DATE", "isoformat", "State", "SUCCESS", "None", "task_id", "expected_execution_order", "executor", "sorted_tasks"]], "self": [["dag", "self", "dagbag", "get_dag", "dag_id"]]}, "params_p": {"args": [], "dag_id": [["str", 0.5027024475962965], ["int", 0.29709183579438675], ["Mapping[str, Any]", 0.10010285830465832]], "expected_execution_order": [["str", 0.6752840679497549], ["Optional[str]", 0.14664897661029536], ["int", 0.09485319029699302]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_examples", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "executor": "", "job": "", "job_runner": ""}, "variables_p": {"dag": [["float", 0.1868572661849371], ["List[Dict[str, Any]]", 0.10093661913104181], ["dict", 0.092269374179497], ["datetime.datetime.timedelta", 0.09137577551112457], ["datetime.datetime.datetime", 0.09081444093260771]], "executor": [], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11445898598751932]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[301, 4], [323, 34]], "fn_var_ln": {"conf_": [[307, 8], [307, 13]], "dag": [[302, 8], [302, 11]], "dr": [[319, 8], [319, 10]], "executor": [[305, 8], [305, 16]], "job": [[308, 8], [308, 11]], "job_runner": [[309, 8], [309, 18]]}, "fn_var_occur": {"conf_": [["conf_", "json", "loads"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "conf", "conf_"], ["conf_", "dr", "conf"]], "dag": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "conf", "conf_"]], "dr": [["dr", "DagRun", "find", "dag_id", "execution_start_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["conf_", "dr", "conf"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "conf", "conf_"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "conf", "conf_"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]]}, "name": "test_backfill_conf", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id"], ["dag_maker", "create_dagrun", "state", "None"]], "self": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_conf", "ret_exprs": [], "ret_type": "", "variables": {"conf_": "", "dag": "", "dr": "", "executor": "", "job": "", "job_runner": ""}, "variables_p": {"conf_": [["list", 0.21604521922634906], ["Optional[Callable[..., Any]]", 0.20174368613129154], ["List[Union[Any, Any, Any, Any]]", 0.09881200297468377], ["Dict[Tuple[Any, str], str]", 0.08315815664353059], ["Dict[Tuple[Any, Any], Any]", 0.07181946721404202], ["dict", 0.06861425823133381]], "dag": [["dict", 0.4217388297452475], ["Dict[str, str]", 0.0917751342331643], ["List[str]", 0.08928599530556602]], "dr": [["Dict[str, Any]", 0.2014855090497955], ["datetime.datetime", 0.09717628572353498], ["str", 0.09717628572353498], ["List[int]", 0.08170839475684687], ["byceps.services.party.transfer.models.Party", 0.07953174351171582]], "executor": [["mock.Mock", 0.17527592926847138]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.12033544224407712], ["Sequence[str]", 0.08281924180205968]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[326, 4], [378, 64]], "fn_var_ln": {"dag": [[328, 8], [328, 11]], "executor": [[335, 8], [335, 16]], "job": [[337, 8], [337, 11]], "job_runner": [[338, 8], [338, 18]], "max_active_tis_per_dag": [[327, 8], [327, 30]], "num_running_task_instances": [[351, 8], [351, 34]], "task_concurrency_limit_reached_at_least_once": [[356, 16], [356, 60]], "times_dag_concurrency_limit_reached_in_debug": [[361, 8], [361, 52]], "times_pool_limit_reached_in_debug": [[366, 8], [366, 41]], "times_task_concurrency_limit_reached_in_debug": [[371, 8], [371, 53]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "max_active_tis_per_dag", "max_active_tis_per_dag"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"], ["len", "executor", "history"], ["executor", "history"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "max_active_tis_per_dag": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "max_active_tis_per_dag", "max_active_tis_per_dag"], ["len", "running_task_instances", "max_active_tis_per_dag"], ["len", "running_task_instances", "max_active_tis_per_dag"]], "num_running_task_instances": [["num_running_task_instances", "len", "running_task_instances"]], "task_concurrency_limit_reached_at_least_once": [["task_concurrency_limit_reached_at_least_once", "False"], ["task_concurrency_limit_reached_at_least_once", "True"]], "times_dag_concurrency_limit_reached_in_debug": [["times_dag_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "DagConcurrencyLimitReached"]], "times_pool_limit_reached_in_debug": [["times_pool_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "NoAvailablePoolSlot"]], "times_task_concurrency_limit_reached_in_debug": [["times_task_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "TaskConcurrencyLimitReached"]]}, "name": "test_backfill_respect_max_active_tis_per_dag_limit", "params": {"dag_maker": "", "mock_log": "", "self": ""}, "params_descr": {"dag_maker": "", "mock_log": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "max_active_tis_per_dag", "max_active_tis_per_dag"], ["dag_maker", "create_dagrun", "state", "None"]], "mock_log": [["times_dag_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "DagConcurrencyLimitReached"], ["times_pool_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "NoAvailablePoolSlot"], ["times_task_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "TaskConcurrencyLimitReached"]], "self": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "max_active_tis_per_dag", "max_active_tis_per_dag"], ["times_dag_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "DagConcurrencyLimitReached"], ["times_pool_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "NoAvailablePoolSlot"], ["times_task_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "TaskConcurrencyLimitReached"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "mock_log": [["tests.test_util.aiohttp.AiohttpClientMocker", 0.193782212613225], ["Dict[str, Any]", 0.0901963215492896]], "self": []}, "q_name": "TestBackfillJob.test_backfill_respect_max_active_tis_per_dag_limit", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "executor": "", "job": "", "job_runner": "", "max_active_tis_per_dag": "", "num_running_task_instances": "", "task_concurrency_limit_reached_at_least_once": "", "times_dag_concurrency_limit_reached_in_debug": "", "times_pool_limit_reached_in_debug": "", "times_task_concurrency_limit_reached_in_debug": ""}, "variables_p": {"dag": [["int", 0.7071983038077675], ["str", 0.10050381686903646], ["list", 0.09631813748524325]], "executor": [["int", 0.19583143321129043], ["List[str]", 0.11020456459254284], ["float", 0.1087869306075289], ["set", 0.0985874011442543], ["Dict[int, Dict[str, Any]]", 0.09668955308445275], ["str", 0.09195844854900993], ["list", 0.09104428120321958]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11861072391587794], ["Sequence[str]", 0.07914521800214441]], "max_active_tis_per_dag": [["int", 0.6718928408856274]], "num_running_task_instances": [["List[bool]", 0.6243676060789192], ["List[str]", 0.18891634074611313], ["Dict[str, Union[None, dict, Any]]", 0.10255815872918057], ["list", 0.08415789444578718]], "task_concurrency_limit_reached_at_least_once": [["List[List[int]]", 0.3236796521676692], ["int", 0.14045902268992386], ["List[str]", 0.11617337555126751], ["bytes", 0.09366015527193934]], "times_dag_concurrency_limit_reached_in_debug": [["int", 0.08451941665617924]], "times_pool_limit_reached_in_debug": [["Dict[int, int]", 0.09266442460175625]], "times_task_concurrency_limit_reached_in_debug": [["tracim.models.data.Content", 0.37496418895368094], ["str", 0.18766469577390008], ["Dict[str, List[str]]", 0.13970648458046414], ["int", 0.09695670532771053], ["bool", 0.09640294785527832]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[412, 8], [416, 46]], "fn_var_ln": {"running_tis_per_dagrun_dict": [[413, 12], [413, 39]]}, "fn_var_occur": {"running_tis_per_dagrun_dict": [["running_tis_per_dagrun_dict", "defaultdict", "int"], ["running_tis_per_dagrun_dict", "running_ti", "dag_run", "id"]]}, "name": "get_running_tis_per_dagrun", "params": {"running_tis": ""}, "params_descr": {"running_tis": ""}, "params_occur": {"running_tis": []}, "params_p": {"args": [], "kwargs": [], "running_tis": [["bool", 0.33904350553484863], ["Optional[Iterable[str]]", 0.18952462486108607], ["str", 0.09476231243054303], ["int", 0.09476231243054303]], "self": []}, "q_name": "TestBackfillJob.test_backfill_respect_max_active_tis_per_dagrun_limit.<locals>.get_running_tis_per_dagrun", "ret_exprs": ["return running_tis_per_dagrun_dict"], "ret_type": "", "ret_type_p": [["bool", 0.704303208957733], ["int", 0.2956967910422672]], "variables": {"running_tis_per_dagrun_dict": ""}, "variables_p": {"running_tis_per_dagrun_dict": [["Dict[str, str]", 0.18819393849237245], ["List[int]", 0.11135904459400077], ["Dict[str, Any]", 0.10661662157675585], ["Dict[str, bool]", 0.09820491420115142], ["int", 0.09807968244562916], ["List[str]", 0.09736889545952442], ["Callable[[List[Any]], List[Any]]", 0.09194229206717931]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[382, 4], [460, 64]], "fn_var_ln": {"executor": [[396, 8], [396, 16]], "job": [[398, 8], [398, 11]], "job_runner": [[399, 8], [399, 18]], "kwargs": [[387, 8], [387, 14]], "max_active_tis_per_dag": [[385, 8], [385, 30]], "max_active_tis_per_dagrun": [[386, 8], [386, 33]], "num_running_task_instances": [[418, 8], [418, 34]], "running_tis_per_dagrun_dict": [[422, 12], [422, 39]], "task_concurrency_limit_reached_at_least_once": [[430, 12], [430, 56]], "times_dag_concurrency_limit_reached_in_debug": [[443, 8], [443, 52]], "times_pool_limit_reached_in_debug": [[448, 8], [448, 41]], "times_task_concurrency_limit_reached_in_debug": [[453, 8], [453, 53]]}, "fn_var_occur": {"executor": [["executor", "history"]], "job": [], "job_runner": [], "kwargs": [], "max_active_tis_per_dag": [["len", "running_task_instances", "max_active_tis_per_dag"]], "max_active_tis_per_dagrun": [["all", "num_running_tis", "max_active_tis_per_dagrun", "num_running_tis", "running_tis_per_dagrun_dict", "values"], ["task_concurrency_limit_reached_at_least_once", "task_concurrency_limit_reached_at_least_once", "any", "num_running_tis", "max_active_tis_per_dagrun", "num_running_tis", "running_tis_per_dagrun_dict", "values"]], "num_running_task_instances": [["num_running_task_instances", "len", "running_task_instances"]], "running_tis_per_dagrun_dict": [["running_tis_per_dagrun_dict", "get_running_tis_per_dagrun", "running_task_instances"], ["all", "num_running_tis", "max_active_tis_per_dagrun", "num_running_tis", "running_tis_per_dagrun_dict", "values"], ["task_concurrency_limit_reached_at_least_once", "task_concurrency_limit_reached_at_least_once", "any", "num_running_tis", "max_active_tis_per_dagrun", "num_running_tis", "running_tis_per_dagrun_dict", "values"]], "task_concurrency_limit_reached_at_least_once": [["task_concurrency_limit_reached_at_least_once", "task_concurrency_limit_reached_at_least_once", "any", "num_running_tis", "max_active_tis_per_dagrun", "num_running_tis", "running_tis_per_dagrun_dict", "values"]], "times_dag_concurrency_limit_reached_in_debug": [["times_dag_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "DagConcurrencyLimitReached"]], "times_pool_limit_reached_in_debug": [["times_pool_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "NoAvailablePoolSlot"]], "times_task_concurrency_limit_reached_in_debug": [["times_task_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "TaskConcurrencyLimitReached"]]}, "name": "test_backfill_respect_max_active_tis_per_dagrun_limit", "params": {"dag_maker": "", "mock_log": "", "self": "", "with_max_active_tis_per_dag": ""}, "params_descr": {"dag_maker": "", "mock_log": "", "self": "", "with_max_active_tis_per_dag": ""}, "params_occur": {"dag_maker": [], "mock_log": [["times_dag_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "DagConcurrencyLimitReached"], ["times_pool_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "NoAvailablePoolSlot"], ["times_task_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "TaskConcurrencyLimitReached"]], "self": [["times_dag_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "DagConcurrencyLimitReached"], ["times_pool_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "NoAvailablePoolSlot"], ["times_task_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "TaskConcurrencyLimitReached"]], "with_max_active_tis_per_dag": []}, "params_p": {"args": [], "dag_maker": [["mock.Mock", 0.25074767849390406], ["mock.MagicMock", 0.2431817259067205]], "kwargs": [], "mock_log": [["tests.test_util.aiohttp.AiohttpClientMocker", 0.193782212613225], ["Dict[str, Any]", 0.0901963215492896]], "self": [], "with_max_active_tis_per_dag": [["mock.Mock", 0.25074767849390406], ["mock.MagicMock", 0.2431817259067205]]}, "q_name": "TestBackfillJob.test_backfill_respect_max_active_tis_per_dagrun_limit", "ret_exprs": [], "ret_type": "", "variables": {"executor": "", "job": "", "job_runner": "", "kwargs": "", "max_active_tis_per_dag": "", "max_active_tis_per_dagrun": "", "num_running_task_instances": "", "running_tis_per_dagrun_dict": "", "task_concurrency_limit_reached_at_least_once": "", "times_dag_concurrency_limit_reached_in_debug": "", "times_pool_limit_reached_in_debug": "", "times_task_concurrency_limit_reached_in_debug": ""}, "variables_p": {"executor": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "job": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "job_runner": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "kwargs": [["dict", 0.30000000000000004], ["Mapping", 0.2], ["Mapping[str, Any]", 0.1], ["Dict[str, int]", 0.1], ["Dict[str, Any]", 0.1], ["Mapping[Any, Any]", 0.1], ["Dict[str, Literal]", 0.1]], "max_active_tis_per_dag": [["int", 0.753882494512418], ["Counter[int]", 0.24611750548758188]], "max_active_tis_per_dagrun": [["int", 0.7677557042224437]], "num_running_task_instances": [["List[bool]", 0.6243676060789192], ["List[str]", 0.18891634074611313], ["Dict[str, Union[None, dict, Any]]", 0.10255815872918057], ["list", 0.08415789444578718]], "running_tis_per_dagrun_dict": [["str", 0.18737063062827491], ["Dict[str, Any]", 0.13553706308850225], ["int", 0.11571045130750988]], "task_concurrency_limit_reached_at_least_once": [["int", 0.191046426012084], ["List[str]", 0.1276016363291096], ["DefaultDict[Any, List[Any]]", 0.1258888586768218], ["bytearray", 0.08713129243936084], ["list", 0.08115991456327656], ["dict", 0.07595921352151654]], "times_dag_concurrency_limit_reached_in_debug": [["int", 0.08451941665617924]], "times_pool_limit_reached_in_debug": [["Dict[int, int]", 0.09266442460175625]], "times_task_concurrency_limit_reached_in_debug": [["tracim.models.data.Content", 0.37496418895368094], ["str", 0.18766469577390008], ["Dict[str, List[str]]", 0.13970648458046414], ["int", 0.09695670532771053], ["bool", 0.09640294785527832]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[463, 4], [511, 63]], "fn_var_ln": {"concurrency_limit_reached_at_least_once": [[489, 16], [489, 55]], "dag": [[464, 8], [464, 11]], "executor": [[468, 8], [468, 16]], "job": [[470, 8], [470, 11]], "job_runner": [[471, 8], [471, 18]], "max_active_tasks": [[466, 8], [466, 28]], "num_running_task_instances": [[483, 8], [483, 34]], "times_dag_concurrency_limit_reached_in_debug": [[494, 8], [494, 52]], "times_pool_limit_reached_in_debug": [[499, 8], [499, 41]], "times_task_concurrency_limit_reached_in_debug": [[504, 8], [504, 53]]}, "fn_var_occur": {"concurrency_limit_reached_at_least_once": [["concurrency_limit_reached_at_least_once", "False"], ["concurrency_limit_reached_at_least_once", "True"]], "dag": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id"], ["dag", "max_active_tasks"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["len", "running_task_instances", "dag", "max_active_tasks"], ["len", "running_task_instances", "dag", "max_active_tasks"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"], ["len", "executor", "history"], ["executor", "history"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "max_active_tasks": [["dag", "max_active_tasks"], ["len", "running_task_instances", "dag", "max_active_tasks"], ["len", "running_task_instances", "dag", "max_active_tasks"]], "num_running_task_instances": [["num_running_task_instances", "len", "running_task_instances"]], "times_dag_concurrency_limit_reached_in_debug": [["times_dag_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "DagConcurrencyLimitReached"]], "times_pool_limit_reached_in_debug": [["times_pool_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "NoAvailablePoolSlot"]], "times_task_concurrency_limit_reached_in_debug": [["times_task_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "TaskConcurrencyLimitReached"]]}, "name": "test_backfill_respect_dag_concurrency_limit", "params": {"dag_maker": "", "mock_log": "", "self": ""}, "params_descr": {"dag_maker": "", "mock_log": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id"], ["dag_maker", "create_dagrun", "state", "None"]], "mock_log": [["times_dag_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "DagConcurrencyLimitReached"], ["times_pool_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "NoAvailablePoolSlot"], ["times_task_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "TaskConcurrencyLimitReached"]], "self": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id"], ["times_dag_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "DagConcurrencyLimitReached"], ["times_pool_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "NoAvailablePoolSlot"], ["times_task_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "TaskConcurrencyLimitReached"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.08194144996104859]], "kwargs": [], "mock_log": [["tests.test_util.aiohttp.AiohttpClientMocker", 0.193782212613225], ["Dict[str, Any]", 0.0901963215492896]], "self": []}, "q_name": "TestBackfillJob.test_backfill_respect_dag_concurrency_limit", "ret_exprs": [], "ret_type": "", "variables": {"concurrency_limit_reached_at_least_once": "", "dag": "", "executor": "", "job": "", "job_runner": "", "max_active_tasks": "", "num_running_task_instances": "", "times_dag_concurrency_limit_reached_in_debug": "", "times_pool_limit_reached_in_debug": "", "times_task_concurrency_limit_reached_in_debug": ""}, "variables_p": {"concurrency_limit_reached_at_least_once": [["logging.Logger", 0.20769423613961763], ["str", 0.18614661696136398], ["bool", 0.1288239496052165], ["float", 0.09641746688670204], ["List[str]", 0.09641746688670204], ["List[List[str]]", 0.09166532974699378]], "dag": [["str", 0.3376028118225781], ["OrderedDict", 0.13106189434400403], ["int", 0.07705335110800525], ["Any[Any]", 0.07632262776045771]], "executor": [["int", 0.19583143321129043], ["List[str]", 0.11020456459254284], ["float", 0.1087869306075289], ["set", 0.0985874011442543], ["Dict[int, Dict[str, Any]]", 0.09668955308445275], ["str", 0.09195844854900993], ["list", 0.09104428120321958]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11861072391587794], ["Sequence[str]", 0.07914521800214441]], "max_active_tasks": [["int", 0.6801337917948668], ["str", 0.09037642932461774]], "num_running_task_instances": [["List[bool]", 0.6243676060789192], ["List[str]", 0.18891634074611313], ["Dict[str, Union[None, dict, Any]]", 0.10255815872918057], ["list", 0.08415789444578718]], "times_dag_concurrency_limit_reached_in_debug": [["int", 0.08451941665617924]], "times_pool_limit_reached_in_debug": [["Dict[int, int]", 0.09266442460175625]], "times_task_concurrency_limit_reached_in_debug": [["tracim.models.data.Content", 0.37496418895368094], ["str", 0.18766469577390008], ["Dict[str, List[str]]", 0.13970648458046414], ["int", 0.09695670532771053], ["bool", 0.09640294785527832]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[514, 4], [568, 52]], "fn_var_ln": {"dag": [[518, 8], [518, 11]], "default_pool_slots": [[515, 8], [515, 26]], "default_pool_task_slot_count_reached_at_least_once": [[546, 16], [546, 66]], "executor": [[521, 8], [521, 16]], "job": [[523, 8], [523, 11]], "job_runner": [[524, 8], [524, 18]], "num_running_task_instances": [[537, 8], [537, 34]], "times_dag_concurrency_limit_reached_in_debug": [[551, 8], [551, 52]], "times_pool_limit_reached_in_debug": [[556, 8], [556, 41]], "times_task_concurrency_limit_reached_in_debug": [[561, 8], [561, 53]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"]], "default_pool_slots": [["set_default_pool_slots", "default_pool_slots"], ["len", "running_task_instances", "default_pool_slots"], ["len", "running_task_instances", "default_pool_slots"]], "default_pool_task_slot_count_reached_at_least_once": [["default_pool_task_slot_count_reached_at_least_once", "False"], ["default_pool_task_slot_count_reached_at_least_once", "True"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"], ["len", "executor", "history"], ["executor", "history"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "num_running_task_instances": [["num_running_task_instances", "len", "running_task_instances"]], "times_dag_concurrency_limit_reached_in_debug": [["times_dag_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "DagConcurrencyLimitReached"]], "times_pool_limit_reached_in_debug": [["times_pool_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "NoAvailablePoolSlot"]], "times_task_concurrency_limit_reached_in_debug": [["times_task_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "TaskConcurrencyLimitReached"]]}, "name": "test_backfill_respect_default_pool_limit", "params": {"dag_maker": "", "mock_log": "", "self": ""}, "params_descr": {"dag_maker": "", "mock_log": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id"], ["dag_maker", "create_dagrun", "state", "None"]], "mock_log": [["times_dag_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "DagConcurrencyLimitReached"], ["times_pool_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "NoAvailablePoolSlot"], ["times_task_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "TaskConcurrencyLimitReached"]], "self": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id"], ["times_dag_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "DagConcurrencyLimitReached"], ["times_pool_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "NoAvailablePoolSlot"], ["times_task_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "TaskConcurrencyLimitReached"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.08113037497279349]], "kwargs": [], "mock_log": [["tests.test_util.aiohttp.AiohttpClientMocker", 0.196714202119074]], "self": []}, "q_name": "TestBackfillJob.test_backfill_respect_default_pool_limit", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "default_pool_slots": "", "default_pool_task_slot_count_reached_at_least_once": "", "executor": "", "job": "", "job_runner": "", "num_running_task_instances": "", "times_dag_concurrency_limit_reached_in_debug": "", "times_pool_limit_reached_in_debug": "", "times_task_concurrency_limit_reached_in_debug": ""}, "variables_p": {"dag": [["dict", 0.4217388297452475], ["Dict[str, str]", 0.0917751342331643], ["List[str]", 0.08928599530556602]], "default_pool_slots": [["List[int]", 0.41153672334423436], ["list", 0.18197449407758526], ["int", 0.13466627906852482]], "default_pool_task_slot_count_reached_at_least_once": [["str", 0.3364260318674688], ["int", 0.14040970863929317], ["cmk.base.api.agent_based.checking_classes.state", 0.06930318986425033]], "executor": [["int", 0.19583143321129043], ["List[str]", 0.11020456459254284], ["float", 0.1087869306075289], ["set", 0.0985874011442543], ["Dict[int, Dict[str, Any]]", 0.09668955308445275], ["str", 0.09195844854900993], ["list", 0.09104428120321958]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11861072391587794], ["Sequence[str]", 0.07914521800214441]], "num_running_task_instances": [["List[bool]", 0.6243676060789192], ["List[str]", 0.18891634074611313], ["Dict[str, Union[None, dict, Any]]", 0.10255815872918057], ["list", 0.08415789444578718]], "times_dag_concurrency_limit_reached_in_debug": [["int", 0.08451941665617924]], "times_pool_limit_reached_in_debug": [["Dict[int, int]", 0.09266442460175625]], "times_task_concurrency_limit_reached_in_debug": [["tracim.models.data.Content", 0.37496418895368094], ["str", 0.18766469577390008], ["Dict[str, List[str]]", 0.13970648458046414], ["int", 0.09695670532771053], ["bool", 0.09640294785527832]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[570, 4], [591, 18]], "fn_var_ln": {"dag": [[571, 8], [571, 11]], "executor": [[578, 8], [578, 16]], "job": [[580, 8], [580, 11]], "job_runner": [[581, 8], [581, 18]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "pool"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]]}, "name": "test_backfill_pool_not_found", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "pool"], ["dag_maker", "create_dagrun", "state", "None"]], "self": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "pool"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_pool_not_found", "ret_exprs": ["return"], "ret_type": "", "ret_type_p": [], "variables": {"dag": "", "executor": "", "job": "", "job_runner": ""}, "variables_p": {"dag": [["dict", 0.2933706846486449], ["List[str]", 0.12015721497750428], ["str", 0.11539861187852356], ["Dict[str, Any]", 0.09036601142875693], ["Dict[str, str]", 0.0897201576768915]], "executor": [["mock.Mock", 0.17527592926847138]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11861072391587794], ["Sequence[str]", 0.07914521800214441]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[594, 4], [655, 52]], "fn_var_ln": {"dag": [[605, 8], [605, 11]], "executor": [[612, 8], [612, 16]], "job": [[614, 8], [614, 11]], "job_runner": [[615, 8], [615, 18]], "num_running_task_instances": [[627, 8], [627, 34]], "pool": [[598, 8], [598, 12]], "pool_was_full_at_least_once": [[633, 16], [633, 43]], "session": [[595, 8], [595, 15]], "slots": [[597, 8], [597, 13]], "times_dag_concurrency_limit_reached_in_debug": [[638, 8], [638, 52]], "times_pool_limit_reached_in_debug": [[643, 8], [643, 41]], "times_task_concurrency_limit_reached_in_debug": [[648, 8], [648, 53]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "pool", "pool", "pool"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"], ["len", "executor", "history"], ["executor", "history"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "num_running_task_instances": [["num_running_task_instances", "len", "running_task_instances"]], "pool": [["pool", "Pool", "pool", "slots", "slots"], ["session", "add", "pool"], ["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "pool", "pool", "pool"]], "pool_was_full_at_least_once": [["pool_was_full_at_least_once", "False"], ["pool_was_full_at_least_once", "True"]], "session": [["session", "settings", "Session"], ["session", "add", "pool"], ["session", "commit"]], "slots": [["pool", "Pool", "pool", "slots", "slots"], ["len", "running_task_instances", "slots"], ["len", "running_task_instances", "slots"]], "times_dag_concurrency_limit_reached_in_debug": [["times_dag_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "DagConcurrencyLimitReached"]], "times_pool_limit_reached_in_debug": [["times_pool_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "NoAvailablePoolSlot"]], "times_task_concurrency_limit_reached_in_debug": [["times_task_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "TaskConcurrencyLimitReached"]]}, "name": "test_backfill_respect_pool_limit", "params": {"dag_maker": "", "mock_log": "", "self": ""}, "params_descr": {"dag_maker": "", "mock_log": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "pool", "pool", "pool"], ["dag_maker", "create_dagrun", "state", "None"]], "mock_log": [["times_dag_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "DagConcurrencyLimitReached"], ["times_pool_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "NoAvailablePoolSlot"], ["times_task_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "TaskConcurrencyLimitReached"]], "self": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "pool", "pool", "pool"], ["times_dag_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "DagConcurrencyLimitReached"], ["times_pool_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "NoAvailablePoolSlot"], ["times_task_concurrency_limit_reached_in_debug", "self", "_times_called_with", "mock_log", "debug", "TaskConcurrencyLimitReached"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "mock_log": [["tests.test_util.aiohttp.AiohttpClientMocker", 0.193782212613225], ["Dict[str, Any]", 0.0901963215492896]], "self": []}, "q_name": "TestBackfillJob.test_backfill_respect_pool_limit", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "executor": "", "job": "", "job_runner": "", "num_running_task_instances": "", "pool": "", "pool_was_full_at_least_once": "", "session": "", "slots": "", "times_dag_concurrency_limit_reached_in_debug": "", "times_pool_limit_reached_in_debug": "", "times_task_concurrency_limit_reached_in_debug": ""}, "variables_p": {"dag": [["str", 0.19623972382523155], ["List[Dict[str, Any]]", 0.10945931999220182], ["list", 0.10477115613593906], ["Dict[str, str]", 0.08777959110056509], ["int", 0.08660050626741725]], "executor": [["int", 0.19583143321129043], ["List[str]", 0.11020456459254284], ["float", 0.1087869306075289], ["set", 0.0985874011442543], ["Dict[int, Dict[str, Any]]", 0.09668955308445275], ["str", 0.09195844854900993], ["list", 0.09104428120321958]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11861072391587794], ["Sequence[str]", 0.07914521800214441]], "num_running_task_instances": [["List[bool]", 0.6243676060789192], ["List[str]", 0.18891634074611313], ["Dict[str, Union[None, dict, Any]]", 0.10255815872918057], ["list", 0.08415789444578718]], "pool": [["starfish.core.types._spot_attributes.SpotAttributes", 0.09731741617424693], ["str", 0.09507970376993405]], "pool_was_full_at_least_once": [["bool", 0.6511167313154816], ["Tuple[str, str]", 0.2202905567038546]], "session": [["sqlalchemy.orm.session.Session", 0.23335872576169808], ["Optional[str]", 0.0607836960422308]], "slots": [["list", 0.16879729611340005], ["str", 0.12329249800318852], ["List[bool]", 0.10165078605617625], ["Dict[str, Any]", 0.08344851010492099]], "times_dag_concurrency_limit_reached_in_debug": [["int", 0.08451941665617924]], "times_pool_limit_reached_in_debug": [["Dict[int, int]", 0.09266442460175625]], "times_task_concurrency_limit_reached_in_debug": [["tracim.models.data.Content", 0.37496418895368094], ["str", 0.18766469577390008], ["Dict[str, List[str]]", 0.13970648458046414], ["int", 0.09695670532771053], ["bool", 0.09640294785527832]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[657, 4], [689, 40]], "fn_var_ln": {"dag": [[658, 8], [658, 11]], "executor": [[663, 8], [663, 16]], "job": [[678, 8], [678, 11]], "job_runner": [[679, 8], [679, 18]], "ti": [[687, 8], [687, 10]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "task_id"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "rerun_failed_tasks", "True"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"], ["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "rerun_failed_tasks", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "rerun_failed_tasks", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "ti": [["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti", "refresh_from_db"], ["ti", "set_state", "State", "UP_FOR_RESCHEDULE"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti", "refresh_from_db"], ["ti", "state", "State", "SUCCESS"]]}, "name": "test_backfill_run_rescheduled", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "task_id"], ["dag_maker", "create_dagrun", "state", "None"]], "self": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "task_id"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_run_rescheduled", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "executor": "", "job": "", "job_runner": "", "ti": ""}, "variables_p": {"dag": [["list", 0.12715910529934402], ["Type[List[Any]]", 0.11799334444088382], ["Dict[str, Any]", 0.10001533103682762], ["raiden.utils.Any", 0.08780887495077282], ["int", 0.08447093672624802], ["Dict[str, dict]", 0.08418017308559299]], "executor": [], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11861072391587794], ["Sequence[str]", 0.07914521800214441]], "ti": [["golem.task.taskcomputer.TaskComputation", 0.19332645342206473], ["hub2labhook.github.models.evenGithubEvent", 0.183183748176938], ["cg_broker.models.Runner", 0.08961747109870095], ["backend.api.models.group.Group", 0.08938540486101494]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[691, 4], [718, 38]], "fn_var_ln": {"dag": [[692, 8], [692, 11]], "dr": [[717, 12], [717, 14]], "executor": [[700, 8], [700, 16]], "job": [[702, 8], [702, 11]], "job_runner": [[703, 8], [703, 18]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "task_id"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "conf"]], "dr": [["dr", "dag_maker", "create_dagrun", "state", "None", "start_date", "DEFAULT_DATE"], ["dr", "wrapped_task_instances_for_dag_run", "call_args_list"], ["dr", "conf"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "conf"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "conf"], ["patch", "object", "job_runner", "wraps", "job_runner", "_task_instances_for_dag_run", "wrapped_task_instances_for_dag_run"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]]}, "name": "test_backfill_override_conf", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "task_id"], ["dr", "dag_maker", "create_dagrun", "state", "None", "start_date", "DEFAULT_DATE"]], "self": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "task_id"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_override_conf", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dr": "", "executor": "", "job": "", "job_runner": ""}, "variables_p": {"dag": [["list", 0.12715910529934402], ["Type[List[Any]]", 0.11799334444088382], ["Dict[str, Any]", 0.10001533103682762], ["raiden.utils.Any", 0.08780887495077282], ["int", 0.08447093672624802], ["Dict[str, dict]", 0.08418017308559299]], "dr": [["int", 0.17576632122731156], ["Dict[str, Optional[float]]", 0.09855198493328139]], "executor": [["mock.Mock", 0.17527592926847138]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.12033544224407712], ["Sequence[str]", 0.08281924180205968]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[720, 4], [750, 37]], "fn_var_ln": {"dag": [[721, 8], [721, 11]], "executor": [[731, 8], [731, 16]], "job": [[733, 8], [733, 11]], "job_runner": [[734, 8], [734, 18]], "ti": [[745, 8], [745, 10]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "task_id"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "ti": [["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti", "refresh_from_db"], ["ti", "state", "State", "NONE"]]}, "name": "test_backfill_skip_active_scheduled_dagrun", "params": {"caplog": "", "dag_maker": "", "self": ""}, "params_descr": {"caplog": "", "dag_maker": "", "self": ""}, "params_occur": {"caplog": [["caplog", "at_level", "logging", "ERROR", "logger"], ["caplog", "clear"], ["caplog", "messages"]], "dag_maker": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "task_id"], ["dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "state", "State", "RUNNING"]], "self": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "task_id"]]}, "params_p": {"args": [], "caplog": [["tests.basilisp.helpers.CompileFn", 0.285829789198319], ["dict", 0.19012576545102003], ["str", 0.09230813403190759]], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_skip_active_scheduled_dagrun", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "executor": "", "job": "", "job_runner": "", "ti": ""}, "variables_p": {"dag": [["list", 0.12715910529934402], ["Type[List[Any]]", 0.11799334444088382], ["Dict[str, Any]", 0.10001533103682762], ["raiden.utils.Any", 0.08780887495077282], ["int", 0.08447093672624802], ["Dict[str, dict]", 0.08418017308559299]], "executor": [["mock.Mock", 0.17527592926847138]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11861072391587794], ["Sequence[str]", 0.07914521800214441]], "ti": [["backend.api.models.group.Group", 0.41005283171377643], ["golem.task.taskcomputer.TaskComputation", 0.19732365619488804]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[752, 4], [784, 40]], "fn_var_ln": {"dag": [[753, 8], [753, 11]], "executor": [[758, 8], [758, 16]], "job": [[773, 8], [773, 11]], "job_runner": [[774, 8], [774, 18]], "ti": [[782, 8], [782, 10]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "task_id"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "rerun_failed_tasks", "True"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"], ["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "rerun_failed_tasks", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "rerun_failed_tasks", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "ti": [["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti", "refresh_from_db"], ["ti", "set_state", "State", "FAILED"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti", "refresh_from_db"], ["ti", "state", "State", "SUCCESS"]]}, "name": "test_backfill_rerun_failed_tasks", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "task_id"], ["dag_maker", "create_dagrun", "state", "None"]], "self": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "task_id"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_rerun_failed_tasks", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "executor": "", "job": "", "job_runner": "", "ti": ""}, "variables_p": {"dag": [["list", 0.12715910529934402], ["Type[List[Any]]", 0.11799334444088382], ["Dict[str, Any]", 0.10001533103682762], ["raiden.utils.Any", 0.08780887495077282], ["int", 0.08447093672624802], ["Dict[str, dict]", 0.08418017308559299]], "executor": [], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11861072391587794], ["Sequence[str]", 0.07914521800214441]], "ti": [["golem.task.taskcomputer.TaskComputation", 0.19775237723086622], ["backend.api.models.group.Group", 0.17956550987293615], ["apps.core.task.coretaskstate.TaskDefinition", 0.08906435815434427], ["cg_broker.models.Runner", 0.08865341177995405]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[786, 4], [820, 40]], "fn_var_ln": {"executor": [[794, 8], [794, 16]], "job": [[809, 8], [809, 11]], "job_runner": [[810, 8], [810, 18]], "op1": [[789, 12], [789, 15]], "op2": [[790, 12], [790, 15]], "ti": [[818, 8], [818, 10]]}, "fn_var_occur": {"executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"], ["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "rerun_failed_tasks", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "rerun_failed_tasks", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "op1": [["op1", "EmptyOperator", "task_id"], ["op1", "set_upstream", "op2"]], "op2": [["op2", "EmptyOperator", "task_id"], ["op1", "set_upstream", "op2"]], "ti": [["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti", "refresh_from_db"], ["ti", "set_state", "State", "UPSTREAM_FAILED"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti", "refresh_from_db"], ["ti", "state", "State", "SUCCESS"]]}, "name": "test_backfill_rerun_upstream_failed_tasks", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "schedule", "dag"], ["dag_maker", "create_dagrun", "state", "None"]], "self": []}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_rerun_upstream_failed_tasks", "ret_exprs": [], "ret_type": "", "variables": {"executor": "", "job": "", "job_runner": "", "op1": "", "op2": "", "ti": ""}, "variables_p": {"executor": [], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11861072391587794], ["Sequence[str]", 0.07914521800214441]], "op1": [["Pattern[Any]", 0.24920695694715456], ["dict", 0.18075641439136372], ["list", 0.1530259623276781], ["Dict[int, Any]", 0.08682544068173122], ["str", 0.08588676396207981], ["Dict[str, Tuple[Any, Any]]", 0.07936138948903751]], "op2": [["Pattern[Any]", 0.24920695694715456], ["dict", 0.18075641439136372], ["list", 0.1530259623276781], ["Dict[int, Any]", 0.08682544068173122], ["str", 0.08588676396207981], ["Dict[str, Tuple[Any, Any]]", 0.07936138948903751]], "ti": [["backend.api.models.group.Group", 0.35318393829905337], ["golem.task.taskcomputer.TaskComputation", 0.21084840563315554], ["cg_broker.models.Runner", 0.0931228325946595], ["hub2labhook.github.models.evenGithubEvent", 0.08304420923831353]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[822, 4], [853, 66]], "fn_var_ln": {"dag": [[823, 8], [823, 11]], "executor": [[828, 8], [828, 16]], "job": [[843, 8], [843, 11]], "job_runner": [[844, 8], [844, 18]], "ti": [[839, 8], [839, 10]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "task_id"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "rerun_failed_tasks", "False"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"], ["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "rerun_failed_tasks", "False"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "rerun_failed_tasks", "False"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "ti": [["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti", "refresh_from_db"], ["ti", "set_state", "State", "FAILED"]]}, "name": "test_backfill_rerun_failed_tasks_without_flag", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "task_id"], ["dag_maker", "create_dagrun", "state", "None"]], "self": [["dag", "self", "_get_dummy_dag", "dag_maker", "dag_id", "task_id"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_rerun_failed_tasks_without_flag", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "executor": "", "job": "", "job_runner": "", "ti": ""}, "variables_p": {"dag": [["list", 0.12715910529934402], ["Type[List[Any]]", 0.11799334444088382], ["Dict[str, Any]", 0.10001533103682762], ["raiden.utils.Any", 0.08780887495077282], ["int", 0.08447093672624802], ["Dict[str, dict]", 0.08418017308559299]], "executor": [], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11861072391587794], ["Sequence[str]", 0.07914521800214441]], "ti": [["backend.api.models.group.Group", 0.35318393829905337], ["golem.task.taskcomputer.TaskComputation", 0.21084840563315554], ["cg_broker.models.Runner", 0.0931228325946595], ["hub2labhook.github.models.evenGithubEvent", 0.08304420923831353]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[855, 4], [881, 62]], "fn_var_ln": {"executor": [[867, 8], [867, 16]], "job": [[874, 8], [874, 11]], "job_runner": [[875, 8], [875, 18]], "task1": [[864, 12], [864, 17]]}, "fn_var_occur": {"executor": [["executor", "MockExecutor", "parallelism"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "DEFAULT_DATE", "try_number", "State", "UP_FOR_RETRY"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "DEFAULT_DATE", "try_number", "State", "UP_FOR_RETRY"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "task1": [["task1", "EmptyOperator", "task_id"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "DEFAULT_DATE", "try_number", "State", "UP_FOR_RETRY"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "DEFAULT_DATE", "try_number", "State", "UP_FOR_RETRY"]]}, "name": "test_backfill_retry_intermittent_failed_task", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "schedule", "default_args", "datetime", "timedelta", "seconds", "dag"], ["dag_maker", "create_dagrun", "state", "None"]], "self": []}, "params_p": {"args": [], "dag_maker": [["int", 0.2957201690999795]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_retry_intermittent_failed_task", "ret_exprs": [], "ret_type": "", "variables": {"executor": "", "job": "", "job_runner": "", "task1": ""}, "variables_p": {"executor": [["Optional[List[Any]]", 0.1307395854133863], ["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.11682499142279348], ["Dict[str, Callable]", 0.10834213349723279], ["int", 0.10071246825741796], ["str", 0.09131180952305132], ["decksite.data.models.person.Person", 0.09083934376924815]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11861072391587794], ["Sequence[str]", 0.07914521800214441]], "task1": [["restful_functions.modules.task.TaskStore", 0.13180412343368858], ["golem.task.taskcomputer.TaskComputer", 0.10474387055645522], ["golem.task.taskbase.Task.ExtraData", 0.09627537709376831], ["Dict[str, Dict[str, int]]", 0.09308912201286412], ["zero.domain.task.Task", 0.09212578662432223], ["taskiapplication.models.task.Task", 0.08524423913745995], ["khetha.models.Task", 0.08318903974394193]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[883, 4], [908, 66]], "fn_var_ln": {"dr": [[893, 8], [893, 10]], "executor": [[895, 8], [895, 16]], "job": [[900, 8], [900, 11]], "job_runner": [[901, 8], [901, 18]], "task1": [[892, 12], [892, 17]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun", "state", "None"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "dr", "run_id", "try_number", "State", "UP_FOR_RETRY"], ["executor", "mock_task_fail", "dag", "dag_id", "task1", "task_id", "dr", "run_id", "try_number"]], "executor": [["executor", "MockExecutor", "parallelism"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "dr", "run_id", "try_number", "State", "UP_FOR_RETRY"], ["executor", "mock_task_fail", "dag", "dag_id", "task1", "task_id", "dr", "run_id", "try_number"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "task1": [["task1", "EmptyOperator", "task_id"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "dr", "run_id", "try_number", "State", "UP_FOR_RETRY"], ["executor", "mock_task_fail", "dag", "dag_id", "task1", "task_id", "dr", "run_id", "try_number"]]}, "name": "test_backfill_retry_always_failed_task", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "schedule", "default_args", "datetime", "timedelta", "seconds", "dag"], ["dr", "dag_maker", "create_dagrun", "state", "None"]], "self": []}, "params_p": {"args": [], "dag_maker": [["int", 0.31616415082754623]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_retry_always_failed_task", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "executor": "", "job": "", "job_runner": "", "task1": ""}, "variables_p": {"dr": [["str", 0.2271617830924046], ["int", 0.21652362673713874], ["raiden.utils.PaymentID", 0.08722521320558077], ["float", 0.08346314991241478], ["Dict[str, str]", 0.08280527647630921]], "executor": [["Optional[List[Any]]", 0.13778020847138525], ["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.10232687500865462], ["list", 0.09608528710896226], ["Tuple[bool, bool]", 0.0834503163352182]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.10238998589499847]], "task1": [["restful_functions.modules.task.TaskStore", 0.11097196249031732], ["golem.task.taskbase.Task.ExtraData", 0.09996709046504482], ["golem.task.taskcomputer.TaskComputer", 0.09950279409369743], ["annofabapi.dataclass.task.Task", 0.09423821499230839], ["zero.domain.task.Task", 0.09094735369417675], ["taskiapplication.models.task.Task", 0.08188648839576505]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[910, 4], [957, 9]], "fn_var_ln": {"executor": [[929, 8], [929, 16]], "history": [[943, 8], [943, 15]], "job": [[930, 8], [930, 11]], "job_runner": [[931, 8], [931, 18]], "op1": [[916, 12], [916, 15]], "op2": [[917, 12], [917, 15]], "op3": [[918, 12], [918, 15]], "op4": [[919, 12], [919, 15]], "op5": [[920, 12], [920, 15]], "runid0": [[926, 8], [926, 14]], "runid1": [[939, 8], [939, 14]], "runid2": [[940, 8], [940, 14]]}, "fn_var_occur": {"executor": [["executor", "MockExecutor", "parallelism"], ["job", "Job", "executor", "executor"], ["history", "executor", "history"]], "history": [["history", "executor", "history"], ["sorted", "item", "key", "item", "batch", "batch", "history", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "op1": [["op1", "EmptyOperator", "task_id"], ["op1", "set_downstream", "op3"]], "op2": [["op2", "EmptyOperator", "task_id"], ["op2", "set_downstream", "op3"]], "op3": [["op3", "EmptyOperator", "task_id"], ["op2", "set_downstream", "op3"], ["op1", "set_downstream", "op3"], ["op3", "set_downstream", "op4"]], "op4": [["op4", "EmptyOperator", "task_id"], ["op4", "set_downstream", "op5"], ["op3", "set_downstream", "op4"]], "op5": [["op5", "EmptyOperator", "task_id"], ["op4", "set_downstream", "op5"]], "runid0": [["runid0", "DEFAULT_DATE", "isoformat"], ["dag_maker", "create_dagrun", "run_id", "runid0"], ["sorted", "item", "key", "item", "batch", "batch", "history", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2"]], "runid1": [["runid1", "DEFAULT_DATE", "datetime", "timedelta", "days", "isoformat"], ["sorted", "item", "key", "item", "batch", "batch", "history", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2"]], "runid2": [["runid2", "DEFAULT_DATE", "datetime", "timedelta", "days", "isoformat"], ["sorted", "item", "key", "item", "batch", "batch", "history", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2", "runid0", "runid1", "runid2"]]}, "name": "test_backfill_ordered_concurrent_execute", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "schedule", "dag"], ["dag_maker", "create_dagrun", "run_id", "runid0"]], "self": []}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_ordered_concurrent_execute", "ret_exprs": [], "ret_type": "", "variables": {"executor": "", "history": "", "job": "", "job_runner": "", "op1": "", "op2": "", "op3": "", "op4": "", "op5": "", "runid0": "", "runid1": "", "runid2": ""}, "variables_p": {"executor": [["str", 0.0972795069592408]], "history": [["int", 0.16648216819657546], ["List[Tuple[Any, Any]]", 0.1310310940873599], ["dict", 0.11444407942382064], ["str", 0.10352855880322999], ["list", 0.0917657210240632], ["threading.Event", 0.08303738751874509], ["tuple", 0.08074557193460996]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11861072391587794], ["Sequence[str]", 0.07914521800214441]], "op1": [["Pattern[Any]", 0.24920695694715456], ["dict", 0.18075641439136372], ["list", 0.1530259623276781], ["Dict[int, Any]", 0.08682544068173122], ["str", 0.08588676396207981], ["Dict[str, Tuple[Any, Any]]", 0.07936138948903751]], "op2": [["Pattern[Any]", 0.24920695694715456], ["dict", 0.18075641439136372], ["list", 0.1530259623276781], ["Dict[int, Any]", 0.08682544068173122], ["str", 0.08588676396207981], ["Dict[str, Tuple[Any, Any]]", 0.07936138948903751]], "op3": [["Dict[str, Any]", 0.4153191625095281], ["int", 0.1332043738623851], ["dict", 0.10002244783152449], ["Dict[str, Literal]", 0.09764105297166412], ["Dict[int, int]", 0.08703632538926484], ["List[str]", 0.08261738478953636]], "op4": [["int", 0.3088733442640498], ["Dict[str, Any]", 0.2824461965268254], ["Dict[str, Literal]", 0.11573192688678151], ["Pattern[Any]", 0.09709471404328351], ["Dict[str, str]", 0.0884227059824768]], "op5": [["Pattern[Any]", 0.24920695694715456], ["dict", 0.18075641439136372], ["list", 0.1530259623276781], ["Dict[int, Any]", 0.08682544068173122], ["str", 0.08588676396207981], ["Dict[str, Tuple[Any, Any]]", 0.07936138948903751]], "runid0": [["dict", 0.28470650211813253], ["list", 0.1949473419627946], ["tuple", 0.08949705490708441]], "runid1": [["datetime.datetime.datetime", 0.47667672128253535], ["datetime.date.time.date", 0.09877147137951381], ["datetime.timedelta", 0.09104704680983863], ["int", 0.07933574329127642]], "runid2": [["datetime.datetime.datetime", 0.47667672128253535], ["datetime.date.time.date", 0.09877147137951381], ["datetime.timedelta", 0.09104704680983863], ["int", 0.07933574329127642]]}}, {"docstring": {"func": "Test that queued tasks are executed by BackfillJobRunner", "long_descr": null, "ret": null}, "fn_lc": [[959, 4], [985, 40]], "fn_var_ln": {"dag": [[969, 8], [969, 11]], "executor": [[972, 8], [972, 16]], "job": [[973, 8], [973, 11]], "job_runner": [[974, 8], [974, 18]], "pool": [[964, 8], [964, 12]], "session": [[963, 8], [963, 15]], "ti": [[983, 8], [983, 10]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag"], ["dag", "clear"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"]], "executor": [["executor", "MockExecutor", "do_update", "True"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "pool": [["pool", "Pool", "pool", "slots"], ["session", "add", "pool"]], "session": [["session", "settings", "Session"], ["session", "add", "pool"], ["session", "commit"], ["session", "close"]], "ti": [["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti", "refresh_from_db"], ["ti", "state", "State", "SUCCESS"]]}, "name": "test_backfill_pooled_tasks", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["dag", "self", "dagbag", "get_dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_pooled_tasks", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "executor": "", "job": "", "job_runner": "", "pool": "", "session": "", "ti": ""}, "variables_p": {"dag": [["float", 0.330344239235128], ["list", 0.09734917044742683], ["str", 0.08943949502177498], ["int", 0.08768511053989937]], "executor": [["Dict[str, None]", 0.2427060148522245], ["Dict[str, List[str]]", 0.1775870106000878], ["Dict[str, Union[Any, Any, Any]]", 0.11586183297590229], ["List[str]", 0.08112105563696301], ["int", 0.06991689411871894], ["list", 0.06991689411871894]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.10238998589499847]], "pool": [["str", 0.1931491470986433], ["DefaultDict[str, Set[str]]", 0.12160105290481399], ["Dict[None, None]", 0.10493290411675728], ["Set[int]", 0.10317265707166826], ["int", 0.09998187944042009], ["dict", 0.09571216414216588], ["list", 0.09536923922726434]], "session": [["sqlalchemy.orm.session.Session", 0.11753988784328177], ["grpy.core.models.User", 0.07501996383503794], ["dict", 0.06969939095666138]], "ti": [["backend.api.models.group.Group", 0.44819894369897817], ["golem.task.taskcomputer.TaskComputation", 0.1644419879791028], ["cg_broker.models.Runner", 0.08089982863743662]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[988, 4], [1008, 40]], "fn_var_ln": {"dag": [[991, 8], [991, 11]], "job": [[995, 8], [995, 11]], "job_runner": [[996, 8], [996, 18]], "run_date": [[993, 8], [993, 16]], "ti": [[1006, 8], [1006, 10]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag"], ["dag", "clear"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "run_date", "end_date", "run_date", "ignore_first_depends_on_past", "ignore_depends_on_past"], ["ti", "TI", "dag", "tasks", "run_date"]], "job": [["job", "Job", "executor", "MockExecutor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "run_date", "end_date", "run_date", "ignore_first_depends_on_past", "ignore_depends_on_past"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "run_date", "end_date", "run_date", "ignore_first_depends_on_past", "ignore_depends_on_past"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "run_date": [["run_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "run_date", "end_date", "run_date", "ignore_first_depends_on_past", "ignore_depends_on_past"], ["ti", "TI", "dag", "tasks", "run_date"]], "ti": [["ti", "TI", "dag", "tasks", "run_date"], ["ti", "refresh_from_db"], ["ti", "state", "State", "SUCCESS"]]}, "name": "test_backfill_depends_on_past_works_independently_on_ignore_depends_on_past", "params": {"ignore_depends_on_past": "", "self": ""}, "params_descr": {"ignore_depends_on_past": "", "self": ""}, "params_occur": {"ignore_depends_on_past": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "run_date", "end_date", "run_date", "ignore_first_depends_on_past", "ignore_depends_on_past"]], "self": [["dag", "self", "dagbag", "get_dag"]]}, "params_p": {"args": [], "ignore_depends_on_past": [["core.models.Grouping", 0.09753915221811549], ["django.conf.settings.AUTH_USER_MODEL", 0.0870720103548226]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_depends_on_past_works_independently_on_ignore_depends_on_past", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "job": "", "job_runner": "", "run_date": "", "ti": ""}, "variables_p": {"dag": [["float", 0.26355183030719354], ["list", 0.09764863177582478], ["int", 0.09300174973553853], ["List[int]", 0.08756805142900029]], "job": [["dict", 0.10924239644311211], ["str", 0.09809478742549986], ["Dict[Any, str]", 0.09466072915412499]], "job_runner": [["Dict[Any, str]", 0.11743096250851681]], "run_date": [["datetime.date", 0.3334573335958782], ["datetime.datetime", 0.18983859037269268], ["datetime.datetime.datetime", 0.11651078451088663], ["str", 0.09651566010509323], ["datetime.date.time.date", 0.09279544672905411], ["Dict[Any, List[str]]", 0.07738253947254646]], "ti": [["str", 0.4895905324895814], ["Tuple[int, int]", 0.15605683721596855], ["Dict[str, str]", 0.08016940941072884], ["Optional[hpaction.models.HPActionDocuments]", 0.07952078988761857], ["datetime.datetime", 0.06591153934468297], ["dict", 0.06441202608602771], ["Optional[byceps.services.user.transfer.models.User]", 0.06433886556539202]]}}, {"docstring": {"func": "Test that CLI respects -B argument and raises on interaction with depends_on_past", "long_descr": null, "ret": null}, "fn_lc": [[1010, 4], [1040, 66]], "fn_var_ln": {"dag": [[1021, 8], [1021, 11]], "dag_id": [[1014, 8], [1014, 14]], "end_date": [[1016, 8], [1016, 16]], "executor": [[1037, 12], [1037, 20]], "expected_msg": [[1035, 8], [1035, 20]], "job": [[1038, 12], [1038, 15]], "job_runner": [[1039, 12], [1039, 22]], "kwargs": [[1017, 8], [1017, 14]], "start_date": [[1015, 8], [1015, 18]], "ti": [[1029, 8], [1029, 10]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["dag", "clear"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "ignore_first_depends_on_past", "True", "kwargs"], ["ti", "TI", "dag", "get_task", "end_date"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "run_backwards", "True", "kwargs"]], "dag_id": [["dag", "self", "dagbag", "get_dag", "dag_id"]], "end_date": [["end_date", "start_date", "datetime", "timedelta", "days"], ["kwargs", "dict", "start_date", "start_date", "end_date", "end_date"], ["ti", "TI", "dag", "get_task", "end_date"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"], ["executor", "MockExecutor"], ["job", "Job", "executor", "executor"]], "expected_msg": [["pytest", "raises", "AirflowException", "match", "expected_msg"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "ignore_first_depends_on_past", "True", "kwargs"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"], ["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "run_backwards", "True", "kwargs"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "ignore_first_depends_on_past", "True", "kwargs"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "run_backwards", "True", "kwargs"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "kwargs": [["kwargs", "dict", "start_date", "start_date", "end_date", "end_date"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "ignore_first_depends_on_past", "True", "kwargs"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "run_backwards", "True", "kwargs"]], "start_date": [["start_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["end_date", "start_date", "datetime", "timedelta", "days"], ["kwargs", "dict", "start_date", "start_date", "end_date", "end_date"]], "ti": [["ti", "TI", "dag", "get_task", "end_date"], ["ti", "refresh_from_db"], ["ti", "state", "State", "SUCCESS"]]}, "name": "test_backfill_depends_on_past_backwards", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["dag", "self", "dagbag", "get_dag", "dag_id"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_depends_on_past_backwards", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_id": "", "end_date": "", "executor": "", "expected_msg": "", "job": "", "job_runner": "", "kwargs": "", "start_date": "", "ti": ""}, "variables_p": {"dag": [["DefaultDict[Any, dict]", 0.27510358159206694], ["dict", 0.2548039445443788], ["set", 0.11222146488810156], ["str", 0.09158515358567106], ["int", 0.09158515358567106], ["Dict[str, Union[None, Any, str]]", 0.0893668373185131], ["Dict[str, str]", 0.08533386448559742]], "dag_id": [["int", 0.7986376939949497], ["List[int]", 0.20136230600505037]], "end_date": [["datetime.date", 0.8382626192018167], ["datetime.datetime", 0.16173738079818348]], "executor": [["str", 0.10620885912570666]], "expected_msg": [["Pattern[str]", 0.4489808906483841], ["List[str]", 0.2908043470288664], ["str", 0.17672311767519258], ["list", 0.0834916446475569]], "job": [["List[str]", 0.18048545476326872], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.09106003634825277]], "job_runner": [["list", 0.18999982429660864], ["int", 0.17197852268214714], ["str", 0.12401323540527794]], "kwargs": [["datetime.timedelta", 0.22816074005670908], ["datetime.date.time.timedelta", 0.19499293371205434], ["Dict[Optional[str], str]", 0.10851605733715498], ["Dict[str, str]", 0.08801933390579961], ["list", 0.07903576229821524]], "start_date": [["datetime.date", 0.8077902707420552], ["datetime.timedelta", 0.1922097292579448]], "ti": [["tartare.core.models.ValidityPeriod", 0.11184942180185167], ["byceps.services.user.transfer.models.User", 0.09606301088900936]]}}, {"docstring": {"func": "Tests that the --delay argument is passed correctly to the BackfillJob", "long_descr": null, "ret": null}, "fn_lc": [[1042, 4], [1058, 48]], "fn_var_ln": {"args": [[1048, 8], [1048, 12]], "dag_id": [[1046, 8], [1046, 14]], "parsed_args": [[1057, 8], [1057, 19]], "run_date": [[1047, 8], [1047, 16]]}, "fn_var_occur": {"args": [["args", "dag_id", "run_date", "isoformat"], ["parsed_args", "self", "parser", "parse_args", "args"]], "dag_id": [["args", "dag_id", "run_date", "isoformat"]], "parsed_args": [["parsed_args", "self", "parser", "parse_args", "args"], ["parsed_args", "delay_on_limit"]], "run_date": [["run_date", "DEFAULT_DATE"], ["args", "dag_id", "run_date", "isoformat"]]}, "name": "test_cli_receives_delay_arg", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["parsed_args", "self", "parser", "parse_args", "args"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_cli_receives_delay_arg", "ret_exprs": [], "ret_type": "", "variables": {"args": "", "dag_id": "", "parsed_args": "", "run_date": ""}, "variables_p": {"args": [["List[str]", 0.09387884291266377], ["Dict[str, Any]", 0.09361307029974177]], "dag_id": [["int", 0.5012176275657475], ["str", 0.22493405187516569], ["dict", 0.06958426062339734]], "parsed_args": [["List[str]", 0.6527949550850097]], "run_date": [["datetime.datetime", 0.38725817074444574], ["Dict[str, bool]", 0.3180924584101571], ["datetime.datetime.time", 0.12251527813195379], ["datetime.datetime.datetime", 0.08824857903170061], ["datetime.date", 0.08388551368174274]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1060, 4], [1076, 18]], "fn_var_ln": {"op1": [[1069, 12], [1069, 15]], "op2": [[1070, 12], [1070, 15]], "op3": [[1071, 12], [1071, 15]], "op4": [[1072, 12], [1072, 15]]}, "fn_var_occur": {"op1": [["op1", "EmptyOperator", "task_id"], ["op1", "op2", "op3"]], "op2": [["op2", "EmptyOperator", "task_id"], ["op1", "op2", "op3"]], "op3": [["op3", "EmptyOperator", "task_id"], ["op1", "op2", "op3"], ["op4", "op3"]], "op4": [["op4", "EmptyOperator", "task_id"], ["op4", "op3"]]}, "name": "_get_dag_test_max_active_limits", "params": {"dag_id": "", "dag_maker_fixture": "", "kwargs": "", "max_active_runs": "", "self": ""}, "params_descr": {"dag_id": "", "dag_maker_fixture": "", "kwargs": "", "max_active_runs": "", "self": ""}, "params_occur": {"dag_id": [["dag_maker_fixture", "dag_id", "dag_id", "schedule", "max_active_runs", "max_active_runs", "kwargs", "dag"]], "dag_maker_fixture": [["dag_maker_fixture", "dag_id", "dag_id", "schedule", "max_active_runs", "max_active_runs", "kwargs", "dag"]], "kwargs": [["dag_maker_fixture", "dag_id", "dag_id", "schedule", "max_active_runs", "max_active_runs", "kwargs", "dag"]], "max_active_runs": [["dag_maker_fixture", "dag_id", "dag_id", "schedule", "max_active_runs", "max_active_runs", "kwargs", "dag"]], "self": []}, "params_p": {"args": [], "dag_id": [["int", 0.7977867560501976], ["Dict[str, Any]", 0.12138710097748645], ["Optional[int]", 0.08082614297231615]], "dag_maker_fixture": [["int", 0.7977867560501976], ["Dict[str, Any]", 0.12138710097748645], ["Optional[int]", 0.08082614297231615]], "kwargs": [], "max_active_runs": [["int", 0.7977867560501976], ["Dict[str, Any]", 0.12138710097748645], ["Optional[int]", 0.08082614297231615]], "self": []}, "q_name": "TestBackfillJob._get_dag_test_max_active_limits", "ret_exprs": ["return dag"], "ret_type": "", "ret_type_p": [["list", 0.20866564354312933], ["str", 0.12967718328439964], ["List[str]", 0.0647033333291311]], "variables": {"op1": "", "op2": "", "op3": "", "op4": ""}, "variables_p": {"op1": [["Pattern[Any]", 0.31009746229780155], ["str", 0.25306320510175906], ["Dict[str, str]", 0.17917338048540177], ["Dict[str, Union[Any, Any, Any]]", 0.09322078256194516], ["Dict[int, Any]", 0.07995347773597332]], "op2": [["Pattern[Any]", 0.31009746229780155], ["str", 0.25306320510175906], ["Dict[str, str]", 0.17917338048540177], ["Dict[str, Union[Any, Any, Any]]", 0.09322078256194516], ["Dict[int, Any]", 0.07995347773597332]], "op3": [["str", 0.3002001175622883], ["Pattern[Any]", 0.22992832987008952], ["int", 0.10657185799543573], ["dict", 0.09605105283913176], ["Dict[int, Any]", 0.08668204371755524]], "op4": [["Pattern[Any]", 0.2650537788171139], ["Dict[str, Union[Any, Any, Any]]", 0.1161347669483028], ["Dict[str, str]", 0.10064090791402337], ["dict", 0.09286057147798296], ["str", 0.09276268242869652], ["list", 0.086678711119582], ["Dict[int, str]", 0.08220818865404256], ["Dict[str, Type[Any]]", 0.08142834839109074]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1078, 4], [1099, 65]], "fn_var_ln": {"dag": [[1079, 8], [1079, 11]], "dagruns": [[1097, 8], [1097, 15]], "end_date": [[1084, 8], [1084, 16]], "executor": [[1086, 8], [1086, 16]], "job": [[1087, 8], [1087, 11]], "job_runner": [[1088, 8], [1088, 18]], "start_date": [[1083, 8], [1083, 18]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dag_test_max_active_limits", "dag_maker", "dag_id", "max_active_runs"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"], ["dagruns", "DagRun", "find", "dag_id", "dag", "dag_id"]], "dagruns": [["dagruns", "DagRun", "find", "dag_id", "dag", "dag_id"], ["len", "dagruns"], ["all", "run", "state", "State", "SUCCESS", "run", "dagruns"]], "end_date": [["end_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "start_date": [["start_date", "DEFAULT_DATE", "datetime", "timedelta", "hours"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"]]}, "name": "test_backfill_max_limit_check_within_limit", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dag_test_max_active_limits", "dag_maker", "dag_id", "max_active_runs"], ["dag_maker", "create_dagrun", "state", "None"]], "self": [["dag", "self", "_get_dag_test_max_active_limits", "dag_maker", "dag_id", "max_active_runs"]]}, "params_p": {"args": [], "dag_maker": [["List[Dict[str, Any]]", 0.1524525802559586], ["int", 0.07642490067108894]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_max_limit_check_within_limit", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dagruns": "", "end_date": "", "executor": "", "job": "", "job_runner": "", "start_date": ""}, "variables_p": {"dag": [["int", 0.12208254768104064], ["str", 0.09250256465062905], ["float", 0.08374072112229897]], "dagruns": [["int", 0.37554557517365766], ["float", 0.18878065263119798], ["Tuple[Any, Any, Any]", 0.1144309957143235], ["set", 0.10802959565207847]], "end_date": [["datetime.datetime", 0.2886350914059635], ["datetime.date", 0.17399379679231092], ["str", 0.13994724114205334], ["Pattern[str]", 0.09836255555067651], ["Dict[Any, List[str]]", 0.0816496894813934]], "executor": [["mock.Mock", 0.17527592926847138]], "job": [["list", 0.28338099757820706], ["dict", 0.10866015811222443], ["guillotina.db.interfaces.ITransaction", 0.09796057701060183], ["server.openslides.users.models.Group", 0.09476113658608351]], "job_runner": [["str", 0.16537663101073893], ["Dict[Any, str]", 0.0865600571850599]], "start_date": [["datetime.date", 0.4155572273914882], ["datetime.datetime", 0.19096779591957197], ["datetime.datetime.datetime", 0.10507794039032715], ["Dict[Any, List[str]]", 0.09385889118183491], ["datetime.date.time.date", 0.08956782344006087]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1101, 4], [1130, 67]], "fn_var_ln": {"dag": [[1102, 8], [1102, 11]], "dag_run": [[1103, 8], [1103, 15]], "end_date": [[1108, 8], [1108, 16]], "executor": [[1110, 8], [1110, 16]], "job": [[1111, 8], [1111, 11]], "job_runner": [[1112, 8], [1112, 18]], "notification_threadpool": [[1119, 8], [1119, 35]], "start_date": [[1107, 8], [1107, 18]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dummy_dag", "dag_maker"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"], ["dag_listener", "running", "dag", "dag_id", "dag_run", "dag", "dag_id"], ["dag_listener", "success", "dag", "dag_id", "dag_run", "dag", "dag_id"]], "dag_run": [["dag_run", "dag_maker", "create_dagrun", "state", "None"], ["dag_listener", "running", "dag", "dag_id", "dag_run", "dag", "dag_id"], ["dag_listener", "running", "run_id", "dag_run", "run_id"], ["dag_listener", "success", "dag", "dag_id", "dag_run", "dag", "dag_id"], ["dag_listener", "success", "run_id", "dag_run", "run_id"]], "end_date": [["end_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"], ["job", "notification_threadpool", "mock", "MagicMock"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "notification_threadpool": [["job", "notification_threadpool", "mock", "MagicMock"]], "start_date": [["start_date", "DEFAULT_DATE", "datetime", "timedelta", "hours"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"]]}, "name": "test_backfill_notifies_dagrun_listener", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dummy_dag", "dag_maker"], ["dag_run", "dag_maker", "create_dagrun", "state", "None"]], "self": [["dag", "self", "_get_dummy_dag", "dag_maker"]]}, "params_p": {"args": [], "dag_maker": [["dict", 0.08475810213096414]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_notifies_dagrun_listener", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_run": "", "end_date": "", "executor": "", "job": "", "job_runner": "", "notification_threadpool": "", "start_date": ""}, "variables_p": {"dag": [["list", 0.32593521933700187], ["str", 0.19154140195380576], ["List[Union[Any, Any, Any, Any]]", 0.12072232991730195], ["bool", 0.09520855232364375]], "dag_run": [["bytes", 0.23544735675539208], ["threading.Event", 0.19227089827716162], ["int", 0.08824002328792992], ["datetime.datetime", 0.08685989240138627]], "end_date": [["datetime.datetime", 0.2886350914059635], ["datetime.date", 0.17399379679231092], ["str", 0.13994724114205334], ["Pattern[str]", 0.09836255555067651], ["Dict[Any, List[str]]", 0.0816496894813934]], "executor": [["mock.Mock", 0.17527592926847138]], "job": [["list", 0.28338099757820706], ["dict", 0.10866015811222443], ["guillotina.db.interfaces.ITransaction", 0.09796057701060183], ["server.openslides.users.models.Group", 0.09476113658608351]], "job_runner": [["str", 0.16537663101073893], ["Dict[Any, str]", 0.0865600571850599]], "notification_threadpool": [["int", 0.20652509343497108], ["Dict[str, str]", 0.11022876331250356], ["mode.utils.mocks.Mock", 0.10326604198082145], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.09159704290057437], ["mock.Mock", 0.08787334267419773]], "start_date": [["datetime.date", 0.4155572273914882], ["datetime.datetime", 0.19096779591957197], ["datetime.datetime.datetime", 0.10507794039032715], ["Dict[Any, List[str]]", 0.09385889118183491], ["datetime.date.time.date", 0.08956782344006087]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1140, 8], [1174, 70]], "fn_var_ln": {"dag": [[1145, 20], [1145, 23]], "executor": [[1163, 16], [1163, 24]], "job": [[1164, 16], [1164, 19]], "job_runner": [[1167, 16], [1167, 26]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dag_test_max_active_limits", "dag_maker", "dag_id", "dag_id"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]]}, "name": "run_backfill", "params": {"cond": ""}, "params_descr": {"cond": ""}, "params_occur": {"cond": [["cond", "acquire"], ["cond", "notify"], ["cond", "release"]]}, "params_p": {"args": [], "cond": [["str", 0.2], ["int", 0.1], ["bool", 0.1], ["list", 0.1]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_max_limit_check.<locals>.run_backfill", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "executor": "", "job": "", "job_runner": ""}, "variables_p": {"dag": [["int", 0.36304662267993726], ["Dict[int, Any]", 0.2342064651332085], ["float", 0.10282243183168766], ["dict", 0.10106871794103522]], "executor": [["mock.Mock", 0.17527592926847138]], "job": [["list", 0.28338099757820706], ["dict", 0.10866015811222443], ["guillotina.db.interfaces.ITransaction", 0.09796057701060183], ["server.openslides.users.models.Group", 0.09476113658608351]], "job_runner": [["str", 0.16537663101073893], ["Dict[Any, str]", 0.0865600571850599]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1132, 4], [1206, 46]], "fn_var_ln": {"backfill_job_thread": [[1176, 8], [1176, 27]], "dag_id": [[1133, 8], [1133, 14]], "dag_run_created_cond": [[1138, 8], [1138, 28]], "dagruns": [[1202, 16], [1202, 23]], "dr": [[1190, 16], [1190, 18]], "end_date": [[1136, 8], [1136, 16]], "run_id": [[1134, 8], [1134, 14]], "start_date": [[1135, 8], [1135, 18]]}, "fn_var_occur": {"backfill_job_thread": [["backfill_job_thread", "threading", "Thread", "target", "run_backfill", "name", "args", "dag_run_created_cond"], ["backfill_job_thread", "start"], ["backfill_job_thread", "join"]], "dag_id": [["dagruns", "DagRun", "find", "dag_id", "dag_id"], ["dagruns", "DagRun", "find", "dag_id", "dag_id"]], "dag_run_created_cond": [["backfill_job_thread", "threading", "Thread", "target", "run_backfill", "name", "args", "dag_run_created_cond"], ["dag_run_created_cond", "acquire"], ["dag_run_created_cond", "wait", "timeout"], ["dag_run_created_cond", "release"]], "dagruns": [["dagruns", "DagRun", "find", "dag_id", "dag_id"], ["logger", "info", "dagruns"], ["len", "dagruns"], ["dr", "dagruns"], ["dagruns", "DagRun", "find", "dag_id", "dag_id"], ["len", "dagruns"], ["dagruns", "run_id", "dr", "run_id"]], "dr": [["dr", "dagruns"], ["dr", "run_id", "run_id"], ["dr", "set_state", "State", "SUCCESS"], ["session", "merge", "dr"], ["dagruns", "run_id", "dr", "run_id"]], "end_date": [], "run_id": [["dr", "run_id", "run_id"], ["dagruns", "run_id", "dr", "run_id"]], "start_date": []}, "name": "test_backfill_max_limit_check", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [], "self": []}, "params_p": {"args": [], "dag_maker": [["tests.basilisp.helpers.CompileFn", 0.2], ["str", 0.2], ["tests.async_mock.MagicMock", 0.1], ["tests.async_mock.Mock", 0.1], ["Mapping[str, Any]", 0.1]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_max_limit_check", "ret_exprs": [], "ret_type": "", "variables": {"backfill_job_thread": "", "dag_id": "", "dag_run_created_cond": "", "dagruns": "", "dr": "", "end_date": "", "run_id": "", "start_date": ""}, "variables_p": {"backfill_job_thread": [["threading.Thread", 0.8826214889412821]], "dag_id": [["str", 0.4239592832574428], ["int", 0.23080614792806214], ["Set[int]", 0.1765799395676437], ["list", 0.08670771411812213], ["Optional[int]", 0.08194691512872931]], "dag_run_created_cond": [["threading.Thread", 0.5662221412864233], ["List[str]", 0.11256925730977368], ["threading.Event", 0.10883689253989803], ["int", 0.09843919373561438]], "dagruns": [["int", 0.23571919370901867], ["float", 0.184677456191371], ["Tuple[Any, str]", 0.10117852150958925], ["Dict[str, str]", 0.09205975402413819], ["list", 0.09171895432176001], ["str", 0.0897103129335238], ["deque[str]", 0.0874867893287271]], "dr": [["list", 0.08613431636142697], ["str", 0.08223236229860578], ["golem.task.taskbase.AcceptClientVerdict", 0.081447488793905]], "end_date": [["Optional[datetime.date]", 0.2], ["str", 0.2], ["Optional[datetime.datetime]", 0.1], ["Type[leasing.models.decision.Decision]", 0.1]], "run_id": [["int", 0.5045805759632233], ["str", 0.1947810223034186], ["list", 0.0998351114130714]], "start_date": [["str", 0.10000000000000002], ["Type[app.models.entity.EntityToEntityRel]", 0.10000000000000002], ["Optional[str]", 0.10000000000000002], ["Type[leasing.models.renContractRent]", 0.10000000000000002], ["Type[leasing.models.renIndexAdjustedRent]", 0.10000000000000002], ["datetime.datetime", 0.10000000000000002], ["Type[finances.models.DiscountBase]", 0.10000000000000002], ["Type[guild_calendar.models.Event]", 0.10000000000000002], ["Optional[datetime.date]", 0.10000000000000002], ["datetime.date", 0.10000000000000002]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1208, 4], [1230, 48]], "fn_var_ln": {"dag": [[1212, 8], [1212, 11]], "dagruns": [[1226, 8], [1226, 15]], "end_date": [[1210, 8], [1210, 16]], "executor": [[1217, 8], [1217, 16]], "job": [[1218, 8], [1218, 11]], "job_runner": [[1219, 8], [1219, 18]], "start_date": [[1209, 8], [1209, 18]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dag_test_max_active_limits", "dag_maker", "dag_id"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"], ["dagruns", "DagRun", "find", "dag_id", "dag", "dag_id"]], "dagruns": [["dagruns", "DagRun", "find", "dag_id", "dag", "dag_id"], ["len", "dagruns"], ["State", "SUCCESS", "dagruns", "state"]], "end_date": [["end_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "start_date": [["start_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"]]}, "name": "test_backfill_max_limit_check_no_count_existing", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dag_test_max_active_limits", "dag_maker", "dag_id"], ["dag_maker", "create_dagrun", "state", "None"]], "self": [["dag", "self", "_get_dag_test_max_active_limits", "dag_maker", "dag_id"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_max_limit_check_no_count_existing", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dagruns": "", "end_date": "", "executor": "", "job": "", "job_runner": "", "start_date": ""}, "variables_p": {"dag": [["Counter[Any]", 0.3371348401706511], ["Dict[int, Any]", 0.24998811092168055], ["int", 0.0853915116031864], ["dict", 0.08163718328447488], ["float", 0.08021098378199285]], "dagruns": [["List[int]", 0.18681115864250747], ["str", 0.11940162139640007], ["float", 0.08435947423971471]], "end_date": [["datetime.datetime", 0.2886350914059635], ["datetime.date", 0.17399379679231092], ["str", 0.13994724114205334], ["Pattern[str]", 0.09836255555067651], ["Dict[Any, List[str]]", 0.0816496894813934]], "executor": [["mock.Mock", 0.17527592926847138]], "job": [["list", 0.28338099757820706], ["dict", 0.10866015811222443], ["guillotina.db.interfaces.ITransaction", 0.09796057701060183], ["server.openslides.users.models.Group", 0.09476113658608351]], "job_runner": [["str", 0.16537663101073893], ["Dict[Any, str]", 0.0865600571850599]], "start_date": [["datetime.date", 0.5887159869447559], ["datetime.datetime", 0.18105342803296498], ["datetime.date.time.date", 0.13157378479641618], ["Type[leasing.models.vaVat]", 0.09865680022586293]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1232, 4], [1257, 35]], "fn_var_ln": {"dag": [[1233, 8], [1233, 11]], "end_date": [[1238, 8], [1238, 16]], "executor": [[1243, 8], [1243, 16]], "job": [[1244, 8], [1244, 11]], "job_runner": [[1245, 8], [1245, 18]], "running_dagruns": [[1255, 8], [1255, 23]], "start_date": [[1237, 8], [1237, 18]], "success_dagruns": [[1254, 8], [1254, 23]], "success_expected": [[1242, 8], [1242, 24]]}, "fn_var_occur": {"dag": [["dag", "self", "_get_dag_test_max_active_limits", "dag_maker", "dag_id"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"], ["success_dagruns", "len", "DagRun", "find", "dag_id", "dag", "dag_id", "state", "State", "SUCCESS"], ["running_dagruns", "len", "DagRun", "find", "dag_id", "dag", "dag_id", "state", "State", "RUNNING"]], "end_date": [["end_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "running_dagruns": [["running_dagruns", "len", "DagRun", "find", "dag_id", "dag", "dag_id", "state", "State", "RUNNING"]], "start_date": [["start_date", "DEFAULT_DATE", "datetime", "timedelta", "hours"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "start_date", "end_date", "end_date", "donot_pickle", "True"]], "success_dagruns": [["success_dagruns", "len", "DagRun", "find", "dag_id", "dag", "dag_id", "state", "State", "SUCCESS"], ["success_expected", "success_dagruns"]], "success_expected": [["success_expected", "success_dagruns"]]}, "name": "test_backfill_max_limit_check_complete_loop", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag", "self", "_get_dag_test_max_active_limits", "dag_maker", "dag_id"], ["dag_maker", "create_dagrun", "state", "None"]], "self": [["dag", "self", "_get_dag_test_max_active_limits", "dag_maker", "dag_id"]]}, "params_p": {"args": [], "dag_maker": [["raiden.utils.Address", 0.07927160484290968]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_max_limit_check_complete_loop", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "end_date": "", "executor": "", "job": "", "job_runner": "", "running_dagruns": "", "start_date": "", "success_dagruns": "", "success_expected": ""}, "variables_p": {"dag": [["Counter[Any]", 0.3371348401706511], ["Dict[int, Any]", 0.24998811092168055], ["int", 0.0853915116031864], ["dict", 0.08163718328447488], ["float", 0.08021098378199285]], "end_date": [["datetime.datetime", 0.2886350914059635], ["datetime.date", 0.17399379679231092], ["str", 0.13994724114205334], ["Pattern[str]", 0.09836255555067651], ["Dict[Any, List[str]]", 0.0816496894813934]], "executor": [["mock.Mock", 0.17527592926847138]], "job": [["list", 0.28338099757820706], ["dict", 0.10866015811222443], ["guillotina.db.interfaces.ITransaction", 0.09796057701060183], ["server.openslides.users.models.Group", 0.09476113658608351]], "job_runner": [["str", 0.16537663101073893], ["Dict[Any, str]", 0.0865600571850599]], "running_dagruns": [["int", 0.7176969072726153], ["Set[str]", 0.10275546981434378], ["str", 0.0959102535628964], ["Dict[str, int]", 0.08363736935014471]], "start_date": [["datetime.date", 0.4155572273914882], ["datetime.datetime", 0.19096779591957197], ["datetime.datetime.datetime", 0.10507794039032715], ["Dict[Any, List[str]]", 0.09385889118183491], ["datetime.date.time.date", 0.08956782344006087]], "success_dagruns": [["int", 0.28302134356634595], ["list", 0.27296860895220343], ["Dict[str, str]", 0.14388451952509868], ["dict", 0.11321024888758972], ["Callable(len)[[Sized], int]", 0.11059965237419812], ["Type[object]", 0.07631562669456397]], "success_expected": [["str", 0.39999999999999997], ["Dict[int, List[Any]]", 0.09999999999999999], ["List[Union[int, str]]", 0.09999999999999999], ["List[str]", 0.09999999999999999]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1259, 4], [1289, 45]], "fn_var_ln": {"dr": [[1275, 8], [1275, 10]], "executor": [[1277, 8], [1277, 16]], "job": [[1281, 8], [1281, 11]], "job_runner": [[1282, 8], [1282, 18]], "op1": [[1264, 12], [1264, 15]], "op2": [[1265, 12], [1265, 15]], "op3": [[1266, 12], [1266, 15]], "op4": [[1267, 12], [1267, 15]], "op5": [[1268, 12], [1268, 15]], "sub_dag": [[1278, 8], [1278, 15]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun", "state", "None"], ["dr", "get_task_instances"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "sub_dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "sub_dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "op1": [["op1", "EmptyOperator", "task_id"], ["op1", "set_downstream", "op3"]], "op2": [["op2", "EmptyOperator", "task_id"], ["op2", "set_downstream", "op3"]], "op3": [["op3", "EmptyOperator", "task_id"], ["op2", "set_downstream", "op3"], ["op1", "set_downstream", "op3"], ["op3", "set_downstream", "op4"]], "op4": [["op4", "EmptyOperator", "task_id"], ["op4", "set_downstream", "op5"], ["op3", "set_downstream", "op4"]], "op5": [["op5", "EmptyOperator", "task_id"], ["op4", "set_downstream", "op5"]], "sub_dag": [["sub_dag", "dag", "partial_subset", "task_ids_or_regex", "include_downstream", "False", "include_upstream", "False"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "sub_dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"]]}, "name": "test_sub_set_subdag", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag"], ["dr", "dag_maker", "create_dagrun", "state", "None"]], "self": []}, "params_p": {"args": [], "dag_maker": [["tests.async_mock.Mock", 0.13120671648068058]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_sub_set_subdag", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "executor": "", "job": "", "job_runner": "", "op1": "", "op2": "", "op3": "", "op4": "", "op5": "", "sub_dag": ""}, "variables_p": {"dr": [["threading.local", 0.21979220210991038], ["Tuple[Type[str]]", 0.1775947918955786], ["str", 0.10973589542145355], ["Optional[List[str]]", 0.08808549103527732], ["Dict[str, Any]", 0.08562869960322207], ["Dict[str, str]", 0.08139532884197274], ["List[None]", 0.07396311869947282]], "executor": [["mock.Mock", 0.17527592926847138]], "job": [["Dict[str, None]", 0.10970604064778233], ["guillotina.db.interfaces.ITransaction", 0.09214188382738916], ["dict", 0.08889351256841356], ["str", 0.08774240916523296]], "job_runner": [["Dict[Any, str]", 0.10715311277406797], ["Dict[str, None]", 0.08698820899059033]], "op1": [["Pattern[Any]", 0.24920695694715456], ["dict", 0.18075641439136372], ["list", 0.1530259623276781], ["Dict[int, Any]", 0.08682544068173122], ["str", 0.08588676396207981], ["Dict[str, Tuple[Any, Any]]", 0.07936138948903751]], "op2": [["Pattern[Any]", 0.24920695694715456], ["dict", 0.18075641439136372], ["list", 0.1530259623276781], ["Dict[int, Any]", 0.08682544068173122], ["str", 0.08588676396207981], ["Dict[str, Tuple[Any, Any]]", 0.07936138948903751]], "op3": [["Dict[str, Any]", 0.4153191625095281], ["int", 0.1332043738623851], ["dict", 0.10002244783152449], ["Dict[str, Literal]", 0.09764105297166412], ["Dict[int, int]", 0.08703632538926484], ["List[str]", 0.08261738478953636]], "op4": [["int", 0.3088733442640498], ["Dict[str, Any]", 0.2824461965268254], ["Dict[str, Literal]", 0.11573192688678151], ["Pattern[Any]", 0.09709471404328351], ["Dict[str, str]", 0.0884227059824768]], "op5": [["Pattern[Any]", 0.24920695694715456], ["dict", 0.18075641439136372], ["list", 0.1530259623276781], ["Dict[int, Any]", 0.08682544068173122], ["str", 0.08588676396207981], ["Dict[str, Tuple[Any, Any]]", 0.07936138948903751]], "sub_dag": []}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1291, 4], [1344, 56]], "fn_var_ln": {"dr": [[1302, 8], [1302, 10]], "end_date": [[1312, 16], [1312, 27]], "executor": [[1304, 8], [1304, 16]], "job": [[1326, 8], [1326, 11]], "job_runner": [[1327, 8], [1327, 18]], "op1": [[1295, 12], [1295, 15]], "op2": [[1296, 12], [1296, 15]], "op3": [[1297, 12], [1297, 15]], "op4": [[1298, 12], [1298, 15]], "op5": [[1299, 12], [1299, 15]], "op6": [[1300, 12], [1300, 15]], "session": [[1306, 8], [1306, 15]], "state": [[1320, 16], [1320, 24]], "tis": [[1335, 8], [1335, 11]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun", "state", "None"], ["tis", "dr", "get_task_instances"], ["dr", "refresh_from_db"], ["dr", "state", "State", "FAILED"], ["tis", "dr", "get_task_instances"]], "end_date": [["ti", "end_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "op1": [["op1", "EmptyOperator", "task_id"], ["ti", "task_id", "op1", "task_id"], ["ti", "task_id", "op1", "task_id", "op4", "task_id", "op6", "task_id"]], "op2": [["op2", "EmptyOperator", "task_id"], ["ti", "task_id", "op2", "task_id"], ["ti", "task_id", "op2", "task_id"]], "op3": [["op3", "EmptyOperator", "task_id"], ["ti", "task_id", "op3", "task_id"], ["ti", "task_id", "op3", "task_id"]], "op4": [["op4", "EmptyOperator", "task_id"], ["ti", "task_id", "op4", "task_id"], ["ti", "task_id", "op1", "task_id", "op4", "task_id", "op6", "task_id"]], "op5": [["op5", "EmptyOperator", "task_id"], ["ti", "task_id", "op5", "task_id"], ["ti", "task_id", "op5", "task_id"]], "op6": [["op6", "EmptyOperator", "task_id"], ["ti", "task_id", "op1", "task_id", "op4", "task_id", "op6", "task_id"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti"], ["session", "commit"], ["session", "close"]], "state": [["dr", "dag_maker", "create_dagrun", "state", "None"], ["ti", "state", "State", "UP_FOR_RETRY"], ["ti", "state", "State", "FAILED"], ["ti", "state", "State", "SKIPPED"], ["ti", "state", "State", "SCHEDULED"], ["ti", "state", "State", "UPSTREAM_FAILED"], ["dr", "state", "State", "FAILED"], ["ti", "state", "State", "SUCCESS"], ["ti", "state", "State", "FAILED"], ["ti", "state", "State", "SKIPPED"], ["ti", "state", "State", "UPSTREAM_FAILED"]], "tis": [["tis", "dr", "get_task_instances"], ["tis", "dr", "get_task_instances"]]}, "name": "test_backfill_fill_blanks", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag"], ["dr", "dag_maker", "create_dagrun", "state", "None"]], "self": []}, "params_p": {"args": [], "dag_maker": [["tests.async_mock.Mock", 0.09620919288884076]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_fill_blanks", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "end_date": "", "executor": "", "job": "", "job_runner": "", "op1": "", "op2": "", "op3": "", "op4": "", "op5": "", "op6": "", "session": "", "state": "", "tis": ""}, "variables_p": {"dr": [["float", 0.1255864653630856], ["int", 0.10394777016843139], ["list", 0.10252225570263253], ["datetime.datetime.datetime", 0.10197814318331591], ["str", 0.09155557375006759], ["Optional[str]", 0.0834942523652156]], "end_date": [["datetime.datetime", 0.37796728893377307], ["str", 0.13116986203137432], ["datetime.datetime.date", 0.10930359062801756], ["list", 0.08269044547634413], ["datetime.datetime.datetime", 0.08128307288695404]], "executor": [["mock.Mock", 0.17527592926847138]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.10238998589499847]], "op1": [["int", 0.19474289996649474], ["str", 0.12911330857576944], ["khetha.models.Task", 0.1070090179274528], ["Dict[str, str]", 0.09805830363628147], ["reminders.task.Task", 0.09739451256723393], ["dict", 0.09633821598870422], ["magic.models.card.Card", 0.09455968620203248], ["List[str]", 0.0924751864772773], ["Dict[str, Union[int, str]]", 0.09030886865875379]], "op2": [["int", 0.21466313310829402], ["list", 0.18103145696143141], ["str", 0.13363436970695305], ["dict", 0.10019166730610621], ["Dict[str, Union[int, str]]", 0.09902520337857662], ["reminders.task.Task", 0.09362841280776403], ["List[str]", 0.0905429924358906], ["tests.components.withings.common.WebhookResponse", 0.08728276429498397]], "op3": [["int", 0.21466313310829402], ["list", 0.18103145696143141], ["str", 0.13363436970695305], ["dict", 0.10019166730610621], ["Dict[str, Union[int, str]]", 0.09902520337857662], ["reminders.task.Task", 0.09362841280776403], ["List[str]", 0.0905429924358906], ["tests.components.withings.common.WebhookResponse", 0.08728276429498397]], "op4": [["int", 0.19474289996649474], ["str", 0.12911330857576944], ["khetha.models.Task", 0.1070090179274528], ["Dict[str, str]", 0.09805830363628147], ["reminders.task.Task", 0.09739451256723393], ["dict", 0.09633821598870422], ["magic.models.card.Card", 0.09455968620203248], ["List[str]", 0.0924751864772773], ["Dict[str, Union[int, str]]", 0.09030886865875379]], "op5": [["int", 0.21466313310829402], ["list", 0.18103145696143141], ["str", 0.13363436970695305], ["dict", 0.10019166730610621], ["Dict[str, Union[int, str]]", 0.09902520337857662], ["reminders.task.Task", 0.09362841280776403], ["List[str]", 0.0905429924358906], ["tests.components.withings.common.WebhookResponse", 0.08728276429498397]], "op6": [["int", 0.21514745248369238], ["tests.components.withings.common.WebhookResponse", 0.17634122509968392], ["str", 0.14037431806088696], ["Dict[str, Union[int, str]]", 0.09970947931311888], ["dict", 0.09798754690795426], ["list", 0.0910486978115444], ["reminders.task.Task", 0.08976667670975665], ["List[str]", 0.08962460361336262]], "session": [["sqlalchemy.orm.session.Session", 0.3797405490417261], ["Optional[str]", 0.2723642433318019], ["kedro.framework.session.session.KedroSession", 0.14116166255747536]], "state": [["Dict[str, Any]", 0.10906813154661495], ["Optional[Tuple[int, int]]", 0.09900259446749012]], "tis": [["Dict[str, Any]", 0.14766912150085032], ["int", 0.1034261282792421], ["str", 0.08792979708271811], ["raiden.api.python.RaidenAPI", 0.07975850591598889]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1346, 4], [1390, 19]], "fn_var_ln": {"dag": [[1347, 8], [1347, 11]], "executor": [[1354, 8], [1354, 16]], "history": [[1369, 8], [1369, 15]], "job": [[1355, 8], [1355, 11]], "job_runner": [[1356, 8], [1356, 18]], "start_date": [[1353, 8], [1353, 18]], "subdag": [[1350, 8], [1350, 14]], "subdag_history": [[1370, 8], [1370, 22]], "subdag_op_task": [[1348, 8], [1348, 22]], "successful_subdag_runs": [[1379, 12], [1379, 34]], "ti": [[1375, 12], [1375, 14]], "timetable": [[1351, 8], [1351, 24]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag"], ["subdag_op_task", "dag", "get_task"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "subdag", "start_date", "start_date", "end_date", "start_date", "donot_pickle", "True"], ["dag", "clear"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"], ["history", "executor", "history"]], "history": [["history", "executor", "history"], ["subdag_history", "history"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "subdag", "start_date", "start_date", "end_date", "start_date", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "subdag", "start_date", "start_date", "end_date", "start_date", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "start_date": [["start_date", "timezone", "utcnow"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "subdag", "start_date", "start_date", "end_date", "start_date", "donot_pickle", "True"], ["subdag_op_task", "pre_execute", "context", "start_date"], ["subdag_op_task", "execute", "context", "start_date"], ["subdag_op_task", "post_execute", "context", "start_date"], ["successful_subdag_runs", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "subdag", "dag_id", "filter", "DagRun", "execution_date", "start_date", "filter", "DagRun", "state", "State", "SUCCESS", "count"]], "subdag": [["subdag", "subdag_op_task", "subdag"], ["subdag", "timetable", "cron_timetable"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "subdag", "start_date", "start_date", "end_date", "start_date", "donot_pickle", "True"], ["successful_subdag_runs", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "subdag", "dag_id", "filter", "DagRun", "execution_date", "start_date", "filter", "DagRun", "state", "State", "SUCCESS", "count"], ["subdag", "clear"]], "subdag_history": [["subdag_history", "history"], ["len", "subdag_history"]], "subdag_op_task": [["subdag_op_task", "dag", "get_task"], ["subdag", "subdag_op_task", "subdag"], ["subdag_op_task", "pre_execute", "context", "start_date"], ["subdag_op_task", "execute", "context", "start_date"], ["subdag_op_task", "post_execute", "context", "start_date"]], "successful_subdag_runs": [["successful_subdag_runs", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "subdag", "dag_id", "filter", "DagRun", "execution_date", "start_date", "filter", "DagRun", "state", "State", "SUCCESS", "count"]], "ti": [["ti", "sdh"], ["ti", "task_id"]], "timetable": [["subdag", "timetable", "cron_timetable"]]}, "name": "test_backfill_execute_subdag", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["dag", "self", "dagbag", "get_dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_execute_subdag", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "executor": "", "history": "", "job": "", "job_runner": "", "start_date": "", "subdag": "", "subdag_history": "", "subdag_op_task": "", "successful_subdag_runs": "", "ti": "", "timetable": ""}, "variables_p": {"dag": [["src.controllers.tests.keyboard_tesBasicListener", 0.17693231263369827], ["Iterator[Any]", 0.08070317404180243]], "executor": [["mock.Mock", 0.17527592926847138]], "history": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "job": [["list", 0.3740530990617784], ["dict", 0.11493397170652206]], "job_runner": [["str", 0.1703793846746843], ["Dict[Any, str]", 0.08655322087216574]], "start_date": [["datetime.datetime.datetime", 0.21106719353127337], ["Optional[str]", 0.10806326045494771], ["Dict[Any, List[str]]", 0.09458966711075639], ["dict", 0.08900694081376957], ["datetime.date", 0.08790633929943803]], "subdag": [["zam_repondeur.services.fetch.an.dossiers.models.DossierRefsByUID", 0.1798378112751564], ["dict", 0.09256280286255875]], "subdag_history": [["List[int]", 0.6666666666027546], ["int", 0.16666666669895586], ["Set[str]", 0.16666666665068866], ["str", 4.760074634658266e-11]], "subdag_op_task": [["dict", 0.11580005545629125], ["int", 0.11109676246733924], ["list", 0.09137341155456948]], "successful_subdag_runs": [["list", 0.2070454317367452], ["str", 0.19658973844530614], ["dict", 0.1941426921305312], ["int", 0.18390568755736372], ["Dict[str, str]", 0.09031000552295865]], "ti": [["str", 0.6268665739468171], ["Dict[str, List[Any]]", 0.09622584468178295], ["Union[Literal, str]", 0.0906344112599617]], "timetable": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1392, 4], [1439, 19]], "fn_var_ln": {"dag": [[1393, 8], [1393, 11]], "executor": [[1398, 8], [1398, 16]], "job": [[1399, 8], [1399, 11]], "job_runner": [[1400, 8], [1400, 18]], "sdag": [[1423, 8], [1423, 12]], "subdag": [[1396, 8], [1396, 14]], "subdag_op_task": [[1394, 8], [1394, 22]], "ti_downstream": [[1419, 8], [1419, 21]], "ti_irrelevant": [[1415, 8], [1415, 21]], "ti_subdag": [[1411, 8], [1411, 17]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag"], ["subdag_op_task", "dag", "get_task"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "donot_pickle", "True"], ["ti_subdag", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti_irrelevant", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti_downstream", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["dag", "clear"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "sdag": [["sdag", "subdag", "partial_subset", "task_ids_or_regex", "include_downstream", "True", "include_upstream", "False"], ["sdag", "clear", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "include_parentdag", "True"]], "subdag": [["subdag", "subdag_op_task", "subdag"], ["sdag", "subdag", "partial_subset", "task_ids_or_regex", "include_downstream", "True", "include_upstream", "False"], ["subdag", "clear"]], "subdag_op_task": [["subdag_op_task", "dag", "get_task"], ["subdag", "subdag_op_task", "subdag"]], "ti_downstream": [["ti_downstream", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti_downstream", "refresh_from_db"], ["ti_downstream", "state", "State", "SUCCESS"], ["ti_downstream", "refresh_from_db"], ["State", "NONE", "ti_downstream", "state"]], "ti_irrelevant": [["ti_irrelevant", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti_irrelevant", "refresh_from_db"], ["ti_irrelevant", "state", "State", "SUCCESS"], ["ti_irrelevant", "refresh_from_db"], ["State", "SUCCESS", "ti_irrelevant", "state"]], "ti_subdag": [["ti_subdag", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti_subdag", "refresh_from_db"], ["ti_subdag", "state", "State", "SUCCESS"], ["ti_subdag", "refresh_from_db"], ["State", "NONE", "ti_subdag", "state"]]}, "name": "test_subdag_clear_parentdag_downstream_clear", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["dag", "self", "dagbag", "get_dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_subdag_clear_parentdag_downstream_clear", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "executor": "", "job": "", "job_runner": "", "sdag": "", "subdag": "", "subdag_op_task": "", "ti_downstream": "", "ti_irrelevant": "", "ti_subdag": ""}, "variables_p": {"dag": [["src.controllers.tests.keyboard_tesBasicListener", 0.17693231263369827], ["Iterator[Any]", 0.08070317404180243]], "executor": [["mock.Mock", 0.17527592926847138]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.09134236042586363]], "sdag": [["grpy.core.models.Grouping", 0.40177614361709185], ["Optional[excars.models.rides.Ride]", 0.10133891284506001], ["Optional[pxl.state.Album]", 0.1005354349669182]], "subdag": [["quantumflow.states.State", 0.10325947677969391], ["decksite.data.models.person.Person", 0.09994734901915858], ["str", 0.09802147650928413]], "subdag_op_task": [["list", 0.2108595793926552], ["dict", 0.2106280512150337], ["Dict[str, Any]", 0.09177259655304368]], "ti_downstream": [["backend.api.models.group.Group", 0.429677635169772], ["byceps.services.ticketing.models.tickeTicket", 0.18714693875103827], ["gardnr.models.Metric", 0.18017018035875582]], "ti_irrelevant": [["backend.api.models.group.Group", 0.429677635169772], ["byceps.services.ticketing.models.tickeTicket", 0.18714693875103827], ["gardnr.models.Metric", 0.18017018035875582]], "ti_subdag": [["backend.api.models.group.Group", 0.429677635169772], ["byceps.services.ticketing.models.tickeTicket", 0.18714693875103827], ["gardnr.models.Metric", 0.18017018035875582]]}}, {"docstring": {"func": "Ensure that subdag operators execute properly in the case where", "long_descr": "an associated task of the subdag has been removed from the dag\ndefinition, but has instances in the database from previous runs.", "ret": null}, "fn_lc": [[1441, 4], [1492, 19]], "fn_var_ln": {"dag": [[1447, 8], [1447, 11]], "dag_id": [[1468, 8], [1468, 30]], "dr": [[1460, 8], [1460, 10]], "executor": [[1451, 8], [1451, 16]], "instance": [[1477, 12], [1477, 20]], "job": [[1452, 8], [1452, 11]], "job_runner": [[1453, 8], [1453, 18]], "removed_task_ti": [[1465, 8], [1465, 23]], "session": [[1450, 8], [1450, 15]], "subdag": [[1448, 8], [1448, 14]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag"], ["subdag", "dag", "get_task", "subdag"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "subdag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "donot_pickle", "True"], ["dag", "clear"]], "dag_id": [["dr", "DagRun", "dag_id", "subdag", "dag_id", "execution_date", "DEFAULT_DATE", "run_id", "run_type", "DagRunType", "BACKFILL_JOB"], ["removed_task_ti", "dag_id", "subdag", "dag_id"], ["instance", "session", "query", "TI", "filter", "TI", "dag_id", "subdag", "dag_id", "TI", "task_id", "task", "task_id", "TI", "execution_date", "DEFAULT_DATE", "first"]], "dr": [["dr", "DagRun", "dag_id", "subdag", "dag_id", "execution_date", "DEFAULT_DATE", "run_id", "run_type", "DagRunType", "BACKFILL_JOB"], ["session", "add", "dr"], ["removed_task_ti", "TI", "task", "EmptyOperator", "task_id", "run_id", "dr", "run_id", "state", "State", "REMOVED"], ["dr", "task_instances", "append", "removed_task_ti"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"]], "instance": [["instance", "session", "query", "TI", "filter", "TI", "dag_id", "subdag", "dag_id", "TI", "task_id", "task", "task_id", "TI", "execution_date", "DEFAULT_DATE", "first"], ["instance", "None"], ["instance", "state", "State", "SUCCESS"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "subdag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "subdag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "removed_task_ti": [["removed_task_ti", "TI", "task", "EmptyOperator", "task_id", "run_id", "dr", "run_id", "state", "State", "REMOVED"], ["removed_task_ti", "dag_id", "subdag", "dag_id"], ["dr", "task_instances", "append", "removed_task_ti"], ["removed_task_ti", "refresh_from_db"], ["removed_task_ti", "state", "State", "REMOVED"]], "session": [["session", "settings", "Session"], ["session", "add", "dr"], ["session", "commit"], ["instance", "session", "query", "TI", "filter", "TI", "dag_id", "subdag", "dag_id", "TI", "task_id", "task", "task_id", "TI", "execution_date", "DEFAULT_DATE", "first"]], "subdag": [["subdag", "dag", "get_task", "subdag"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "subdag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "donot_pickle", "True"], ["dr", "DagRun", "dag_id", "subdag", "dag_id", "execution_date", "DEFAULT_DATE", "run_id", "run_type", "DagRunType", "BACKFILL_JOB"], ["removed_task_ti", "dag_id", "subdag", "dag_id"], ["subdag", "tasks"], ["instance", "session", "query", "TI", "filter", "TI", "dag_id", "subdag", "dag_id", "TI", "task_id", "task", "task_id", "TI", "execution_date", "DEFAULT_DATE", "first"], ["subdag", "clear"]]}, "name": "test_backfill_execute_subdag_with_removed_task", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["dag", "self", "dagbag", "get_dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_execute_subdag_with_removed_task", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_id": "", "dr": "", "executor": "", "instance": "", "job": "", "job_runner": "", "removed_task_ti": "", "session": "", "subdag": ""}, "variables_p": {"dag": [["dict", 0.10031037997403519]], "dag_id": [["str", 0.36331087532917217], ["int", 0.2655885809934748], ["Optional[int]", 0.09311703545801259]], "dr": [["str", 0.36259156345910215], ["int", 0.12372114092145708], ["byceps.services.user.transfer.models.User", 0.1181166699594973], ["decksite.data.models.person.Person", 0.11797516102290939], ["List[Tuple[Any, Any]]", 0.09367373991090339], ["Optional[excars.models.profiles.Profile]", 0.08072457741299684]], "executor": [["mock.Mock", 0.17527592926847138]], "instance": [["int", 0.17811471959771533], ["Union[Literal, int]", 0.08598497675000834], ["notifications.models.Notification", 0.08034275042900962], ["app.models.Tweet", 0.07872701437743558], ["list", 0.07535170681607775]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.09134236042586363]], "removed_task_ti": [["taskiapplication.models.task.Task", 0.3975681100701557], ["reminders.task.Task", 0.1141176916562653], ["taskiinfrastructure.data.json.repositories.task_repository.JsonTaskRepository", 0.10925075536840795], ["golem.task.taskbase.Task", 0.10433852338336141], ["apps.core.task.coretaskstate.TaskDefinition", 0.08681129787012334]], "session": [["sqlalchemy.orm.session.Session", 0.09569568089459617]], "subdag": [["grpy.core.models.Grouping", 0.2834697854114167], ["float", 0.19576105963210239], ["khetha.models.Question", 0.09280765916576487], ["str", 0.0850616075352269]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1494, 4], [1639, 23]], "fn_var_ln": {"_try_number": [[1601, 8], [1601, 22]], "dr": [[1497, 8], [1497, 10]], "job": [[1498, 8], [1498, 11]], "job_runner": [[1499, 8], [1499, 18]], "task1": [[1496, 12], [1496, 17]], "ti": [[1500, 8], [1500, 10]], "ti_status": [[1503, 8], [1503, 17]]}, "fn_var_occur": {"_try_number": [["ti", "_try_number"], ["ti", "_try_number"], ["ti", "_try_number"], ["ti", "_try_number"], ["ti", "_try_number"], ["ti", "_try_number"], ["ti", "_try_number"], ["ti", "_try_number"]], "dr": [["dr", "dag_maker", "create_dagrun", "state", "None"], ["ti", "TI", "task1", "dr", "execution_date"]], "job": [["job", "Job"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"]], "task1": [["task1", "EmptyOperator", "task_id", "owner"], ["ti", "TI", "task1", "dr", "execution_date"]], "ti": [["ti", "TI", "task1", "dr", "execution_date"], ["ti", "refresh_from_db"], ["ti_status", "running", "ti", "key", "ti"], ["ti", "_try_number"], ["ti", "set_state", "State", "SUCCESS", "session"], ["ti_status", "running", "ti", "key", "ti"], ["ti", "_try_number"], ["ti", "set_state", "State", "SUCCESS", "session"], ["ti_status", "running", "ti", "key", "ti"], ["ti", "_try_number"], ["ti", "set_state", "State", "SKIPPED", "session"], ["ti_status", "running", "ti", "key", "ti"], ["ti", "_try_number"], ["ti", "set_state", "State", "FAILED", "session"], ["ti_status", "running", "ti", "key", "ti"], ["ti", "_try_number"], ["ti", "set_state", "State", "UP_FOR_RETRY", "session"], ["ti_status", "running", "ti", "key", "ti"], ["ti", "_try_number"], ["ti", "_try_number"], ["ti", "set_state", "State", "UP_FOR_RESCHEDULE", "session"], ["ti", "set_state", "State", "NONE", "session"], ["ti", "_try_number"], ["ti", "try_number"], ["session", "merge", "ti"], ["ti_status", "running", "ti", "key", "ti"], ["ti", "set_state", "State", "SCHEDULED"], ["ti_status", "running", "ti", "key", "ti"], ["ti", "set_state", "State", "DEFERRED"], ["ti_status", "running", "ti", "key", "ti"]], "ti_status": [["ti_status", "BackfillJobRunner", "_DagRunTaskStatus"], ["ti_status", "running", "ti", "key", "ti"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["len", "ti_status", "running"], ["len", "ti_status", "succeeded"], ["len", "ti_status", "skipped"], ["len", "ti_status", "failed"], ["len", "ti_status", "to_run"], ["ti_status", "succeeded", "clear"], ["ti_status", "running", "ti", "key", "ti"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["len", "ti_status", "running"], ["len", "ti_status", "succeeded"], ["len", "ti_status", "skipped"], ["len", "ti_status", "failed"], ["len", "ti_status", "to_run"], ["ti_status", "succeeded", "clear"], ["ti_status", "running", "ti", "key", "ti"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["len", "ti_status", "running"], ["len", "ti_status", "succeeded"], ["len", "ti_status", "skipped"], ["len", "ti_status", "failed"], ["len", "ti_status", "to_run"], ["ti_status", "skipped", "clear"], ["ti_status", "running", "ti", "key", "ti"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["len", "ti_status", "running"], ["len", "ti_status", "succeeded"], ["len", "ti_status", "skipped"], ["len", "ti_status", "failed"], ["len", "ti_status", "to_run"], ["ti_status", "failed", "clear"], ["ti_status", "running", "ti", "key", "ti"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["len", "ti_status", "running"], ["len", "ti_status", "succeeded"], ["len", "ti_status", "skipped"], ["len", "ti_status", "failed"], ["len", "ti_status", "to_run"], ["ti_status", "to_run", "clear"], ["ti_status", "running", "ti", "key", "ti"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["len", "ti_status", "running"], ["len", "ti_status", "succeeded"], ["len", "ti_status", "skipped"], ["len", "ti_status", "failed"], ["len", "ti_status", "to_run"], ["ti_status", "to_run", "clear"], ["ti_status", "running", "ti", "key", "ti"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["len", "ti_status", "running"], ["len", "ti_status", "succeeded"], ["len", "ti_status", "skipped"], ["len", "ti_status", "failed"], ["len", "ti_status", "to_run"], ["ti_status", "to_run", "clear"], ["ti_status", "running", "ti", "key", "ti"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["len", "ti_status", "running"], ["len", "ti_status", "succeeded"], ["len", "ti_status", "skipped"], ["len", "ti_status", "failed"], ["len", "ti_status", "to_run"], ["ti_status", "to_run", "clear"], ["ti_status", "running", "ti", "key", "ti"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["len", "ti_status", "running"], ["len", "ti_status", "succeeded"], ["len", "ti_status", "skipped"], ["len", "ti_status", "failed"], ["len", "ti_status", "to_run"]]}, "name": "test_update_counters", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "session", "session", "dag"], ["dr", "dag_maker", "create_dagrun", "state", "None"]], "self": [], "session": [["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "session", "session", "dag"], ["ti", "set_state", "State", "SUCCESS", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["ti", "set_state", "State", "SUCCESS", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["ti", "set_state", "State", "SKIPPED", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["ti", "set_state", "State", "FAILED", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["ti", "set_state", "State", "UP_FOR_RETRY", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["ti", "set_state", "State", "UP_FOR_RESCHEDULE", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["ti", "set_state", "State", "NONE", "session"], ["session", "merge", "ti"], ["session", "commit"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["job_runner", "_update_counters", "ti_status", "ti_status", "session", "session"], ["session", "close"]]}, "params_p": {"args": [], "dag_maker": [["Optional[core.models.User]", 0.10207726572998213], ["ajapaik.ajapaik.models.Profile", 0.09923475818820093], ["ajapaik.ajapaik_object_recognition.models.ObjectDetectionAnnotation", 0.09923475818820093], ["Optional[Dict]", 0.09630781818575732], ["zerver.models.Stream", 0.09481196696219076]], "kwargs": [], "self": [], "session": [["str", 0.22276586686509495], ["Optional[core.models.User]", 0.12469028871951053], ["sqlalchemy.orm.session.Session", 0.09274445612467602], ["Optional[Dict]", 0.08939755821482084]]}, "q_name": "TestBackfillJob.test_update_counters", "ret_exprs": [], "ret_type": "", "variables": {"_try_number": "", "dr": "", "job": "", "job_runner": "", "task1": "", "ti": "", "ti_status": ""}, "variables_p": {"_try_number": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "dr": [["int", 0.1446775149215541], ["Type[str]", 0.14079786636205815], ["Dict[str, Optional[float]]", 0.10324695772893068], ["Union[Literal, Literal]", 0.08620417963166142], ["Optional[float]", 0.08078229973281884], ["Tuple[str, str, str, str, str]", 0.07895260880584845], ["Tuple[str, str, str]", 0.07895260880584845], ["List[int]", 0.07489428114848917]], "job": [["Set[str]", 0.39097973902896666], ["Dict[str, str]", 0.11048842597519384], ["dict", 0.09563688783786689], ["List[Optional[bool]]", 0.08648890367005362]], "job_runner": [["qiskiproviders.ibmq.job.ibmqjob.IBMQJob", 0.19665425434686618], ["pwnedapi.utils.Scanner", 0.10600022637215212]], "task1": [["List[List[int]]", 0.1876130505177231], ["o2a.converter.task.Task", 0.16487979714158021], ["Dict[str, str]", 0.1062406245546336], ["str", 0.09405195077985612], ["legistar.models.MatterStatus", 0.0846614488790736], ["Dict[str, Union[Any, Any, str]]", 0.0817158035687143]], "ti": [["dict", 0.3504770391178445], ["str", 0.09034429231957329]], "ti_status": [["Dict[str, Optional[str]]", 0.09149527583885284], ["dict", 0.0908167599011581], ["legistar.models.MatterStatus", 0.08707927756208488], ["str", 0.08705171572352272], ["bytes", 0.07784910315245244]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1641, 4], [1668, 9]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_dag_dagrun_infos_between", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "schedule", "test_dag"]], "self": []}, "params_p": {"args": [], "dag_maker": [["Callable", 0.1987451987910827]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_dag_dagrun_infos_between", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1670, 4], [1700, 23]], "fn_var_ln": {"dag": [[1671, 8], [1671, 11]], "executor": [[1674, 8], [1674, 16]], "job": [[1676, 8], [1676, 11]], "job_runner": [[1677, 8], [1677, 18]], "queued_times": [[1695, 8], [1695, 20]], "session": [[1686, 8], [1686, 15]], "tis": [[1687, 8], [1687, 11]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag"], ["dag", "clear"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "run_backwards", "True"], ["dag", "clear"]], "executor": [["executor", "MockExecutor", "parallelism"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "run_backwards", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "run_backwards", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "queued_times": [["queued_times", "ti", "queued_dttm", "ti", "tis"], ["queued_times", "sorted", "queued_times", "reverse", "True"]], "session": [["session", "settings", "Session"], ["tis", "session", "query", "TI", "join", "TI", "dag_run", "filter", "TI", "dag_id", "TI", "task_id", "order_by", "DagRun", "execution_date", "all"], ["session", "close"]], "tis": [["tis", "session", "query", "TI", "join", "TI", "dag_run", "filter", "TI", "dag_id", "TI", "task_id", "order_by", "DagRun", "execution_date", "all"], ["queued_times", "ti", "queued_dttm", "ti", "tis"], ["all", "ti", "state", "State", "SUCCESS", "ti", "tis"]]}, "name": "test_backfill_run_backwards", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["dag", "self", "dagbag", "get_dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_run_backwards", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "executor": "", "job": "", "job_runner": "", "queued_times": "", "session": "", "tis": ""}, "variables_p": {"dag": [["float", 0.330344239235128], ["list", 0.09734917044742683], ["str", 0.08943949502177498], ["int", 0.08768511053989937]], "executor": [["str", 0.0972795069592408]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11861072391587794], ["Sequence[str]", 0.07914521800214441]], "queued_times": [["pringles.utils.vtime.VirtualTime", 0.437175148654894], ["int", 0.3613720807801089], ["float", 0.13278079470620255]], "session": [["raiden.transfer.state.HopState", 0.21253228558720605], ["dict", 0.12801485341469507], ["legistar.models.MatterStatus", 0.07266844271045751], ["Optional[str]", 0.07204676116870888]], "tis": [["int", 0.4967076773343905], ["notifications.models.Notification", 0.11072991675996001], ["raiden.utils.Any", 0.10828553689173968], ["str", 0.08848765642018762], ["Union[Literal, int]", 0.08773369877688798]]}}, {"docstring": {"func": "Create dagruns and ensure only ones with correct states are reset.", "long_descr": null, "ret": null}, "fn_lc": [[1702, 4], [1762, 36]], "fn_var_ln": {"dr1": [[1719, 8], [1719, 11]], "dr1_tis": [[1723, 8], [1723, 15]], "dr2": [[1720, 8], [1720, 11]], "dr2_tis": [[1724, 8], [1724, 15]], "job": [[1716, 8], [1716, 11]], "job_runner": [[1717, 8], [1717, 18]], "prefix": [[1704, 8], [1704, 14]], "session": [[1715, 8], [1715, 15]], "state": [[1755, 12], [1755, 20]], "states": [[1705, 8], [1705, 14]], "states_to_reset": [[1706, 8], [1706, 23]], "task": [[1712, 16], [1712, 20]], "task_id": [[1711, 16], [1711, 23]], "tasks": [[1708, 8], [1708, 13]], "ti1": [[1726, 12], [1726, 15]], "ti2": [[1727, 12], [1727, 15]]}, "fn_var_occur": {"dr1": [["dr1", "dag_maker", "create_dagrun", "state", "State", "RUNNING"], ["ti1", "TI", "task", "dr1", "execution_date"], ["job_runner", "reset_state_for_orphaned_tasks", "filter_by_dag_run", "dr1", "session", "session"]], "dr1_tis": [["dr1_tis", "append", "ti1"], ["dr1_tis", "dr2_tis"], ["zip", "states", "dr1_tis"], ["zip", "states", "dr1_tis"]], "dr2": [["dr2", "dag", "create_dagrun", "run_id", "state", "State", "SUCCESS"], ["ti2", "TI", "task", "dr2", "execution_date"]], "dr2_tis": [["dr2_tis", "append", "ti2"], ["dr1_tis", "dr2_tis"], ["zip", "states", "dr2_tis"], ["zip", "states", "dr2_tis"]], "job": [["job", "Job"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag"], ["job_runner", "reset_state_for_orphaned_tasks"], ["job_runner", "reset_state_for_orphaned_tasks", "filter_by_dag_run", "dr1", "session", "session"]], "prefix": [["dag_maker", "dag_id", "prefix", "dag"], ["task_id", "prefix", "i"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti1"], ["session", "merge", "ti2"], ["session", "commit"], ["session", "commit"], ["job_runner", "reset_state_for_orphaned_tasks", "filter_by_dag_run", "dr1", "session", "session"]], "state": [["dr1", "dag_maker", "create_dagrun", "state", "State", "RUNNING"], ["dr2", "dag", "create_dagrun", "run_id", "state", "State", "SUCCESS"], ["ti1", "state", "state"], ["ti2", "state", "state"], ["state", "states_to_reset"], ["ti", "state", "None"], ["state", "ti", "state"], ["state", "ti", "state"], ["ti", "state", "state"], ["state", "ti", "state"]], "states": [["states", "State", "QUEUED", "State", "SCHEDULED", "State", "NONE", "State", "RUNNING", "State", "SUCCESS"], ["range", "len", "states"], ["enumerate", "zip", "tasks", "states"], ["zip", "states", "dr1_tis"], ["zip", "states", "dr2_tis"], ["zip", "states", "dr1_tis"], ["zip", "states", "dr2_tis"]], "states_to_reset": [["states_to_reset", "State", "QUEUED", "State", "SCHEDULED", "State", "NONE"], ["state", "states_to_reset"]], "task": [["task", "EmptyOperator", "task_id", "task_id"], ["tasks", "append", "task"], ["ti1", "TI", "task", "dr1", "execution_date"], ["ti2", "TI", "task", "dr2", "execution_date"]], "task_id": [["task_id", "prefix", "i"], ["task", "EmptyOperator", "task_id", "task_id"]], "tasks": [["tasks", "append", "task"], ["enumerate", "zip", "tasks", "states"]], "ti1": [["ti1", "TI", "task", "dr1", "execution_date"], ["ti1", "refresh_from_db"], ["ti1", "state", "state"], ["dr1_tis", "append", "ti1"], ["session", "merge", "ti1"]], "ti2": [["ti2", "TI", "task", "dr2", "execution_date"], ["ti2", "refresh_from_db"], ["ti2", "state", "state"], ["dr2_tis", "append", "ti2"], ["session", "merge", "ti2"]]}, "name": "test_reset_orphaned_tasks_with_orphans", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "prefix", "dag"], ["dr1", "dag_maker", "create_dagrun", "state", "State", "RUNNING"]], "self": []}, "params_p": {"args": [], "dag_maker": [["bool", 0.10175485708063126], ["tests.setup.SetupTest", 0.09749345077102288]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_reset_orphaned_tasks_with_orphans", "ret_exprs": [], "ret_type": "", "variables": {"dr1": "", "dr1_tis": "", "dr2": "", "dr2_tis": "", "job": "", "job_runner": "", "prefix": "", "session": "", "state": "", "states": "", "states_to_reset": "", "task": "", "task_id": "", "tasks": "", "ti1": "", "ti2": ""}, "variables_p": {"dr1": [["dict", 0.12708576516223746], ["List[List[Any]]", 0.10389069894011706], ["Dict[str, Tuple[str, Any]]", 0.09671397876578096], ["str", 0.0936214636492549], ["float", 0.0893763981417434]], "dr1_tis": [["list", 0.7999999999999999], ["Dict[str, Any]", 0.09999999999999999], ["str", 0.09999999999999999]], "dr2": [["int", 0.677479462476613], ["str", 0.22773364456908524], ["bytearray", 0.09478689295430182]], "dr2_tis": [["list", 0.7999999999999999], ["Dict[str, Any]", 0.09999999999999999], ["str", 0.09999999999999999]], "job": [["Set[str]", 0.39097973902896666], ["Dict[str, str]", 0.11048842597519384], ["dict", 0.09563688783786689], ["List[Optional[bool]]", 0.08648890367005362]], "job_runner": [["str", 0.22975572146916892], ["Dict[str, float]", 0.08868943379884907]], "prefix": [["int", 0.7062192011134959], ["Counter[int]", 0.13407743661512733], ["str", 0.07620067177341948]], "session": [["sqlalchemy.orm.session.Session", 0.21424610472016714], ["Optional[str]", 0.17634498504966417], ["kedro.framework.session.session.KedroSession", 0.11449038262254851], ["SMSShell.models.session.Session", 0.08600713456522395], ["dict", 0.08313163983324603]], "state": [["str", 0.2835838340502202], ["int", 0.2143509923393757], ["Tuple[Any, Any, Any]", 0.08515302907786028]], "states": [["List[Tuple[Any, float]]", 0.2755584632600407], ["int", 0.19628771301621384], ["List[str]", 0.11099109966468597], ["list", 0.09430045945284127]], "states_to_reset": [["str", 0.25068395300193375], ["int", 0.20406488128579262], ["list", 0.15110435782063297], ["Dict[str, str]", 0.1395082871889262], ["List[Dict[str, Any]]", 0.09725132530476226], ["Dict[str, int]", 0.080496893565038]], "task": [["List[str]", 0.32241080900914576], ["str", 0.18697617881079953], ["Dict[int, str]", 0.0972485947453046], ["Tuple[str, str, str, str, str, str, str, str, str, str, str, str]", 0.097072467021863], ["Dict[str, Any]", 0.07642684805904142], ["Dict[str, Union[Any, Any]]", 0.07388141659968026], ["Dict[str, str]", 0.07360063531794131], ["Dict[str, Dict[str, Any]]", 0.07238305043622408]], "task_id": [["str", 0.1959398974006829], ["List[str]", 0.12335362299330975], ["list", 0.12156342811627756], ["Pattern[Any]", 0.09295142496652711], ["Optional[str]", 0.08428577305750849]], "tasks": [["list", 0.4352355928112459], ["dict", 0.2662547269612938]], "ti1": [["dict", 0.27918676706473733], ["multiprocessing.pool.Pool", 0.08580040591457846]], "ti2": [["dict", 0.27918676706473733], ["multiprocessing.pool.Pool", 0.08580040591457846]]}}, {"docstring": {"func": "Try to reset when we specify a dagrun and ensure nothing else is.", "long_descr": null, "ret": null}, "fn_lc": [[1764, 4], [1797, 38]], "fn_var_ln": {"dag_id": [[1766, 8], [1766, 14]], "dr1": [[1779, 8], [1779, 11]], "dr2": [[1780, 8], [1780, 11]], "job": [[1776, 8], [1776, 11]], "job_runner": [[1777, 8], [1777, 18]], "num_reset_tis": [[1792, 8], [1792, 21]], "state": [[1784, 8], [1784, 17]], "task_id": [[1767, 8], [1767, 15]], "ti1": [[1781, 8], [1781, 11]], "ti2": [[1782, 8], [1782, 11]]}, "fn_var_occur": {"dag_id": [["task_id", "dag_id"], ["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "schedule", "session", "session", "dag"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "state", "State", "SUCCESS"], ["ti1", "dr1", "get_task_instances", "session", "session"], ["session", "merge", "dr1"]], "dr2": [["dr2", "dag", "create_dagrun", "run_id", "state", "State", "RUNNING", "session", "session"], ["ti2", "dr2", "get_task_instances", "session", "session"], ["session", "merge", "dr2"], ["num_reset_tis", "job_runner", "reset_state_for_orphaned_tasks", "filter_by_dag_run", "dr2", "session", "session"]], "job": [["job", "Job"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag"], ["num_reset_tis", "job_runner", "reset_state_for_orphaned_tasks", "filter_by_dag_run", "dr2", "session", "session"]], "num_reset_tis": [["num_reset_tis", "job_runner", "reset_state_for_orphaned_tasks", "filter_by_dag_run", "dr2", "session", "session"]], "state": [["dr1", "dag_maker", "create_dagrun", "state", "State", "SUCCESS"], ["dr2", "dag", "create_dagrun", "run_id", "state", "State", "RUNNING", "session", "session"], ["ti1", "state", "State", "SCHEDULED"], ["ti2", "state", "State", "SCHEDULED"], ["State", "SCHEDULED", "ti1", "state"], ["State", "NONE", "ti2", "state"]], "task_id": [["task_id", "dag_id"], ["EmptyOperator", "task_id", "task_id", "dag", "dag"]], "ti1": [["ti1", "dr1", "get_task_instances", "session", "session"], ["ti1", "state", "State", "SCHEDULED"], ["session", "merge", "ti1"], ["ti1", "refresh_from_db", "session", "session"], ["State", "SCHEDULED", "ti1", "state"]], "ti2": [["ti2", "dr2", "get_task_instances", "session", "session"], ["ti2", "state", "State", "SCHEDULED"], ["session", "merge", "ti2"], ["ti2", "refresh_from_db", "session", "session"], ["State", "NONE", "ti2", "state"]]}, "name": "test_reset_orphaned_tasks_specified_dagrun", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "schedule", "session", "session", "dag"], ["dr1", "dag_maker", "create_dagrun", "state", "State", "SUCCESS"]], "self": [], "session": [["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "schedule", "session", "session", "dag"], ["dr2", "dag", "create_dagrun", "run_id", "state", "State", "RUNNING", "session", "session"], ["ti1", "dr1", "get_task_instances", "session", "session"], ["ti2", "dr2", "get_task_instances", "session", "session"], ["session", "merge", "ti1"], ["session", "merge", "ti2"], ["session", "merge", "dr1"], ["session", "merge", "dr2"], ["session", "flush"], ["num_reset_tis", "job_runner", "reset_state_for_orphaned_tasks", "filter_by_dag_run", "dr2", "session", "session"], ["ti1", "refresh_from_db", "session", "session"], ["ti2", "refresh_from_db", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["zerver.models.UserProfile", 0.2087866052203734], ["zerver.models.UserGroup", 0.11684392341383563], ["zerver.models.PreregistrationUser", 0.09934599696016952], ["asgard.models.accounAccount", 0.09726485252970694], ["asgard.models.user.User", 0.09726485252970694]], "kwargs": [], "self": [], "session": [["zerver.models.UserProfile", 0.21183358448608627], ["zerver.models.UserGroup", 0.11361606345829585], ["asgard.models.accounAccount", 0.09488120888573282], ["asgard.models.user.User", 0.09488120888573282], ["zerver.models.PreregistrationUser", 0.09384151545370795]]}, "q_name": "TestBackfillJob.test_reset_orphaned_tasks_specified_dagrun", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "dr2": "", "job": "", "job_runner": "", "num_reset_tis": "", "state": "", "task_id": "", "ti1": "", "ti2": ""}, "variables_p": {"dag_id": [["set", 0.34583441527823794], ["Callable(id)[[object], int]", 0.17489710140082126], ["Optional[Match[Any]]", 0.08870800199167152], ["Tuple[Any, Any]", 0.0823381349148169], ["str", 0.08233713374703093]], "dr1": [["str", 0.6041982587897919], ["int", 0.18321189826310508], ["float", 0.12453462593293053], ["Generator[Any, None, None]", 0.08805521701417232]], "dr2": [["str", 0.3991678277382852], ["int", 0.17169166651230333], ["golem.task.taskbase.AcceptClientVerdict", 0.11857390222103253], ["List[int]", 0.10851257773664498], ["Dict[int, str]", 0.10279221843151021]], "job": [["Set[str]", 0.39097973902896666], ["Dict[str, str]", 0.11048842597519384], ["dict", 0.09563688783786689], ["List[Optional[bool]]", 0.08648890367005362]], "job_runner": [["list", 0.17646102397361169]], "num_reset_tis": [["str", 0.18126641570109353], ["int", 0.17972685589995463], ["Set[str]", 0.14450887723931083], ["raiden.utils.PaymentID", 0.10064161429935783], ["Optional[str]", 0.09874441246413804], ["deeplearning.ml4pl.models.checkpoints.CheckpointReference", 0.09113845987607586]], "state": [["str", 0.8001227300293493], ["Tuple[str, str]", 0.11259296411909461]], "task_id": [["int", 0.4143534160596119], ["str", 0.18155608699328873], ["List[str]", 0.1269760450210742], ["list", 0.11622606205600347], ["Tuple[str, str]", 0.08270134997746625], ["KeysView[str]", 0.07818703989255539]], "ti1": [["golem.rpc.session.WebSocketAddress", 0.14471972038057662], ["golem.rpc.session.Publisher", 0.09505973619688438], ["dict", 0.08238073521922012], ["List[str]", 0.08079592854552935], ["str", 0.08037432204366633]], "ti2": [["golem.rpc.session.WebSocketAddress", 0.1122514911129209], ["threading.local", 0.10079475110797768], ["str", 0.09485706761819818], ["raiden.utils.Address", 0.09346793489035814]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1799, 4], [1810, 43]], "fn_var_ln": {"dag_id": [[1800, 8], [1800, 14]], "dr": [[1809, 8], [1809, 10]], "job": [[1804, 8], [1804, 11]], "job_runner": [[1805, 8], [1805, 18]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "schedule", "dag"]], "dr": [["dr", "airflow", "models", "dagrun", "DagRun", "dag", "get_last_dagrun"], ["dr", "creating_job_id", "job", "id"]], "job": [["job", "Job", "executor", "MockExecutor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "timezone", "utcnow", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"], ["dr", "creating_job_id", "job", "id"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "timezone", "utcnow", "datetime", "timedelta", "days"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]]}, "name": "test_job_id_is_assigned_to_dag_run", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "schedule", "dag"]], "self": []}, "params_p": {"args": [], "dag_maker": [["int", 0.2176085154417502], ["Callable", 0.10949442770790688], ["str", 0.08851365788921106], ["excars.models.user.User", 0.08538933197193567], ["Union[str, datetime.datetime, None]", 0.0851214518935399]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_job_id_is_assigned_to_dag_run", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr": "airflow.models.dagrun.DagRun", "job": "", "job_runner": ""}, "variables_p": {"dag_id": [["int", 0.5020745670246961], ["dict", 0.1150402773390172], ["str", 0.11361726136058935], ["raiden.transfer.state.NettingChannelState", 0.09556215176388352], ["bool", 0.08871260978981345], ["Optional[int]", 0.08499313272200042]], "dr": [["salon.models.Stylist", 0.30546012862724997], ["alerta.models.alerAlert", 0.20528945633213697], ["flaskblog.models.User", 0.10226679752426501], ["pili.models.User", 0.0965025413413931], ["billing.models.Charge", 0.0904260084386768]], "job": [["str", 0.10293848873679273], ["Optional[List[Any]]", 0.10264981670311785], ["dict", 0.09232000381003608]], "job_runner": []}}, {"docstring": {"func": "Make sure that backfill jobs are assigned job_ids and that the job_id is an int.", "long_descr": null, "ret": null}, "fn_lc": [[1812, 4], [1828, 47]], "fn_var_ln": {"dag": [[1814, 8], [1814, 11]], "executor": [[1817, 8], [1817, 16]], "job": [[1819, 8], [1819, 11]], "job_runner": [[1820, 8], [1820, 18]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag"], ["dag", "clear"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "run_backwards", "True"]], "executor": [["executor", "MockExecutor", "parallelism"], ["job", "Job", "executor", "executor"], ["isinstance", "executor", "job_id", "int"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "run_backwards", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "run_backwards", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]]}, "name": "test_backfill_has_job_id_int", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["dag", "self", "dagbag", "get_dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_backfill_has_job_id_int", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "executor": "", "job": "", "job_runner": ""}, "variables_p": {"dag": [["float", 0.330344239235128], ["list", 0.09734917044742683], ["str", 0.08943949502177498], ["int", 0.08768511053989937]], "executor": [["str", 0.26705274606455565]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11861072391587794], ["Sequence[str]", 0.07914521800214441]]}}, {"docstring": {"func": "End-to-end test for backfilling dags with various executors.", "long_descr": "We test with multiple executors as they have different \"execution environments\" -- for instance\nDebugExecutor runs a lot more in the same process than other Executors.", "ret": null}, "fn_lc": [[1833, 4], [1867, 42]], "fn_var_ln": {"dag": [[1845, 8], [1845, 11]], "dr": [[1859, 8], [1859, 10]], "job": [[1849, 8], [1849, 11]], "job_runner": [[1850, 8], [1850, 18]], "when": [[1847, 8], [1847, 12]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "when", "end_date", "when", "donot_pickle", "True"], ["dr", "DagRun", "find", "dag_id", "dag", "dag_id", "execution_date", "when", "session", "session"]], "dr": [["dr", "DagRun", "find", "dag_id", "dag", "dag_id", "execution_date", "when", "session", "session"], ["dr", "state", "DagRunState", "SUCCESS"], ["dr", "task_instances"]], "job": [["job", "Job", "executor", "ExecutorLoader", "load_executor", "executor_name"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "when", "end_date", "when", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "when", "end_date", "when", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "when": [["when", "timezone", "datetime"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "when", "end_date", "when", "donot_pickle", "True"], ["dr", "DagRun", "find", "dag_id", "dag", "dag_id", "execution_date", "when", "session", "session"]]}, "name": "test_backfilling_dags", "params": {"dag_id": "", "executor_name": "", "self": "", "session": ""}, "params_descr": {"dag_id": "", "executor_name": "", "self": "", "session": ""}, "params_occur": {"dag_id": [["self", "dagbag", "process_file", "str", "TEST_DAGS_FOLDER", "dag_id"], ["dag", "self", "dagbag", "get_dag", "dag_id"], ["dr", "DagRun", "find", "dag_id", "dag", "dag_id", "execution_date", "when", "session", "session"]], "executor_name": [["job", "Job", "executor", "ExecutorLoader", "load_executor", "executor_name"]], "self": [["self", "dagbag", "process_file", "str", "TEST_DAGS_FOLDER", "dag_id"], ["dag", "self", "dagbag", "get_dag", "dag_id"]], "session": [["dr", "DagRun", "find", "dag_id", "dag", "dag_id", "execution_date", "when", "session", "session"]]}, "params_p": {"args": [], "dag_id": [["str", 0.28405024893284025], ["Dict[str, str]", 0.09864203803593521], ["Optional[Callable[[Any], None]]", 0.0892609863305601]], "executor_name": [["str", 0.6109930299564166], ["int", 0.09020734118818274], ["float", 0.09020734118818274]], "kwargs": [], "self": [], "session": [["int", 0.290617339530693], ["str", 0.20187351334531234], ["Callable[[], None]", 0.13942945765593384], ["django.conf.settings.AUTH_USER_MODEL", 0.09298350202818552], ["cmk.utils.type_defs.UserId", 0.0919164158220094]]}, "q_name": "TestBackfillJob.test_backfilling_dags", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dr": "", "job": "", "job_runner": "", "when": ""}, "variables_p": {"dag": [["Dict[str, str]", 0.36772030307349174], ["list", 0.10370239823551297], ["dict", 0.10282148817570963], ["str", 0.09092874605847515]], "dr": [["str", 0.4735229324670693], ["int", 0.21767184437986262]], "job": [["str", 0.6192762307140738], ["Dict[str, Any]", 0.11143568408376274], ["multiprocessing.pool.Pool", 0.09143198669971973], ["List[str]", 0.08921660782267408]], "job_runner": [["Dict[str, None]", 0.0896002761006272]], "when": [["datetime.datetime.timedelta", 0.5368835809339455], ["datetime.timedelta", 0.3737460342338762], ["datetime.datetime.datetime", 0.08937038483217834]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1877, 8], [1878, 30]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "make_arg_lists", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_mapped_dag_pre_existing_tis.<locals>.make_arg_lists", "ret_exprs": ["return list_result"], "ret_type": "", "ret_type_p": [["List[str]", 0.4607194251741399], ["str", 0.24550923642003286], ["List[Dict]", 0.11575539366760496], ["Optional[Type]", 0.0848738755543377]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1880, 8], [1881, 30]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "consumer", "params": {"value": ""}, "params_descr": {"value": ""}, "params_occur": {"value": [["print", "repr", "value"]]}, "params_p": {"args": [], "kwargs": [], "self": [], "value": [["Union[str, int]", 0.12599720594148162], ["str", 0.08799913118368236], ["float", 0.0877036352718962], ["Optional[str]", 0.08605783985091123], ["int", 0.08249386908011935]]}, "q_name": "TestBackfillJob.test_mapped_dag_pre_existing_tis.<locals>.consumer", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1919, 8], [1932, 51]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "on_change_state", "params": {"info": "", "key": "", "state": ""}, "params_descr": {"info": "", "key": "", "state": ""}, "params_occur": {"info": [["executor_change_state", "key", "state", "info"]], "key": [["ti_status", "to_run", "ti", "key", "ti", "ti", "dr", "task_instances"], ["key", "task_id"], ["session", "add", "TaskMap", "length", "len", "list_result", "keys", "None", "dag_id", "key", "dag_id", "run_id", "key", "run_id", "task_id", "key", "task_id", "map_index", "key", "map_index"], ["executor_change_state", "key", "state", "info"]], "state": [["executor_change_state", "key", "state", "info"]]}, "params_p": {"args": [], "info": [["str", 0.6018148161282557], ["dict", 0.19427573947932772], ["T", 0.12131848593968816], ["Optional[Callable]", 0.08259095845272833]], "key": [["str", 0.40262682409569683], ["List[Dict]", 0.10535865727582097]], "kwargs": [], "self": [], "state": [["str", 0.6018148161282557], ["dict", 0.19427573947932772], ["T", 0.12131848593968816], ["Optional[Callable]", 0.08259095845272833]]}, "q_name": "TestBackfillJob.test_mapped_dag_pre_existing_tis.<locals>.on_change_state", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "If the DagRun already has some mapped TIs, ensure that we re-run them successfully", "long_descr": null, "ret": null}, "fn_lc": [[1869, 4], [1959, 9]], "fn_var_ln": {"consumer_op": [[1884, 12], [1884, 23]], "dag_run": [[1898, 12], [1898, 22]], "dr": [[1891, 8], [1891, 10]], "executor": [[1902, 8], [1902, 16]], "executor_change_state": [[1917, 8], [1917, 29]], "job": [[1908, 8], [1908, 11]], "job_runner": [[1909, 8], [1909, 18]], "list_result": [[1874, 8], [1874, 19]], "map_index": [[1895, 8], [1895, 20]], "ti": [[1897, 12], [1897, 14]], "ti_status": [[1904, 8], [1904, 17]], "to_run": [[1906, 8], [1906, 24]]}, "fn_var_occur": {"consumer_op": [], "dag_run": [], "dr": [["job_runner", "_process_backfill_task_instances", "ti_status", "ti_status", "executor", "job", "executor", "start_date", "dr", "execution_date", "pickle_id", "None", "session", "session"], ["ti_status", "succeeded", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index"]], "executor": [["patch", "object", "executor", "side_effect", "on_change_state"], ["job_runner", "_process_backfill_task_instances", "ti_status", "ti_status", "executor", "job", "executor", "start_date", "dr", "execution_date", "pickle_id", "None", "session", "session"]], "executor_change_state": [], "job": [["job_runner", "_process_backfill_task_instances", "ti_status", "ti_status", "executor", "job", "executor", "start_date", "dr", "execution_date", "pickle_id", "None", "session", "session"]], "job_runner": [["job_runner", "_process_backfill_task_instances", "ti_status", "ti_status", "executor", "job", "executor", "start_date", "dr", "execution_date", "pickle_id", "None", "session", "session"]], "list_result": [], "map_index": [["ti_status", "succeeded", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index"]], "ti": [], "ti_status": [["job_runner", "_process_backfill_task_instances", "ti_status", "ti_status", "executor", "job", "executor", "start_date", "dr", "execution_date", "pickle_id", "None", "session", "session"], ["ti_status", "failed", "set"], ["ti_status", "succeeded", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index", "TaskInstanceKey", "dag_id", "dr", "dag_id", "task_id", "run_id", "try_number", "map_index"]], "to_run": []}, "name": "test_mapped_dag_pre_existing_tis", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [], "self": [], "session": [["job_runner", "_process_backfill_task_instances", "ti_status", "ti_status", "executor", "job", "executor", "start_date", "dr", "execution_date", "pickle_id", "None", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["bool", 1.300244872692562e-10], ["int", 1.2326933785745473e-10], ["raiden.utils.List[raiden.raiden_service.RaidenService]", 1.0761478226884828e-10]], "kwargs": [], "self": [], "session": [["Optional[core.models.User]", 0.11777230494110529], ["lms.lmsdb.models.User", 0.10937514224798157], ["zerver.models.UserProfile", 0.10569978817177594], ["core.models.Grouping", 0.09633672792848366], ["float", 0.0918368379752295], ["server.models.bike.Bike", 0.0918368379752295], ["server.models.Rental", 0.0918368379752295]]}, "q_name": "TestBackfillJob.test_mapped_dag_pre_existing_tis", "ret_exprs": [], "ret_type": "", "variables": {"consumer_op": "", "dag_run": "", "dr": "", "executor": "", "executor_change_state": "", "job": "", "job_runner": "", "list_result": "", "map_index": "", "ti": "", "ti_status": "", "to_run": ""}, "variables_p": {"consumer_op": [["int", 0.9999999999999999]], "dag_run": [["str", 0.4], ["bool", 0.2], ["int", 0.1], ["set", 0.1]], "dr": [["dict", 0.29233113721005893], ["grpy.core.models.Grouping", 0.13830029138564356]], "executor": [["dict", 0.2909815188795384], ["List[Tuple[int, str]]", 0.09628117059304823], ["str", 0.08504825671629408]], "executor_change_state": [["str", 0.6], ["cmk.gui.plugins.openapi.livestatus_helpers.types.Column", 0.2], ["int", 0.1]], "job": [["dict", 0.29233113721005893], ["grpy.core.models.Grouping", 0.13830029138564356]], "job_runner": [["dict", 0.29233113721005893], ["grpy.core.models.Grouping", 0.13830029138564356]], "list_result": [["List[str]", 0.7], ["Tuple[Literal, Literal, Literal, Literal, Literal]", 0.1], ["Tuple[str, str, str, str]", 0.1], ["Tuple[str, str, str, str, str]", 0.1]], "map_index": [["int", 0.6721640159610052], ["str", 0.09146969790618166]], "ti": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "ti_status": [["dict", 0.20360288658007739], ["kedro.framework.session.session.KedroSession", 0.10353539982506547], ["abilian.core.models.subjects.User", 0.09027017010207691], ["legistar.models.Body", 0.09016479980909198]], "to_run": [["bool", 0.9999999982005254], ["int", 1.4041221170938033e-09], ["threading.Event", 1.4341447820961433e-10]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1965, 12], [1966, 29]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "get_things", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_mapped_dag_unexpandable.<locals>.get_things", "ret_exprs": ["return [1, 2]"], "ret_type": "", "ret_type_p": [["str", 0.19999999999999998], ["bool", 0.09999999999999999]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1969, 12], [1970, 44]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "this_fails", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_mapped_dag_unexpandable.<locals>.this_fails", "ret_exprs": [], "ret_type": "None", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1973, 12], [1974, 27]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "consumer", "params": {"a": "", "b": ""}, "params_descr": {"a": "", "b": ""}, "params_occur": {"a": [["print", "a", "b"]], "b": [["print", "a", "b"]]}, "params_p": {"a": [["int", 0.9999999998817176], ["Iterable", 3.623142972286152e-11], ["Iterable[str]", 2.0334241315434646e-11], ["Sequence[T]", 2.0334241315434646e-11], ["str", 1.811571486143076e-11]], "args": [], "b": [["int", 0.9999999998817176], ["Iterable", 3.623142972286152e-11], ["Iterable[str]", 2.0334241315434646e-11], ["Sequence[T]", 2.0334241315434646e-11], ["str", 1.811571486143076e-11]], "kwargs": [], "self": []}, "q_name": "TestBackfillJob.test_mapped_dag_unexpandable.<locals>.consumer", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1961, 4], [1991, 72]], "fn_var_ln": {"dr": [[1983, 9], [1983, 11]], "executor": [[1978, 8], [1978, 16]], "job": [[1980, 8], [1980, 11]], "job_runner": [[1981, 8], [1981, 18]], "tis": [[1987, 8], [1987, 11]], "when": [[1979, 8], [1979, 12]]}, "fn_var_occur": {"dr": [["dr", "DagRun", "find", "dag_id", "dag", "dag_id", "execution_date", "when", "session", "session"], ["dr", "state", "DagRunState", "FAILED"], ["tis", "ti", "task_id", "ti", "map_index", "ti", "ti", "dr", "task_instances"]], "executor": [["executor", "MockExecutor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "when", "end_date", "when", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "when", "end_date", "when", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "tis": [["tis", "ti", "task_id", "ti", "map_index", "ti", "ti", "dr", "task_instances"], ["len", "tis"], ["tis", "state", "TaskInstanceState", "SUCCESS"], ["tis", "state", "TaskInstanceState", "FAILED"], ["tis", "state", "TaskInstanceState", "UPSTREAM_FAILED"]], "when": [["when", "timezone", "datetime"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "when", "end_date", "when", "donot_pickle", "True"], ["dr", "DagRun", "find", "dag_id", "dag", "dag_id", "execution_date", "when", "session", "session"]]}, "name": "test_mapped_dag_unexpandable", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [], "self": [], "session": [["dr", "DagRun", "find", "dag_id", "dag", "dag_id", "execution_date", "when", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["bool", 1.300244872692562e-10], ["int", 1.2326933785745473e-10], ["raiden.utils.List[raiden.raiden_service.RaidenService]", 1.0761478226884828e-10]], "kwargs": [], "self": [], "session": [["sqlalchemy.orm.session.Session", 0.21479550216997365], ["zerver.models.UserProfile", 0.0944514835724239], ["float", 0.0923619453585026]]}, "q_name": "TestBackfillJob.test_mapped_dag_unexpandable", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "executor": "", "job": "", "job_runner": "", "tis": "", "when": ""}, "variables_p": {"dr": [["str", 0.4595194009343357], ["int", 0.23600825155733737]], "executor": [["mock.Mock", 0.17527592926847138]], "job": [["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10581185893323075], ["dict", 0.10030013308636232], ["Dict[str, None]", 0.09957725014581725], ["list", 0.09299337824793678], ["property", 0.08781458460765265], ["str", 0.08586651283563877]], "job_runner": [["Dict[str, None]", 0.0896002761006272]], "tis": [["int", 0.194663018001768], ["dict", 0.19059895697104018], ["list", 0.11893149531390343], ["List[Dict[str, Any]]", 0.1077200070181471], ["float", 0.10347833599768191], ["alerta.models.alerAlert", 0.09232909381353295], ["Dict[str, Any]", 0.09071515909444036]], "when": [["datetime.datetime.timedelta", 0.5368835809339455], ["datetime.timedelta", 0.3737460342338762], ["datetime.datetime.datetime", 0.08937038483217834]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1993, 4], [2015, 70]], "fn_var_ln": {"dr": [[2013, 9], [2013, 11]], "job": [[2003, 8], [2003, 11]], "job_runner": [[2004, 8], [2004, 18]], "state": [[1999, 8], [1999, 16]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun"], ["dr", "state", "State", "SUCCESS"], ["session", "merge", "dr"], ["dr", "DagRun", "find", "dag_id", "dag", "dag_id", "execution_date", "DEFAULT_DATE", "session", "session"], ["dr", "start_date"], ["dr", "caplog", "text"]], "job": [["job", "Job", "executor", "MockExecutor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "donot_pickle", "True"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "state": [["dr", "state", "State", "SUCCESS"]]}, "name": "test_start_date_set_for_resetted_dagruns", "params": {"caplog": "", "dag_maker": "", "self": "", "session": ""}, "params_descr": {"caplog": "", "dag_maker": "", "self": "", "session": ""}, "params_occur": {"caplog": [["dr", "caplog", "text"]], "dag_maker": [["dag_maker", "dag"], ["dr", "dag_maker", "create_dagrun"]], "self": [], "session": [["session", "merge", "dr"], ["session", "flush"], ["dr", "DagRun", "find", "dag_id", "dag", "dag_id", "execution_date", "DEFAULT_DATE", "session", "session"]]}, "params_p": {"args": [], "caplog": [], "dag_maker": [["int", 0.19650184237745322], ["str", 0.19650184237745322]], "kwargs": [], "self": [], "session": [["zerver.models.UserProfile", 0.2963798928772419], ["zam_repondeur.models.Dossier", 0.10739900885844805], ["models.User", 0.09573538412481149]]}, "q_name": "TestBackfillJob.test_start_date_set_for_resetted_dagruns", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "job": "", "job_runner": "", "state": ""}, "variables_p": {"dr": [["str", 0.5023832491751754], ["Callable", 0.1271545943586816], ["Type[int]", 0.08849917617466119], ["Dict[str, int]", 0.08537037658037139]], "job": [["str", 0.12863963198751818], ["Optional[List[Any]]", 0.12341893238771337], ["dict", 0.08634432236839679]], "job_runner": [["Dict[Any, str]", 0.09134236042586363]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]]}}, {"docstring": {"func": "Test that when dagrun is reset, task instances are not set to scheduled", "long_descr": null, "ret": null}, "fn_lc": [[2017, 4], [2045, 39]], "fn_var_ln": {"job": [[2033, 8], [2033, 11]], "job_runner": [[2034, 8], [2034, 18]], "states": [[2043, 12], [2043, 18]], "task1": [[2021, 12], [2021, 17]], "task2": [[2022, 12], [2022, 17]], "task3": [[2023, 12], [2023, 17]], "tasks_to_run": [[2042, 12], [2042, 24]]}, "fn_var_occur": {"job": [["job", "Job", "executor", "MockExecutor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "donot_pickle", "True"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "donot_pickle", "True"], ["tasks_to_run", "job_runner", "_task_instances_for_dag_run", "dag", "dr", "session", "session"]], "states": [["states", "ti", "state", "_", "ti", "tasks_to_run", "items"], ["TaskInstanceState", "SCHEDULED", "states"], ["State", "NONE", "states"]], "task1": [["task1", "EmptyOperator", "task_id"], ["task1", "task2", "task3"]], "task2": [["task2", "EmptyOperator", "task_id"], ["task1", "task2", "task3"]], "task3": [["task3", "EmptyOperator", "task_id"], ["task1", "task2", "task3"]], "tasks_to_run": [["tasks_to_run", "job_runner", "_task_instances_for_dag_run", "dag", "dr", "session", "session"], ["states", "ti", "state", "_", "ti", "tasks_to_run", "items"]]}, "name": "test_task_instances_are_not_set_to_scheduled_when_dagrun_reset", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag"], ["dag_maker", "create_dagrun", "run_id", "i", "execution_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "i"]], "self": [], "session": [["DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["tasks_to_run", "job_runner", "_task_instances_for_dag_run", "dag", "dr", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.10911530385763105], ["server.models.bike.Bike", 0.1061514267107251], ["models.User", 0.10337071987957039], ["models.RepoInterface", 0.10337071987957039], ["zam_repondeur.models.Dossier", 0.0984429434640039], ["int", 0.08814391357091884]], "kwargs": [], "self": [], "session": [["zerver.models.UserProfile", 0.17213689654994468], ["Optional[str]", 0.12473700787680643], ["cnaas_nms.db.device.Device", 0.09783997134917341], ["app.models.Tweet", 0.08895229764282006], ["app.models.Position", 0.08895229764282006]]}, "q_name": "TestBackfillJob.test_task_instances_are_not_set_to_scheduled_when_dagrun_reset", "ret_exprs": [], "ret_type": "", "variables": {"job": "", "job_runner": "", "states": "", "task1": "", "task2": "", "task3": "", "tasks_to_run": ""}, "variables_p": {"job": [["str", 0.11053042285018362], ["dict", 0.10147163409724465], ["Optional[List[Any]]", 0.10135131085699645]], "job_runner": [["Dict[Any, str]", 0.11551009395814536], ["Sequence[str]", 0.08532789567901694]], "states": [["T", 0.353822918348434], ["str", 0.17801887388300078], ["int", 0.17123466778400853], ["list", 0.09743026935052208], ["Tuple[str, str]", 0.08097132695804148]], "task1": [["List[Tuple[Any, str]]", 0.11007172098376057], ["Dict[str, Union[int, str]]", 0.10253760492946135], ["list", 0.09862777152659163], ["golem.task.taskcomputer.TaskComputer", 0.09579246812801435], ["int", 0.09302316987214108], ["restful_functions.modules.task.TaskStore", 0.09094200225982788], ["nufb.task.Task", 0.08528894067609334]], "task2": [["List[Tuple[Any, str]]", 0.11007172098376057], ["Dict[str, Union[int, str]]", 0.10253760492946135], ["list", 0.09862777152659163], ["golem.task.taskcomputer.TaskComputer", 0.09579246812801435], ["int", 0.09302316987214108], ["restful_functions.modules.task.TaskStore", 0.09094200225982788], ["nufb.task.Task", 0.08528894067609334]], "task3": [["List[Tuple[Any, str]]", 0.11007172098376057], ["Dict[str, Union[int, str]]", 0.10253760492946135], ["list", 0.09862777152659163], ["golem.task.taskcomputer.TaskComputer", 0.09579246812801435], ["int", 0.09302316987214108], ["restful_functions.modules.task.TaskStore", 0.09094200225982788], ["nufb.task.Task", 0.08528894067609334]], "tasks_to_run": [["o2a.converter.task.Task", 0.437071801880896], ["taskiinfrastructure.data.json.repositories.task_repository.JsonTaskRepository", 0.11279749794515331], ["List[str]", 0.09976068335520231], ["golem.task.task_api.EnvironmentTaskApiService", 0.09359066845710043]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[2054, 4], [2092, 19]], "fn_var_ln": {"dag_run": [[2064, 8], [2064, 15]], "executor": [[2066, 8], [2066, 16]], "job": [[2074, 8], [2074, 11]], "job_runner": [[2075, 8], [2075, 18]], "task1": [[2063, 12], [2063, 17]], "ti": [[2084, 8], [2084, 10]]}, "fn_var_occur": {"dag_run": [["dag_run", "dag_maker", "create_dagrun", "state", "None"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "dag_run", "run_id", "try_number", "TaskInstanceState", "UP_FOR_RETRY"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "dag_run", "run_id", "try_number", "TaskInstanceState", "FAILED"], ["ti", "dag_run", "get_task_instance", "task_id", "task1", "task_id"], ["dag_run", "refresh_from_db"], ["dag_run", "state", "DagRunState", "FAILED"]], "executor": [["executor", "MockExecutor", "parallelism"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "dag_run", "run_id", "try_number", "TaskInstanceState", "UP_FOR_RETRY"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "dag_run", "run_id", "try_number", "TaskInstanceState", "FAILED"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "disable_retry", "disable_retry"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "job_runner": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "disable_retry", "disable_retry"], ["run_job", "job", "job", "execute_callable", "job_runner", "_execute"]], "task1": [["task1", "EmptyOperator", "task_id"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "dag_run", "run_id", "try_number", "TaskInstanceState", "UP_FOR_RETRY"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "dag_run", "run_id", "try_number", "TaskInstanceState", "FAILED"], ["ti", "dag_run", "get_task_instance", "task_id", "task1", "task_id"]], "ti": [["ti", "dag_run", "get_task_instance", "task_id", "task1", "task_id"], ["ti", "_try_number", "try_number"]]}, "name": "test_backfill_disable_retry", "params": {"dag_maker": "", "disable_retry": "", "exception": "", "self": "", "try_number": ""}, "params_descr": {"dag_maker": "", "disable_retry": "", "exception": "", "self": "", "try_number": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "schedule_interval", "default_args", "datetime", "timedelta", "seconds", "dag"], ["dag_run", "dag_maker", "create_dagrun", "state", "None"]], "disable_retry": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "disable_retry", "disable_retry"]], "exception": [["pytest", "raises", "exception"]], "self": [], "try_number": [["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "dag_run", "run_id", "try_number", "TaskInstanceState", "UP_FOR_RETRY"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "dag_run", "run_id", "try_number", "TaskInstanceState", "FAILED"], ["ti", "_try_number", "try_number"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.32387912238114647], ["List[src.main.core.models.area.Area]", 0.1108171794635265], ["raiden.utils.Address", 0.09781436677621662], ["bool", 0.09272862775218281]], "disable_retry": [], "exception": [["str", 0.10857187463915609], ["boggle.models.board.Board", 0.10857187463915609], ["tests.basilisp.helpers.CompileFn", 0.08677691053526085]], "kwargs": [], "self": [], "try_number": [["str", 0.10635656331103474], ["tests.e2e.Helper", 0.10242724142437785]]}, "q_name": "TestBackfillJob.test_backfill_disable_retry", "ret_exprs": [], "ret_type": "", "variables": {"dag_run": "", "executor": "", "job": "", "job_runner": "", "task1": "", "ti": ""}, "variables_p": {"dag_run": [["str", 0.19857308388770012], ["int", 0.1954390751086149]], "executor": [["list", 0.1409243292828537], ["Optional[List[Any]]", 0.09811297766163041], ["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.09811213357168527], ["List[Tuple[int, str]]", 0.08529692894096604]], "job": [["list", 0.27902379003106687], ["dict", 0.11118432060681176], ["server.openslides.users.models.Group", 0.10092897507522937], ["guillotina.db.interfaces.ITransaction", 0.09159714602810724]], "job_runner": [["Dict[Any, str]", 0.11445898598751932]], "task1": [["restful_functions.modules.task.TaskStore", 0.12633206996991855], ["golem.task.taskcomputer.TaskComputer", 0.1054657655747446], ["golem.task.taskbase.Task.ExtraData", 0.097221867984215], ["Dict[str, Dict[str, int]]", 0.08702889226564495], ["annofabapi.dataclass.task.Task", 0.0821744719413649], ["bytes", 0.08138836753486328]], "ti": [["str", 0.1804515656571079], ["byceps.services.user.transfer.models.User", 0.13219293690856854], ["raiden.utils.PaymentID", 0.12090233525254195], ["geode.models.common.Address", 0.11854946772947401], ["Dict[str, str]", 0.09823305072807774], ["o2a.converter.task.Task", 0.09034587413685458], ["int", 0.08905249604361318], ["list", 0.0852145079037408]]}}], "name": "TestBackfillJob", "q_name": "TestBackfillJob", "variables": {}, "variables_p": {}}], "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[75, 0], [76, 40]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "dag_bag", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "dag_bag", "ret_exprs": ["return DagBag(include_examples=True)"], "ret_type": "", "ret_type_p": [["str", 0.29061237758880376], ["int", 0.09857931942710206], ["Tuple[Tuple[int, Any]]", 0.08653019444713063], ["List[List[str]]", 0.07827631439028908], ["bool", 0.07815996581783863]], "variables": {}, "variables_p": {}}], "imports": ["__future__", "annotations", "datetime", "json", "logging", "threading", "collections", "defaultdict", "unittest", "mock", "unittest", "mock", "patch", "pytest", "airflow", "settings", "airflow", "cli", "cli_parser", "airflow", "exceptions", "AirflowException", "AirflowTaskTimeout", "BackfillUnfinished", "DagConcurrencyLimitReached", "NoAvailablePoolSlot", "TaskConcurrencyLimitReached", "airflow", "executors", "executor_constants", "MOCK_EXECUTOR", "airflow", "executors", "executor_loader", "ExecutorLoader", "airflow", "jobs", "backfill_job_runner", "BackfillJobRunner", "airflow", "jobs", "job", "Job", "run_job", "airflow", "listeners", "listener", "get_listener_manager", "airflow", "models", "DagBag", "Pool", "TaskInstance", "TI", "airflow", "models", "dagrun", "DagRun", "airflow", "models", "serialized_dag", "SerializedDagModel", "airflow", "models", "taskinstancekey", "TaskInstanceKey", "airflow", "models", "taskmap", "TaskMap", "airflow", "operators", "empty", "EmptyOperator", "airflow", "utils", "timezone", "airflow", "utils", "session", "create_session", "airflow", "utils", "state", "DagRunState", "State", "TaskInstanceState", "airflow", "utils", "timeout", "timeout", "airflow", "utils", "trigger_rule", "TriggerRule", "airflow", "utils", "types", "DagRunType", "tests", "listeners", "dag_listener", "tests", "models", "TEST_DAGS_FOLDER", "tests", "test_utils", "db", "clear_db_dags", "clear_db_pools", "clear_db_runs", "clear_db_xcom", "set_default_pool_slots", "tests", "test_utils", "mock_executor", "MockExecutor", "tests", "test_utils", "timetables", "cron_timetable", "airflow", "executors", "executor_loader", "ExecutorLoader", "airflow", "decorators", "task", "airflow", "operators", "python", "PythonOperator"], "mod_var_ln": {"DEFAULT_DATE": [[71, 0], [71, 12]], "logger": [[69, 0], [69, 6]]}, "mod_var_occur": {"DEFAULT_DATE": [["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "ignore_first_depends_on_past", "True"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "ignore_first_depends_on_past", "True"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_first_depends_on_past", "True"], ["end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "end_date", "ignore_first_depends_on_past", "True"], ["expected_execution_order", "DEFAULT_DATE", "DEFAULT_DATE", "DEFAULT_DATE", "end_date", "end_date", "end_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "end_date"], ["drs", "execution_date", "DEFAULT_DATE"], ["drs", "execution_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_first_depends_on_past", "True"], ["dag_id", "task_id", "DEFAULT_DATE", "isoformat", "State", "SUCCESS", "None", "task_id", "expected_execution_order", "executor", "sorted_tasks"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "conf", "conf_"], ["dr", "DagRun", "find", "dag_id", "execution_start_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "rerun_failed_tasks", "True"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["dr", "dag_maker", "create_dagrun", "state", "None", "start_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "conf"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "rerun_failed_tasks", "True"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "rerun_failed_tasks", "True"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "rerun_failed_tasks", "False"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "DEFAULT_DATE", "try_number", "State", "UP_FOR_RETRY"], ["executor", "mock_task_results", "TaskInstanceKey", "dag", "dag_id", "task1", "task_id", "DEFAULT_DATE", "try_number", "State", "UP_FOR_RETRY"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["runid0", "DEFAULT_DATE", "isoformat"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["runid1", "DEFAULT_DATE", "datetime", "timedelta", "days", "isoformat"], ["runid2", "DEFAULT_DATE", "datetime", "timedelta", "days", "isoformat"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["ti", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["run_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["start_date", "DEFAULT_DATE", "datetime", "timedelta", "days"], ["run_date", "DEFAULT_DATE"], ["start_date", "DEFAULT_DATE", "datetime", "timedelta", "hours"], ["end_date", "DEFAULT_DATE"], ["start_date", "DEFAULT_DATE", "datetime", "timedelta", "hours"], ["end_date", "DEFAULT_DATE"], ["start_date", "DEFAULT_DATE", "datetime", "timedelta", "hours"], ["end_date", "DEFAULT_DATE"], ["dag_maker", "create_dagrun", "state", "State", "RUNNING", "run_id", "run_id", "execution_date", "DEFAULT_DATE", "datetime", "timedelta", "hours"], ["start_date", "DEFAULT_DATE"], ["end_date", "DEFAULT_DATE"], ["start_date", "DEFAULT_DATE", "datetime", "timedelta", "hours"], ["end_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "sub_dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["ti", "end_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "donot_pickle", "True"], ["ti_subdag", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti_irrelevant", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["ti_downstream", "TI", "task", "dag", "get_task", "execution_date", "DEFAULT_DATE"], ["sdag", "clear", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "include_parentdag", "True"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "subdag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "donot_pickle", "True"], ["dr", "DagRun", "dag_id", "subdag", "dag_id", "execution_date", "DEFAULT_DATE", "run_id", "run_type", "DagRunType", "BACKFILL_JOB"], ["instance", "session", "query", "TI", "filter", "TI", "dag_id", "subdag", "dag_id", "TI", "task_id", "task", "task_id", "TI", "execution_date", "DEFAULT_DATE", "first"], ["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "session", "session", "dag"], ["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "schedule", "test_dag"], ["DEFAULT_DATE", "info", "logical_date", "info", "test_dag", "iter_dagrun_infos_between", "earliest", "DEFAULT_DATE", "latest", "DEFAULT_DATE"], ["DEFAULT_DATE", "datetime", "timedelta", "hours", "DEFAULT_DATE", "datetime", "timedelta", "hours", "DEFAULT_DATE", "datetime", "timedelta", "hours", "DEFAULT_DATE", "info", "logical_date", "info", "test_dag", "iter_dagrun_infos_between", "earliest", "DEFAULT_DATE", "datetime", "timedelta", "hours", "latest", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "run_backwards", "True"], ["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "schedule", "session", "session", "dag"], ["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "schedule", "dag"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "run_backwards", "True"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "donot_pickle", "True"], ["dr", "DagRun", "find", "dag_id", "dag", "dag_id", "execution_date", "DEFAULT_DATE", "session", "session"], ["dag_maker", "create_dagrun", "run_id", "i", "execution_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "i"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "end_date", "DEFAULT_DATE", "datetime", "timedelta", "days", "donot_pickle", "True"], ["job_runner", "BackfillJobRunner", "job", "job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "disable_retry", "disable_retry"]], "logger": [["logger", "info", "dag", "dag_id"], ["caplog", "at_level", "logging", "ERROR", "logger"], ["logger", "exception"], ["logger", "info", "dagruns"]]}, "no_types_annot": {"D": 2, "I": 0, "U": 505}, "session_id": "ELT-PAudLv8C7RBp-7_ZZeUPKnuk2A46JN9JiwrdcLM", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"DEFAULT_DATE": "", "logger": ""}, "variables_p": {"DEFAULT_DATE": [["datetime.datetime", 0.24977721296768407]], "logger": [["logging.Logger", 1.0]]}}}