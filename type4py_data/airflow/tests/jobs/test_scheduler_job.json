{"error": null, "response": {"classes": [{"cls_lc": [[124, 0], [5053, 50]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[126, 4], [133, 27]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "clean_db", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.clean_db", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[138, 4], [147, 23]], "fn_var_ln": {"job_runner": [[146, 12], [146, 27]]}, "fn_var_occur": {"job_runner": [["self", "job_runner", "None"], ["self", "job_runner", "self", "job_runner", "processor_agent"], ["self", "job_runner", "processor_agent", "end"], ["self", "job_runner", "None"]]}, "name": "per_test", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "clean_db"], ["self", "job_runner", "None"], ["self", "job_runner", "self", "job_runner", "processor_agent"], ["self", "job_runner", "processor_agent", "end"], ["self", "job_runner", "None"], ["self", "clean_db"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.per_test", "ret_exprs": [], "ret_type": "typing.Generator", "variables": {"job_runner": ""}, "variables_p": {"job_runner": [["str", 0.31335913437279006], ["int", 0.1925080994927686], ["Pattern[str]", 0.18843528259054002], ["Set[str]", 0.1198897521587702], ["List[str]", 0.09713483224825559], ["bool", 0.08867289913687552]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[150, 4], [162, 23]], "fn_var_ln": {"dagbag": [[151, 8], [151, 19]], "null_exec": [[161, 8], [161, 22]]}, "fn_var_occur": {"dagbag": [["self", "dagbag", "airflow", "models", "DagBag", "dagbag"], ["self", "dagbag"]], "null_exec": [["self", "null_exec", "MockExecutor", "None", "MockExecutor"], ["self", "null_exec", "None"]]}, "name": "set_instance_attrs", "params": {"dagbag": "", "self": ""}, "params_descr": {"dagbag": "", "self": ""}, "params_occur": {"dagbag": [["self", "dagbag", "airflow", "models", "DagBag", "dagbag"], ["self", "dagbag"]], "self": [["self", "dagbag", "airflow", "models", "DagBag", "dagbag"], ["self", "null_exec", "MockExecutor", "None", "MockExecutor"], ["self", "null_exec", "None"], ["self", "dagbag"]]}, "params_p": {"args": [], "dagbag": [["int", 0.36459775233761565], ["models.Profile", 0.1756379982687994], ["str", 0.15061424524454897]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.set_instance_attrs", "ret_exprs": [], "ret_type": "typing.Generator", "variables": {"dagbag": "airflow.models.DagBag", "null_exec": ""}, "variables_p": {"dagbag": [["pili.models.User", 0.40274539571953616], ["simple_model.models.Model", 0.21248425614943944], ["jinete.models.trips.Trip", 0.11524956146234497], ["legistar.models.MatterAttachment", 0.08984026222289317], ["legistar.models.OfficeRecord", 0.08984026222289317], ["legistar.models.MatterIndex", 0.08984026222289317]], "null_exec": [["int", 0.2887018778635654], ["str", 0.20801608913647535], ["Tuple[str, int]", 0.1087260752990689], ["logging.Logger", 0.10376404957918274], ["bool", 0.09267957985771413]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[171, 4], [192, 78]], "fn_var_ln": {"job_runner": [[174, 12], [174, 27]], "latest_heartbeat": [[189, 12], [189, 42]], "scheduler_job": [[173, 12], [173, 25]], "state": [[188, 12], [188, 31]]}, "fn_var_occur": {"job_runner": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"]], "latest_heartbeat": [["scheduler_job", "latest_heartbeat", "timezone", "utcnow", "datetime", "timedelta", "seconds"], ["scheduler_job", "latest_heartbeat", "timezone", "utcnow", "datetime", "timedelta", "seconds"], ["scheduler_job", "latest_heartbeat", "timezone", "utcnow", "datetime", "timedelta", "days"], ["scheduler_job", "latest_heartbeat", "timezone", "utcnow", "datetime", "timedelta", "seconds"]], "scheduler_job": [["scheduler_job", "Job", "heartrate", "state", "State", "RUNNING"], ["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["scheduler_job", "is_alive"], ["scheduler_job", "latest_heartbeat", "timezone", "utcnow", "datetime", "timedelta", "seconds"], ["scheduler_job", "is_alive"], ["scheduler_job", "latest_heartbeat", "timezone", "utcnow", "datetime", "timedelta", "seconds"], ["scheduler_job", "is_alive"], ["scheduler_job", "latest_heartbeat", "timezone", "utcnow", "datetime", "timedelta", "days"], ["scheduler_job", "is_alive"], ["scheduler_job", "state", "State", "SUCCESS"], ["scheduler_job", "latest_heartbeat", "timezone", "utcnow", "datetime", "timedelta", "seconds"], ["scheduler_job", "is_alive"]], "state": [["scheduler_job", "Job", "heartrate", "state", "State", "RUNNING"], ["scheduler_job", "state", "State", "SUCCESS"]]}, "name": "test_is_alive", "params": {"configs": "", "self": ""}, "params_descr": {"configs": "", "self": ""}, "params_occur": {"configs": [["conf_vars", "configs"]], "self": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"]]}, "params_p": {"args": [], "configs": [["tests.basilisp.helpers.CompileFn", 0.7242661790453628], ["Callable", 0.07173104782200529], ["str", 0.03695272163233518]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_is_alive", "ret_exprs": [], "ret_type": "", "variables": {"job_runner": "", "latest_heartbeat": "", "scheduler_job": "", "state": ""}, "variables_p": {"job_runner": [["int", 0.37148435758180975], ["str", 0.12382811919393658], ["app.types.HTML", 0.12210368293627039], ["dict", 0.06491086983784891], ["Dict[str, Any]", 0.06430703413039314]], "latest_heartbeat": [["datetime.timedelta", 0.8589313560585181], ["int", 0.09104877765790362]], "scheduler_job": [["myia.utils.orderedseOrderedSet", 0.6216466663917635]], "state": [["property", 0.19020796498315515], ["list", 0.11253488971440083], ["dict", 0.09615953512441967]]}}, {"docstring": {"func": "Utility function that runs a single scheduler loop without actually", "long_descr": "changing/scheduling any dags. This is useful to simulate the other side effects of\nrunning a scheduler loop, e.g. to see what parse errors there are in the\ndags_folder.", "ret": null}, "fn_lc": [[194, 4], [210, 73]], "fn_var_ln": {"heartrate": [[209, 8], [209, 31]], "job_runner": [[208, 8], [208, 23]], "scheduler_job": [[203, 8], [203, 21]]}, "fn_var_occur": {"heartrate": [["scheduler_job", "heartrate"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]], "scheduler_job": [["scheduler_job", "Job", "executor", "self", "null_exec", "num_times_parse_dags", "subdir", "os", "path", "join", "dags_folder"], ["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["scheduler_job", "heartrate"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]]}, "name": "run_single_scheduler_loop_with_no_dags", "params": {"dags_folder": "", "self": ""}, "params_descr": {"dags_folder": "the directory to traverse", "self": ""}, "params_occur": {"dags_folder": [["scheduler_job", "Job", "executor", "self", "null_exec", "num_times_parse_dags", "subdir", "os", "path", "join", "dags_folder"]], "self": [["scheduler_job", "Job", "executor", "self", "null_exec", "num_times_parse_dags", "subdir", "os", "path", "join", "dags_folder"], ["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]]}, "params_p": {"args": [], "dags_folder": [["bool", 0.09354740173567803]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.run_single_scheduler_loop_with_no_dags", "ret_exprs": [], "ret_type": "", "variables": {"heartrate": "", "job_runner": "", "scheduler_job": ""}, "variables_p": {"heartrate": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "job_runner": [["dict", 0.48575988666263425], ["list", 0.09445021701212407], ["str", 0.08734232437100814]], "scheduler_job": [["Dict[str, Tuple[Any, Any]]", 0.1129533011786406]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[212, 4], [225, 35]], "fn_var_ln": {"current_children": [[224, 8], [224, 24]], "current_process": [[214, 8], [214, 23]], "empty_dir": [[213, 8], [213, 17]], "job_runner": [[219, 8], [219, 23]], "old_children": [[215, 8], [215, 20]], "scheduler_job": [[216, 8], [216, 21]]}, "fn_var_occur": {"current_children": [["current_children", "set", "current_process", "children", "recursive", "True", "set", "old_children"]], "current_process": [["current_process", "psutil", "Process"], ["old_children", "current_process", "children", "recursive", "True"], ["current_children", "set", "current_process", "children", "recursive", "True", "set", "old_children"]], "empty_dir": [["empty_dir", "mkdtemp"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "empty_dir", "num_runs"], ["shutil", "rmtree", "empty_dir"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "empty_dir", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]], "old_children": [["old_children", "current_process", "children", "recursive", "True"], ["current_children", "set", "current_process", "children", "recursive", "True", "set", "old_children"]], "scheduler_job": [["scheduler_job", "Job", "executor", "MockExecutor", "do_update", "False"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "empty_dir", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]]}, "name": "test_no_orphan_process_will_be_left", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "empty_dir", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_no_orphan_process_will_be_left", "ret_exprs": [], "ret_type": "", "variables": {"current_children": "", "current_process": "", "empty_dir": "", "job_runner": "", "old_children": "", "scheduler_job": ""}, "variables_p": {"current_children": [["Dict[str, int]", 0.21609828810217815], ["dict", 0.21405650247236907], ["Dict[str, str]", 0.167513186438017], ["str", 0.10536134128293695], ["frozenset[str]", 0.10176764179914702], ["set", 0.10119506252071749], ["Pattern[str]", 0.09400797738463422]], "current_process": [["multiprocessing.pool.Pool", 0.09456468453113849], ["Dict[str, str]", 0.09452809755846268], ["dict", 0.0921091672819935], ["List[List[Any]]", 0.09168865956641595], ["Dict[str, Any]", 0.09156925631360381]], "empty_dir": [["dict", 0.19552635449476943], ["str", 0.17176522492984564], ["Dict[str, str]", 0.1298692318121752], ["cmp_command_processor.src.file.metainformation.MetaJsonInfo", 0.09899010739210222], ["list", 0.09756296170054343]], "job_runner": [["Dict[str, Any]", 0.3250230855720078], ["dict", 0.2876238600161987], ["NamedTuple", 0.11444844584710794], ["Dict[str, Tuple[Any, Any]]", 0.09222027314003721], ["Dict[str, Dict[str, Any]]", 0.0908488905495054], ["list", 0.089835444875143]], "old_children": [["str", 0.8954278493951235]], "scheduler_job": [["pxl.config.Config", 0.1654460086368282], ["app.config.Config", 0.08411271129122026]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[229, 4], [278, 9]], "fn_var_ln": {"dag_id": [[230, 8], [230, 14]], "executor": [[240, 8], [240, 16]], "job_runner": [[244, 8], [244, 23]], "return_value": [[242, 8], [242, 39]], "scheduler_job": [[243, 8], [243, 21]], "session": [[233, 8], [233, 15]], "state": [[259, 8], [259, 17]], "task1": [[235, 12], [235, 17]], "task_callback": [[241, 8], [241, 21]], "task_id_1": [[231, 8], [231, 17]], "ti1": [[236, 8], [236, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "fileloc"], ["mock_stats_incr", "assert_has_calls", "mock", "call", "tags", "dag_id", "ti1", "task_id", "mock", "call", "tags", "dag_id", "ti1", "task_id", "mock", "call", "tags", "dag_id", "ti1", "task_id", "any_order", "True"]], "executor": [["executor", "MockExecutor", "do_update", "False"], ["scheduler_job", "Job", "executor", "executor"], ["executor", "event_buffer", "ti1", "key", "State", "FAILED", "None"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"], ["executor", "event_buffer", "ti1", "key", "State", "SUCCESS", "None"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_process_executor_events", "session", "session"], ["self", "job_runner", "processor_agent", "reset_mock"], ["self", "job_runner", "_process_executor_events", "session", "session"]], "return_value": [["mock_task_callback", "return_value", "task_callback"]], "scheduler_job": [["scheduler_job", "Job", "executor", "executor"], ["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti1"], ["session", "commit"], ["self", "job_runner", "_process_executor_events", "session", "session"], ["ti1", "refresh_from_db", "session", "session"], ["session", "merge", "ti1"], ["session", "commit"], ["self", "job_runner", "_process_executor_events", "session", "session"], ["ti1", "refresh_from_db", "session", "session"]], "state": [["ti1", "state", "State", "QUEUED"], ["ti1", "state", "State", "FAILED"], ["ti1", "state", "State", "SUCCESS"], ["ti1", "state", "State", "SUCCESS"]], "task1": [["task1", "EmptyOperator", "task_id", "task_id_1"], ["ti1", "dag_maker", "create_dagrun", "get_task_instance", "task1", "task_id"]], "task_callback": [["task_callback", "mock", "MagicMock"], ["mock_task_callback", "return_value", "task_callback"]], "task_id_1": [["task1", "EmptyOperator", "task_id", "task_id_1"]], "ti1": [["ti1", "dag_maker", "create_dagrun", "get_task_instance", "task1", "task_id"], ["ti1", "state", "State", "QUEUED"], ["session", "merge", "ti1"], ["executor", "event_buffer", "ti1", "key", "State", "FAILED", "None"], ["ti1", "refresh_from_db", "session", "session"], ["ti1", "state", "State", "FAILED"], ["ti1", "state", "State", "SUCCESS"], ["session", "merge", "ti1"], ["executor", "event_buffer", "ti1", "key", "State", "SUCCESS", "None"], ["ti1", "refresh_from_db", "session", "session"], ["ti1", "state", "State", "SUCCESS"], ["mock_stats_incr", "assert_has_calls", "mock", "call", "tags", "dag_id", "ti1", "task_id", "mock", "call", "tags", "dag_id", "ti1", "task_id", "mock", "call", "tags", "dag_id", "ti1", "task_id", "any_order", "True"]]}, "name": "test_process_executor_events", "params": {"dag_maker": "", "mock_stats_incr": "", "mock_task_callback": "", "self": ""}, "params_descr": {"dag_maker": "", "mock_stats_incr": "", "mock_task_callback": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "fileloc"], ["ti1", "dag_maker", "create_dagrun", "get_task_instance", "task1", "task_id"]], "mock_stats_incr": [["mock_stats_incr", "reset_mock"], ["mock_stats_incr", "assert_has_calls", "mock", "call", "tags", "dag_id", "ti1", "task_id", "mock", "call", "tags", "dag_id", "ti1", "task_id", "mock", "call", "tags", "dag_id", "ti1", "task_id", "any_order", "True"]], "mock_task_callback": [["mock_task_callback", "return_value", "task_callback"]], "self": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_process_executor_events", "session", "session"], ["self", "job_runner", "processor_agent", "reset_mock"], ["self", "job_runner", "_process_executor_events", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.10177488166965726]], "kwargs": [], "mock_stats_incr": [["unittesmock.MagicMock", 0.6312907835845317]], "mock_task_callback": [["unittesmock.MagicMock", 0.3799097371927553]], "self": []}, "q_name": "TestSchedulerJob.test_process_executor_events", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "executor": "", "job_runner": "", "return_value": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "task_callback": "", "task_id_1": "", "ti1": ""}, "variables_p": {"dag_id": [["str", 0.20107563282897706], ["int", 0.19098483626000606], ["List[Tuple[Any, Any, Any]]", 0.11709253114987452], ["List[Tuple[str, str]]", 0.11300779382483676], ["list", 0.10014970953288052], ["ClassVar[str]", 0.0929400254954199], ["List[int]", 0.09282088726690844], ["bytes", 0.09192858364109663]], "executor": [["str", 0.10959716330851016], ["unittesmock.MagicMock", 0.10804856902243588]], "job_runner": [["MagicMock[Union[mock.AsyncMock, mock.MagicMock]]", 0.49887362703971805], ["Tuple[Literal, Literal]", 0.17347513807927054], ["mock._patch[Union[mock.AsyncMock, mock.MagicMock]]", 0.08368600115603678]], "return_value": [["Dict[str, Union[int, str]]", 0.09944129922660078], ["list", 0.09578431763052545], ["Optional[bytes]", 0.09350490016598349], ["str", 0.09171437375848566]], "scheduler_job": [["dict", 0.20336741560115645], ["Dict[str, Union[Any, Any]]", 0.12182445757889099], ["OrderedDict[str, Any]", 0.08112912091189835]], "session": [["sqlalchemy.orm.session.Session", 0.13155637872491766]], "state": [["Type[str]", 0.11596786545386442], ["int", 0.09224698867393655]], "task1": [["Dict[str, Union[Any, bool, str]]", 0.21696436906738675], ["Dict[str, Dict[str, int]]", 0.08581656510455088], ["taskiapplication.models.task.Task", 0.08340513364439607]], "task_callback": [["unittesmock.MagicMock", 0.3411051383749402]], "task_id_1": [["str", 0.5264566963820929], ["set", 0.13100570258410138], ["int", 0.08427137950743863]], "ti1": [["str", 0.40102291820434255], ["raiden.utils.TargetAddress", 0.09813036303319506]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[282, 4], [341, 9]], "fn_var_ln": {"dag_id": [[283, 8], [283, 14]], "executor": [[304, 8], [304, 16]], "job_runner": [[308, 8], [308, 23]], "return_value": [[306, 8], [306, 39]], "run_id": [[285, 8], [285, 14]], "scheduler_job": [[307, 8], [307, 21]], "session": [[295, 8], [295, 15]], "state": [[322, 8], [322, 17]], "task1": [[297, 12], [297, 17]], "task_callback": [[305, 8], [305, 21]], "task_id": [[284, 8], [284, 15]], "ti1": [[298, 8], [298, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "fileloc"], ["mock_stats_incr", "assert_has_calls", "mock", "call", "tags", "dag_id", "task_id", "mock", "call", "tags", "dag_id", "task_id", "mock", "call", "tags", "dag_id", "task_id", "any_order", "True"]], "executor": [["executor", "MockExecutor", "do_update", "False"], ["scheduler_job", "Job", "executor", "executor"], ["executor", "MockExecutor", "do_update", "False"], ["scheduler_job", "Job", "executor", "executor"], ["executor", "event_buffer", "ti1", "key", "State", "FAILED", "None"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"], ["executor", "event_buffer", "ti1", "key", "State", "SUCCESS", "None"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_process_executor_events", "session", "session"], ["self", "job_runner", "_process_executor_events", "session", "session"]], "return_value": [["mock_task_callback", "return_value", "task_callback"], ["mock_task_callback", "return_value", "task_callback"]], "run_id": [["ti1", "dag_maker", "create_dagrun", "run_id", "run_id", "execution_date", "DEFAULT_DATE", "timedelta", "hours", "get_task_instance", "task1", "task_id"]], "scheduler_job": [["scheduler_job", "Job", "executor", "executor"], ["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["scheduler_job", "Job", "executor", "executor"], ["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti1"], ["session", "commit"], ["self", "job_runner", "_process_executor_events", "session", "session"], ["ti1", "refresh_from_db", "session", "session"], ["session", "merge", "ti1"], ["session", "commit"], ["self", "job_runner", "_process_executor_events", "session", "session"], ["ti1", "refresh_from_db", "session", "session"]], "state": [["ti1", "state", "State", "QUEUED"], ["ti1", "state", "State", "UP_FOR_RETRY"], ["ti1", "state", "State", "SUCCESS"], ["ti1", "state", "State", "SUCCESS"]], "task1": [["task1", "EmptyOperator", "task_id", "task_id", "retries"], ["ti1", "dag_maker", "create_dagrun", "run_id", "run_id", "execution_date", "DEFAULT_DATE", "timedelta", "hours", "get_task_instance", "task1", "task_id"]], "task_callback": [["task_callback", "mock", "MagicMock"], ["mock_task_callback", "return_value", "task_callback"], ["task_callback", "mock", "MagicMock"], ["mock_task_callback", "return_value", "task_callback"]], "task_id": [["task1", "EmptyOperator", "task_id", "task_id", "retries"], ["ti1", "dag_maker", "create_dagrun", "run_id", "run_id", "execution_date", "DEFAULT_DATE", "timedelta", "hours", "get_task_instance", "task1", "task_id"], ["mock_stats_incr", "assert_has_calls", "mock", "call", "tags", "dag_id", "task_id", "mock", "call", "tags", "dag_id", "task_id", "mock", "call", "tags", "dag_id", "task_id", "any_order", "True"]], "ti1": [["ti1", "dag_maker", "create_dagrun", "run_id", "run_id", "execution_date", "DEFAULT_DATE", "timedelta", "hours", "get_task_instance", "task1", "task_id"], ["ti1", "state", "State", "QUEUED"], ["session", "merge", "ti1"], ["executor", "event_buffer", "ti1", "key", "State", "FAILED", "None"], ["ti1", "refresh_from_db", "session", "session"], ["ti1", "state", "State", "UP_FOR_RETRY"], ["ti1", "state", "State", "SUCCESS"], ["session", "merge", "ti1"], ["executor", "event_buffer", "ti1", "key", "State", "SUCCESS", "None"], ["ti1", "refresh_from_db", "session", "session"], ["ti1", "state", "State", "SUCCESS"]]}, "name": "test_process_executor_events_with_no_callback", "params": {"dag_maker": "", "mock_stats_incr": "", "mock_task_callback": "", "self": ""}, "params_descr": {"dag_maker": "", "mock_stats_incr": "", "mock_task_callback": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "fileloc"], ["ti1", "dag_maker", "create_dagrun", "run_id", "run_id", "execution_date", "DEFAULT_DATE", "timedelta", "hours", "get_task_instance", "task1", "task_id"]], "mock_stats_incr": [["mock_stats_incr", "reset_mock"], ["mock_stats_incr", "reset_mock"], ["mock_stats_incr", "assert_has_calls", "mock", "call", "tags", "dag_id", "task_id", "mock", "call", "tags", "dag_id", "task_id", "mock", "call", "tags", "dag_id", "task_id", "any_order", "True"]], "mock_task_callback": [["mock_task_callback", "return_value", "task_callback"], ["mock_task_callback", "return_value", "task_callback"]], "self": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_process_executor_events", "session", "session"], ["self", "job_runner", "_process_executor_events", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "mock_stats_incr": [["unittesmock.MagicMock", 0.30249482569911684], ["tests.test_util.aiohttp.AiohttpClientMocker", 0.11474725353915827]], "mock_task_callback": [["unittesmock.MagicMock", 0.2901469691230708]], "self": []}, "q_name": "TestSchedulerJob.test_process_executor_events_with_no_callback", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "executor": "", "job_runner": "", "return_value": "", "run_id": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "task_callback": "", "task_id": "", "ti1": ""}, "variables_p": {"dag_id": [["str", 0.32253942960931503], ["Set[str]", 0.3001095131114873], ["float", 0.1847066572728102], ["Optional[str]", 0.09748164969390163], ["List[Tuple[Any, Any, Any]]", 0.09516275031248574]], "executor": [["Dict[int, Dict[str, Any]]", 0.30045119776065093], ["str", 0.29440778876046986], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.12932796961254964], ["List[str]", 0.09676330046200302], ["unittesmock._patch[Union[unittesmock.AsyncMock, unittesmock.MagicMock]]", 0.08863757645784262]], "job_runner": [["MagicMock[Union[mock.AsyncMock, mock.MagicMock]]", 0.49887362703971805], ["Tuple[Literal, Literal]", 0.17347513807927054], ["mock._patch[Union[mock.AsyncMock, mock.MagicMock]]", 0.08368600115603678]], "return_value": [["Optional[bytes]", 0.09771255820305137], ["list", 0.09257903855011115], ["Dict[str, Union[int, str]]", 0.08985422081100247]], "run_id": [["str", 0.3047635571828556], ["int", 0.30334357724469285], ["models.File", 0.08770534817720993]], "scheduler_job": [["dict", 0.3719822887431503], ["Dict[str, Union[Any, Any]]", 0.09569733207094952]], "session": [["sqlalchemy.orm.session.Session", 0.13155637872491766]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task1": [["Dict[str, Union[Any, bool, str]]", 0.17017763130263097], ["Dict[str, Dict[str, int]]", 0.1360586800252992], ["Dict[str, Union[int, str]]", 0.08858371869511014], ["Dict[str, Optional[str]]", 0.08456224136469705], ["legistar.models.MatterStatus", 0.08416194022197235]], "task_callback": [["unittesmock.MagicMock", 0.6117008920406055]], "task_id": [["str", 0.884645279504843], ["list", 0.11535472049515702]], "ti1": [["list", 0.1477187488635566], ["float", 0.08738320536263482], ["str", 0.08602142072798274], ["backend.api.models.group.Group", 0.07691542073508233], ["bool", 0.07522817223988587]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[345, 4], [391, 9]], "fn_var_ln": {"dag_id": [[346, 8], [346, 14]], "executor": [[355, 8], [355, 16]], "job_runner": [[359, 8], [359, 23]], "return_value": [[357, 8], [357, 39]], "scheduler_job": [[358, 8], [358, 21]], "session": [[361, 8], [361, 15]], "state": [[363, 8], [363, 17]], "task1": [[350, 12], [350, 17]], "task_callback": [[356, 8], [356, 21]], "task_id_1": [[347, 8], [347, 17]], "ti1": [[351, 8], [351, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "fileloc", "dag"]], "executor": [["executor", "MockExecutor", "do_update", "False"], ["scheduler_job", "Job", "executor", "executor"], ["executor", "event_buffer", "ti1", "key", "State", "FAILED", "None"], ["scheduler_job", "executor", "callback_sink", "send", "assert_called_once_with", "task_callback"], ["scheduler_job", "executor", "callback_sink", "reset_mock"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_process_executor_events", "session", "session"]], "return_value": [["mock_task_callback", "return_value", "task_callback"]], "scheduler_job": [["scheduler_job", "Job", "executor", "executor"], ["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["scheduler_job", "executor", "callback_sink", "send", "assert_called_once_with", "task_callback"], ["scheduler_job", "executor", "callback_sink", "reset_mock"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti1"], ["session", "commit"], ["self", "job_runner", "_process_executor_events", "session", "session"]], "state": [["ti1", "state", "State", "QUEUED"], ["ti1", "state", "State", "QUEUED"]], "task1": [["task1", "EmptyOperator", "task_id", "task_id_1", "on_failure_callback", "x", "print"], ["ti1", "dag_maker", "create_dagrun", "get_task_instance", "task1", "task_id"]], "task_callback": [["task_callback", "mock", "MagicMock"], ["mock_task_callback", "return_value", "task_callback"], ["scheduler_job", "executor", "callback_sink", "send", "assert_called_once_with", "task_callback"]], "task_id_1": [["task1", "EmptyOperator", "task_id", "task_id_1", "on_failure_callback", "x", "print"]], "ti1": [["ti1", "dag_maker", "create_dagrun", "get_task_instance", "task1", "task_id"], ["ti1", "state", "State", "QUEUED"], ["session", "merge", "ti1"], ["executor", "event_buffer", "ti1", "key", "State", "FAILED", "None"], ["ti1", "refresh_from_db"], ["ti1", "state", "State", "QUEUED"]]}, "name": "test_process_executor_events_with_callback", "params": {"dag_maker": "", "mock_stats_incr": "", "mock_task_callback": "", "self": ""}, "params_descr": {"dag_maker": "", "mock_stats_incr": "", "mock_task_callback": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "fileloc", "dag"], ["ti1", "dag_maker", "create_dagrun", "get_task_instance", "task1", "task_id"]], "mock_stats_incr": [["mock_stats_incr", "reset_mock"], ["mock_stats_incr", "assert_called_once_with", "tags"]], "mock_task_callback": [["mock_task_callback", "return_value", "task_callback"], ["mock_task_callback", "assert_called_once_with", "full_filepath", "dag", "fileloc", "simple_task_instance", "mock", "ANY", "processor_subdir", "None", "msg"]], "self": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_process_executor_events", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.09865841728643021]], "kwargs": [], "mock_stats_incr": [["unittesmock.MagicMock", 0.7991335348903872]], "mock_task_callback": [["unittesmock.MagicMock", 0.09195810852960662]], "self": []}, "q_name": "TestSchedulerJob.test_process_executor_events_with_callback", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "executor": "", "job_runner": "", "return_value": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "task_callback": "", "task_id_1": "", "ti1": ""}, "variables_p": {"dag_id": [["int", 0.5784179031930052], ["list", 0.1848914798641481], ["Set[str]", 0.07872132975991047]], "executor": [["str", 0.10959716330851016], ["unittesmock.MagicMock", 0.10804856902243588]], "job_runner": [["MagicMock[Union[mock.AsyncMock, mock.MagicMock]]", 0.49887362703971805], ["Tuple[Literal, Literal]", 0.17347513807927054], ["mock._patch[Union[mock.AsyncMock, mock.MagicMock]]", 0.08368600115603678]], "return_value": [["Dict[str, Union[int, str]]", 0.09944129922660078], ["list", 0.09578431763052545], ["Optional[bytes]", 0.09350490016598349], ["str", 0.09171437375848566]], "scheduler_job": [["dict", 0.20336741560115645], ["Dict[str, Union[Any, Any]]", 0.12182445757889099], ["OrderedDict[str, Any]", 0.08112912091189835]], "session": [["sqlalchemy.orm.session.Session", 0.22666933250135723], ["kedro.framework.session.session.KedroSession", 0.11760106656975909]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task1": [["Dict[str, Union[Any, bool, str]]", 0.21652647397053612], ["List[str]", 0.1164242292061451], ["Dict[str, Any]", 0.08797860710468686]], "task_callback": [["mock.Mock", 0.3369315201012286], ["unittesmock.MagicMock", 0.3074655572426462]], "task_id_1": [["int", 0.6369310195276088], ["Type[Tuple[str, Any]]", 0.18972018068209354], ["str", 0.09773715888640079], ["List[str]", 0.07561164090389684]], "ti1": [["str", 0.40102291820434255], ["raiden.utils.TargetAddress", 0.09813036303319506]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[395, 4], [422, 40]], "fn_var_ln": {"dag_id": [[396, 8], [396, 14]], "executor": [[405, 8], [405, 16]], "job_runner": [[409, 8], [409, 23]], "return_value": [[407, 8], [407, 39]], "scheduler_job": [[408, 8], [408, 21]], "session": [[413, 8], [413, 15]], "state": [[415, 8], [415, 17]], "task1": [[400, 12], [400, 17]], "task_callback": [[406, 8], [406, 21]], "task_id_1": [[397, 8], [397, 17]], "ti1": [[401, 8], [401, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "fileloc"]], "executor": [["executor", "MockExecutor", "do_update", "False"], ["scheduler_job", "Job", "executor", "executor"], ["executor", "event_buffer", "ti1", "key", "State", "FAILED", "None"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "job_runner", "dagbag", "mock", "MagicMock"], ["self", "job_runner", "dagbag", "get_dag", "side_effect", "Exception"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_process_executor_events", "session", "session"]], "return_value": [["mock_task_callback", "return_value", "task_callback"]], "scheduler_job": [["scheduler_job", "Job", "executor", "executor"], ["self", "job_runner", "SchedulerJobRunner", "scheduler_job"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti1"], ["session", "commit"], ["self", "job_runner", "_process_executor_events", "session", "session"]], "state": [["ti1", "state", "State", "QUEUED"], ["ti1", "state", "State", "FAILED"]], "task1": [["task1", "EmptyOperator", "task_id", "task_id_1", "on_failure_callback", "x", "print"], ["ti1", "dag_maker", "create_dagrun", "get_task_instance", "task1", "task_id"]], "task_callback": [["task_callback", "mock", "MagicMock"], ["mock_task_callback", "return_value", "task_callback"]], "task_id_1": [["task1", "EmptyOperator", "task_id", "task_id_1", "on_failure_callback", "x", "print"]], "ti1": [["ti1", "dag_maker", "create_dagrun", "get_task_instance", "task1", "task_id"], ["ti1", "state", "State", "QUEUED"], ["session", "merge", "ti1"], ["executor", "event_buffer", "ti1", "key", "State", "FAILED", "None"], ["ti1", "refresh_from_db"], ["ti1", "state", "State", "FAILED"]]}, "name": "test_process_executor_event_missing_dag", "params": {"caplog": "", "dag_maker": "", "mock_stats_incr": "", "mock_task_callback": "", "self": ""}, "params_descr": {"caplog": "", "dag_maker": "", "mock_stats_incr": "", "mock_task_callback": "", "self": ""}, "params_occur": {"caplog": [], "dag_maker": [["dag_maker", "dag_id", "dag_id", "fileloc"], ["ti1", "dag_maker", "create_dagrun", "get_task_instance", "task1", "task_id"]], "mock_stats_incr": [["mock_stats_incr", "reset_mock"]], "mock_task_callback": [["mock_task_callback", "return_value", "task_callback"]], "self": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "job_runner", "dagbag", "mock", "MagicMock"], ["self", "job_runner", "dagbag", "get_dag", "side_effect", "Exception"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_process_executor_events", "session", "session"]]}, "params_p": {"args": [], "caplog": [["mock.MagicMock", 0.3680896144761768], ["tests.async_mock.MagicMock", 0.08607767254595287], ["mock.Mock", 0.07206206880354865]], "dag_maker": [["int", 0.10177488166965726]], "kwargs": [], "mock_stats_incr": [["unittesmock.MagicMock", 0.5358441835972853], ["mock.Mock", 0.22080595400729364]], "mock_task_callback": [["unittesmock.MagicMock", 0.3799097371927553]], "self": []}, "q_name": "TestSchedulerJob.test_process_executor_event_missing_dag", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "executor": "", "job_runner": "", "return_value": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "task_callback": "", "task_id_1": "", "ti1": ""}, "variables_p": {"dag_id": [["int", 0.5784179031930052], ["list", 0.1848914798641481], ["Set[str]", 0.07872132975991047]], "executor": [["str", 0.1757897712769195], ["Dict[int, Dict[str, Any]]", 0.1739953073989], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.10710450869038567], ["unittesmock.MagicMock", 0.09445262496585789]], "job_runner": [["MagicMock[Union[mock.AsyncMock, mock.MagicMock]]", 0.6678944156791958]], "return_value": [["Dict[str, Union[int, str]]", 0.09944129922660078], ["list", 0.09578431763052545], ["Optional[bytes]", 0.09350490016598349], ["str", 0.09171437375848566]], "scheduler_job": [["dict", 0.2814798551909752], ["bool", 0.224208947328532], ["Dict[str, Union[Any, Any, Any]]", 0.12585281134008208], ["str", 0.09503156588393918], ["Dict[str, int]", 0.0931865856894567], ["Dict[str, Any]", 0.09002645422134034]], "session": [["sqlalchemy.orm.session.Session", 0.22666933250135723], ["kedro.framework.session.session.KedroSession", 0.11760106656975909]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task1": [["Dict[str, Union[Any, bool, str]]", 0.21652647397053612], ["List[str]", 0.1164242292061451], ["Dict[str, Any]", 0.08797860710468686]], "task_callback": [["unittesmock.MagicMock", 0.3411051383749402]], "task_id_1": [["int", 0.6369310195276088], ["Type[Tuple[str, Any]]", 0.18972018068209354], ["str", 0.09773715888640079], ["List[str]", 0.07561164090389684]], "ti1": [["str", 0.40102291820434255], ["raiden.utils.TargetAddress", 0.09813036303319506]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[426, 4], [485, 43]], "fn_var_ln": {"dag_id": [[427, 8], [427, 14]], "executor": [[437, 8], [437, 16]], "has_task": [[479, 8], [479, 25]], "id": [[442, 8], [442, 15]], "job_runner": [[441, 8], [441, 23]], "queued_by_job_id": [[474, 8], [474, 28]], "return_value": [[439, 8], [439, 39]], "scheduler_job": [[440, 8], [440, 21]], "session": [[430, 8], [430, 15]], "state": [[473, 8], [473, 17]], "task1": [[432, 12], [432, 17]], "task_callback": [[438, 8], [438, 21]], "task_id_1": [[428, 8], [428, 17]], "ti1": [[433, 8], [433, 11]], "try_number": [[448, 8], [448, 22]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "fileloc"]], "executor": [["executor", "MockExecutor", "do_update", "False"], ["scheduler_job", "Job", "executor", "executor"], ["executor", "event_buffer", "ti1", "key", "with_try_number", "State", "SUCCESS", "None"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"], ["executor", "event_buffer", "ti1", "key", "State", "SUCCESS", "None"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"], ["executor", "event_buffer", "ti1", "key", "State", "SUCCESS", "None"], ["executor", "has_task", "mock", "MagicMock", "return_value", "True"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"]], "has_task": [["executor", "has_task", "mock", "MagicMock", "return_value", "True"]], "id": [["self", "id"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_process_executor_events", "session", "session"], ["self", "job_runner", "_process_executor_events", "session", "session"], ["self", "job_runner", "_process_executor_events", "session", "session"]], "queued_by_job_id": [["ti1", "queued_by_job_id"], ["ti1", "queued_by_job_id"], ["ti1", "queued_by_job_id"]], "return_value": [["mock_task_callback", "return_value", "task_callback"], ["executor", "has_task", "mock", "MagicMock", "return_value", "True"]], "scheduler_job": [["scheduler_job", "Job", "executor", "executor"], ["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti1"], ["session", "commit"], ["self", "job_runner", "_process_executor_events", "session", "session"], ["ti1", "refresh_from_db", "session", "session"], ["session", "merge", "ti1"], ["session", "commit"], ["self", "job_runner", "_process_executor_events", "session", "session"], ["ti1", "refresh_from_db", "session", "session"], ["session", "merge", "ti1"], ["session", "commit"], ["self", "job_runner", "_process_executor_events", "session", "session"], ["ti1", "refresh_from_db", "session", "session"]], "state": [["ti1", "state", "State", "QUEUED"], ["ti1", "state", "State", "QUEUED"], ["ti1", "state", "State", "QUEUED"], ["ti1", "state", "State", "QUEUED"], ["ti1", "state", "State", "QUEUED"], ["ti1", "state", "State", "QUEUED"]], "task1": [["task1", "EmptyOperator", "task_id", "task_id_1"], ["ti1", "dag_maker", "create_dagrun", "get_task_instance", "task1", "task_id"]], "task_callback": [["task_callback", "mock", "MagicMock"], ["mock_task_callback", "return_value", "task_callback"]], "task_id_1": [["task1", "EmptyOperator", "task_id", "task_id_1"]], "ti1": [["ti1", "dag_maker", "create_dagrun", "get_task_instance", "task1", "task_id"], ["ti1", "state", "State", "QUEUED"], ["ti1", "queued_by_job_id"], ["ti1", "try_number"], ["session", "merge", "ti1"], ["executor", "event_buffer", "ti1", "key", "with_try_number", "State", "SUCCESS", "None"], ["ti1", "refresh_from_db", "session", "session"], ["ti1", "state", "State", "QUEUED"], ["ti1", "state", "State", "QUEUED"], ["ti1", "queued_by_job_id"], ["session", "merge", "ti1"], ["executor", "event_buffer", "ti1", "key", "State", "SUCCESS", "None"], ["ti1", "refresh_from_db", "session", "session"], ["ti1", "state", "State", "QUEUED"], ["ti1", "state", "State", "QUEUED"], ["ti1", "queued_by_job_id"], ["session", "merge", "ti1"], ["executor", "event_buffer", "ti1", "key", "State", "SUCCESS", "None"], ["ti1", "refresh_from_db", "session", "session"], ["ti1", "state", "State", "QUEUED"]], "try_number": [["ti1", "try_number"]]}, "name": "test_process_executor_events_ti_requeued", "params": {"dag_maker": "", "mock_stats_incr": "", "mock_task_callback": "", "self": ""}, "params_descr": {"dag_maker": "", "mock_stats_incr": "", "mock_task_callback": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "fileloc"], ["ti1", "dag_maker", "create_dagrun", "get_task_instance", "task1", "task_id"]], "mock_stats_incr": [["mock_stats_incr", "reset_mock"], ["mock_stats_incr", "assert_not_called"]], "mock_task_callback": [["mock_task_callback", "return_value", "task_callback"]], "self": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "id"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_process_executor_events", "session", "session"], ["self", "job_runner", "_process_executor_events", "session", "session"], ["self", "job_runner", "_process_executor_events", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.10177488166965726]], "kwargs": [], "mock_stats_incr": [["unittesmock.MagicMock", 0.801031843418256]], "mock_task_callback": [["unittesmock.MagicMock", 0.3799097371927553]], "self": []}, "q_name": "TestSchedulerJob.test_process_executor_events_ti_requeued", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "executor": "", "has_task": "", "id": "", "job_runner": "", "queued_by_job_id": "", "return_value": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "task_callback": "", "task_id_1": "", "ti1": "", "try_number": ""}, "variables_p": {"dag_id": [["int", 0.5784179031930052], ["list", 0.1848914798641481], ["Set[str]", 0.07872132975991047]], "executor": [["unittesmock.MagicMock", 0.11176554500780315], ["str", 0.09518837117974957]], "has_task": [["unittesmock.MagicMock", 0.23478696013935105], ["mock.MagicMock", 0.194460286334732], ["mock.Mock", 0.09110759473469951]], "id": [["str", 0.7939082549413211], ["int", 0.20609174505867855]], "job_runner": [["MagicMock[Union[mock.AsyncMock, mock.MagicMock]]", 0.49887362703971805], ["Tuple[Literal, Literal]", 0.17347513807927054], ["mock._patch[Union[mock.AsyncMock, mock.MagicMock]]", 0.08368600115603678]], "queued_by_job_id": [["int", 0.6133350388839789], ["Dict[str, str]", 0.3866649611160211]], "return_value": [["Dict[str, Any]", 0.18664294717743285], ["mock._patch[Union[mock.AsyncMock, mock.MagicMock]]", 0.12082768772006298], ["dict", 0.08407534809493361]], "scheduler_job": [["dict", 0.20336741560115645], ["Dict[str, Union[Any, Any]]", 0.12182445757889099], ["OrderedDict[str, Any]", 0.08112912091189835]], "session": [["sqlalchemy.orm.session.Session", 0.13155637872491766]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task1": [["Dict[str, Union[Any, bool, str]]", 0.21696436906738675], ["Dict[str, Dict[str, int]]", 0.08581656510455088], ["taskiapplication.models.task.Task", 0.08340513364439607]], "task_callback": [["unittesmock.MagicMock", 0.3411051383749402]], "task_id_1": [["str", 0.5264566963820929], ["set", 0.13100570258410138], ["int", 0.08427137950743863]], "ti1": [["int", 0.5918203729804167], ["bool", 0.096868286610341], ["str", 0.09106876393515953]], "try_number": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[487, 4], [505, 26]], "fn_var_ln": {"dag_id": [[488, 8], [488, 14]], "dr1": [[497, 8], [497, 11]], "job_runner": [[496, 8], [496, 23]], "scheduler_job": [[495, 8], [495, 21]], "state": [[499, 8], [499, 17]], "task_id_1": [[489, 8], [489, 17]], "ti1": [[498, 9], [498, 12]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "session", "session", "dag"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "BACKFILL_JOB"], ["ti1", "dr1", "task_instances"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_critical_section_enqueue_task_instances", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "state": [["ti1", "state", "State", "SCHEDULED"], ["State", "SCHEDULED", "ti1", "state"]], "task_id_1": [["EmptyOperator", "task_id", "task_id_1"]], "ti1": [["ti1", "dr1", "task_instances"], ["ti1", "state", "State", "SCHEDULED"], ["ti1", "refresh_from_db", "session", "session"], ["State", "SCHEDULED", "ti1", "state"]]}, "name": "test_execute_task_instances_is_paused_wont_execute", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "session", "session", "dag"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "BACKFILL_JOB"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_critical_section_enqueue_task_instances", "session"]], "session": [["dag_maker", "dag_id", "dag_id", "session", "session", "dag"], ["self", "job_runner", "_critical_section_enqueue_task_instances", "session"], ["session", "flush"], ["ti1", "refresh_from_db", "session", "session"], ["session", "rollback"]]}, "params_p": {"args": [], "dag_maker": [["sqlalchemy.orm.Session", 0.2728223528339136], ["sqlalchemy.orm.session.Session", 0.17332056368718796], ["sqlalchemy.orm.scoping.scoped_session", 0.12027973265008661], ["grouper.settings.Settings", 0.0837243796078444]], "kwargs": [], "self": [], "session": [["sqlalchemy.orm.Session", 0.40196937011655254], ["sqlalchemy.orm.scoping.scoped_session", 0.0926458684275167], ["abilian.core.sqlalchemy.SQLAlchemy", 0.07688265379534326], ["datasets.github.scrape_repos.contentfiles.ContentFiles", 0.07661527686664349]]}, "q_name": "TestSchedulerJob.test_execute_task_instances_is_paused_wont_execute", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "job_runner": "", "scheduler_job": "", "state": "", "task_id_1": "", "ti1": ""}, "variables_p": {"dag_id": [["int", 0.20803454367831015], ["Optional[str]", 0.10162749809529564], ["Pattern[Any]", 0.07977830766978587]], "dr1": [["int", 0.4807871000255693], ["str", 0.20974871267502915], ["datetime.datetime", 0.19334874299085358], ["raiden.utils.PaymentID", 0.11611544430854796]], "job_runner": [["dict", 0.5195932870091522], ["str", 0.10048369439679648], ["Dict[str, Sequence[Any]]", 0.09618375079695307], ["List[str]", 0.09263377712193202]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task_id_1": [["str", 0.694840659685026], ["set", 0.1363810265279712], ["Set[str]", 0.08666639891407141], ["int", 0.08211191487293125]], "ti1": [["float", 0.31703975336552637], ["str", 0.28339456393627926], ["Dict[str, str]", 0.0886778458760176], ["Tuple[int, int, int, int]", 0.08485772279702333]]}}, {"docstring": {"func": "Tests that backfill tasks won't get executed.", "long_descr": null, "ret": null}, "fn_lc": [[507, 4], [535, 26]], "fn_var_ln": {"dag_id": [[511, 8], [511, 14]], "dr1": [[521, 8], [521, 11]], "job_runner": [[518, 8], [518, 23]], "scheduler_job": [[517, 8], [517, 21]], "session": [[519, 8], [519, 15]], "state": [[525, 8], [525, 17]], "task1": [[515, 12], [515, 17]], "task_id_1": [[512, 8], [512, 17]], "ti1": [[523, 8], [523, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "BACKFILL_JOB"], ["ti1", "TaskInstance", "task1", "run_id", "dr1", "run_id"], ["dr1", "is_backfill"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_critical_section_enqueue_task_instances", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti1"], ["session", "flush"], ["self", "job_runner", "_critical_section_enqueue_task_instances", "session"], ["session", "flush"], ["session", "rollback"]], "state": [["ti1", "state", "State", "SCHEDULED"], ["State", "SCHEDULED", "ti1", "state"]], "task1": [["task1", "EmptyOperator", "task_id", "task_id_1"], ["ti1", "TaskInstance", "task1", "run_id", "dr1", "run_id"]], "task_id_1": [["task1", "EmptyOperator", "task_id", "task_id_1"]], "ti1": [["ti1", "TaskInstance", "task1", "run_id", "dr1", "run_id"], ["ti1", "refresh_from_db"], ["ti1", "state", "State", "SCHEDULED"], ["session", "merge", "ti1"], ["ti1", "refresh_from_db"], ["State", "SCHEDULED", "ti1", "state"]]}, "name": "test_execute_task_instances_backfill_tasks_wont_execute", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "BACKFILL_JOB"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_critical_section_enqueue_task_instances", "session"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_execute_task_instances_backfill_tasks_wont_execute", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "job_runner": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "task_id_1": "", "ti1": ""}, "variables_p": {"dag_id": [["Set[str]", 0.9999999997063854], ["int", 1.3721455947465137e-10], ["str", 6.953826511577719e-11]], "dr1": [["str", 0.29128328052742086], ["list", 0.24122275885686043], ["Dict[str, Any]", 0.10037571340996587], ["Optional[types.TracebackType]", 0.09014042237264545], ["Dict[str, Union[int, str]]", 0.09005884015554366], ["List[str]", 0.08983231374220263]], "job_runner": [["dict", 0.5195932870091522], ["str", 0.10048369439679648], ["Dict[str, Sequence[Any]]", 0.09618375079695307], ["List[str]", 0.09263377712193202]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["sqlalchemy.orm.session.Session", 0.23108998809001405], ["kedro.framework.session.session.KedroSession", 0.11781618415842995]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task1": [["Dict[str, str]", 0.2404962868339916], ["Dict[str, Union[Any, Any]]", 0.10747716925970223], ["List[str]", 0.08975259160652399], ["str", 0.06997841560969648], ["Dict[str, Any]", 0.06244999902016678]], "task_id_1": [["str", 0.5264566963820929], ["set", 0.13100570258410138], ["int", 0.08427137950743863]], "ti1": [["int", 0.4318943324057601], ["str", 0.2512849778966301], ["Dict[int, str]", 0.11866261487530516], ["List[dict]", 0.10928847653247539], ["List[str]", 0.08886959828982936]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[538, 4], [543, 81]], "fn_var_ln": {"job_runner": [[540, 8], [540, 23]], "scheduler_job": [[539, 8], [539, 21]]}, "fn_var_occur": {"job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull", "num_runs"], ["self", "job_runner", "_execute"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull", "num_runs"], ["isinstance", "scheduler_job", "executor", "callback_sink", "PipeCallbackSink"]]}, "name": "test_setup_callback_sink_not_standalone_dag_processor", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull", "num_runs"], ["self", "job_runner", "_execute"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_setup_callback_sink_not_standalone_dag_processor", "ret_exprs": [], "ret_type": "", "variables": {"job_runner": "", "scheduler_job": ""}, "variables_p": {"job_runner": [["Dict[int, Any]", 0.18812369333990844], ["set", 0.11977534145787987], ["List[int]", 0.10569048935957706], ["str", 0.10285118790103966], ["Sequence[str]", 0.10058763821695707], ["float", 0.09996481233629669], ["deque[str]", 0.09853186785951079], ["defaultdict", 0.09131879075256077]], "scheduler_job": [["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.09774635426388985], ["property", 0.09675405193821106], ["list", 0.09227802900708225]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[546, 4], [551, 85]], "fn_var_ln": {"job_runner": [[548, 8], [548, 23]], "scheduler_job": [[547, 8], [547, 21]]}, "fn_var_occur": {"job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull", "num_runs"], ["self", "job_runner", "_execute"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull", "num_runs"], ["isinstance", "scheduler_job", "executor", "callback_sink", "DatabaseCallbackSink"]]}, "name": "test_setup_callback_sink_standalone_dag_processor", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull", "num_runs"], ["self", "job_runner", "_execute"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_setup_callback_sink_standalone_dag_processor", "ret_exprs": [], "ret_type": "", "variables": {"job_runner": "", "scheduler_job": ""}, "variables_p": {"job_runner": [["Dict[int, Any]", 0.18812369333990844], ["set", 0.11977534145787987], ["List[int]", 0.10569048935957706], ["str", 0.10285118790103966], ["Sequence[str]", 0.10058763821695707], ["float", 0.09996481233629669], ["deque[str]", 0.09853186785951079], ["defaultdict", 0.09131879075256077]], "scheduler_job": [["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.09774635426388985], ["property", 0.09675405193821106], ["list", 0.09227802900708225]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[553, 4], [581, 26]], "fn_var_ln": {"dag_id": [[554, 8], [554, 14]], "dr1": [[563, 8], [563, 11]], "dr2": [[564, 8], [564, 11]], "job_runner": [[560, 8], [560, 23]], "res": [[577, 8], [577, 11]], "res_keys": [[579, 8], [579, 16]], "scheduler_job": [[559, 8], [559, 21]], "session": [[561, 8], [561, 15]], "state": [[570, 8], [570, 28]], "task1": [[557, 12], [557, 17]], "task_id_1": [[555, 8], [555, 17]], "ti_backfill": [[566, 8], [566, 19]], "ti_with_dagrun": [[567, 8], [567, 22]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "max_active_tasks"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "BACKFILL_JOB", "state", "State", "RUNNING"], ["ti_with_dagrun", "dr1", "get_task_instance", "task1", "task_id"]], "dr2": [["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "BACKFILL_JOB", "state", "State", "RUNNING"], ["ti_backfill", "dr2", "get_task_instance", "task1", "task_id"], ["session", "merge", "dr2"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["res_keys", "map", "x", "x", "key", "res"]], "res_keys": [["res_keys", "map", "x", "x", "key", "res"], ["ti_with_dagrun", "key", "res_keys"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["session", "merge", "dr2"], ["session", "merge", "ti_backfill"], ["session", "merge", "ti_with_dagrun"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "rollback"]], "state": [["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "BACKFILL_JOB", "state", "State", "RUNNING"], ["ti_backfill", "state", "State", "SCHEDULED"], ["ti_with_dagrun", "state", "State", "SCHEDULED"]], "task1": [["task1", "EmptyOperator", "task_id", "task_id_1"], ["ti_backfill", "dr2", "get_task_instance", "task1", "task_id"], ["ti_with_dagrun", "dr1", "get_task_instance", "task1", "task_id"]], "task_id_1": [["task1", "EmptyOperator", "task_id", "task_id_1"]], "ti_backfill": [["ti_backfill", "dr2", "get_task_instance", "task1", "task_id"], ["ti_backfill", "state", "State", "SCHEDULED"], ["session", "merge", "ti_backfill"]], "ti_with_dagrun": [["ti_with_dagrun", "dr1", "get_task_instance", "task1", "task_id"], ["ti_with_dagrun", "state", "State", "SCHEDULED"], ["session", "merge", "ti_with_dagrun"], ["ti_with_dagrun", "key", "res_keys"]]}, "name": "test_find_executable_task_instances_backfill", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "max_active_tasks"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "BACKFILL_JOB", "state", "State", "RUNNING"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["core.models.Recipe", 0.10132577026664324], ["str", 0.09914590854621817]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_backfill", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "dr2": "", "job_runner": "", "res": "", "res_keys": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "task_id_1": "", "ti_backfill": "", "ti_with_dagrun": ""}, "variables_p": {"dag_id": [["int", 0.3245352945578084], ["List[int]", 0.2605460696386551], ["list", 0.2569897771209679], ["range", 0.15792885868256853]], "dr1": [["str", 0.681251074607625], ["Set[str]", 0.11617581937022295], ["List[str]", 0.09946341575061407]], "dr2": [["str", 0.7983516572661533], ["Dict[str, str]", 0.10861087516236893], ["List[str]", 0.09303746757147757]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "res": [["list", 0.22869572497195942], ["List[str]", 0.1155526259878928], ["Dict[Type[Any], Union[Any, Any, Any, Any]]", 0.11073564743564863], ["Tuple[str, str, str, str, str, str, str, str, str, str, str, str, str, str, str, str, str]", 0.09422802132008634], ["Dict[str, str]", 0.08798897303896375], ["Pattern[str]", 0.08698736460897076]], "res_keys": [["str", 0.539636276833303], ["Optional[str]", 0.1519437845074809], ["List[str]", 0.13263414671602494], ["Tuple[Any, Any, Any, Any]", 0.08800417440720155], ["Dict[Any, str]", 0.08778161753598954]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["sqlalchemy.orm.session.Session", 0.30057069461621316], ["Optional[str]", 0.17232145501414867], ["kedro.framework.session.session.KedroSession", 0.09527047662876642], ["SMSShell.models.session.Session", 0.09201854424016943], ["unittesmock.MagicMock", 0.07583632203167011], ["sqlalchemy.orm.scoped_session", 0.07174443277204484]], "state": [["str", 0.903899772360661], ["int", 0.09610022763933894]], "task1": [["Dict[str, Union[Any, bool, str]]", 0.2038530758883859], ["taskiapplication.models.task.Task", 0.09847801008197456]], "task_id_1": [["str", 0.5264566963820929], ["set", 0.13100570258410138], ["int", 0.08427137950743863]], "ti_backfill": [["zerver.models.Realm", 0.1750712446028635], ["str", 0.09588071946850867], ["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.084286444984542], ["List[unittesmock.MagicMock]", 0.07385247197467784]], "ti_with_dagrun": [["str", 0.1939530086614531], ["int", 0.19068604131976258]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[583, 4], [623, 26]], "fn_var_ln": {"dag_id": [[584, 8], [584, 14]], "dr1": [[595, 8], [595, 11]], "dr2": [[596, 8], [596, 11]], "job_runner": [[593, 8], [593, 23]], "pool": [[608, 8], [608, 12]], "pool2": [[609, 8], [609, 13]], "res": [[614, 8], [614, 11]], "res_keys": [[617, 8], [617, 16]], "scheduler_job": [[592, 8], [592, 21]], "session": [[587, 8], [587, 15]], "state": [[606, 12], [606, 20]], "task_id_1": [[585, 8], [585, 17]], "task_id_2": [[586, 8], [586, 17]], "tis": [[604, 8], [604, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "max_active_tasks", "session", "session"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["tis", "dr1", "get_task_instance", "task_id_1", "session", "session", "dr1", "get_task_instance", "task_id_2", "session", "session", "dr2", "get_task_instance", "task_id_1", "session", "session", "dr2", "get_task_instance", "task_id_2", "session", "session"]], "dr2": [["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["tis", "dr1", "get_task_instance", "task_id_1", "session", "session", "dr1", "get_task_instance", "task_id_2", "session", "session", "dr2", "get_task_instance", "task_id_1", "session", "session", "dr2", "get_task_instance", "task_id_2", "session", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "pool": [["EmptyOperator", "task_id", "task_id_1", "pool", "priority_weight"], ["EmptyOperator", "task_id", "task_id_2", "pool", "priority_weight"], ["pool", "Pool", "pool", "slots", "description"], ["pool2", "Pool", "pool", "slots", "description"], ["session", "add", "pool"]], "pool2": [["pool2", "Pool", "pool", "slots", "description"], ["session", "add", "pool2"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"]], "res_keys": [["res_keys", "append", "ti", "key"], ["tis", "key", "res_keys"], ["tis", "key", "res_keys"], ["tis", "key", "res_keys"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["dag_maker", "dag_id", "dag_id", "max_active_tasks", "session", "session"], ["tis", "dr1", "get_task_instance", "task_id_1", "session", "session", "dr1", "get_task_instance", "task_id_2", "session", "session", "dr2", "get_task_instance", "task_id_1", "session", "session", "dr2", "get_task_instance", "task_id_2", "session", "session"], ["session", "merge", "ti"], ["session", "add", "pool"], ["session", "add", "pool2"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "flush"], ["session", "rollback"]], "state": [["ti", "state", "State", "SCHEDULED"]], "task_id_1": [["EmptyOperator", "task_id", "task_id_1", "pool", "priority_weight"], ["tis", "dr1", "get_task_instance", "task_id_1", "session", "session", "dr1", "get_task_instance", "task_id_2", "session", "session", "dr2", "get_task_instance", "task_id_1", "session", "session", "dr2", "get_task_instance", "task_id_2", "session", "session"]], "task_id_2": [["EmptyOperator", "task_id", "task_id_2", "pool", "priority_weight"], ["tis", "dr1", "get_task_instance", "task_id_1", "session", "session", "dr1", "get_task_instance", "task_id_2", "session", "session", "dr2", "get_task_instance", "task_id_1", "session", "session", "dr2", "get_task_instance", "task_id_2", "session", "session"]], "tis": [["tis", "dr1", "get_task_instance", "task_id_1", "session", "session", "dr1", "get_task_instance", "task_id_2", "session", "session", "dr2", "get_task_instance", "task_id_1", "session", "session", "dr2", "get_task_instance", "task_id_2", "session", "session"], ["tis", "sorted", "tis", "key", "ti", "ti", "key"], ["tis", "key", "res_keys"], ["tis", "key", "res_keys"], ["tis", "key", "res_keys"]]}, "name": "test_find_executable_task_instances_pool", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "max_active_tasks", "session", "session"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_pool", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "dr2": "", "job_runner": "", "pool": "", "pool2": "", "res": "", "res_keys": "", "scheduler_job": "", "session": "", "state": "", "task_id_1": "", "task_id_2": "", "tis": ""}, "variables_p": {"dag_id": [["int", 0.3841096539340305], ["Type[Tuple[str, Any]]", 0.18832209865183502], ["Tuple[int]", 0.14339914388523387]], "dr1": [["str", 0.681251074607625], ["Set[str]", 0.11617581937022295], ["List[str]", 0.09946341575061407]], "dr2": [["str", 0.7975852611863946], ["bool", 0.11377161667537806]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "pool": [["str", 0.4550665577834466], ["List[str]", 0.14051193445350096], ["Dict[str, Any]", 0.09562102557533415], ["int", 0.09016277738834384]], "pool2": [["Tuple[Any, Any]", 0.15462329599979815], ["List[Dict[str, str]]", 0.09101351823979201], ["list", 0.08752673057056293], ["str", 0.08732545620021245], ["abilian.core.models.subjects.User", 0.08666683570142286]], "res": [["Type[bytes]", 0.29576978403338117], ["str", 0.185586268259803], ["Optional[str]", 0.12032931326332398], ["List[str]", 0.10221106102140093]], "res_keys": [["Dict[str, str]", 0.8321270451752947], ["List[str]", 0.0866129731423878], ["Tuple[Any, Any, Any, Any]", 0.08125998168231735]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["str", 0.1966439339176302], ["dict", 0.1797549338133712], ["legistar.models.MatterStatus", 0.09883955742419018], ["unittesmock.MagicMock", 0.0951585442012905], ["Dict[str, object]", 0.08544185938238968], ["bool", 0.07947234056484889]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task_id_1": [["str", 0.2839284175957852], ["Dict[str, int]", 0.09985640000684297]], "task_id_2": [["str", 0.2839284175957852], ["Dict[str, int]", 0.09985640000684297]], "tis": [["str", 0.3693862241623732], ["Dict[str, str]", 0.1198921391213534], ["pydynasync.models.Changes", 0.10836796390742101]]}}, {"docstring": {"func": "Test that only task instances of 'running' dagruns are executed", "long_descr": null, "ret": null}, "fn_lc": [[634, 4], [658, 44]], "fn_var_ln": {"dag_id": [[638, 8], [638, 14]], "dr": [[649, 8], [649, 10]], "job_runner": [[647, 8], [647, 23]], "res": [[656, 8], [656, 11]], "scheduler_job": [[646, 8], [646, 21]], "state": [[653, 12], [653, 20]], "task_id_1": [[639, 8], [639, 17]], "task_id_2": [[640, 8], [640, 17]], "tis": [[651, 8], [651, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "session", "session"]], "dr": [["dr", "dag_maker", "create_dagrun", "state", "state"], ["tis", "dr", "task_instances"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["total_executed_ti", "len", "res"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "state": [["dr", "dag_maker", "create_dagrun", "state", "state"], ["ti", "state", "State", "SCHEDULED"]], "task_id_1": [["EmptyOperator", "task_id", "task_id_1"]], "task_id_2": [["EmptyOperator", "task_id", "task_id_2"]], "tis": [["tis", "dr", "task_instances"]]}, "name": "test_find_executable_task_instances_only_running_dagruns", "params": {"dag_maker": "", "self": "", "session": "", "state": "", "total_executed_ti": ""}, "params_descr": {"dag_maker": "", "self": "", "session": "", "state": "", "total_executed_ti": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "session", "session"], ["dr", "dag_maker", "create_dagrun", "state", "state"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "session": [["dag_maker", "dag_id", "dag_id", "session", "session"], ["session", "merge", "ti"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "flush"]], "state": [["dr", "dag_maker", "create_dagrun", "state", "state"], ["ti", "state", "State", "SCHEDULED"]], "total_executed_ti": [["total_executed_ti", "len", "res"]]}, "params_p": {"args": [], "dag_maker": [["raiden.utils.BlockIdentifier", 0.1775699371338382], ["List[raiden.utils.TokenNetworkAddress]", 0.1304168819945341], ["raiden.utils.TokenAddress", 0.10739502235399633], ["raiden.utils.TokenNetworkAddress", 0.0887849685669191], ["raiden.utils.ChannelID", 0.0887849685669191], ["raiden.utils.TokenAmount", 0.08560193393382257]], "kwargs": [], "self": [], "session": [["zerver.models.UserProfile", 0.11034070940869507], ["raiden.utils.Address", 0.09741230656171301], ["raiden.utils.ChannelID", 0.08609494360001695]], "state": [["Optional[str]", 0.243344090072069], ["Callable", 0.10189319037755609], ["raiden.utils.NetworkTimeout", 0.09242537874272073]], "total_executed_ti": [["int", 0.3999751720829622], ["List[float]", 0.10754399487991921], ["Callable", 0.09929254967477961]]}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_only_running_dagruns", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr": "", "job_runner": "", "res": "", "scheduler_job": "", "state": "", "task_id_1": "", "task_id_2": "", "tis": ""}, "variables_p": {"dag_id": [["int", 0.3286743983583179], ["str", 0.22478189861897768], ["Set[int]", 0.18783995901303535], ["Pattern[Any]", 0.08223336777182666], ["Dict[str, int]", 0.08036500292919317]], "dr": [["str", 0.4910352663048221], ["bool", 0.14713651932929245], ["dict", 0.06755517570730041]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "res": [["List[str]", 0.30277057593538725], ["Type[int]", 0.20635407649128382], ["set", 0.11465211397609457], ["dict", 0.09193985845663165], ["deque", 0.08941758449118448], ["list", 0.08567476313022897]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "state": [["str", 0.35654303458297326], ["List[str]", 0.20574617729743877], ["tuple", 0.10387476207376622], ["Dict[str, int]", 0.1022895847351446], ["T", 0.09074428481015313]], "task_id_1": [["str", 0.694840659685026], ["set", 0.1363810265279712], ["Set[str]", 0.08666639891407141], ["int", 0.08211191487293125]], "task_id_2": [["str", 0.694840659685026], ["set", 0.1363810265279712], ["Set[str]", 0.08666639891407141], ["int", 0.08211191487293125]], "tis": [["int", 0.40606835171693134], ["str", 0.20142967799816824], ["Tuple[str, str, str, str, str, str, str, str, str, str]", 0.11200260905559]]}}, {"docstring": {"func": "Test that task instances follow execution_date order priority. If two dagruns with", "long_descr": "different execution dates are scheduled, tasks with earliest dagrun execution date will first\nbe executed", "ret": null}, "fn_lc": [[660, 4], [692, 26]], "fn_var_ln": {"dag_id_1": [[666, 8], [666, 16]], "dag_id_2": [[667, 8], [667, 16]], "dr1": [[678, 8], [678, 11]], "dr2": [[676, 8], [676, 11]], "job_runner": [[681, 8], [681, 23]], "res": [[689, 8], [689, 11]], "scheduler_job": [[680, 8], [680, 21]], "session": [[669, 8], [669, 15]], "state": [[685, 12], [685, 20]], "task_id": [[668, 8], [668, 15]], "tis": [[683, 8], [683, 11]]}, "fn_var_occur": {"dag_id_1": [["dag_maker", "dag_id", "dag_id_1", "max_active_tasks", "session", "session"]], "dag_id_2": [["dag_maker", "dag_id", "dag_id_2", "max_active_tasks", "session", "session"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "execution_date", "DEFAULT_DATE", "timedelta", "hours"], ["dr1", "session", "merge", "dr1", "load", "False"], ["tis", "dr1", "task_instances", "dr2", "task_instances"]], "dr2": [["dr2", "dag_maker", "create_dagrun"], ["tis", "dr1", "task_instances", "dr2", "task_instances"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["ti", "key", "ti", "res", "tis", "key"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["dag_maker", "dag_id", "dag_id_1", "max_active_tasks", "session", "session"], ["dag_maker", "dag_id", "dag_id_2", "max_active_tasks", "session", "session"], ["dr1", "session", "merge", "dr1", "load", "False"], ["session", "merge", "ti"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "flush"], ["session", "rollback"]], "state": [["ti", "state", "State", "SCHEDULED"]], "task_id": [["EmptyOperator", "task_id", "task_id"], ["EmptyOperator", "task_id", "task_id"]], "tis": [["tis", "dr1", "task_instances", "dr2", "task_instances"], ["ti", "key", "ti", "res", "tis", "key"]]}, "name": "test_find_executable_task_instances_order_execution_date", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id_1", "max_active_tasks", "session", "session"], ["dr1", "dag_maker", "create_dagrun", "execution_date", "DEFAULT_DATE", "timedelta", "hours"], ["dag_maker", "dag_id", "dag_id_2", "max_active_tasks", "session", "session"], ["dr2", "dag_maker", "create_dagrun"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["core.models.Grouping", 0.11682054367896069], ["raiden.utils.Address", 0.10601684088052876]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_order_execution_date", "ret_exprs": [], "ret_type": "", "variables": {"dag_id_1": "", "dag_id_2": "", "dr1": "", "dr2": "", "job_runner": "", "res": "", "scheduler_job": "", "session": "", "state": "", "task_id": "", "tis": ""}, "variables_p": {"dag_id_1": [["int", 0.3841096539340305], ["Type[Tuple[str, Any]]", 0.18832209865183502], ["Tuple[int]", 0.14339914388523387]], "dag_id_2": [["int", 0.3841096539340305], ["Type[Tuple[str, Any]]", 0.18832209865183502], ["Tuple[int]", 0.14339914388523387]], "dr1": [["datetime.timedelta", 0.11673491789902586], ["float", 0.11634513557820221], ["int", 0.09582255943048822], ["datetime.datetime", 0.09382811114381721], ["byceps.services.user.models.detail.UserDetail", 0.08577294853674722]], "dr2": [["str", 0.2624078416659086], ["int", 0.21728158101393982], ["dict", 0.12829096541127552], ["bytes", 0.12457426589137181], ["bool", 0.0891484486725014]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "res": [["str", 0.20328485230206372], ["dict", 0.19006521139793725], ["Dict[str, Type[Any]]", 0.1124490600198634], ["Optional[str]", 0.0905560951703642], ["Dict[str, Union[Any, Any, Any, Any]]", 0.089594476279715], ["list", 0.08706831623202105]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["dict", 0.2509649573493128], ["unittesmock.MagicMock", 0.20586712475929692], ["legistar.models.MatterStatus", 0.11081465701647229], ["Dict[str, str]", 0.08779519290903842], ["Dict[str, object]", 0.08763004276961686], ["raiden.transfer.state.HopState", 0.07646428229719454]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task_id": [["str", 0.5678110303234423], ["int", 0.14123824108086785], ["list", 0.11371303503620243], ["List[str]", 0.08688851068114596]], "tis": [["Dict[str, Union[float, str]]", 0.17634679153726557], ["unittesmock.MagicMock", 0.13257892226984644], ["dict", 0.11177307493968483], ["pydynasync.models.Changes", 0.09766683125579231]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[694, 4], [721, 26]], "fn_var_ln": {"dag_id_1": [[695, 8], [695, 16]], "dag_id_2": [[696, 8], [696, 16]], "dr1": [[707, 8], [707, 11]], "dr2": [[705, 8], [705, 11]], "job_runner": [[710, 8], [710, 23]], "res": [[718, 8], [718, 11]], "scheduler_job": [[709, 8], [709, 21]], "session": [[698, 8], [698, 15]], "state": [[714, 12], [714, 20]], "task_id": [[697, 8], [697, 15]], "tis": [[712, 8], [712, 11]]}, "fn_var_occur": {"dag_id_1": [["dag_maker", "dag_id", "dag_id_1", "max_active_tasks", "session", "session"]], "dag_id_2": [["dag_maker", "dag_id", "dag_id_2", "max_active_tasks", "session", "session"]], "dr1": [["dr1", "dag_maker", "create_dagrun"], ["dr1", "session", "merge", "dr1", "load", "False"], ["tis", "dr1", "task_instances", "dr2", "task_instances"]], "dr2": [["dr2", "dag_maker", "create_dagrun"], ["tis", "dr1", "task_instances", "dr2", "task_instances"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["ti", "key", "ti", "res", "tis", "key"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["dag_maker", "dag_id", "dag_id_1", "max_active_tasks", "session", "session"], ["dag_maker", "dag_id", "dag_id_2", "max_active_tasks", "session", "session"], ["dr1", "session", "merge", "dr1", "load", "False"], ["session", "merge", "ti"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "flush"], ["session", "rollback"]], "state": [["ti", "state", "State", "SCHEDULED"]], "task_id": [["EmptyOperator", "task_id", "task_id", "priority_weight"], ["EmptyOperator", "task_id", "task_id", "priority_weight"]], "tis": [["tis", "dr1", "task_instances", "dr2", "task_instances"], ["ti", "key", "ti", "res", "tis", "key"]]}, "name": "test_find_executable_task_instances_order_priority", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id_1", "max_active_tasks", "session", "session"], ["dr1", "dag_maker", "create_dagrun"], ["dag_maker", "dag_id", "dag_id_2", "max_active_tasks", "session", "session"], ["dr2", "dag_maker", "create_dagrun"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_order_priority", "ret_exprs": [], "ret_type": "", "variables": {"dag_id_1": "", "dag_id_2": "", "dr1": "", "dr2": "", "job_runner": "", "res": "", "scheduler_job": "", "session": "", "state": "", "task_id": "", "tis": ""}, "variables_p": {"dag_id_1": [["int", 0.3841096539340305], ["Type[Tuple[str, Any]]", 0.18832209865183502], ["Tuple[int]", 0.14339914388523387]], "dag_id_2": [["int", 0.3841096539340305], ["Type[Tuple[str, Any]]", 0.18832209865183502], ["Tuple[int]", 0.14339914388523387]], "dr1": [["str", 0.33623332123181277], ["float", 0.130427291261686], ["geode.models.common.Address", 0.11079597624814204]], "dr2": [["str", 0.2624078416659086], ["int", 0.21728158101393982], ["dict", 0.12829096541127552], ["bytes", 0.12457426589137181], ["bool", 0.0891484486725014]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "res": [["str", 0.20328485230206372], ["dict", 0.19006521139793725], ["Dict[str, Type[Any]]", 0.1124490600198634], ["Optional[str]", 0.0905560951703642], ["Dict[str, Union[Any, Any, Any, Any]]", 0.089594476279715], ["list", 0.08706831623202105]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["dict", 0.2509649573493128], ["unittesmock.MagicMock", 0.20586712475929692], ["legistar.models.MatterStatus", 0.11081465701647229], ["Dict[str, str]", 0.08779519290903842], ["Dict[str, object]", 0.08763004276961686], ["raiden.transfer.state.HopState", 0.07646428229719454]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task_id": [["str", 0.3237679181950004], ["int", 0.2555797891477004], ["list", 0.10449506192762069], ["List[str]", 0.09045213965223256], ["cmk.utils.type_defs.UserId", 0.08113891473858902]], "tis": [["Dict[str, Union[float, str]]", 0.17634679153726557], ["unittesmock.MagicMock", 0.13257892226984644], ["dict", 0.11177307493968483], ["pydynasync.models.Changes", 0.09766683125579231]]}}, {"docstring": {"func": "The scheduler job should pick tasks with higher priority for execution", "long_descr": "even if different pools are involved.", "ret": null}, "fn_lc": [[723, 4], [761, 26]], "fn_var_ln": {"dag_id": [[733, 8], [733, 14]], "dag_run": [[743, 8], [743, 15]], "job_runner": [[730, 8], [730, 23]], "op1": [[739, 12], [739, 15]], "op2": [[740, 12], [740, 15]], "op3": [[741, 12], [741, 15]], "res": [[755, 8], [755, 11]], "scheduler_job": [[729, 8], [729, 21]], "session": [[731, 8], [731, 15]], "state": [[751, 8], [751, 17]], "ti1": [[745, 8], [745, 11]], "ti2": [[746, 8], [746, 11]], "ti3": [[747, 8], [747, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "max_active_tasks"]], "dag_run": [["dag_run", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["ti1", "dag_run", "get_task_instance", "op1", "task_id", "session"], ["ti2", "dag_run", "get_task_instance", "op2", "task_id", "session"], ["ti3", "dag_run", "get_task_instance", "op3", "task_id", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "op1": [["op1", "EmptyOperator", "task_id", "priority_weight", "pool"], ["ti1", "dag_run", "get_task_instance", "op1", "task_id", "session"]], "op2": [["op2", "EmptyOperator", "task_id", "priority_weight", "pool"], ["ti2", "dag_run", "get_task_instance", "op2", "task_id", "session"]], "op3": [["op3", "EmptyOperator", "task_id", "priority_weight", "pool"], ["ti3", "dag_run", "get_task_instance", "op3", "task_id", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["ti3", "key", "res", "key"], ["ti2", "key", "res", "key"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["session", "add", "Pool", "pool", "slots"], ["session", "add", "Pool", "pool", "slots"], ["ti1", "dag_run", "get_task_instance", "op1", "task_id", "session"], ["ti2", "dag_run", "get_task_instance", "op2", "task_id", "session"], ["ti3", "dag_run", "get_task_instance", "op3", "task_id", "session"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "rollback"]], "state": [["ti1", "state", "State", "SCHEDULED"], ["ti2", "state", "State", "SCHEDULED"], ["ti3", "state", "State", "SCHEDULED"]], "ti1": [["ti1", "dag_run", "get_task_instance", "op1", "task_id", "session"], ["ti1", "state", "State", "SCHEDULED"]], "ti2": [["ti2", "dag_run", "get_task_instance", "op2", "task_id", "session"], ["ti2", "state", "State", "SCHEDULED"], ["ti2", "key", "res", "key"]], "ti3": [["ti3", "dag_run", "get_task_instance", "op3", "task_id", "session"], ["ti3", "state", "State", "SCHEDULED"], ["ti3", "key", "res", "key"]]}, "name": "test_find_executable_task_instances_order_priority_with_pools", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "max_active_tasks"], ["dag_run", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["core.models.Recipe", 0.09554217530065871], ["tests.async_mock.Mock", 0.08855607234118383]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_order_priority_with_pools", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dag_run": "", "job_runner": "", "op1": "", "op2": "", "op3": "", "res": "", "scheduler_job": "", "session": "", "state": "", "ti1": "", "ti2": "", "ti3": ""}, "variables_p": {"dag_id": [["int", 0.3245352945578084], ["List[int]", 0.2605460696386551], ["list", 0.2569897771209679], ["range", 0.15792885868256853]], "dag_run": [["dict", 0.10391147062628582], ["list", 0.08755599719827094]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "op1": [["Dict[str, Union[Any, bool, str]]", 0.2862029972596688], ["list", 0.15157419962817292], ["int", 0.10335889361077487], ["Dict[str, Optional[str]]", 0.09219524855268763]], "op2": [["Dict[str, Union[Any, bool, str]]", 0.2862029972596688], ["list", 0.15157419962817292], ["int", 0.10335889361077487], ["Dict[str, Optional[str]]", 0.09219524855268763]], "op3": [["Dict[str, Union[Any, bool, str]]", 0.2862029972596688], ["list", 0.15157419962817292], ["int", 0.10335889361077487], ["Dict[str, Optional[str]]", 0.09219524855268763]], "res": [["Type[bytes]", 0.29164664440028454], ["Union[Literal, Literal]", 0.11714899817607977], ["List[str]", 0.10128469520117708], ["Type[str]", 0.09721554813342818], ["Type[int]", 0.09721554813342818]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["sqlalchemy.orm.session.Session", 0.1985494972765594], ["sqlalchemy.orm.Session", 0.10237214865020362], ["kedro.framework.session.session.KedroSession", 0.10119380930879308], ["Dict[str, str]", 0.08831928165429315], ["Dict[str, Any]", 0.08831928165429315]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "ti1": [["int", 0.5628960144500454], ["str", 0.11261033769772319], ["List[Dict[str, str]]", 0.08897952206514399]], "ti2": [["geode.models.common.Address", 0.1091164915771353], ["float", 0.09806617189164284], ["List[str]", 0.09530403565578083]], "ti3": [["geode.models.common.Address", 0.1091164915771353], ["float", 0.09806617189164284], ["List[str]", 0.09530403565578083]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[763, 4], [789, 26]], "fn_var_ln": {"dag_id_1": [[764, 8], [764, 16]], "dag_id_2": [[765, 8], [765, 16]], "dr1": [[776, 8], [776, 11]], "dr2": [[774, 8], [774, 11]], "job_runner": [[778, 8], [778, 23]], "res": [[786, 8], [786, 11]], "scheduler_job": [[777, 8], [777, 21]], "session": [[767, 8], [767, 15]], "state": [[782, 12], [782, 20]], "task_id": [[766, 8], [766, 15]], "tis": [[780, 8], [780, 11]]}, "fn_var_occur": {"dag_id_1": [["dag_maker", "dag_id", "dag_id_1", "max_active_tasks", "session", "session"]], "dag_id_2": [["dag_maker", "dag_id", "dag_id_2", "max_active_tasks", "session", "session"]], "dr1": [["dr1", "dag_maker", "create_dagrun"], ["dr1", "session", "merge", "dr1", "load", "False"], ["tis", "dr1", "task_instances", "dr2", "task_instances"]], "dr2": [["dr2", "dag_maker", "create_dagrun", "execution_date", "DEFAULT_DATE", "timedelta", "hours"], ["tis", "dr1", "task_instances", "dr2", "task_instances"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["ti", "key", "ti", "res", "tis", "key"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["dag_maker", "dag_id", "dag_id_1", "max_active_tasks", "session", "session"], ["dag_maker", "dag_id", "dag_id_2", "max_active_tasks", "session", "session"], ["dr1", "session", "merge", "dr1", "load", "False"], ["session", "merge", "ti"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "flush"], ["session", "rollback"]], "state": [["ti", "state", "State", "SCHEDULED"]], "task_id": [["EmptyOperator", "task_id", "task_id", "priority_weight"], ["EmptyOperator", "task_id", "task_id", "priority_weight"]], "tis": [["tis", "dr1", "task_instances", "dr2", "task_instances"], ["ti", "key", "ti", "res", "tis", "key"]]}, "name": "test_find_executable_task_instances_order_execution_date_and_priority", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id_1", "max_active_tasks", "session", "session"], ["dr1", "dag_maker", "create_dagrun"], ["dag_maker", "dag_id", "dag_id_2", "max_active_tasks", "session", "session"], ["dr2", "dag_maker", "create_dagrun", "execution_date", "DEFAULT_DATE", "timedelta", "hours"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["raiden.utils.Address", 0.104669948166665], ["int", 0.09388454838290818]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_order_execution_date_and_priority", "ret_exprs": [], "ret_type": "", "variables": {"dag_id_1": "", "dag_id_2": "", "dr1": "", "dr2": "", "job_runner": "", "res": "", "scheduler_job": "", "session": "", "state": "", "task_id": "", "tis": ""}, "variables_p": {"dag_id_1": [["int", 0.3841096539340305], ["Type[Tuple[str, Any]]", 0.18832209865183502], ["Tuple[int]", 0.14339914388523387]], "dag_id_2": [["int", 0.3841096539340305], ["Type[Tuple[str, Any]]", 0.18832209865183502], ["Tuple[int]", 0.14339914388523387]], "dr1": [["str", 0.33623332123181277], ["float", 0.130427291261686], ["geode.models.common.Address", 0.11079597624814204]], "dr2": [["datetime.datetime", 0.16729535987292246], ["Dict[str, Any]", 0.08618062918283084], ["Optional[hpaction.models.HPActionDocuments]", 0.07648146957425082], ["datetime.timedelta", 0.07647696743222772], ["str", 0.07497704414615967], ["list", 0.07090681584143975], ["int", 0.06290633686889224]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "res": [["str", 0.20328485230206372], ["dict", 0.19006521139793725], ["Dict[str, Type[Any]]", 0.1124490600198634], ["Optional[str]", 0.0905560951703642], ["Dict[str, Union[Any, Any, Any, Any]]", 0.089594476279715], ["list", 0.08706831623202105]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["dict", 0.2509649573493128], ["unittesmock.MagicMock", 0.20586712475929692], ["legistar.models.MatterStatus", 0.11081465701647229], ["Dict[str, str]", 0.08779519290903842], ["Dict[str, object]", 0.08763004276961686], ["raiden.transfer.state.HopState", 0.07646428229719454]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task_id": [["str", 0.3237679181950004], ["int", 0.2555797891477004], ["list", 0.10449506192762069], ["List[str]", 0.09045213965223256], ["cmk.utils.type_defs.UserId", 0.08113891473858902]], "tis": [["Dict[str, Union[float, str]]", 0.17634679153726557], ["unittesmock.MagicMock", 0.13257892226984644], ["dict", 0.11177307493968483], ["pydynasync.models.Changes", 0.09766683125579231]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[791, 4], [825, 23]], "fn_var_ln": {"dag_id": [[794, 8], [794, 14]], "dr1": [[803, 8], [803, 11]], "dr2": [[804, 8], [804, 11]], "job_runner": [[799, 8], [799, 23]], "op1": [[796, 12], [796, 15]], "op2": [[797, 12], [797, 15]], "res": [[821, 8], [821, 11]], "scheduler_job": [[798, 8], [798, 21]], "session": [[801, 8], [801, 15]], "state": [[817, 8], [817, 17]], "ti1": [[806, 8], [806, 11]], "ti2": [[807, 8], [807, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED", "state", "State", "RUNNING"], ["ti1", "dr1", "get_task_instance", "op1", "task_id", "session"]], "dr2": [["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED", "state", "State", "RUNNING"], ["ti2", "dr2", "get_task_instance", "op2", "task_id", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull", "num_runs"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "op1": [["op1", "EmptyOperator", "task_id"], ["ti1", "dr1", "get_task_instance", "op1", "task_id", "session"]], "op2": [["op2", "EmptyOperator", "task_id"], ["ti2", "dr2", "get_task_instance", "op2", "task_id", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"]], "scheduler_job": [["scheduler_job", "Job", "executor", "MockExecutor"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull", "num_runs"]], "session": [["session", "settings", "Session"], ["ti1", "dr1", "get_task_instance", "op1", "task_id", "session"], ["ti2", "dr2", "get_task_instance", "op2", "task_id", "session"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "rollback"], ["session", "close"]], "state": [["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED", "state", "State", "RUNNING"], ["ti1", "state", "State", "SCHEDULED"], ["ti2", "state", "State", "SCHEDULED"], ["ti2", "state", "State", "RUNNING"]], "ti1": [["ti1", "dr1", "get_task_instance", "op1", "task_id", "session"], ["ti1", "state", "State", "SCHEDULED"]], "ti2": [["ti2", "dr2", "get_task_instance", "op2", "task_id", "session"], ["ti2", "state", "State", "SCHEDULED"], ["ti2", "state", "State", "RUNNING"]]}, "name": "test_find_executable_task_instances_in_default_pool", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED", "state", "State", "RUNNING"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull", "num_runs"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_in_default_pool", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "dr2": "", "job_runner": "", "op1": "", "op2": "", "res": "", "scheduler_job": "", "session": "", "state": "", "ti1": "", "ti2": ""}, "variables_p": {"dag_id": [["Set[str]", 0.9999999997063854], ["int", 1.3721455947465137e-10], ["str", 6.953826511577719e-11]], "dr1": [["str", 0.681251074607625], ["Set[str]", 0.11617581937022295], ["List[str]", 0.09946341575061407]], "dr2": [["str", 0.9999999999999999]], "job_runner": [["Dict[int, Any]", 0.19256203503056935], ["bytearray", 0.11378208521948092], ["Dict[str, str]", 0.09981055808508117], ["Sequence[str]", 0.09710133974268445], ["str", 0.09521985250390791], ["float", 0.09223448413698002], ["dict", 0.08904484012023277]], "op1": [["int", 0.23088969403450632], ["Dict[str, str]", 0.10539161709278401], ["legistar.models.MatterStatus", 0.06875963896387632], ["List[List[int]]", 0.06773563158218511]], "op2": [["int", 0.23088969403450632], ["Dict[str, str]", 0.10539161709278401], ["legistar.models.MatterStatus", 0.06875963896387632], ["List[List[int]]", 0.06773563158218511]], "res": [["dict", 0.29526258431013624], ["Tuple[str, str, str, str, str]", 0.11602606470975585], ["List[str]", 0.11546440897274018], ["str", 0.10892818528036818], ["Optional[str]", 0.09472515813338765], ["List[Tuple[str, int, int]]", 0.08961964015829142]], "scheduler_job": [["dict", 0.16917686498893153]], "session": [["Dict[str, Any]", 0.16716092098074414], ["Dict[str, str]", 0.08895453728447875], ["dict", 0.08358046049037207]], "state": [["str", 0.9023189363515858], ["int", 0.0976810636484142]], "ti1": [["geode.models.common.Address", 0.13820818073394958], ["str", 0.11997063689162411], ["Dict[int, str]", 0.111067539077412], ["asgard.models.app.AppStats", 0.08362710782671556], ["Optional[Dict[str, str]]", 0.08238998814479868], ["List[int]", 0.08124683857540263]], "ti2": [["geode.models.common.Address", 0.13820818073394958], ["str", 0.11997063689162411], ["Dict[int, str]", 0.111067539077412], ["asgard.models.app.AppStats", 0.08362710782671556], ["Optional[Dict[str, str]]", 0.08238998814479868], ["List[int]", 0.08124683857540263]]}}, {"docstring": {"func": "Check that task instances of missing DAGs are failed", "long_descr": null, "ret": null}, "fn_lc": [[827, 4], [855, 58]], "fn_var_ln": {"dag_id": [[829, 8], [829, 14]], "dr": [[843, 8], [843, 10]], "job_runner": [[838, 8], [838, 23]], "res": [[850, 8], [850, 11]], "scheduler_job": [[837, 8], [837, 21]], "state": [[847, 12], [847, 20]], "task_id_1": [[830, 8], [830, 17]], "task_id_2": [[831, 8], [831, 17]], "tis": [[853, 8], [853, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "session", "session", "default_args"]], "dr": [["dr", "dag_maker", "create_dagrun", "state", "DagRunState", "RUNNING"], ["tis", "dr", "task_instances"], ["tis", "dr", "get_task_instances", "session", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "mock", "MagicMock"], ["self", "job_runner", "dagbag", "get_dag", "return_value", "None"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "state": [["dr", "dag_maker", "create_dagrun", "state", "DagRunState", "RUNNING"], ["ti", "state", "State", "SCHEDULED"], ["all", "ti", "state", "State", "FAILED", "ti", "tis"]], "task_id_1": [["EmptyOperator", "task_id", "task_id_1"]], "task_id_2": [["EmptyOperator", "task_id", "task_id_2"]], "tis": [["tis", "dr", "task_instances"], ["tis", "dr", "get_task_instances", "session", "session"], ["len", "tis"], ["all", "ti", "state", "State", "FAILED", "ti", "tis"]]}, "name": "test_queued_task_instances_fails_with_missing_dag", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "session", "session", "default_args"], ["dr", "dag_maker", "create_dagrun", "state", "DagRunState", "RUNNING"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "mock", "MagicMock"], ["self", "job_runner", "dagbag", "get_dag", "return_value", "None"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "session": [["dag_maker", "dag_id", "dag_id", "session", "session", "default_args"], ["session", "merge", "ti"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "flush"], ["tis", "dr", "get_task_instances", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["sqlalchemy.orm.session.Session", 0.25377661823944475], ["zerver.models.UserProfile", 0.1781652606938125], ["ajapaik.ajapaik.models.Profile", 0.09196080964299266], ["ajapaik.ajapaik_object_recognition.models.ObjectDetectionAnnotation", 0.09196080964299266], ["django.contrib.auth.models.User", 0.08391584910702178]], "kwargs": [], "self": [], "session": [["str", 0.17544505216255835], ["sqlalchemy.orm.session.Session", 0.17180228253701207], ["sqlalchemy.orm.Session", 0.09606141838734941], ["django.conf.settings.AUTH_USER_MODEL", 0.09239280366787914], ["grouper.models.user.User", 0.0878177695480342]]}, "q_name": "TestSchedulerJob.test_queued_task_instances_fails_with_missing_dag", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr": "", "job_runner": "", "res": "", "scheduler_job": "", "state": "", "task_id_1": "", "task_id_2": "", "tis": ""}, "variables_p": {"dag_id": [["int", 0.23640397204943026], ["Optional[str]", 0.10291794151796935], ["Pattern[Any]", 0.08283643808318199]], "dr": [["str", 0.4016900480622925], ["Type[str]", 0.21271857228969307], ["Dict[str, str]", 0.10389278842656417], ["Optional[List[Any]]", 0.09673369683407997], ["int", 0.09547012427925848], ["List[str]", 0.08949477010811169]], "job_runner": [["Dict[str, Union[Any, str]]", 0.29878551747953186], ["Dict[str, Dict[str, str]]", 0.2561111296076921], ["Dict[str, dict]", 0.24723169777695805], ["Dict[Any, Tuple[Any, Any]]", 0.1077846428876792], ["Dict[Tuple[Any, str], str]", 0.09008701224813871]], "res": [["Type[bytes]", 0.29576978403338117], ["str", 0.185586268259803], ["Optional[str]", 0.12032931326332398], ["List[str]", 0.10221106102140093]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "state": [["str", 0.8078210623317339], ["Dict[str, Dict[str, str]]", 0.1060535804075289], ["int", 0.08612535726073732]], "task_id_1": [["str", 0.694840659685026], ["set", 0.1363810265279712], ["Set[str]", 0.08666639891407141], ["int", 0.08211191487293125]], "task_id_2": [["str", 0.694840659685026], ["set", 0.1363810265279712], ["Set[str]", 0.08666639891407141], ["int", 0.08211191487293125]], "tis": [["int", 0.28869421840358667], ["dict", 0.19599294998344396], ["set", 0.11509119552811395], ["list", 0.08741571121717619], ["DefaultDict[Any, List[Any]]", 0.08735637625000486]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[857, 4], [876, 26]], "fn_var_ln": {"dag_id": [[858, 8], [858, 14]], "dr": [[866, 8], [866, 10]], "job_runner": [[863, 8], [863, 23]], "res": [[873, 8], [873, 11]], "scheduler_job": [[862, 8], [862, 21]], "session": [[864, 8], [864, 15]], "state": [[869, 8], [869, 16]], "ti": [[868, 8], [868, 10]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "max_active_tasks"]], "dr": [["dr", "dag_maker", "create_dagrun"], ["ti", "dr", "task_instances"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti"], ["session", "commit"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "flush"], ["session", "rollback"]], "state": [["ti", "state", "State", "SCHEDULED"]], "ti": [["ti", "dr", "task_instances"], ["ti", "state", "State", "SCHEDULED"], ["session", "merge", "ti"]]}, "name": "test_nonexistent_pool", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "max_active_tasks"], ["dr", "dag_maker", "create_dagrun"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.09800732979047799], ["core.models.Grouping", 0.08944135799641645]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_nonexistent_pool", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr": "", "job_runner": "", "res": "", "scheduler_job": "", "session": "", "state": "", "ti": ""}, "variables_p": {"dag_id": [["int", 0.3245352945578084], ["List[int]", 0.2605460696386551], ["list", 0.2569897771209679], ["range", 0.15792885868256853]], "dr": [["str", 0.19102769262823638], ["int", 0.17162166477055174], ["bytes", 0.13147271979782202], ["bool", 0.10824312554182834], ["dict", 0.10110987431707087], ["list", 0.0800386718608339]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "res": [["Type[bytes]", 0.29576978403338117], ["str", 0.185586268259803], ["Optional[str]", 0.12032931326332398], ["List[str]", 0.10221106102140093]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["sqlalchemy.orm.session.Session", 0.30541803199773737], ["kedro.framework.session.session.KedroSession", 0.10683735858196809]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "ti": [["str", 0.49468490664783743], ["int", 0.10373076711841674], ["bool", 0.09870682025613552]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[878, 4], [898, 26]], "fn_var_ln": {"dag_id": [[879, 8], [879, 14]], "dr": [[887, 8], [887, 10]], "infinite_pool": [[891, 8], [891, 21]], "job_runner": [[884, 8], [884, 23]], "res": [[895, 8], [895, 11]], "scheduler_job": [[883, 8], [883, 21]], "session": [[885, 8], [885, 15]], "state": [[889, 8], [889, 16]], "ti": [[888, 8], [888, 10]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "concurrency"]], "dr": [["dr", "dag_maker", "create_dagrun"], ["ti", "dr", "task_instances"]], "infinite_pool": [["infinite_pool", "Pool", "pool", "slots", "description"], ["session", "add", "infinite_pool"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti"], ["session", "add", "infinite_pool"], ["session", "commit"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "flush"], ["session", "rollback"]], "state": [["ti", "state", "State", "SCHEDULED"]], "ti": [["ti", "dr", "task_instances"], ["ti", "state", "State", "SCHEDULED"], ["session", "merge", "ti"]]}, "name": "test_infinite_pool", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "concurrency"], ["dr", "dag_maker", "create_dagrun"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.08259566044759374]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_infinite_pool", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr": "", "infinite_pool": "", "job_runner": "", "res": "", "scheduler_job": "", "session": "", "state": "", "ti": ""}, "variables_p": {"dag_id": [["int", 0.5784179031930052], ["list", 0.1848914798641481], ["Set[str]", 0.07872132975991047]], "dr": [["str", 0.19102769262823638], ["int", 0.17162166477055174], ["bytes", 0.13147271979782202], ["bool", 0.10824312554182834], ["dict", 0.10110987431707087], ["list", 0.0800386718608339]], "infinite_pool": [["str", 0.29743912636588404], ["Tuple[Any, Any]", 0.1278985484571582]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "res": [["Type[bytes]", 0.29576978403338117], ["str", 0.185586268259803], ["Optional[str]", 0.12032931326332398], ["List[str]", 0.10221106102140093]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["sqlalchemy.orm.session.Session", 0.35208663797439166], ["kedro.framework.session.session.KedroSession", 0.08276683501654034]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "ti": [["str", 0.49468490664783743], ["int", 0.10373076711841674], ["bool", 0.09870682025613552]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[900, 4], [942, 26]], "fn_var_ln": {"dag_id": [[901, 8], [901, 14]], "dr": [[909, 8], [909, 10]], "job_runner": [[907, 8], [907, 23]], "scheduler_job": [[906, 8], [906, 21]], "session": [[908, 8], [908, 15]], "some_pool": [[916, 8], [916, 17]], "state": [[914, 8], [914, 16]], "ti": [[913, 8], [913, 10]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "concurrency"], ["session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag_id", "TaskInstance", "state", "State", "SCHEDULED", "count"], ["session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag_id", "TaskInstance", "state", "State", "QUEUED", "count"]], "dr": [["dr", "dag_maker", "create_dagrun"], ["ti", "dr", "task_instances"], ["ti", "dr", "task_instances"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti"], ["session", "merge", "ti"], ["session", "add", "some_pool"], ["session", "commit"], ["self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag_id", "TaskInstance", "state", "State", "SCHEDULED", "count"], ["session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag_id", "TaskInstance", "state", "State", "QUEUED", "count"], ["session", "flush"], ["session", "rollback"]], "some_pool": [["some_pool", "Pool", "pool", "slots", "description"], ["session", "add", "some_pool"]], "state": [["ti", "state", "State", "SCHEDULED"], ["ti", "state", "State", "SCHEDULED"], ["session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag_id", "TaskInstance", "state", "State", "SCHEDULED", "count"], ["session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag_id", "TaskInstance", "state", "State", "QUEUED", "count"]], "ti": [["ti", "dr", "task_instances"], ["ti", "state", "State", "SCHEDULED"], ["session", "merge", "ti"], ["ti", "dr", "task_instances"], ["ti", "state", "State", "SCHEDULED"], ["session", "merge", "ti"]]}, "name": "test_not_enough_pool_slots", "params": {"caplog": "", "dag_maker": "", "self": ""}, "params_descr": {"caplog": "", "dag_maker": "", "self": ""}, "params_occur": {"caplog": [["caplog", "at_level", "logging", "WARNING"], ["caplog", "text"]], "dag_maker": [["dag_maker", "dag_id", "dag_id", "concurrency"], ["dr", "dag_maker", "create_dagrun"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "caplog": [["tests.basilisp.helpers.CompileFn", 0.6865388842956376]], "dag_maker": [["int", 0.08259566044759374]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_not_enough_pool_slots", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr": "", "job_runner": "", "scheduler_job": "", "session": "", "some_pool": "", "state": "", "ti": ""}, "variables_p": {"dag_id": [["int", 0.5735027388225576], ["Type[Tuple[str, Any]]", 0.28238468902890346]], "dr": [["int", 0.18956402865661903], ["str", 0.184487931942745], ["dict", 0.12809143998425687], ["bytes", 0.12011468434797766], ["bool", 0.09858361795442906], ["Dict[int, Dict[str, Any]]", 0.08199106120511428]], "job_runner": [["Set[str]", 0.20229854225175853], ["Dict[str, Union[None, Any, str]]", 0.1374717065522021], ["Dict[str, Dict[str, str]]", 0.10946817350342801], ["Dict[str, Any]", 0.09374533236494696], ["dict", 0.09366360524508616], ["str", 0.08735312784988031], ["Dict[str, Sequence[Any]]", 0.08405903564220338]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["sqlalchemy.orm.session.Session", 0.47274757564976083], ["kedro.framework.session.session.KedroSession", 0.13047195762124295], ["Optional[str]", 0.09065151509819593]], "some_pool": [["Tuple[Any, Any]", 0.15462329599979815], ["List[Dict[str, str]]", 0.09101351823979201], ["list", 0.08752673057056293], ["str", 0.08732545620021245], ["abilian.core.models.subjects.User", 0.08666683570142286]], "state": [["zproc.state.state.State", 0.08909732026425533], ["Tuple[Literal, Literal]", 0.07916711948434181], ["raiden.utils.Any", 0.07604292789907124]], "ti": [["str", 0.5008753853572987], ["bool", 0.10146288616691193]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[944, 4], [955, 26]], "fn_var_ln": {"dag_id": [[945, 8], [945, 14]], "job_runner": [[951, 8], [951, 23]], "scheduler_job": [[950, 8], [950, 21]], "session": [[952, 8], [952, 15]], "task_id_1": [[946, 8], [946, 17]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "max_active_tasks"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["len", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["len", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "rollback"]], "task_id_1": [["EmptyOperator", "task_id", "task_id_1"]]}, "name": "test_find_executable_task_instances_none", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "max_active_tasks"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["len", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.0863085238181429]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_none", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "job_runner": "", "scheduler_job": "", "session": "", "task_id_1": ""}, "variables_p": {"dag_id": [["int", 0.3245352945578084], ["List[int]", 0.2605460696386551], ["list", 0.2569897771209679], ["range", 0.15792885868256853]], "job_runner": [["int", 0.30306018256815115], ["List[int]", 0.19562118135145606], ["set", 0.10654830995743857], ["Set[str]", 0.10654830995743857], ["list", 0.09370552163309778]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["Dict[str, Dict[str, int]]", 0.1133559796308541], ["dict", 0.10720125635903219], ["List[str]", 0.09662259291380415], ["list", 0.08361691279928728]], "task_id_1": [["str", 0.694840659685026], ["set", 0.1363810265279712], ["Set[str]", 0.08666639891407141], ["int", 0.08211191487293125]]}}, {"docstring": {"func": "This tests that tis from queued dagruns are not queued", "long_descr": null, "ret": null}, "fn_lc": [[957, 4], [985, 40]], "fn_var_ln": {"dag_id": [[961, 8], [961, 14]], "dr1": [[966, 8], [966, 11]], "dr2": [[967, 8], [967, 11]], "job_runner": [[969, 8], [969, 23]], "res": [[978, 8], [978, 11]], "scheduler_job": [[968, 8], [968, 21]], "session": [[970, 8], [970, 15]], "state": [[974, 8], [974, 17]], "task1": [[965, 12], [965, 17]], "task_id_1": [[962, 8], [962, 17]], "ti1": [[971, 8], [971, 11]], "ti2": [[972, 8], [972, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["ti1", "TaskInstance", "task1", "run_id", "dr1", "run_id"]], "dr2": [["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["ti2", "TaskInstance", "task1", "run_id", "dr2", "run_id"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["ti2", "key", "res", "key"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti1"], ["session", "merge", "ti2"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "state": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"], ["ti1", "state", "State", "SCHEDULED"], ["ti2", "state", "State", "SCHEDULED"], ["ti1", "state", "State", "SCHEDULED"], ["ti2", "state", "State", "QUEUED"]], "task1": [["task1", "EmptyOperator", "task_id", "task_id_1"], ["ti1", "TaskInstance", "task1", "run_id", "dr1", "run_id"], ["ti2", "TaskInstance", "task1", "run_id", "dr2", "run_id"]], "task_id_1": [["task1", "EmptyOperator", "task_id", "task_id_1"]], "ti1": [["ti1", "TaskInstance", "task1", "run_id", "dr1", "run_id"], ["ti1", "state", "State", "SCHEDULED"], ["session", "merge", "ti1"], ["ti1", "refresh_from_db"], ["ti1", "state", "State", "SCHEDULED"]], "ti2": [["ti2", "TaskInstance", "task1", "run_id", "dr2", "run_id"], ["ti2", "state", "State", "SCHEDULED"], ["session", "merge", "ti2"], ["ti2", "key", "res", "key"], ["ti2", "refresh_from_db"], ["ti2", "state", "State", "QUEUED"]]}, "name": "test_tis_for_queued_dagruns_are_not_run", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_tis_for_queued_dagruns_are_not_run", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "dr2": "", "job_runner": "", "res": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "task_id_1": "", "ti1": "", "ti2": ""}, "variables_p": {"dag_id": [["str", 0.9999999998710318], ["int", 1.078511434222292e-10]], "dr1": [["str", 0.3057481442275511], ["int", 0.20617658641168843], ["list", 0.1858427544048101], ["Dict[str, Union[int, str]]", 0.12334609146232423], ["Tuple[str, str, str, str, str, str, str]", 0.09084567470905663], ["Dict[str, Any]", 0.0880407487845695]], "dr2": [["str", 0.8715587201108896], ["List[str]", 0.1284412798891105]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "res": [["str", 0.21087214299719717], ["float", 0.1978947723499037], ["dict", 0.18898989699065755], ["List[str]", 0.12468788464655424], ["Tuple[Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal]", 0.1003440907793541], ["set", 0.08953777935967111], ["Any[Any]", 0.08767343287666216]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["sqlalchemy.orm.session.Session", 0.2824916462177737], ["kedro.framework.session.session.KedroSession", 0.16560069349375628], ["Optional[str]", 0.11835900398712162], ["unittesmock.MagicMock", 0.09314325450382913], ["SMSShell.models.session.Session", 0.08357814272127474]], "state": [["str", 0.6035191469514078], ["Type[catalog.models.Category]", 0.10733157435287678], ["Optional[str]", 0.09743801112157312]], "task1": [["str", 0.2836297370120155], ["Dict[str, str]", 0.18709655691557006], ["Dict[str, Union[Any, Any]]", 0.10046163028610158], ["Dict[str, Any]", 0.07766545055435323]], "task_id_1": [["str", 0.5264566963820929], ["set", 0.13100570258410138], ["int", 0.08427137950743863]], "ti1": [["int", 0.42772961243618346], ["str", 0.24975302971394742], ["Dict[int, str]", 0.12348623540724184], ["List[dict]", 0.10794078469661568], ["List[str]", 0.09109033774601155]], "ti2": [["pydynasync.models.Changes", 0.11930626824068252], ["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.07940315026779983], ["Optional[List[Any]]", 0.07895918143050229], ["List[Dict[str, str]]", 0.07664121169299602]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[987, 4], [1025, 26]], "fn_var_ln": {"dag_id": [[988, 8], [988, 14]], "dr1": [[996, 8], [996, 11]], "dr2": [[997, 8], [997, 11]], "dr3": [[998, 8], [998, 11]], "job_runner": [[994, 8], [994, 23]], "res": [[1022, 8], [1022, 11]], "res_keys": [[1015, 8], [1015, 16]], "scheduler_job": [[993, 8], [993, 21]], "session": [[989, 8], [989, 15]], "state": [[1018, 8], [1018, 17]], "ti1": [[1000, 8], [1000, 11]], "ti2": [[1001, 8], [1001, 11]], "ti3": [[1002, 8], [1002, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "max_active_tasks", "session", "session"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["ti1", "dr1", "task_instances"]], "dr2": [["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["dr3", "dag_maker", "create_dagrun_after", "dr2", "run_type", "DagRunType", "SCHEDULED"], ["ti2", "dr2", "task_instances"]], "dr3": [["dr3", "dag_maker", "create_dagrun_after", "dr2", "run_type", "DagRunType", "SCHEDULED"], ["ti3", "dr3", "task_instances"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["res_keys", "map", "x", "x", "key", "res"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"]], "res_keys": [["res_keys", "map", "x", "x", "key", "res"], ["ti2", "key", "res_keys"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["dag_maker", "dag_id", "dag_id", "max_active_tasks", "session", "session"], ["session", "merge", "ti1"], ["session", "merge", "ti2"], ["session", "merge", "ti3"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "merge", "ti2"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "rollback"]], "state": [["ti1", "state", "State", "RUNNING"], ["ti2", "state", "State", "SCHEDULED"], ["ti3", "state", "State", "SCHEDULED"], ["ti2", "state", "State", "RUNNING"]], "ti1": [["ti1", "dr1", "task_instances"], ["ti1", "state", "State", "RUNNING"], ["session", "merge", "ti1"]], "ti2": [["ti2", "dr2", "task_instances"], ["ti2", "state", "State", "SCHEDULED"], ["session", "merge", "ti2"], ["ti2", "key", "res_keys"], ["ti2", "state", "State", "RUNNING"], ["session", "merge", "ti2"]], "ti3": [["ti3", "dr3", "task_instances"], ["ti3", "state", "State", "SCHEDULED"], ["session", "merge", "ti3"]]}, "name": "test_find_executable_task_instances_concurrency", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "max_active_tasks", "session", "session"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["dr3", "dag_maker", "create_dagrun_after", "dr2", "run_type", "DagRunType", "SCHEDULED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_concurrency", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "dr2": "", "dr3": "", "job_runner": "", "res": "", "res_keys": "", "scheduler_job": "", "session": "", "state": "", "ti1": "", "ti2": "", "ti3": ""}, "variables_p": {"dag_id": [["int", 0.3841096539340305], ["Type[Tuple[str, Any]]", 0.18832209865183502], ["Tuple[int]", 0.14339914388523387]], "dr1": [["str", 0.681251074607625], ["Set[str]", 0.11617581937022295], ["List[str]", 0.09946341575061407]], "dr2": [["str", 0.6934718208248444], ["Dict[str, str]", 0.11173469734990611], ["List[str]", 0.10234468087672219], ["Set[str]", 0.09244880094852738]], "dr3": [["str", 0.7688339723525636], ["list", 0.08086376805804114], ["datetime.timedelta", 0.0767302546464838], ["dict", 0.07357200494291122]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "res": [["list", 0.11406040771379444], ["Tuple[Any, Any]", 0.10650781767966037], ["Dict[str, str]", 0.10613625997319015], ["str", 0.10336677041577873], ["List[str]", 0.096251752810531], ["Dict[str, Tuple[str, str]]", 0.09375420335276165], ["dict", 0.09375420335276165], ["List[Tuple[Any, str]]", 0.09251004337653312], ["Dict[str, int]", 0.09017815271868851]], "res_keys": [["str", 0.40651095948107785], ["Optional[str]", 0.12885661156165443], ["bytes", 0.09662382193904841], ["bool", 0.09255015826517927], ["Optional[int]", 0.09255015826517927], ["Dict[str, Any]", 0.09035813222268146]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["dict", 0.21702359746499975], ["unittesmock.MagicMock", 0.1499019864908795], ["Optional[str]", 0.07697489082600828], ["sqlalchemy.orm.session.Session", 0.06461235352587363], ["SMSShell.models.session.Session", 0.062159707688307815]], "state": [["str", 0.16614022144833834], ["Generator[Any, None, None]", 0.10565626038259482], ["Type[Dict[str, Any]]", 0.08394029931145731], ["int", 0.08127642996032079], ["Iterator[str]", 0.08016514786122955]], "ti1": [["int", 0.22561009616460795], ["str", 0.196225310849939], ["float", 0.19598145591815164], ["list", 0.09969341875679119]], "ti2": [["str", 0.8992356374741898], ["bool", 0.10076436252581032]], "ti3": [["str", 0.49468490664783743], ["int", 0.10373076711841674], ["bool", 0.09870682025613552]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1027, 4], [1057, 26]], "fn_var_ln": {"dag_id": [[1028, 8], [1028, 14]], "dag_run": [[1038, 8], [1038, 15]], "job_runner": [[1035, 8], [1035, 23]], "res": [[1053, 8], [1053, 11]], "scheduler_job": [[1034, 8], [1034, 21]], "session": [[1036, 8], [1036, 15]], "state": [[1045, 8], [1045, 17]], "task1": [[1030, 12], [1030, 17]], "task2": [[1031, 12], [1031, 17]], "task3": [[1032, 12], [1032, 17]], "ti1": [[1040, 8], [1040, 11]], "ti2": [[1041, 8], [1041, 11]], "ti3": [[1042, 8], [1042, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "max_active_tasks"]], "dag_run": [["dag_run", "dag_maker", "create_dagrun"], ["ti1", "dag_run", "get_task_instance", "task1", "task_id"], ["ti2", "dag_run", "get_task_instance", "task2", "task_id"], ["ti3", "dag_run", "get_task_instance", "task3", "task_id"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["res", "key", "ti3", "key"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti1"], ["session", "merge", "ti2"], ["session", "merge", "ti3"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "rollback"]], "state": [["ti1", "state", "State", "RUNNING"], ["ti2", "state", "State", "QUEUED"], ["ti3", "state", "State", "SCHEDULED"]], "task1": [["task1", "EmptyOperator", "task_id"], ["ti1", "dag_run", "get_task_instance", "task1", "task_id"]], "task2": [["task2", "EmptyOperator", "task_id"], ["ti2", "dag_run", "get_task_instance", "task2", "task_id"]], "task3": [["task3", "EmptyOperator", "task_id"], ["ti3", "dag_run", "get_task_instance", "task3", "task_id"]], "ti1": [["ti1", "dag_run", "get_task_instance", "task1", "task_id"], ["ti1", "state", "State", "RUNNING"], ["session", "merge", "ti1"]], "ti2": [["ti2", "dag_run", "get_task_instance", "task2", "task_id"], ["ti2", "state", "State", "QUEUED"], ["session", "merge", "ti2"]], "ti3": [["ti3", "dag_run", "get_task_instance", "task3", "task_id"], ["ti3", "state", "State", "SCHEDULED"], ["session", "merge", "ti3"], ["res", "key", "ti3", "key"]]}, "name": "test_find_executable_task_instances_concurrency_queued", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "max_active_tasks"], ["dag_run", "dag_maker", "create_dagrun"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["datasets.opencl.device_mapping.opencl_device_mapping_dataseOpenClDeviceMappingsDataset", 0.0862899692260758], ["int", 0.08275047086065798]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_concurrency_queued", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dag_run": "", "job_runner": "", "res": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "task2": "", "task3": "", "ti1": "", "ti2": "", "ti3": ""}, "variables_p": {"dag_id": [["int", 0.3245352945578084], ["List[int]", 0.2605460696386551], ["list", 0.2569897771209679], ["range", 0.15792885868256853]], "dag_run": [["int", 0.18661401173098574], ["bytes", 0.10087535054094764]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "res": [["float", 0.17312821301551173], ["str", 0.12560593900630496], ["List[str]", 0.1254972803079337], ["Dict[str, Tuple[float, float]]", 0.09984611276486911], ["dict", 0.0957996521957334], ["Dict[str, str]", 0.08697966028651816], ["Dict[str, Union[Any, int, str]]", 0.08631720041626095]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["sqlalchemy.orm.session.Session", 0.3666072518957969], ["Optional[str]", 0.13053435585483955], ["kedro.framework.session.session.KedroSession", 0.12873347399967242], ["unittesmock.MagicMock", 0.09353960315430368], ["SMSShell.models.session.Session", 0.08979747864511693]], "state": [["str", 0.16614022144833834], ["Generator[Any, None, None]", 0.10565626038259482], ["Type[Dict[str, Any]]", 0.08394029931145731], ["int", 0.08127642996032079], ["Iterator[str]", 0.08016514786122955]], "task1": [["Dict[Any, str]", 0.27857889104208783], ["list", 0.09362243687934976], ["dict", 0.09285963034736261]], "task2": [["Dict[Any, str]", 0.27857889104208783], ["list", 0.09362243687934976], ["dict", 0.09285963034736261]], "task3": [["Dict[Any, str]", 0.27857889104208783], ["list", 0.09362243687934976], ["dict", 0.09285963034736261]], "ti1": [["zerver.models.Realm", 0.1819664243337281], ["str", 0.08834934848941979], ["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.07485468988710167]], "ti2": [["zerver.models.Realm", 0.17863949758387354], ["str", 0.09576247234271192], ["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.08245358236110259], ["geode.models.common.Address", 0.0749725366688468]], "ti3": [["list", 0.10584777358532226], ["zerver.models.Realm", 0.10121180705084452], ["List[unittesmock.MagicMock]", 0.08556975030818952], ["tuple", 0.08480939193943517]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1060, 4], [1138, 26]], "fn_var_ln": {"dag_id": [[1061, 8], [1061, 14]], "dr1": [[1074, 8], [1074, 11]], "dr2": [[1075, 8], [1075, 11]], "dr3": [[1076, 8], [1076, 11]], "executor": [[1068, 8], [1068, 16]], "job_runner": [[1071, 8], [1071, 23]], "res": [[1135, 8], [1135, 11]], "scheduler_job": [[1070, 8], [1070, 21]], "session": [[1072, 8], [1072, 15]], "state": [[1129, 8], [1129, 19]], "task1": [[1065, 12], [1065, 17]], "task2": [[1066, 12], [1066, 17]], "task_id_1": [[1062, 8], [1062, 17]], "task_id_2": [[1063, 8], [1063, 17]], "ti1_1": [[1078, 8], [1078, 13]], "ti1_2": [[1093, 8], [1093, 13]], "ti1_3": [[1105, 8], [1105, 13]], "ti2": [[1079, 8], [1079, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "max_active_tasks"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["ti1_1", "dr1", "get_task_instance", "task1", "task_id"], ["ti2", "dr1", "get_task_instance", "task2", "task_id"]], "dr2": [["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["dr3", "dag_maker", "create_dagrun_after", "dr2", "run_type", "DagRunType", "SCHEDULED"], ["ti1_2", "dr2", "get_task_instance", "task1", "task_id"]], "dr3": [["dr3", "dag_maker", "create_dagrun_after", "dr2", "run_type", "DagRunType", "SCHEDULED"], ["ti1_3", "dr3", "get_task_instance", "task1", "task_id"]], "executor": [["executor", "MockExecutor", "do_update", "True"], ["scheduler_job", "Job", "executor", "executor"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"]], "scheduler_job": [["scheduler_job", "Job", "executor", "executor"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti1_1"], ["session", "merge", "ti2"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "merge", "ti1_1"], ["session", "merge", "ti2"], ["session", "merge", "ti1_2"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "merge", "ti1_2"], ["session", "merge", "ti1_3"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "merge", "ti1_1"], ["session", "merge", "ti1_2"], ["session", "merge", "ti1_3"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "merge", "ti1_1"], ["session", "merge", "ti1_2"], ["session", "merge", "ti1_3"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "rollback"]], "state": [["ti1_1", "state", "State", "SCHEDULED"], ["ti2", "state", "State", "SCHEDULED"], ["ti1_1", "state", "State", "RUNNING"], ["ti2", "state", "State", "RUNNING"], ["ti1_2", "state", "State", "SCHEDULED"], ["ti1_2", "state", "State", "RUNNING"], ["ti1_3", "state", "State", "SCHEDULED"], ["ti1_1", "state", "State", "SCHEDULED"], ["ti1_2", "state", "State", "SCHEDULED"], ["ti1_3", "state", "State", "SCHEDULED"], ["ti1_1", "state", "State", "RUNNING"], ["ti1_2", "state", "State", "SCHEDULED"], ["ti1_3", "state", "State", "SCHEDULED"]], "task1": [["task1", "EmptyOperator", "task_id", "task_id_1", "max_active_tis_per_dag"], ["ti1_1", "dr1", "get_task_instance", "task1", "task_id"], ["ti1_2", "dr2", "get_task_instance", "task1", "task_id"], ["ti1_3", "dr3", "get_task_instance", "task1", "task_id"]], "task2": [["task2", "EmptyOperator", "task_id", "task_id_2"], ["ti2", "dr1", "get_task_instance", "task2", "task_id"]], "task_id_1": [["task1", "EmptyOperator", "task_id", "task_id_1", "max_active_tis_per_dag"]], "task_id_2": [["task2", "EmptyOperator", "task_id", "task_id_2"]], "ti1_1": [["ti1_1", "dr1", "get_task_instance", "task1", "task_id"], ["ti1_1", "state", "State", "SCHEDULED"], ["session", "merge", "ti1_1"], ["ti1_1", "state", "State", "RUNNING"], ["session", "merge", "ti1_1"], ["ti1_1", "state", "State", "SCHEDULED"], ["session", "merge", "ti1_1"], ["ti1_1", "state", "State", "RUNNING"], ["session", "merge", "ti1_1"]], "ti1_2": [["ti1_2", "dr2", "get_task_instance", "task1", "task_id"], ["ti1_2", "state", "State", "SCHEDULED"], ["session", "merge", "ti1_2"], ["ti1_2", "state", "State", "RUNNING"], ["session", "merge", "ti1_2"], ["ti1_2", "state", "State", "SCHEDULED"], ["session", "merge", "ti1_2"], ["ti1_2", "state", "State", "SCHEDULED"], ["session", "merge", "ti1_2"]], "ti1_3": [["ti1_3", "dr3", "get_task_instance", "task1", "task_id"], ["ti1_3", "state", "State", "SCHEDULED"], ["session", "merge", "ti1_3"], ["ti1_3", "state", "State", "SCHEDULED"], ["session", "merge", "ti1_3"], ["ti1_3", "state", "State", "SCHEDULED"], ["session", "merge", "ti1_3"]], "ti2": [["ti2", "dr1", "get_task_instance", "task2", "task_id"], ["ti2", "state", "State", "SCHEDULED"], ["session", "merge", "ti2"], ["ti2", "state", "State", "RUNNING"], ["session", "merge", "ti2"]]}, "name": "test_find_executable_task_instances_max_active_tis_per_dag", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "max_active_tasks"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["dr3", "dag_maker", "create_dagrun_after", "dr2", "run_type", "DagRunType", "SCHEDULED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["core.models.Recipe", 0.10132577026664324], ["str", 0.09914590854621817]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_max_active_tis_per_dag", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "dr2": "", "dr3": "", "executor": "", "job_runner": "", "res": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "task2": "", "task_id_1": "", "task_id_2": "", "ti1_1": "", "ti1_2": "", "ti1_3": "", "ti2": ""}, "variables_p": {"dag_id": [["int", 0.3245352945578084], ["List[int]", 0.2605460696386551], ["list", 0.2569897771209679], ["range", 0.15792885868256853]], "dr1": [["str", 0.681251074607625], ["Set[str]", 0.11617581937022295], ["List[str]", 0.09946341575061407]], "dr2": [["str", 0.6934718208248444], ["Dict[str, str]", 0.11173469734990611], ["List[str]", 0.10234468087672219], ["Set[str]", 0.09244880094852738]], "dr3": [["str", 0.595822207837361], ["List[str]", 0.10864138454457452], ["Dict[str, str]", 0.10510119109574172], ["Dict[str, List[str]]", 0.09632970599862829]], "executor": [["Dict[str, None]", 0.24620247216516303], ["Dict[str, Union[bool, str]]", 0.12749942027614472], ["Dict[str, List[str]]", 0.11048193697903438], ["mock.MagicMock", 0.08885768942405606], ["unittesmock.MagicMock", 0.08378576573345009]], "job_runner": [["dict", 0.6701582669757242], ["Dict[Optional[str], Any]", 0.10382657421612093]], "res": [["dict", 0.29526258431013624], ["Tuple[str, str, str, str, str]", 0.11602606470975585], ["List[str]", 0.11546440897274018], ["str", 0.10892818528036818], ["Optional[str]", 0.09472515813338765], ["List[Tuple[str, int, int]]", 0.08961964015829142]], "scheduler_job": [["dict", 0.4699754736839022]], "session": [["sqlalchemy.orm.session.Session", 0.2824916462177737], ["kedro.framework.session.session.KedroSession", 0.16560069349375628], ["Optional[str]", 0.11835900398712162], ["unittesmock.MagicMock", 0.09314325450382913], ["SMSShell.models.session.Session", 0.08357814272127474]], "state": [["FlexioFlow.State.State", 0.20280167855261402]], "task1": [["Dict[str, Union[Any, bool, str]]", 0.2598014523175032], ["Dict[str, Union[Any, Any, str]]", 0.1970684752000842], ["str", 0.18378345311314598], ["List[List[int]]", 0.17511126210547476]], "task2": [["taskiapplication.models.task.Task", 0.10284049471446208], ["list", 0.0930972180487016]], "task_id_1": [["str", 0.6259008282963865], ["int", 0.09969315396154498]], "task_id_2": [["str", 0.5264566963820929], ["set", 0.13100570258410138], ["int", 0.08427137950743863]], "ti1_1": [["List[unittesmock.MagicMock]", 0.09086430931835791], ["Dict[str, Any]", 0.08887597311074982], ["golem.rpc.session.WebSocketAddress", 0.08695122854918808]], "ti1_2": [["List[unittesmock.MagicMock]", 0.09086430931835791], ["Dict[str, Any]", 0.08887597311074982], ["golem.rpc.session.WebSocketAddress", 0.08695122854918808]], "ti1_3": [["List[unittesmock.MagicMock]", 0.08908276889514476], ["Dict[str, Any]", 0.08881241872738649], ["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.08563882419532624]], "ti2": [["List[unittesmock.MagicMock]", 0.09086430931835791], ["Dict[str, Any]", 0.08887597311074982], ["golem.rpc.session.WebSocketAddress", 0.08695122854918808]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1140, 4], [1169, 26]], "fn_var_ln": {"dag_id": [[1141, 8], [1141, 14]], "dr1": [[1150, 8], [1150, 11]], "dr2": [[1151, 8], [1151, 11]], "dr3": [[1152, 8], [1152, 11]], "job_runner": [[1147, 8], [1147, 23]], "res": [[1166, 8], [1166, 11]], "scheduler_job": [[1146, 8], [1146, 21]], "session": [[1148, 8], [1148, 15]], "state": [[1159, 8], [1159, 17]], "task1": [[1144, 12], [1144, 17]], "task_id_1": [[1142, 8], [1142, 17]], "ti1": [[1154, 8], [1154, 11]], "ti2": [[1155, 8], [1155, 11]], "ti3": [[1156, 8], [1156, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "max_active_tasks"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["ti1", "dr1", "get_task_instance", "task1", "task_id"]], "dr2": [["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["dr3", "dag_maker", "create_dagrun_after", "dr2", "run_type", "DagRunType", "SCHEDULED"], ["ti2", "dr2", "get_task_instance", "task1", "task_id"]], "dr3": [["dr3", "dag_maker", "create_dagrun_after", "dr2", "run_type", "DagRunType", "SCHEDULED"], ["ti3", "dr3", "get_task_instance", "task1", "task_id"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti1"], ["session", "merge", "ti2"], ["session", "merge", "ti3"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "rollback"]], "state": [["ti1", "state", "State", "RUNNING"], ["ti2", "state", "State", "RUNNING"], ["ti3", "state", "State", "RUNNING"]], "task1": [["task1", "EmptyOperator", "task_id", "task_id_1"], ["ti1", "dr1", "get_task_instance", "task1", "task_id"], ["ti2", "dr2", "get_task_instance", "task1", "task_id"], ["ti3", "dr3", "get_task_instance", "task1", "task_id"]], "task_id_1": [["task1", "EmptyOperator", "task_id", "task_id_1"]], "ti1": [["ti1", "dr1", "get_task_instance", "task1", "task_id"], ["ti1", "state", "State", "RUNNING"], ["session", "merge", "ti1"]], "ti2": [["ti2", "dr2", "get_task_instance", "task1", "task_id"], ["ti2", "state", "State", "RUNNING"], ["session", "merge", "ti2"]], "ti3": [["ti3", "dr3", "get_task_instance", "task1", "task_id"], ["ti3", "state", "State", "RUNNING"], ["session", "merge", "ti3"]]}, "name": "test_change_state_for_executable_task_instances_no_tis_with_state", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "max_active_tasks"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["dr3", "dag_maker", "create_dagrun_after", "dr2", "run_type", "DagRunType", "SCHEDULED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["core.models.Recipe", 0.10006390269928844], ["str", 0.09873867075151528]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_change_state_for_executable_task_instances_no_tis_with_state", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "dr2": "", "dr3": "", "job_runner": "", "res": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "task_id_1": "", "ti1": "", "ti2": "", "ti3": ""}, "variables_p": {"dag_id": [["int", 0.3245352945578084], ["List[int]", 0.2605460696386551], ["list", 0.2569897771209679], ["range", 0.15792885868256853]], "dr1": [["str", 0.681251074607625], ["Set[str]", 0.11617581937022295], ["List[str]", 0.09946341575061407]], "dr2": [["str", 0.6934718208248444], ["Dict[str, str]", 0.11173469734990611], ["List[str]", 0.10234468087672219], ["Set[str]", 0.09244880094852738]], "dr3": [["str", 0.595822207837361], ["List[str]", 0.10864138454457452], ["Dict[str, str]", 0.10510119109574172], ["Dict[str, List[str]]", 0.09632970599862829]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "res": [["Type[bytes]", 0.29576978403338117], ["str", 0.185586268259803], ["Optional[str]", 0.12032931326332398], ["List[str]", 0.10221106102140093]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["sqlalchemy.orm.session.Session", 0.3666072518957969], ["Optional[str]", 0.13053435585483955], ["kedro.framework.session.session.KedroSession", 0.12873347399967242], ["unittesmock.MagicMock", 0.09353960315430368], ["SMSShell.models.session.Session", 0.08979747864511693]], "state": [["str", 0.3255955726526206], ["Packages.psutil.st3_linux_x32.psutil.Process", 0.09328749978767001], ["Optional[raiden.utils.TokenNetworkAddress]", 0.09091958827446991]], "task1": [["Dict[str, Union[Any, bool, str]]", 0.18644585537759312], ["Dict[str, Dict[str, int]]", 0.10403798943671184], ["List[str]", 0.1036189314257719], ["Dict[str, Union[Any, Any]]", 0.09864886169689671]], "task_id_1": [["str", 0.5264566963820929], ["set", 0.13100570258410138], ["int", 0.08427137950743863]], "ti1": [["str", 0.27496766831961555], ["raiden.utils.PaymentID", 0.09147554579320107], ["List[int]", 0.08714659701170745], ["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.08327262256961342]], "ti2": [["str", 0.27496766831961555], ["raiden.utils.PaymentID", 0.09147554579320107], ["List[int]", 0.08714659701170745], ["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.08327262256961342]], "ti3": [["str", 0.27496766831961555], ["raiden.utils.PaymentID", 0.09147554579320107], ["List[int]", 0.08714659701170745], ["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.08327262256961342]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1171, 4], [1197, 26]], "fn_var_ln": {"dag_id": [[1178, 8], [1178, 14]], "dr1": [[1183, 8], [1183, 11]], "job_runner": [[1175, 8], [1175, 23]], "op1": [[1180, 12], [1180, 15]], "op2": [[1181, 12], [1181, 15]], "res": [[1193, 8], [1193, 11]], "scheduler_job": [[1174, 8], [1174, 21]], "session": [[1176, 8], [1176, 15]], "state": [[1188, 8], [1188, 17]], "ti1": [[1185, 8], [1185, 11]], "ti2": [[1186, 8], [1186, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["ti1", "dr1", "get_task_instance", "op1", "task_id", "session"], ["ti2", "dr1", "get_task_instance", "op2", "task_id", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "op1": [["op1", "EmptyOperator", "task_id", "priority_weight", "pool_slots"], ["ti1", "dr1", "get_task_instance", "op1", "task_id", "session"]], "op2": [["op2", "EmptyOperator", "task_id", "priority_weight", "pool_slots"], ["ti2", "dr1", "get_task_instance", "op2", "task_id", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["res", "key", "ti2", "key"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["ti1", "dr1", "get_task_instance", "op1", "task_id", "session"], ["ti2", "dr1", "get_task_instance", "op2", "task_id", "session"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "rollback"]], "state": [["ti1", "state", "State", "SCHEDULED"], ["ti2", "state", "State", "SCHEDULED"]], "ti1": [["ti1", "dr1", "get_task_instance", "op1", "task_id", "session"], ["ti1", "state", "State", "SCHEDULED"]], "ti2": [["ti2", "dr1", "get_task_instance", "op2", "task_id", "session"], ["ti2", "state", "State", "SCHEDULED"], ["res", "key", "ti2", "key"]]}, "name": "test_find_executable_task_instances_not_enough_pool_slots_for_first", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["dict", 0.09026122012723699]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_not_enough_pool_slots_for_first", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "job_runner": "", "op1": "", "op2": "", "res": "", "scheduler_job": "", "session": "", "state": "", "ti1": "", "ti2": ""}, "variables_p": {"dag_id": [["Set[str]", 0.9999999997063854], ["int", 1.3721455947465137e-10], ["str", 6.953826511577719e-11]], "dr1": [["str", 0.3193744612210297], ["Optional[types.TracebackType]", 0.1212593364272098], ["dict", 0.09591253433123786], ["Dict[str, Dict[str, int]]", 0.08615427337492025], ["Dict[str, str]", 0.08512502058033311]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "op1": [["Dict[str, Union[Any, bool, str]]", 0.2862029972596688], ["list", 0.15157419962817292], ["int", 0.10335889361077487], ["Dict[str, Optional[str]]", 0.09219524855268763]], "op2": [["Dict[str, Union[Any, bool, str]]", 0.2862029972596688], ["list", 0.15157419962817292], ["int", 0.10335889361077487], ["Dict[str, Optional[str]]", 0.09219524855268763]], "res": [["float", 0.17312821301551173], ["str", 0.12560593900630496], ["List[str]", 0.1254972803079337], ["Dict[str, Tuple[float, float]]", 0.09984611276486911], ["dict", 0.0957996521957334], ["Dict[str, str]", 0.08697966028651816], ["Dict[str, Union[Any, int, str]]", 0.08631720041626095]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["Dict[str, Any]", 0.16716092098074414], ["Dict[str, str]", 0.08895453728447875], ["dict", 0.08358046049037207]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "ti1": [["geode.models.common.Address", 0.13820818073394958], ["str", 0.11997063689162411], ["Dict[int, str]", 0.111067539077412], ["asgard.models.app.AppStats", 0.08362710782671556], ["Optional[Dict[str, str]]", 0.08238998814479868], ["List[int]", 0.08124683857540263]], "ti2": [["geode.models.common.Address", 0.13696910474664897], ["float", 0.09804689872512608], ["golem.rpc.session.WebSocketAddress", 0.0969580547227679]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1199, 4], [1234, 26]], "fn_var_ln": {"dag_id_1": [[1204, 8], [1204, 16]], "dag_id_2": [[1207, 8], [1207, 16]], "dr1": [[1214, 8], [1214, 11]], "dr2": [[1218, 8], [1218, 11]], "job_runner": [[1201, 8], [1201, 23]], "op1a": [[1212, 12], [1212, 16]], "op1b": [[1213, 12], [1213, 16]], "op2": [[1217, 12], [1217, 15]], "res": [[1230, 8], [1230, 11]], "scheduler_job": [[1200, 8], [1200, 21]], "session": [[1202, 8], [1202, 15]], "state": [[1225, 8], [1225, 17]], "ti1a": [[1220, 8], [1220, 12]], "ti1b": [[1221, 8], [1221, 12]], "ti2": [[1222, 8], [1222, 11]]}, "fn_var_occur": {"dag_id_1": [["dag_maker", "dag_id", "dag_id_1", "max_active_tasks"]], "dag_id_2": [["dag_maker", "dag_id", "dag_id_2"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["ti1a", "dr1", "get_task_instance", "op1a", "task_id", "session"], ["ti1b", "dr1", "get_task_instance", "op1b", "task_id", "session"]], "dr2": [["dr2", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["ti2", "dr2", "get_task_instance", "op2", "task_id", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "op1a": [["op1a", "EmptyOperator", "task_id", "priority_weight"], ["ti1a", "dr1", "get_task_instance", "op1a", "task_id", "session"]], "op1b": [["op1b", "EmptyOperator", "task_id", "priority_weight"], ["ti1b", "dr1", "get_task_instance", "op1b", "task_id", "session"]], "op2": [["op2", "EmptyOperator", "task_id", "priority_weight"], ["ti2", "dr2", "get_task_instance", "op2", "task_id", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["res", "key", "ti2", "key"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["ti1a", "dr1", "get_task_instance", "op1a", "task_id", "session"], ["ti1b", "dr1", "get_task_instance", "op1b", "task_id", "session"], ["ti2", "dr2", "get_task_instance", "op2", "task_id", "session"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "rollback"]], "state": [["ti1a", "state", "State", "RUNNING"], ["ti1b", "state", "State", "SCHEDULED"], ["ti2", "state", "State", "SCHEDULED"]], "ti1a": [["ti1a", "dr1", "get_task_instance", "op1a", "task_id", "session"], ["ti1a", "state", "State", "RUNNING"]], "ti1b": [["ti1b", "dr1", "get_task_instance", "op1b", "task_id", "session"], ["ti1b", "state", "State", "SCHEDULED"]], "ti2": [["ti2", "dr2", "get_task_instance", "op2", "task_id", "session"], ["ti2", "state", "State", "SCHEDULED"], ["res", "key", "ti2", "key"]]}, "name": "test_find_executable_task_instances_not_enough_dag_concurrency_for_first", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id_1", "max_active_tasks"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dag_maker", "dag_id", "dag_id_2"], ["dr2", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["tests.basilisp.helpers.CompileFn", 0.13295998603916392], ["datetime.date.time", 0.10943439953806672]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_not_enough_dag_concurrency_for_first", "ret_exprs": [], "ret_type": "", "variables": {"dag_id_1": "", "dag_id_2": "", "dr1": "", "dr2": "", "job_runner": "", "op1a": "", "op1b": "", "op2": "", "res": "", "scheduler_job": "", "session": "", "state": "", "ti1a": "", "ti1b": "", "ti2": ""}, "variables_p": {"dag_id_1": [["int", 0.3245352945578084], ["List[int]", 0.2605460696386551], ["list", 0.2569897771209679], ["range", 0.15792885868256853]], "dag_id_2": [["Set[str]", 0.9999999997063854], ["int", 1.3721455947465137e-10], ["str", 6.953826511577719e-11]], "dr1": [["str", 0.3193744612210297], ["Optional[types.TracebackType]", 0.1212593364272098], ["dict", 0.09591253433123786], ["Dict[str, Dict[str, int]]", 0.08615427337492025], ["Dict[str, str]", 0.08512502058033311]], "dr2": [["str", 0.42147493072015874], ["Dict[str, Union[int, str]]", 0.09946027913403799], ["Set[str]", 0.09853803683909321], ["Optional[types.TracebackType]", 0.0960206684541944]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "op1a": [["dict", 0.20233914393007318], ["Dict[str, str]", 0.16222950434113245], ["legistar.models.MatterStatus", 0.09099753595067392], ["Dict[str, Optional[str]]", 0.09089681806987633]], "op1b": [["int", 0.1785311519863852], ["str", 0.17468536833016135], ["Dict[int, List[Any]]", 0.11835444714104863], ["set", 0.11543745619960002], ["dict", 0.11081122110503064], ["List[int]", 0.10647795293379524], ["Pattern[Any]", 0.09010245143349611]], "op2": [["Dict[str, Union[Any, bool, str]]", 0.2771540815533889], ["list", 0.1770577616472694], ["str", 0.16630272977752322], ["dict", 0.10331176302411413]], "res": [["float", 0.17312821301551173], ["str", 0.12560593900630496], ["List[str]", 0.1254972803079337], ["Dict[str, Tuple[float, float]]", 0.09984611276486911], ["dict", 0.0957996521957334], ["Dict[str, str]", 0.08697966028651816], ["Dict[str, Union[Any, int, str]]", 0.08631720041626095]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["Dict[str, str]", 0.2858197360197696], ["Dict[str, Dict[str, Any]]", 0.12700721255898295], ["services.shop.order.models.order_evenOrderEvent", 0.08928131137182152], ["List[str]", 0.08837529318631274]], "state": [["frozenset[Any]", 0.25963796039614606], ["Generator[Any, None, None]", 0.12520577621360504], ["cmk.gui.utils.html.HTML", 0.11954819080621977], ["List[Tuple[str, Any, Any]]", 0.10674177788944529]], "ti1a": [["str", 0.3354283666357456], ["int", 0.19944548375425886], ["Dict[str, int]", 0.09270265528279933], ["Pattern[Any]", 0.09013317966196888]], "ti1b": [["int", 0.39007721850246124], ["str", 0.2843826068275677], ["datetime.datetime", 0.12915883309538065], ["Dict[str, str]", 0.07941506599036628]], "ti2": [["geode.models.common.Address", 0.13696910474664897], ["float", 0.09804689872512608], ["golem.rpc.session.WebSocketAddress", 0.0969580547227679]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1236, 4], [1263, 26]], "fn_var_ln": {"dag_id": [[1241, 8], [1241, 14]], "dr1": [[1246, 8], [1246, 11]], "dr2": [[1247, 8], [1247, 11]], "job_runner": [[1238, 8], [1238, 23]], "op1a": [[1244, 12], [1244, 16]], "op1b": [[1245, 12], [1245, 16]], "res": [[1259, 8], [1259, 11]], "scheduler_job": [[1237, 8], [1237, 21]], "session": [[1239, 8], [1239, 15]], "state": [[1254, 8], [1254, 18]], "ti1a": [[1249, 8], [1249, 12]], "ti1b": [[1250, 8], [1250, 12]], "ti2a": [[1251, 8], [1251, 12]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["ti1a", "dr1", "get_task_instance", "op1a", "task_id", "session"], ["ti1b", "dr1", "get_task_instance", "op1b", "task_id", "session"]], "dr2": [["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["ti2a", "dr2", "get_task_instance", "op1a", "task_id", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "op1a": [["op1a", "EmptyOperator", "task_id", "priority_weight", "max_active_tis_per_dag"], ["ti1a", "dr1", "get_task_instance", "op1a", "task_id", "session"], ["ti2a", "dr2", "get_task_instance", "op1a", "task_id", "session"]], "op1b": [["op1b", "EmptyOperator", "task_id", "priority_weight"], ["ti1b", "dr1", "get_task_instance", "op1b", "task_id", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["res", "key", "ti1b", "key"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["ti1a", "dr1", "get_task_instance", "op1a", "task_id", "session"], ["ti1b", "dr1", "get_task_instance", "op1b", "task_id", "session"], ["ti2a", "dr2", "get_task_instance", "op1a", "task_id", "session"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "rollback"]], "state": [["ti1a", "state", "State", "RUNNING"], ["ti1b", "state", "State", "SCHEDULED"], ["ti2a", "state", "State", "SCHEDULED"]], "ti1a": [["ti1a", "dr1", "get_task_instance", "op1a", "task_id", "session"], ["ti1a", "state", "State", "RUNNING"]], "ti1b": [["ti1b", "dr1", "get_task_instance", "op1b", "task_id", "session"], ["ti1b", "state", "State", "SCHEDULED"], ["res", "key", "ti1b", "key"]], "ti2a": [["ti2a", "dr2", "get_task_instance", "op1a", "task_id", "session"], ["ti2a", "state", "State", "SCHEDULED"]]}, "name": "test_find_executable_task_instances_not_enough_task_concurrency_for_first", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_not_enough_task_concurrency_for_first", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "dr2": "", "job_runner": "", "op1a": "", "op1b": "", "res": "", "scheduler_job": "", "session": "", "state": "", "ti1a": "", "ti1b": "", "ti2a": ""}, "variables_p": {"dag_id": [["Set[str]", 0.9999999997063854], ["int", 1.3721455947465137e-10], ["str", 6.953826511577719e-11]], "dr1": [["str", 0.681251074607625], ["Set[str]", 0.11617581937022295], ["List[str]", 0.09946341575061407]], "dr2": [["str", 0.6023845104347644], ["List[str]", 0.10411144434429172], ["Set[str]", 0.10105702683759815], ["Dict[str, str]", 0.09804037561854786], ["Dict[str, List[str]]", 0.09440664276479761]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "op1a": [["str", 0.09015933637481537], ["int", 0.08729190157026495]], "op1b": [["int", 0.1785311519863852], ["str", 0.17468536833016135], ["Dict[int, List[Any]]", 0.11835444714104863], ["set", 0.11543745619960002], ["dict", 0.11081122110503064], ["List[int]", 0.10647795293379524], ["Pattern[Any]", 0.09010245143349611]], "res": [["Dict[str, Union[Any, int, str]]", 0.37508737029040407], ["float", 0.20425769290640147], ["List[str]", 0.12553353532133307], ["str", 0.10952910029452798], ["dict", 0.09317494356948192], ["Type[int]", 0.09241735761785136]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["Dict[str, str]", 0.2858197360197696], ["Dict[str, Dict[str, Any]]", 0.12700721255898295], ["services.shop.order.models.order_evenOrderEvent", 0.08928131137182152], ["List[str]", 0.08837529318631274]], "state": [["frozenset[Any]", 0.25963796039614606], ["Generator[Any, None, None]", 0.12520577621360504], ["cmk.gui.utils.html.HTML", 0.11954819080621977], ["List[Tuple[str, Any, Any]]", 0.10674177788944529]], "ti1a": [["str", 0.3354283666357456], ["int", 0.19944548375425886], ["Dict[str, int]", 0.09270265528279933], ["Pattern[Any]", 0.09013317966196888]], "ti1b": [["str", 0.2967829345022132], ["Dict[str, str]", 0.11299270178942354], ["datetime.datetime", 0.10930327415652681], ["Set[str]", 0.08423869539862386], ["int", 0.08253415167435332]], "ti2a": [["str", 0.3354283666357456], ["int", 0.19944548375425886], ["Dict[str, int]", 0.09270265528279933], ["Pattern[Any]", 0.09013317966196888]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1265, 4], [1292, 26]], "fn_var_ln": {"dag_id": [[1270, 8], [1270, 14]], "dr1": [[1275, 8], [1275, 11]], "dr2": [[1276, 8], [1276, 11]], "job_runner": [[1267, 8], [1267, 23]], "op1a": [[1273, 12], [1273, 16]], "op1b": [[1274, 12], [1274, 16]], "res": [[1288, 8], [1288, 11]], "scheduler_job": [[1266, 8], [1266, 21]], "session": [[1268, 8], [1268, 15]], "state": [[1283, 8], [1283, 18]], "ti1a": [[1278, 8], [1278, 12]], "ti1b": [[1279, 8], [1279, 12]], "ti2a": [[1280, 8], [1280, 12]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["ti1a", "dr1", "get_task_instance", "op1a", "task_id", "session"], ["ti1b", "dr1", "get_task_instance", "op1b", "task_id", "session"]], "dr2": [["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["ti2a", "dr2", "get_task_instance", "op1a", "task_id", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "op1a": [["op1a", "EmptyOperator", "task_id", "priority_weight", "max_active_tis_per_dagrun"], ["ti1a", "dr1", "get_task_instance", "op1a", "task_id", "session"], ["ti2a", "dr2", "get_task_instance", "op1a", "task_id", "session"]], "op1b": [["op1b", "EmptyOperator", "task_id", "priority_weight"], ["ti1b", "dr1", "get_task_instance", "op1b", "task_id", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["res", "key", "ti2a", "key"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["ti1a", "dr1", "get_task_instance", "op1a", "task_id", "session"], ["ti1b", "dr1", "get_task_instance", "op1b", "task_id", "session"], ["ti2a", "dr2", "get_task_instance", "op1a", "task_id", "session"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "rollback"]], "state": [["ti1a", "state", "State", "RUNNING"], ["ti1b", "state", "State", "SCHEDULED"], ["ti2a", "state", "State", "SCHEDULED"]], "ti1a": [["ti1a", "dr1", "get_task_instance", "op1a", "task_id", "session"], ["ti1a", "state", "State", "RUNNING"]], "ti1b": [["ti1b", "dr1", "get_task_instance", "op1b", "task_id", "session"], ["ti1b", "state", "State", "SCHEDULED"]], "ti2a": [["ti2a", "dr2", "get_task_instance", "op1a", "task_id", "session"], ["ti2a", "state", "State", "SCHEDULED"], ["res", "key", "ti2a", "key"]]}, "name": "test_find_executable_task_instances_task_concurrency_per_dagrun_for_first", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["dict", 0.08552765930204341]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_task_concurrency_per_dagrun_for_first", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "dr2": "", "job_runner": "", "op1a": "", "op1b": "", "res": "", "scheduler_job": "", "session": "", "state": "", "ti1a": "", "ti1b": "", "ti2a": ""}, "variables_p": {"dag_id": [["Set[str]", 0.9999999997063854], ["int", 1.3721455947465137e-10], ["str", 6.953826511577719e-11]], "dr1": [["str", 0.681251074607625], ["Set[str]", 0.11617581937022295], ["List[str]", 0.09946341575061407]], "dr2": [["str", 0.6023845104347644], ["List[str]", 0.10411144434429172], ["Set[str]", 0.10105702683759815], ["Dict[str, str]", 0.09804037561854786], ["Dict[str, List[str]]", 0.09440664276479761]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "op1a": [["str", 0.09015933637481537], ["int", 0.08729190157026495]], "op1b": [["int", 0.1785311519863852], ["str", 0.17468536833016135], ["Dict[int, List[Any]]", 0.11835444714104863], ["set", 0.11543745619960002], ["dict", 0.11081122110503064], ["List[int]", 0.10647795293379524], ["Pattern[Any]", 0.09010245143349611]], "res": [["float", 0.17312821301551173], ["str", 0.12560593900630496], ["List[str]", 0.1254972803079337], ["Dict[str, Tuple[float, float]]", 0.09984611276486911], ["dict", 0.0957996521957334], ["Dict[str, str]", 0.08697966028651816], ["Dict[str, Union[Any, int, str]]", 0.08631720041626095]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["Dict[str, str]", 0.2858197360197696], ["Dict[str, Dict[str, Any]]", 0.12700721255898295], ["services.shop.order.models.order_evenOrderEvent", 0.08928131137182152], ["List[str]", 0.08837529318631274]], "state": [["frozenset[Any]", 0.25963796039614606], ["Generator[Any, None, None]", 0.12520577621360504], ["cmk.gui.utils.html.HTML", 0.11954819080621977], ["List[Tuple[str, Any, Any]]", 0.10674177788944529]], "ti1a": [["str", 0.3354283666357456], ["int", 0.19944548375425886], ["Dict[str, int]", 0.09270265528279933], ["Pattern[Any]", 0.09013317966196888]], "ti1b": [["int", 0.39007721850246124], ["str", 0.2843826068275677], ["datetime.datetime", 0.12915883309538065], ["Dict[str, str]", 0.07941506599036628]], "ti2a": [["str", 0.30804926508493674], ["Pattern[Any]", 0.09725500943214482]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1294, 4], [1325, 26]], "fn_var_ln": {"dag_id": [[1299, 8], [1299, 14]], "dr": [[1309, 8], [1309, 10]], "job_runner": [[1296, 8], [1296, 23]], "op1a": [[1305, 12], [1305, 16]], "op1b": [[1308, 12], [1308, 16]], "res": [[1321, 8], [1321, 11]], "scheduler_job": [[1295, 8], [1295, 21]], "session": [[1297, 8], [1297, 15]], "state": [[1316, 8], [1316, 18]], "ti1a0": [[1311, 8], [1311, 13]], "ti1a1": [[1312, 8], [1312, 13]], "ti1b": [[1313, 8], [1313, 12]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id"]], "dr": [["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["ti1a0", "dr", "get_task_instance", "op1a", "task_id", "session", "map_index"], ["ti1a1", "dr", "get_task_instance", "op1a", "task_id", "session", "map_index"], ["ti1b", "dr", "get_task_instance", "op1b", "task_id", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "op1a": [["op1a", "EmptyOperator", "partial", "task_id", "priority_weight", "max_active_tis_per_dagrun", "expand_kwargs"], ["ti1a0", "dr", "get_task_instance", "op1a", "task_id", "session", "map_index"], ["ti1a1", "dr", "get_task_instance", "op1a", "task_id", "session", "map_index"]], "op1b": [["op1b", "EmptyOperator", "task_id", "priority_weight"], ["ti1b", "dr", "get_task_instance", "op1b", "task_id", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["res", "key", "ti1b", "key"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["ti1a0", "dr", "get_task_instance", "op1a", "task_id", "session", "map_index"], ["ti1a1", "dr", "get_task_instance", "op1a", "task_id", "session", "map_index"], ["ti1b", "dr", "get_task_instance", "op1b", "task_id", "session"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "rollback"]], "state": [["ti1a0", "state", "State", "RUNNING"], ["ti1a1", "state", "State", "SCHEDULED"], ["ti1b", "state", "State", "SCHEDULED"]], "ti1a0": [["ti1a0", "dr", "get_task_instance", "op1a", "task_id", "session", "map_index"], ["ti1a0", "state", "State", "RUNNING"]], "ti1a1": [["ti1a1", "dr", "get_task_instance", "op1a", "task_id", "session", "map_index"], ["ti1a1", "state", "State", "SCHEDULED"]], "ti1b": [["ti1b", "dr", "get_task_instance", "op1b", "task_id", "session"], ["ti1b", "state", "State", "SCHEDULED"], ["res", "key", "ti1b", "key"]]}, "name": "test_find_executable_task_instances_not_enough_task_concurrency_per_dagrun_for_first", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id"], ["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_not_enough_task_concurrency_per_dagrun_for_first", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr": "", "job_runner": "", "op1a": "", "op1b": "", "res": "", "scheduler_job": "", "session": "", "state": "", "ti1a0": "", "ti1a1": "", "ti1b": ""}, "variables_p": {"dag_id": [["Set[str]", 0.9999999997063854], ["int", 1.3721455947465137e-10], ["str", 6.953826511577719e-11]], "dr": [["str", 0.3193744612210297], ["Optional[types.TracebackType]", 0.1212593364272098], ["dict", 0.09591253433123786], ["Dict[str, Dict[str, int]]", 0.08615427337492025], ["Dict[str, str]", 0.08512502058033311]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "op1a": [["int", 0.31031048856822574], ["str", 0.2696670377714049], ["Dict[str, Dict[str, str]]", 0.09867952761965369], ["raiden.transfer.state.TransactionExecutionStatus", 0.08407867793090189]], "op1b": [["int", 0.1785311519863852], ["str", 0.17468536833016135], ["Dict[int, List[Any]]", 0.11835444714104863], ["set", 0.11543745619960002], ["dict", 0.11081122110503064], ["List[int]", 0.10647795293379524], ["Pattern[Any]", 0.09010245143349611]], "res": [["Dict[str, Union[Any, int, str]]", 0.37508737029040407], ["float", 0.20425769290640147], ["List[str]", 0.12553353532133307], ["str", 0.10952910029452798], ["dict", 0.09317494356948192], ["Type[int]", 0.09241735761785136]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["Dict[str, str]", 0.2975260373676781], ["Dict[str, Dict[str, Any]]", 0.11752362070541303], ["str", 0.09239270875303526], ["List[Tuple[str, str]]", 0.09239270875303526], ["Callable", 0.09239270875303526], ["dict", 0.09239270875303526]], "state": [["Tuple[Literal, Literal]", 0.39626473337950624], ["List[Tuple[Any, float]]", 0.34135302577576165], ["List[Tuple[int, str]]", 0.08444278405603661], ["List[int]", 0.08222792293641022]], "ti1a0": [["str", 0.3354283666357456], ["int", 0.19944548375425886], ["Dict[str, int]", 0.09270265528279933], ["Pattern[Any]", 0.09013317966196888]], "ti1a1": [["str", 0.3354283666357456], ["int", 0.19944548375425886], ["Dict[str, int]", 0.09270265528279933], ["Pattern[Any]", 0.09013317966196888]], "ti1b": [["str", 0.2967829345022132], ["Dict[str, str]", 0.11299270178942354], ["datetime.datetime", 0.10930327415652681], ["Set[str]", 0.08423869539862386], ["int", 0.08253415167435332]]}}, {"docstring": {"func": "Pools with negative open slots should not block other pools.", "long_descr": "Negative open slots can happen when reducing the number of total slots in a pool\nwhile tasks are running in that pool.", "ret": null}, "fn_lc": [[1327, 4], [1362, 26]], "fn_var_ln": {"dag_id": [[1345, 8], [1345, 14]], "dr1": [[1350, 8], [1350, 11]], "job_runner": [[1336, 8], [1336, 23]], "op1": [[1347, 12], [1347, 15]], "op2": [[1348, 12], [1348, 15]], "pool1": [[1339, 8], [1339, 13]], "pool2": [[1340, 8], [1340, 13]], "res": [[1358, 8], [1358, 11]], "scheduler_job": [[1335, 8], [1335, 21]], "session": [[1337, 8], [1337, 15]], "state": [[1355, 8], [1355, 17]], "ti1": [[1352, 8], [1352, 11]], "ti2": [[1353, 8], [1353, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["ti1", "dr1", "get_task_instance", "op1", "task_id", "session"], ["ti2", "dr1", "get_task_instance", "op2", "task_id", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "op1": [["op1", "EmptyOperator", "task_id", "pool"], ["ti1", "dr1", "get_task_instance", "op1", "task_id", "session"]], "op2": [["op2", "EmptyOperator", "task_id", "pool", "pool_slots"], ["ti2", "dr1", "get_task_instance", "op2", "task_id", "session"]], "pool1": [["pool1", "Pool", "pool", "slots"], ["session", "add", "pool1"]], "pool2": [["pool2", "Pool", "pool", "slots"], ["session", "add", "pool2"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["res", "key", "ti1", "key"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["session", "add", "pool1"], ["session", "add", "pool2"], ["ti1", "dr1", "get_task_instance", "op1", "task_id", "session"], ["ti2", "dr1", "get_task_instance", "op2", "task_id", "session"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "rollback"]], "state": [["ti1", "state", "State", "SCHEDULED"], ["ti2", "state", "State", "RUNNING"]], "ti1": [["ti1", "dr1", "get_task_instance", "op1", "task_id", "session"], ["ti1", "state", "State", "SCHEDULED"], ["res", "key", "ti1", "key"]], "ti2": [["ti2", "dr1", "get_task_instance", "op2", "task_id", "session"], ["ti2", "state", "State", "RUNNING"]]}, "name": "test_find_executable_task_instances_negative_open_pool_slots", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_executable_task_instances_negative_open_pool_slots", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "job_runner": "", "op1": "", "op2": "", "pool1": "", "pool2": "", "res": "", "scheduler_job": "", "session": "", "state": "", "ti1": "", "ti2": ""}, "variables_p": {"dag_id": [["Set[str]", 0.9999999997063854], ["int", 1.3721455947465137e-10], ["str", 6.953826511577719e-11]], "dr1": [["str", 0.3193744612210297], ["Optional[types.TracebackType]", 0.1212593364272098], ["dict", 0.09591253433123786], ["Dict[str, Dict[str, int]]", 0.08615427337492025], ["Dict[str, str]", 0.08512502058033311]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "op1": [["Dict[str, Union[Any, bool, str]]", 0.24205916779146477], ["int", 0.11273203860654403], ["str", 0.1005294804569856], ["dict", 0.0948434874641432], ["Dict[str, str]", 0.08564308511558386], ["Dict[str, Optional[str]]", 0.08457721132453445]], "op2": [["Dict[str, Union[Any, bool, str]]", 0.28202412092743046], ["list", 0.16920851540696083], ["dict", 0.10754987017923917], ["str", 0.08550174685084884], ["metaswitch_tinder.database.models.Request", 0.08148142744767434]], "pool1": [["str", 0.1931491470986433], ["DefaultDict[str, Set[str]]", 0.12160105290481399], ["Dict[None, None]", 0.10493290411675728], ["Set[int]", 0.10317265707166826], ["int", 0.09998187944042009], ["dict", 0.09571216414216588], ["list", 0.09536923922726434]], "pool2": [["str", 0.1931491470986433], ["DefaultDict[str, Set[str]]", 0.12160105290481399], ["Dict[None, None]", 0.10493290411675728], ["Set[int]", 0.10317265707166826], ["int", 0.09998187944042009], ["dict", 0.09571216414216588], ["list", 0.09536923922726434]], "res": [["float", 0.17312821301551173], ["str", 0.12560593900630496], ["List[str]", 0.1254972803079337], ["Dict[str, Tuple[float, float]]", 0.09984611276486911], ["dict", 0.0957996521957334], ["Dict[str, str]", 0.08697966028651816], ["Dict[str, Union[Any, int, str]]", 0.08631720041626095]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["sqlalchemy.orm.session.Session", 0.3727015586194263]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "ti1": [["geode.models.common.Address", 0.13696910474664897], ["float", 0.09804689872512608], ["golem.rpc.session.WebSocketAddress", 0.0969580547227679]], "ti2": [["geode.models.common.Address", 0.13820818073394958], ["str", 0.11997063689162411], ["Dict[int, str]", 0.111067539077412], ["asgard.models.app.AppStats", 0.08362710782671556], ["Optional[Dict[str, str]]", 0.08238998814479868], ["List[int]", 0.08124683857540263]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1365, 4], [1411, 23]], "fn_var_ln": {"dag_id": [[1370, 8], [1370, 14]], "dr": [[1374, 8], [1374, 10]], "job_runner": [[1367, 8], [1367, 23]], "op": [[1372, 12], [1372, 14]], "res": [[1398, 8], [1398, 11]], "scheduler_job": [[1366, 8], [1366, 21]], "session": [[1368, 8], [1368, 15]], "state": [[1377, 8], [1377, 16]], "ti": [[1376, 8], [1376, 10]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id"]], "dr": [["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["ti", "dr", "get_task_instance", "op", "task_id", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "op": [["op", "EmptyOperator", "task_id", "pool_slots"], ["ti", "dr", "get_task_instance", "op", "task_id", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "res"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["ti", "dr", "get_task_instance", "op", "task_id", "session"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "flush"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["session", "rollback"], ["session", "close"]], "state": [["ti", "state", "State", "SCHEDULED"]], "ti": [["ti", "dr", "get_task_instance", "op", "task_id", "session"], ["ti", "state", "State", "SCHEDULED"]]}, "name": "test_emit_pool_starving_tasks_metrics", "params": {"dag_maker": "", "mock_stats_gauge": "", "self": ""}, "params_descr": {"dag_maker": "", "mock_stats_gauge": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id"], ["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"]], "mock_stats_gauge": [["mock_stats_gauge", "assert_has_calls", "mock", "call", "mock", "call", "Pool", "DEFAULT_POOL_NAME", "mock", "call", "tags", "Pool", "DEFAULT_POOL_NAME", "any_order", "True"], ["mock_stats_gauge", "reset_mock"], ["mock_stats_gauge", "assert_has_calls", "mock", "call", "mock", "call", "Pool", "DEFAULT_POOL_NAME", "mock", "call", "tags", "Pool", "DEFAULT_POOL_NAME", "any_order", "True"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "mock_stats_gauge": [["unittesmock.MagicMock", 0.9999999999999999]], "self": []}, "q_name": "TestSchedulerJob.test_emit_pool_starving_tasks_metrics", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr": "", "job_runner": "", "op": "", "res": "", "scheduler_job": "", "session": "", "state": "", "ti": ""}, "variables_p": {"dag_id": [["Set[str]", 0.9999999997063854], ["int", 1.3721455947465137e-10], ["str", 6.953826511577719e-11]], "dr": [["str", 0.42147493072015874], ["Dict[str, Union[int, str]]", 0.09946027913403799], ["Set[str]", 0.09853803683909321], ["Optional[types.TracebackType]", 0.0960206684541944]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "op": [["Dict[str, Union[Any, bool, str]]", 0.2771540815533889], ["list", 0.1770577616472694], ["str", 0.16630272977752322], ["dict", 0.10331176302411413]], "res": [["dict", 0.29526258431013624], ["Tuple[str, str, str, str, str]", 0.11602606470975585], ["List[str]", 0.11546440897274018], ["str", 0.10892818528036818], ["Optional[str]", 0.09472515813338765], ["List[Tuple[str, int, int]]", 0.08961964015829142]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["kedro.framework.session.session.KedroSession", 0.116814810795421], ["Dict[str, Any]", 0.083841957619045], ["sqlalchemy.orm.session.Session", 0.07175196845090576]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "ti": [["geode.models.common.Address", 0.13820818073394958], ["str", 0.11997063689162411], ["Dict[int, str]", 0.111067539077412], ["asgard.models.app.AppStats", 0.08362710782671556], ["Optional[Dict[str, str]]", 0.08238998814479868], ["List[int]", 0.08124683857540263]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1413, 4], [1430, 26]], "fn_var_ln": {"dag_id": [[1414, 8], [1414, 14]], "dr1": [[1423, 8], [1423, 11]], "job_runner": [[1421, 8], [1421, 23]], "scheduler_job": [[1420, 8], [1420, 21]], "session": [[1416, 8], [1416, 15]], "task1": [[1418, 12], [1418, 17]], "task_id_1": [[1415, 8], [1415, 17]], "ti1": [[1424, 8], [1424, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "session", "session"]], "dr1": [["dr1", "dag_maker", "create_dagrun"], ["ti1", "dr1", "get_task_instance", "task1", "task_id", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_enqueue_task_instances_with_queued_state", "ti1", "session", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "session", "session"], ["ti1", "dr1", "get_task_instance", "task1", "task_id", "session"], ["self", "job_runner", "_enqueue_task_instances_with_queued_state", "ti1", "session", "session"], ["session", "rollback"]], "task1": [["task1", "EmptyOperator", "task_id", "task_id_1"], ["ti1", "dr1", "get_task_instance", "task1", "task_id", "session"]], "task_id_1": [["task1", "EmptyOperator", "task_id", "task_id_1"]], "ti1": [["ti1", "dr1", "get_task_instance", "task1", "task_id", "session"], ["self", "job_runner", "_enqueue_task_instances_with_queued_state", "ti1", "session", "session"]]}, "name": "test_enqueue_task_instances_with_queued_state", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "session", "session"], ["dr1", "dag_maker", "create_dagrun"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_enqueue_task_instances_with_queued_state", "ti1", "session", "session"]], "session": [["session", "settings", "Session"], ["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "session", "session"], ["ti1", "dr1", "get_task_instance", "task1", "task_id", "session"], ["self", "job_runner", "_enqueue_task_instances_with_queued_state", "ti1", "session", "session"], ["session", "rollback"]]}, "params_p": {"args": [], "dag_maker": [["ajapaik.ajapaik.models.Profile", 0.2152583367470362], ["ajapaik.ajapaik_object_recognition.models.ObjectDetectionAnnotation", 0.11772330558264882], ["ajapaik.ajapaik_face_recognition.models.FaceRecognitionRectangle", 0.09753503116438737], ["sqlalchemy.orm.Session", 0.09364869879296812], ["zam_repondeur.models.Dossier", 0.09358068920726506], ["str", 0.09211121127804474], ["grouper.models.user.User", 0.09211121127804474]], "kwargs": [], "self": [], "session": [["str", 0.35783896513663915], ["app.models.user.User.InDB", 0.13318800125971322], ["server.models.User", 0.09973250689525223], ["Optional[core.models.User]", 0.08214134714564233]]}, "q_name": "TestSchedulerJob.test_enqueue_task_instances_with_queued_state", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "job_runner": "", "scheduler_job": "", "session": "", "task1": "", "task_id_1": "", "ti1": ""}, "variables_p": {"dag_id": [["str", 0.2713704004945876], ["Optional[hpaction.models.UploadToken]", 0.08714619500952128], ["transfer.models.Order.ID", 0.08500834659772785], ["int", 0.08107555290920554]], "dr1": [["int", 0.4317857816526306], ["str", 0.30260989936807525], ["Dict[Any, str]", 0.09068392724938713], ["dict", 0.08950652571254554], ["bytes", 0.08541386601736146]], "job_runner": [["Set[str]", 0.19855455542793995], ["dict", 0.11308864973293746], ["Dict[str, Union[None, Any, str]]", 0.1114094289500019], ["Dict[str, Any]", 0.09791378386815042], ["Pattern[str]", 0.09692838147415846], ["float", 0.09473804541545071], ["Dict[str, str]", 0.09079290205545444]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["dict", 0.1003218230096741], ["bool", 0.09686089603070215], ["unittesmock.MagicMock", 0.09637505845280768], ["datetime.timedelta", 0.09409589558128256]], "task1": [["Dict[str, Union[Any, bool, str]]", 0.17550629805802673], ["taskiapplication.models.task.Task", 0.0972249975480175]], "task_id_1": [["str", 0.5264566963820929], ["set", 0.13100570258410138], ["int", 0.08427137950743863]], "ti1": [["str", 0.3047744535811741], ["pydynasync.models.Changes", 0.11208762893354796], ["dict", 0.10822274848958306], ["Dict[str, str]", 0.08711193311395282]]}}, {"docstring": {"func": "This tests that task instances whose dagrun is in finished state are not queued", "long_descr": null, "ret": null}, "fn_lc": [[1433, 4], [1455, 46]], "fn_var_ln": {"dag_id": [[1435, 8], [1435, 14]], "dr1": [[1444, 8], [1444, 11]], "job_runner": [[1442, 8], [1442, 23]], "scheduler_job": [[1441, 8], [1441, 21]], "session": [[1437, 8], [1437, 15]], "state": [[1446, 8], [1446, 16]], "task1": [[1439, 12], [1439, 17]], "task_id_1": [[1436, 8], [1436, 17]], "ti": [[1445, 8], [1445, 10]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "session", "session"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "state", "state"], ["ti", "dr1", "get_task_instance", "task1", "task_id", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_enqueue_task_instances_with_queued_state", "ti", "session", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "session", "session"], ["ti", "dr1", "get_task_instance", "task1", "task_id", "session"], ["session", "merge", "ti"], ["session", "commit"], ["self", "job_runner", "_enqueue_task_instances_with_queued_state", "ti", "session", "session"], ["session", "flush"], ["ti", "refresh_from_db", "session", "session"]], "state": [["dr1", "dag_maker", "create_dagrun", "state", "state"], ["ti", "state", "State", "SCHEDULED"], ["ti", "state", "State", "NONE"]], "task1": [["task1", "EmptyOperator", "task_id", "task_id_1"], ["ti", "dr1", "get_task_instance", "task1", "task_id", "session"]], "task_id_1": [["task1", "EmptyOperator", "task_id", "task_id_1"]], "ti": [["ti", "dr1", "get_task_instance", "task1", "task_id", "session"], ["ti", "state", "State", "SCHEDULED"], ["session", "merge", "ti"], ["self", "job_runner", "_enqueue_task_instances_with_queued_state", "ti", "session", "session"], ["ti", "refresh_from_db", "session", "session"], ["ti", "state", "State", "NONE"]]}, "name": "test_enqueue_task_instances_sets_ti_state_to_None_if_dagrun_in_finish_state", "params": {"dag_maker": "", "self": "", "state": ""}, "params_descr": {"dag_maker": "", "self": "", "state": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "session", "session"], ["dr1", "dag_maker", "create_dagrun", "state", "state"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_enqueue_task_instances_with_queued_state", "ti", "session", "session"]], "state": [["dr1", "dag_maker", "create_dagrun", "state", "state"], ["ti", "state", "State", "SCHEDULED"], ["ti", "state", "State", "NONE"]]}, "params_p": {"args": [], "dag_maker": [["asgard.models.accounAccount", 0.18312873574233923], ["raiden.utils.TokenNetworkAddress", 0.12334192246552626], ["Dict[str, Any]", 0.104269697313629], ["zerver.models.UserProfile", 0.09611487111826], ["asgard.models.user.User", 0.09229326761882037], ["models.Submission", 0.09103214347408696]], "kwargs": [], "self": [], "state": [["str", 0.28358939763780194], ["Callable", 0.17813574624339246], ["Optional[str]", 0.17154847058536635], ["bytes", 0.08617277142156017]]}, "q_name": "TestSchedulerJob.test_enqueue_task_instances_sets_ti_state_to_None_if_dagrun_in_finish_state", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "job_runner": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "task_id_1": "", "ti": ""}, "variables_p": {"dag_id": [["str", 0.2713704004945876], ["Optional[hpaction.models.UploadToken]", 0.08714619500952128], ["transfer.models.Order.ID", 0.08500834659772785], ["int", 0.08107555290920554]], "dr1": [["int", 0.4920107374413525], ["str", 0.2980161933760083], ["bool", 0.09285281778899705]], "job_runner": [["Set[str]", 0.19855455542793995], ["dict", 0.11308864973293746], ["Dict[str, Union[None, Any, str]]", 0.1114094289500019], ["Dict[str, Any]", 0.09791378386815042], ["Pattern[str]", 0.09692838147415846], ["float", 0.09473804541545071], ["Dict[str, str]", 0.09079290205545444]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["dict", 0.1003218230096741], ["bool", 0.09686089603070215], ["unittesmock.MagicMock", 0.09637505845280768], ["datetime.timedelta", 0.09409589558128256]], "state": [["str", 0.8544520379394431], ["list", 0.07330135838857758], ["Generator[str, None, None]", 0.07224660367197926]], "task1": [["Dict[str, Union[Any, bool, str]]", 0.17550629805802673], ["taskiapplication.models.task.Task", 0.0972249975480175]], "task_id_1": [["str", 0.5264566963820929], ["set", 0.13100570258410138], ["int", 0.08427137950743863]], "ti": [["str", 0.4386120308600553], ["bytes", 0.18260170342340842], ["Dict[str, Any]", 0.08482475921630649]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1457, 4], [1512, 23]], "fn_var_ln": {"dag_id": [[1458, 8], [1458, 14]], "dr1": [[1475, 8], [1475, 11]], "dr2": [[1489, 8], [1489, 11]], "job_runner": [[1471, 8], [1471, 23]], "res": [[1499, 8], [1499, 11]], "scheduler_job": [[1470, 8], [1470, 21]], "session": [[1461, 8], [1461, 15]], "state": [[1494, 8], [1494, 17]], "task1": [[1467, 12], [1467, 17]], "task2": [[1468, 12], [1468, 17]], "task_id_1": [[1459, 8], [1459, 17]], "task_id_2": [[1460, 8], [1460, 17]], "ti1": [[1477, 8], [1477, 11]], "ti2": [[1478, 8], [1478, 11]], "ti3": [[1490, 8], [1490, 11]], "ti4": [[1491, 8], [1491, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "max_active_tasks", "session", "session", "dag"], ["DAG", "get_num_task_instances", "dag_id", "task_ids", "dag", "task_ids", "states", "State", "RUNNING", "session", "session"], ["DAG", "get_num_task_instances", "dag_id", "task_ids", "dag", "task_ids", "states", "State", "RUNNING", "State", "QUEUED", "session", "session"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["ti1", "dr1", "get_task_instance", "task1", "task_id", "session"], ["ti2", "dr1", "get_task_instance", "task2", "task_id", "session"], ["State", "RUNNING", "dr1", "state"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"]], "dr2": [["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"], ["ti3", "dr2", "get_task_instance", "task1", "task_id", "session"], ["ti4", "dr2", "get_task_instance", "task2", "task_id", "session"], ["State", "RUNNING", "dr2", "state"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"]], "res": [["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["dag_maker", "dag_id", "dag_id", "max_active_tasks", "session", "session", "dag"], ["ti1", "dr1", "get_task_instance", "task1", "task_id", "session"], ["ti2", "dr1", "get_task_instance", "task2", "task_id", "session"], ["session", "flush"], ["DAG", "get_num_task_instances", "dag_id", "task_ids", "dag", "task_ids", "states", "State", "RUNNING", "session", "session"], ["ti3", "dr2", "get_task_instance", "task1", "task_id", "session"], ["ti4", "dr2", "get_task_instance", "task2", "task_id", "session"], ["session", "flush"], ["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"], ["DAG", "get_num_task_instances", "dag_id", "task_ids", "dag", "task_ids", "states", "State", "RUNNING", "State", "QUEUED", "session", "session"]], "state": [["ti1", "state", "State", "RUNNING"], ["ti2", "state", "State", "RUNNING"], ["State", "RUNNING", "dr1", "state"], ["ti3", "state", "State", "SCHEDULED"], ["ti4", "state", "State", "SCHEDULED"], ["State", "RUNNING", "dr2", "state"], ["State", "RUNNING", "ti1", "state"], ["State", "RUNNING", "ti2", "state"], ["State", "QUEUED", "State", "SCHEDULED", "ti3", "state", "ti4", "state"]], "task1": [["task1", "EmptyOperator", "task_id", "task_id_1"], ["ti1", "dr1", "get_task_instance", "task1", "task_id", "session"], ["ti3", "dr2", "get_task_instance", "task1", "task_id", "session"]], "task2": [["task2", "EmptyOperator", "task_id", "task_id_2"], ["ti2", "dr1", "get_task_instance", "task2", "task_id", "session"], ["ti4", "dr2", "get_task_instance", "task2", "task_id", "session"]], "task_id_1": [["task1", "EmptyOperator", "task_id", "task_id_1"]], "task_id_2": [["task2", "EmptyOperator", "task_id", "task_id_2"]], "ti1": [["ti1", "dr1", "get_task_instance", "task1", "task_id", "session"], ["ti1", "state", "State", "RUNNING"], ["ti1", "refresh_from_db"], ["State", "RUNNING", "ti1", "state"]], "ti2": [["ti2", "dr1", "get_task_instance", "task2", "task_id", "session"], ["ti2", "state", "State", "RUNNING"], ["ti2", "refresh_from_db"], ["State", "RUNNING", "ti2", "state"]], "ti3": [["ti3", "dr2", "get_task_instance", "task1", "task_id", "session"], ["ti3", "state", "State", "SCHEDULED"], ["ti3", "refresh_from_db"], ["State", "QUEUED", "State", "SCHEDULED", "ti3", "state", "ti4", "state"]], "ti4": [["ti4", "dr2", "get_task_instance", "task2", "task_id", "session"], ["ti4", "state", "State", "SCHEDULED"], ["ti4", "refresh_from_db"], ["State", "QUEUED", "State", "SCHEDULED", "ti3", "state", "ti4", "state"]]}, "name": "test_critical_section_enqueue_task_instances", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "max_active_tasks", "session", "session", "dag"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr2", "dag_maker", "create_dagrun_after", "dr1", "run_type", "DagRunType", "SCHEDULED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_critical_section_enqueue_task_instances", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "dr2": "", "job_runner": "", "res": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "task2": "", "task_id_1": "", "task_id_2": "", "ti1": "", "ti2": "", "ti3": "", "ti4": ""}, "variables_p": {"dag_id": [["int", 0.4125998796542921], ["str", 0.30772622091569524], ["Dict[str, str]", 0.1860585090578049]], "dr1": [["str", 0.22685202522099762], ["Optional[types.TracebackType]", 0.10856303432615551], ["dict", 0.10792154376928376], ["Dict[str, Dict[str, int]]", 0.09018334122157533], ["Dict[str, str]", 0.08746675561669712]], "dr2": [["dict", 0.18783738547538215], ["Dict[str, Any]", 0.11067147520569393], ["unittesmock.MagicMock", 0.10363507297690526], ["str", 0.09668140797574787]], "job_runner": [["dict", 0.4017845153740443], ["float", 0.1040577059302727], ["str", 0.09429446406437511]], "res": [["str", 0.7907995260908833], ["Dict[str, Union[int, str]]", 0.10672751199308775], ["Dict[str, Union[Any, Any, Any, Any]]", 0.10247296191602889]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["dict", 0.19339349729988337], ["unittesmock.MagicMock", 0.17756847178283325], ["legistar.models.MatterStatus", 0.10064392510470989], ["str", 0.09042184161574084], ["Dict[str, str]", 0.0869501206863643]], "state": [["str", 0.6285478913140308], ["List[str]", 0.09338363115161884], ["bytes", 0.09313815081218521]], "task1": [["taskiapplication.models.task.Task", 0.1517956062248858], ["str", 0.113654226187215], ["Dict[str, Union[Any, Any]]", 0.11134323883706998], ["List[str]", 0.09874829075993147]], "task2": [["taskiapplication.models.task.Task", 0.1517956062248858], ["str", 0.113654226187215], ["Dict[str, Union[Any, Any]]", 0.11134323883706998], ["List[str]", 0.09874829075993147]], "task_id_1": [["str", 0.5264566963820929], ["set", 0.13100570258410138], ["int", 0.08427137950743863]], "task_id_2": [["str", 0.5264566963820929], ["set", 0.13100570258410138], ["int", 0.08427137950743863]], "ti1": [["str", 0.8895406593675758]], "ti2": [["str", 0.8895406593675758]], "ti3": [["str", 0.9085861521153598]], "ti4": [["str", 0.9085861521153598]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1530, 8], [1539, 28]], "fn_var_ln": {"dagrun": [[1534, 16], [1534, 22]]}, "fn_var_occur": {"dagrun": [["dagrun", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "state", "State", "RUNNING"], ["dagrun", "dag_maker", "create_dagrun_after", "dagrun", "run_type", "DagRunType", "SCHEDULED", "state", "State", "RUNNING"]]}, "name": "_create_dagruns", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_execute_task_instances_limit.<locals>._create_dagruns", "ret_exprs": [], "ret_type": "", "variables": {"dagrun": ""}, "variables_p": {"dagrun": [["str", 0.22523630358035668], ["list", 0.1267413880347228], ["Optional[types.TracebackType]", 0.11848943838374797], ["int", 0.08345532685298009]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1514, 4], [1565, 43]], "fn_var_ln": {"dag_id": [[1515, 8], [1515, 14]], "job_runner": [[1528, 8], [1528, 23]], "max_tis_per_query": [[1552, 8], [1552, 39]], "res": [[1561, 8], [1561, 11]], "return_value": [[1556, 12], [1556, 35]], "scheduler_job": [[1527, 8], [1527, 21]], "session": [[1518, 8], [1518, 15]], "state": [[1546, 12], [1546, 21]], "task1": [[1524, 12], [1524, 17]], "task2": [[1525, 12], [1525, 17]], "task_id_1": [[1516, 8], [1516, 17]], "task_id_2": [[1517, 8], [1517, 17]], "ti1": [[1543, 12], [1543, 15]], "ti2": [[1544, 12], [1544, 15]], "tis": [[1541, 8], [1541, 11]]}, "fn_var_occur": {"dag_id": [], "job_runner": [["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"], ["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"], ["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"]], "max_tis_per_query": [["scheduler_job", "max_tis_per_query"], ["scheduler_job", "max_tis_per_query"]], "res": [["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"], ["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"], ["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"]], "return_value": [["mock_slots", "return_value"]], "scheduler_job": [["scheduler_job", "max_tis_per_query"], ["scheduler_job", "max_tis_per_query"], ["mock", "patch", "object", "type", "scheduler_job", "executor", "new_callable", "mock", "PropertyMock", "mock_slots"]], "session": [["ti1", "dr", "get_task_instance", "task1", "task_id", "session"], ["ti2", "dr", "get_task_instance", "task2", "task_id", "session"], ["session", "flush"], ["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"], ["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"], ["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"]], "state": [["ti1", "state", "State", "SCHEDULED"], ["ti2", "state", "State", "SCHEDULED"], ["State", "QUEUED", "ti", "state"]], "task1": [["ti1", "dr", "get_task_instance", "task1", "task_id", "session"]], "task2": [["ti2", "dr", "get_task_instance", "task2", "task_id", "session"]], "task_id_1": [], "task_id_2": [], "ti1": [["ti1", "dr", "get_task_instance", "task1", "task_id", "session"], ["ti1", "state", "State", "SCHEDULED"]], "ti2": [["ti2", "dr", "get_task_instance", "task2", "task_id", "session"], ["ti2", "state", "State", "SCHEDULED"]], "tis": []}, "name": "test_execute_task_instances_limit", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [], "self": [["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"], ["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"], ["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.6054891517526587], ["tests.basilisp.helpers.CompileFn", 0.19725542412367064], ["tests.async_mock.MagicMock", 0.09862771206183532]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_execute_task_instances_limit", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "job_runner": "", "max_tis_per_query": "", "res": "", "return_value": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "task2": "", "task_id_1": "", "task_id_2": "", "ti1": "", "ti2": "", "tis": ""}, "variables_p": {"dag_id": [["Optional[str]", 0.09999999999999999], ["int", 0.09999999999999999], ["List[int]", 0.09999999999999999], ["services.ticketing.transfer.models.TicketID", 0.09999999999999999], ["Type[models.User]", 0.09999999999999999], ["shop.transfer.models.ShopID", 0.09999999999999999], ["Type[pipeline.netfile.models.AbstractSchedule]", 0.09999999999999999]], "job_runner": [["str", 0.5152707915078056], ["list", 0.1854051501947355], ["Optional[str]", 0.09987174177665181]], "max_tis_per_query": [["int", 0.7263940584333457], ["float", 0.2062143736640642], ["List[List[int]]", 0.06739156790259003]], "res": [["str", 0.2896768023388693], ["list", 0.10398839531147047], ["Dict[Any, str]", 0.1032367170141349]], "return_value": [["Set[str]", 0.31968019372842504], ["str", 0.28974495331495453], ["list", 0.1978080233656786], ["int", 0.09819123429613609], ["List[str]", 0.09457559529480569]], "scheduler_job": [["str", 0.21214646390383046], ["Type[hansberger.analysis.models.analysis.MapperAnalysis]", 0.1905016839268838], ["int", 0.17685428883628002], ["Dict[int, int]", 0.10754364835285125], ["float", 0.08659712437892725]], "session": [["Dict[str, str]", 0.27424367444309633], ["kedro.framework.session.session.KedroSession", 0.12581307566959804], ["str", 0.11209713100998182]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task1": [["Dict[str, str]", 0.22468330021164143], ["kippo.tasks.models.KippoTask", 0.1405448036304461], ["str", 0.07251769318661494], ["dict", 0.06774107957390313]], "task2": [["Dict[str, str]", 0.22468330021164143], ["kippo.tasks.models.KippoTask", 0.1405448036304461], ["str", 0.07251769318661494], ["dict", 0.06774107957390313]], "task_id_1": [["str", 0.4], ["Type[bot_app.models.Products]", 0.1], ["medtagger.types.TaskID", 0.1], ["Type[str]", 0.1], ["Optional[str]", 0.1]], "task_id_2": [["str", 0.4], ["Type[bot_app.models.Products]", 0.1], ["medtagger.types.TaskID", 0.1], ["Type[str]", 0.1], ["Optional[str]", 0.1]], "ti1": [["str", 0.9085861521153598]], "ti2": [["str", 0.9085861521153598]], "tis": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1582, 8], [1591, 28]], "fn_var_ln": {"dagrun": [[1586, 16], [1586, 22]]}, "fn_var_occur": {"dagrun": [["dagrun", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "state", "State", "RUNNING"], ["dagrun", "dag_maker", "create_dagrun_after", "dagrun", "run_type", "DagRunType", "SCHEDULED", "state", "State", "RUNNING"]]}, "name": "_create_dagruns", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_execute_task_instances_unlimited.<locals>._create_dagruns", "ret_exprs": [], "ret_type": "", "variables": {"dagrun": ""}, "variables_p": {"dagrun": [["str", 0.22523630358035668], ["list", 0.1267413880347228], ["Optional[types.TracebackType]", 0.11848943838374797], ["int", 0.08345532685298009]]}}, {"docstring": {"func": "Test that max_tis_per_query=0 is unlimited", "long_descr": null, "ret": null}, "fn_lc": [[1567, 4], [1605, 26]], "fn_var_ln": {"dag_id": [[1570, 8], [1570, 14]], "executor": [[1600, 8], [1600, 30]], "job_runner": [[1580, 8], [1580, 23]], "max_tis_per_query": [[1599, 8], [1599, 39]], "res": [[1602, 8], [1602, 11]], "scheduler_job": [[1579, 8], [1579, 21]], "session": [[1573, 8], [1573, 15]], "state": [[1597, 12], [1597, 21]], "task1": [[1576, 12], [1576, 17]], "task2": [[1577, 12], [1577, 17]], "task_id_1": [[1571, 8], [1571, 17]], "task_id_2": [[1572, 8], [1572, 17]], "ti1": [[1594, 12], [1594, 15]], "ti2": [[1595, 12], [1595, 15]]}, "fn_var_occur": {"dag_id": [], "executor": [["scheduler_job", "executor", "MagicMock", "slots_available"]], "job_runner": [["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"]], "max_tis_per_query": [["scheduler_job", "max_tis_per_query"]], "res": [["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"]], "scheduler_job": [["scheduler_job", "max_tis_per_query"], ["scheduler_job", "executor", "MagicMock", "slots_available"]], "session": [["ti1", "dr", "get_task_instance", "task1", "task_id", "session"], ["ti2", "dr", "get_task_instance", "task2", "task_id", "session"], ["session", "flush"], ["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"], ["session", "rollback"]], "state": [["ti1", "state", "State", "SCHEDULED"], ["ti2", "state", "State", "SCHEDULED"]], "task1": [["ti1", "dr", "get_task_instance", "task1", "task_id", "session"]], "task2": [["ti2", "dr", "get_task_instance", "task2", "task_id", "session"]], "task_id_1": [], "task_id_2": [], "ti1": [["ti1", "dr", "get_task_instance", "task1", "task_id", "session"], ["ti1", "state", "State", "SCHEDULED"]], "ti2": [["ti2", "dr", "get_task_instance", "task2", "task_id", "session"], ["ti2", "state", "State", "SCHEDULED"]]}, "name": "test_execute_task_instances_unlimited", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [], "self": [["res", "self", "job_runner", "_critical_section_enqueue_task_instances", "session"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.6054891517526587], ["tests.basilisp.helpers.CompileFn", 0.19725542412367064], ["tests.async_mock.MagicMock", 0.09862771206183532]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_execute_task_instances_unlimited", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "executor": "", "job_runner": "", "max_tis_per_query": "", "res": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "task2": "", "task_id_1": "", "task_id_2": "", "ti1": "", "ti2": ""}, "variables_p": {"dag_id": [["Optional[str]", 0.09999999999999999], ["int", 0.09999999999999999], ["List[int]", 0.09999999999999999], ["services.ticketing.transfer.models.TicketID", 0.09999999999999999], ["Type[models.User]", 0.09999999999999999], ["shop.transfer.models.ShopID", 0.09999999999999999], ["Type[pipeline.netfile.models.AbstractSchedule]", 0.09999999999999999]], "executor": [["myia.utils.misc.Registry[Any, Any]", 0.4060295367557386], ["str", 0.0998192122269178], ["List[Dict[str, Any]]", 0.0995419100642916], ["List[str]", 0.09704689783001479]], "job_runner": [["str", 0.7239060321614146], ["datetime.datetime.timedelta", 0.09686373557052777], ["datetime.datetime.datetime", 0.09686373557052777], ["Dict[str, List[Any]]", 0.08236649669752974]], "max_tis_per_query": [["int", 0.7531855227892141], ["float", 0.2468144772107859]], "res": [["str", 0.7907995260908833], ["Dict[str, Union[int, str]]", 0.10672751199308775], ["Dict[str, Union[Any, Any, Any, Any]]", 0.10247296191602889]], "scheduler_job": [["int", 0.3381154467370398], ["float", 0.19162626684986972], ["List[str]", 0.09497157914197903], ["dict", 0.07820252543207647]], "session": [["Dict[str, str]", 0.27424367444309633], ["kedro.framework.session.session.KedroSession", 0.12581307566959804], ["str", 0.11209713100998182]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task1": [["Dict[str, str]", 0.22468330021164143], ["kippo.tasks.models.KippoTask", 0.1405448036304461], ["str", 0.07251769318661494], ["dict", 0.06774107957390313]], "task2": [["Dict[str, str]", 0.22468330021164143], ["kippo.tasks.models.KippoTask", 0.1405448036304461], ["str", 0.07251769318661494], ["dict", 0.06774107957390313]], "task_id_1": [["str", 0.4], ["Type[bot_app.models.Products]", 0.1], ["medtagger.types.TaskID", 0.1], ["Type[str]", 0.1], ["Optional[str]", 0.1]], "task_id_2": [["str", 0.4], ["Type[bot_app.models.Products]", 0.1], ["medtagger.types.TaskID", 0.1], ["Type[str]", 0.1], ["Optional[str]", 0.1]], "ti1": [["str", 0.9085861521153598]], "ti2": [["str", 0.9085861521153598]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1607, 4], [1637, 90]], "fn_var_ln": {"dr": [[1612, 8], [1612, 10]], "dr2": [[1613, 8], [1613, 11]], "job_runner": [[1629, 8], [1629, 23]], "op1": [[1610, 12], [1610, 15]], "processor": [[1626, 8], [1626, 17]], "scheduler_job": [[1628, 8], [1628, 21]], "session": [[1608, 8], [1608, 15]], "state": [[1623, 8], [1623, 17]], "ti": [[1633, 8], [1633, 10]], "ti2": [[1636, 8], [1636, 11]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun"], ["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"]], "dr2": [["dr2", "dag", "create_dagrun", "run_type", "DagRunType", "BACKFILL_JOB", "state", "State", "RUNNING", "execution_date", "DEFAULT_DATE", "datetime", "timedelta", "start_date", "DEFAULT_DATE", "session", "session"], ["ti2", "dr2", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["ti2", "dr2", "get_task_instance", "task_id", "op1", "task_id", "session", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "num_runs"], ["self", "job_runner", "processor_agent", "processor"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks"]], "op1": [["op1", "EmptyOperator", "task_id"], ["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["ti2", "dr2", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["ti2", "dr2", "get_task_instance", "task_id", "op1", "task_id", "session", "session"]], "processor": [["processor", "mock", "MagicMock"], ["self", "job_runner", "processor_agent", "processor"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "num_runs"]], "session": [["session", "settings", "Session"], ["dr2", "dag", "create_dagrun", "run_type", "DagRunType", "BACKFILL_JOB", "state", "State", "RUNNING", "execution_date", "DEFAULT_DATE", "datetime", "timedelta", "start_date", "DEFAULT_DATE", "session", "session"], ["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["ti2", "dr2", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["session", "commit"], ["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["ti2", "dr2", "get_task_instance", "task_id", "op1", "task_id", "session", "session"]], "state": [["dr2", "dag", "create_dagrun", "run_type", "DagRunType", "BACKFILL_JOB", "state", "State", "RUNNING", "execution_date", "DEFAULT_DATE", "datetime", "timedelta", "start_date", "DEFAULT_DATE", "session", "session"], ["ti", "state", "State", "QUEUED"], ["ti2", "state", "State", "QUEUED"], ["ti", "state", "State", "NONE"], ["ti2", "state", "State", "QUEUED"]], "ti": [["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["ti", "state", "State", "QUEUED"], ["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["ti", "state", "State", "NONE"]], "ti2": [["ti2", "dr2", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["ti2", "state", "State", "QUEUED"], ["ti2", "dr2", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["ti2", "state", "State", "QUEUED"]]}, "name": "test_adopt_or_reset_orphaned_tasks", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag"], ["dr", "dag_maker", "create_dagrun"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "num_runs"], ["self", "job_runner", "processor_agent", "processor"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.057710643577945864]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_adopt_or_reset_orphaned_tasks", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "dr2": "", "job_runner": "", "op1": "", "processor": "", "scheduler_job": "", "session": "", "state": "", "ti": "", "ti2": ""}, "variables_p": {"dr": [["int", 0.3990461120872931], ["str", 0.38792259979028915]], "dr2": [["str", 0.5328378029775543], ["Dict[str, Union[int, str]]", 0.11555375468436435], ["list", 0.09124809059398502], ["int", 0.09004617441814053], ["Dict[int, str]", 0.08587677337981528], ["Union[Literal, Literal]", 0.08443740394614051]], "job_runner": [["dict", 0.4830212952486552], ["DefaultDict", 0.15171240491495577], ["str", 0.09006799381461353], ["List[str]", 0.08903058096586201], ["int", 0.08891945703091635]], "op1": [["Dict[str, Union[Any, bool, str]]", 0.2873398352410515], ["taskiapplication.models.task.Task", 0.0902341181483907], ["List[str]", 0.08591976348128356], ["dict", 0.08056890888830516]], "processor": [["mock.Mock", 0.6033064142352603]], "scheduler_job": [["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.11537684203819668], ["cincoconfig.config.Schema", 0.10530352416243358], ["property", 0.09981857362054283], ["Dict[str, float]", 0.09566389786377835]], "session": [["bool", 0.11325833593730036], ["sqlalchemy.Column", 0.09490024547213073], ["Dict[str, str]", 0.08715066778563249], ["str", 0.08654462800624535]], "state": [["str", 0.6893966675500048], ["dict", 0.14396187365431073], ["Type[hypha.apply.projects.models.Report]", 0.08511241061673681]], "ti": [["str", 0.3917809200069252], ["List[int]", 0.10059781546451992]], "ti2": [["str", 0.3917809200069252], ["List[int]", 0.10059781546451992]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1639, 4], [1656, 79]], "fn_var_ln": {"_task_queued_timeout": [[1652, 8], [1652, 39]], "cleanup_stuck_queued_tasks": [[1649, 8], [1649, 43]], "dr": [[1643, 8], [1643, 10]], "executor": [[1648, 8], [1648, 16]], "job_runner": [[1651, 8], [1651, 18]], "op1": [[1641, 12], [1641, 15]], "queued_dttm": [[1646, 8], [1646, 22]], "scheduler_job": [[1650, 8], [1650, 21]], "state": [[1645, 8], [1645, 16]], "ti": [[1644, 8], [1644, 10]]}, "fn_var_occur": {"_task_queued_timeout": [["job_runner", "_task_queued_timeout"]], "cleanup_stuck_queued_tasks": [["executor", "cleanup_stuck_queued_tasks", "mock", "MagicMock"], ["job_runner", "job", "executor", "cleanup_stuck_queued_tasks", "assert_called_once"]], "dr": [["dr", "dag_maker", "create_dagrun"], ["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"]], "executor": [["executor", "MagicMock"], ["executor", "cleanup_stuck_queued_tasks", "mock", "MagicMock"], ["scheduler_job", "Job", "executor", "executor"], ["job_runner", "job", "executor", "cleanup_stuck_queued_tasks", "assert_called_once"]], "job_runner": [["job_runner", "SchedulerJobRunner", "job", "scheduler_job", "num_runs"], ["job_runner", "_task_queued_timeout"], ["job_runner", "_fail_tasks_stuck_in_queued"], ["job_runner", "job", "executor", "cleanup_stuck_queued_tasks", "assert_called_once"]], "op1": [["op1", "EmptyOperator", "task_id"], ["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"]], "queued_dttm": [["ti", "queued_dttm", "timezone", "utcnow", "timedelta", "minutes"]], "scheduler_job": [["scheduler_job", "Job", "executor", "executor"], ["job_runner", "SchedulerJobRunner", "job", "scheduler_job", "num_runs"]], "state": [["ti", "state", "State", "QUEUED"]], "ti": [["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["ti", "state", "State", "QUEUED"], ["ti", "queued_dttm", "timezone", "utcnow", "timedelta", "minutes"]]}, "name": "test_fail_stuck_queued_tasks", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [["dr", "dag_maker", "create_dagrun"]], "self": [], "session": [["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["session", "commit"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.1667992662770832]], "kwargs": [], "self": [], "session": [["str", 0.20080708840311373], ["django.conf.settings.AUTH_USER_MODEL", 0.0901695879795501]]}, "q_name": "TestSchedulerJob.test_fail_stuck_queued_tasks", "ret_exprs": [], "ret_type": "", "variables": {"_task_queued_timeout": "", "cleanup_stuck_queued_tasks": "", "dr": "", "executor": "", "job_runner": "", "op1": "", "queued_dttm": "", "scheduler_job": "", "state": "", "ti": ""}, "variables_p": {"_task_queued_timeout": [["int", 0.28478704534572746], ["List[List[int]]", 0.22725261356551343], ["Dict[str, str]", 0.08445324228001104]], "cleanup_stuck_queued_tasks": [["bytes", 0.19836760819501592], ["mock.Mock", 0.10804564557018462], ["unittesmock.MagicMock", 0.09924486070028597], ["mock.MagicMock", 0.09496393872873868]], "dr": [["str", 0.6808037006822731], ["Dict[int, Dict[str, Any]]", 0.1982911843589713]], "executor": [["mock.Mock", 0.9037620189615828]], "job_runner": [["yacron.job.RunningJob", 0.11636305163110491]], "op1": [["dict", 0.19748236753146522], ["unittesmock.MagicMock", 0.11290752690899142], ["Dict[str, str]", 0.09405148310545673], ["taskiapplication.models.task.Task", 0.09052692199996464], ["bytes", 0.08897268996988077], ["List[str]", 0.08488258267258057]], "queued_dttm": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "scheduler_job": [["Dict[str, None]", 0.09552725493284592], ["str", 0.08609593496713752]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "ti": [["str", 0.3884519446022829], ["List[int]", 0.11676064363600468], ["Dict[int, str]", 0.09640563852399332]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[1658, 4], [1674, 97]], "fn_var_ln": {"_task_queued_timeout": [[1671, 8], [1671, 39]], "dr": [[1662, 8], [1662, 10]], "job_runner": [[1670, 8], [1670, 18]], "op1": [[1660, 12], [1660, 15]], "queued_dttm": [[1665, 8], [1665, 22]], "scheduler_job": [[1669, 8], [1669, 21]], "state": [[1664, 8], [1664, 16]], "ti": [[1663, 8], [1663, 10]]}, "fn_var_occur": {"_task_queued_timeout": [["job_runner", "_task_queued_timeout"]], "dr": [["dr", "dag_maker", "create_dagrun"], ["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"]], "job_runner": [["job_runner", "SchedulerJobRunner", "job", "scheduler_job", "num_runs"], ["job_runner", "_task_queued_timeout"], ["job_runner", "_fail_tasks_stuck_in_queued"]], "op1": [["op1", "EmptyOperator", "task_id"], ["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"]], "queued_dttm": [["ti", "queued_dttm", "timezone", "utcnow", "timedelta", "minutes"]], "scheduler_job": [["scheduler_job", "Job", "executor", "LocalExecutor"], ["job_runner", "SchedulerJobRunner", "job", "scheduler_job", "num_runs"]], "state": [["ti", "state", "State", "QUEUED"]], "ti": [["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["ti", "state", "State", "QUEUED"], ["ti", "queued_dttm", "timezone", "utcnow", "timedelta", "minutes"]]}, "name": "test_fail_stuck_queued_tasks_raises_not_implemented", "params": {"caplog": "", "dag_maker": "", "self": "", "session": ""}, "params_descr": {"caplog": "", "dag_maker": "", "self": "", "session": ""}, "params_occur": {"caplog": [["caplog", "at_level", "logging", "DEBUG"], ["caplog", "text"]], "dag_maker": [["dr", "dag_maker", "create_dagrun"]], "self": [], "session": [["ti", "dr", "get_task_instance", "task_id", "op1", "task_id", "session", "session"], ["session", "commit"]]}, "params_p": {"args": [], "caplog": [["str", 0.29999295361072814], ["cmk.base.config.HostConfig", 0.09187440066235561]], "dag_maker": [["str", 0.1667992662770832]], "kwargs": [], "self": [], "session": [["str", 0.20080708840311373], ["django.conf.settings.AUTH_USER_MODEL", 0.0901695879795501]]}, "q_name": "TestSchedulerJob.test_fail_stuck_queued_tasks_raises_not_implemented", "ret_exprs": [], "ret_type": "", "variables": {"_task_queued_timeout": "", "dr": "", "job_runner": "", "op1": "", "queued_dttm": "", "scheduler_job": "", "state": "", "ti": ""}, "variables_p": {"_task_queued_timeout": [["int", 0.28478704534572746], ["List[List[int]]", 0.22725261356551343], ["Dict[str, str]", 0.08445324228001104]], "dr": [["str", 0.6808037006822731], ["Dict[int, Dict[str, Any]]", 0.1982911843589713]], "job_runner": [["yacron.job.RunningJob", 0.11636305163110491]], "op1": [["dict", 0.19748236753146522], ["unittesmock.MagicMock", 0.11290752690899142], ["Dict[str, str]", 0.09405148310545673], ["taskiapplication.models.task.Task", 0.09052692199996464], ["bytes", 0.08897268996988077], ["List[str]", 0.08488258267258057]], "queued_dttm": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "scheduler_job": [["int", 0.17704112075792136], ["yacron.job.RunningJob", 0.09293216971944199], ["str", 0.09291310979963222]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "ti": [["str", 0.3884519446022829], ["List[int]", 0.11676064363600468], ["Dict[int, str]", 0.09640563852399332]]}}, {"docstring": {"func": "Test to make sure executor.end gets called with a successful scheduler loop run", "long_descr": null, "ret": null}, "fn_lc": [[1677, 4], [1685, 64]], "fn_var_ln": {"job_runner": [[1682, 8], [1682, 23]], "scheduler_job": [[1681, 8], [1681, 21]]}, "fn_var_occur": {"job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"], ["self", "job_runner", "processor_agent", "end", "assert_called_once"]], "scheduler_job": [["scheduler_job", "Job", "executor", "mock", "MagicMock", "slots_available"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"], ["scheduler_job", "executor", "end", "assert_called_once"]]}, "name": "test_executor_end_called", "params": {"mock_processor_agent": "", "self": ""}, "params_descr": {"mock_processor_agent": "", "self": ""}, "params_occur": {"mock_processor_agent": [], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"], ["self", "job_runner", "processor_agent", "end", "assert_called_once"]]}, "params_p": {"args": [], "kwargs": [], "mock_processor_agent": [["mock.Mock", 0.9441681752758383]], "self": []}, "q_name": "TestSchedulerJob.test_executor_end_called", "ret_exprs": [], "ret_type": "", "variables": {"job_runner": "", "scheduler_job": ""}, "variables_p": {"job_runner": [["int", 0.2905678340834302], ["list", 0.19326739302909557], ["deque[str]", 0.11435918234314686], ["str", 0.10897822522869183], ["Dict[int, Any]", 0.09184964059198068]], "scheduler_job": [["mode.utils.mocks.Mock", 0.10172083604814193]]}}, {"docstring": {"func": "Test to make sure all cleanup methods are called when the scheduler loop has an exception", "long_descr": null, "ret": null}, "fn_lc": [[1688, 4], [1703, 74]], "fn_var_ln": {"job_runner": [[1693, 8], [1693, 23]], "scheduler_job": [[1692, 8], [1692, 21]]}, "fn_var_occur": {"job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull", "num_runs"], ["self", "job_runner", "_run_scheduler_loop", "mock", "MagicMock", "side_effect", "Exception"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"], ["self", "job_runner", "processor_agent", "end", "assert_called_once"]], "scheduler_job": [["scheduler_job", "Job", "executor", "mock", "MagicMock", "slots_available"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull", "num_runs"], ["scheduler_job", "executor", "end", "mock", "MagicMock", "side_effect", "Exception"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"], ["scheduler_job", "executor", "end", "assert_called_once"]]}, "name": "test_cleanup_methods_all_called", "params": {"mock_processor_agent": "", "self": ""}, "params_descr": {"mock_processor_agent": "", "self": ""}, "params_occur": {"mock_processor_agent": [["mock_processor_agent", "return_value", "end", "side_effect", "Exception"], ["mock_processor_agent", "return_value", "end", "reset_mock", "side_effect", "True"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull", "num_runs"], ["self", "job_runner", "_run_scheduler_loop", "mock", "MagicMock", "side_effect", "Exception"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"], ["self", "job_runner", "processor_agent", "end", "assert_called_once"]]}, "params_p": {"args": [], "kwargs": [], "mock_processor_agent": [["unittesmock.MagicMock", 0.8964442087077616]], "self": []}, "q_name": "TestSchedulerJob.test_cleanup_methods_all_called", "ret_exprs": [], "ret_type": "", "variables": {"job_runner": "", "scheduler_job": ""}, "variables_p": {"job_runner": [["int", 0.38548863797694166], ["str", 0.12145322512396892], ["float", 0.12145322512396892], ["dict", 0.11628433698286322], ["Sequence[str]", 0.08597898425307049]], "scheduler_job": [["mode.utils.mocks.Mock", 0.10172083604814193]]}}, {"docstring": {"func": "This tests that queued dagruns stops creating once max_active_runs is reached", "long_descr": null, "ret": null}, "fn_lc": [[1705, 4], [1737, 55]], "fn_var_ln": {"drs": [[1724, 8], [1724, 11]], "executor": [[1714, 8], [1714, 30]], "job_runner": [[1712, 8], [1712, 23]], "orm_dag": [[1720, 8], [1720, 15]], "scheduler_job": [[1711, 8], [1711, 21]], "session": [[1719, 8], [1719, 15]], "state": [[1728, 12], [1728, 20]]}, "fn_var_occur": {"drs": [["drs", "session", "query", "DagRun", "all"], ["len", "drs"]], "executor": [["scheduler_job", "executor", "MockExecutor"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"]], "orm_dag": [["orm_dag", "session", "get", "DagModel", "dag", "dag_id"], ["orm_dag", "None"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["orm_dag", "next_dagrun_create_after", "None"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor"]], "session": [["session", "settings", "Session"], ["session", "settings", "Session"], ["orm_dag", "session", "get", "DagModel", "dag", "dag_id"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["drs", "session", "query", "DagRun", "all"], ["session", "merge", "dr"], ["session", "commit"], ["session", "query", "DagRun", "state", "filter", "DagRun", "state", "State", "RUNNING", "count"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["session", "query", "DagRun", "count"], ["session", "query", "DagRun", "state", "filter", "DagRun", "state", "State", "RUNNING", "count"], ["session", "query", "DagRun", "state", "filter", "DagRun", "state", "State", "QUEUED", "count"]], "state": [["dr", "state", "State", "RUNNING"], ["session", "query", "DagRun", "state", "filter", "DagRun", "state", "State", "RUNNING", "count"], ["session", "query", "DagRun", "state", "filter", "DagRun", "state", "State", "RUNNING", "count"], ["session", "query", "DagRun", "state", "filter", "DagRun", "state", "State", "QUEUED", "count"]]}, "name": "test_queued_dagruns_stops_creating_when_max_active_is_reached", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "max_active_runs", "dag"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.38765816598730357], ["List[Dict[str, Any]]", 0.13651168216100448]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_queued_dagruns_stops_creating_when_max_active_is_reached", "ret_exprs": [], "ret_type": "", "variables": {"drs": "", "executor": "", "job_runner": "", "orm_dag": "", "scheduler_job": "", "session": "", "state": ""}, "variables_p": {"drs": [["List[int]", 0.17919409699877217], ["dict", 0.16731318642268903], ["str", 0.11519265549748424], ["Dict[str, Any]", 0.09648727290759818], ["alerta.models.alerAlert", 0.09049893626927719], ["list", 0.08423813153502649]], "executor": [["unittesmock.MagicMock", 0.49999999995400857], ["list", 2.1664709224561442e-11], ["List[str]", 8.116995576045707e-12], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 8.007660674688464e-12]], "job_runner": [["Dict[str, Dict[str, str]]", 0.3504442058993599], ["Dict[Tuple[str, str], float]", 0.09787558721746727], ["Dict[Tuple[Any, Any], Any]", 0.09329523424504117], ["Dict[int, int]", 0.09078845316495282], ["Dict[Tuple[str, int], Dict[Any, Any]]", 0.09002545157520937], ["Dict[str, int]", 0.08935010783940378], ["Dict[Type[Any], int]", 0.08700999130504251]], "orm_dag": [["str", 0.42523330494184136], ["pydynasync.models.Changes", 0.11426184521037192], ["List[str]", 0.10085695025855539], ["set", 0.08714938268938077], ["int", 0.08490695776479068]], "scheduler_job": [["Dict[str, List[str]]", 0.2866423692826576], ["cincoconfig.config.Schema", 0.08246538960069358], ["raiden.utils.Any", 0.07557206833854697]], "session": [["kedro.framework.session.session.KedroSession", 0.13928433262394785]], "state": [["str", 0.18148290931363986], ["Optional[str]", 0.12009159324998728], ["int", 0.08950677151921613], ["dict", 0.08503127471191863]]}}, {"docstring": {"func": "Test that when creating runs once max_active_runs is reached the runs does not stick", "long_descr": null, "ret": null}, "fn_lc": [[1739, 4], [1774, 33]], "fn_var_ln": {"dag_run": [[1764, 8], [1764, 15]], "dag_runs": [[1773, 8], [1773, 16]], "executor": [[1746, 8], [1746, 30]], "job_runner": [[1744, 8], [1744, 23]], "scheduler_job": [[1743, 8], [1743, 21]]}, "fn_var_occur": {"dag_run": [["dag_run", "dag_maker", "create_dagrun", "state", "State", "RUNNING", "session", "session"], ["dag_run", "session", "merge", "dag_run"], ["session", "refresh", "dag_run"], ["dag_run", "get_task_instance", "task_id", "session", "session", "state", "State", "SUCCESS"]], "dag_runs": [["dag_runs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["len", "dag_runs"]], "executor": [["scheduler_job", "executor", "MockExecutor", "do_update", "True"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_do_scheduling", "session"], ["self", "job_runner", "_do_scheduling", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor", "do_update", "True"]]}, "name": "test_runs_are_created_after_max_active_runs_was_reached", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [["dag_maker", "max_active_runs", "session", "session", "dag"], ["dag_run", "dag_maker", "create_dagrun", "state", "State", "RUNNING", "session", "session"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_do_scheduling", "session"], ["self", "job_runner", "_do_scheduling", "session"]], "session": [["dag_maker", "max_active_runs", "session", "session", "dag"], ["dag_run", "dag_maker", "create_dagrun", "state", "State", "RUNNING", "session", "session"], ["self", "job_runner", "_do_scheduling", "session"], ["dag_run", "session", "merge", "dag_run"], ["session", "refresh", "dag_run"], ["dag_run", "get_task_instance", "task_id", "session", "session", "state", "State", "SUCCESS"], ["self", "job_runner", "_do_scheduling", "session"], ["dag_runs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["zerver.models.UserProfile", 0.19024697948328323], ["models.UserAuth", 0.12101593749190762], ["app.models.User", 0.09584410394202356], ["app.models.user.User", 0.09584410394202356], ["datetime.datetime", 0.09549247738028367], ["bytes", 0.09482248500596004], ["zerver.models.Client", 0.09464483614379564]], "kwargs": [], "self": [], "session": [["zerver.models.UserProfile", 0.1883987646573261], ["models.UserAuth", 0.11319501114913802], ["bytes", 0.10420698212709087], ["zerver.models.Client", 0.09689303280584381], ["str", 0.09689303280584381], ["datetime.datetime", 0.09600715874134674], ["app.models.User", 0.08829705875906702]]}, "q_name": "TestSchedulerJob.test_runs_are_created_after_max_active_runs_was_reached", "ret_exprs": [], "ret_type": "", "variables": {"dag_run": "", "dag_runs": "", "executor": "", "job_runner": "", "scheduler_job": ""}, "variables_p": {"dag_run": [["Tuple[Any, Any, Any]", 0.09933436031978433], ["models.LTI1p3Provider", 0.09904860746468751]], "dag_runs": [["Dict[str, str]", 0.1368462750856127], ["dict", 0.09034283538013223]], "executor": [["int", 0.1104714411875731], ["str", 0.10028627431253338], ["Union[Literal, str]", 0.09889204419015628], ["list", 0.09707821138615018]], "job_runner": [["Dict[int, unittesmock.MagicMock]", 0.30329157117213373], ["Dict[str, dict]", 0.28424197978021976], ["Dict[str, Union[Any, str]]", 0.24656529010642908], ["Dict[Any, Tuple[Any, Any]]", 0.08678261286278287]], "scheduler_job": [["List[str]", 0.11681852065930069], ["list", 0.10535177221245147], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.09208030321930663], ["cincoconfig.config.Schema", 0.08921463292742349]]}}, {"docstring": {"func": "Test if a a dagrun will not be scheduled if max_dag_runs", "long_descr": "has been reached and dagrun_timeout is not reached\n\nTest if a a dagrun would be scheduled if max_dag_runs has\nbeen reached but dagrun_timeout is also reached", "ret": null}, "fn_lc": [[1776, 4], [1846, 23]], "fn_var_ln": {"callback": [[1822, 8], [1822, 16]], "dr": [[1807, 8], [1807, 10]], "drs": [[1805, 8], [1805, 11]], "expected_callback": [[1833, 8], [1833, 25]], "job_runner": [[1794, 8], [1794, 23]], "orm_dag": [[1799, 8], [1799, 15]], "scheduler_job": [[1793, 8], [1793, 21]], "session": [[1798, 8], [1798, 15]], "start_date": [[1816, 8], [1816, 21]]}, "fn_var_occur": {"callback": [["callback", "self", "job_runner", "_schedule_dag_run", "dr", "session"], ["callback", "expected_callback"]], "dr": [["dr", "drs"], ["dr", "start_date", "timezone", "utcnow", "datetime", "timedelta", "days"], ["callback", "self", "job_runner", "_schedule_dag_run", "dr", "session"], ["session", "refresh", "dr"], ["dr", "state", "State", "FAILED"], ["expected_callback", "DagCallbackRequest", "full_filepath", "dr", "dag", "fileloc", "dag_id", "dr", "dag_id", "is_failure_callback", "True", "run_id", "dr", "run_id", "processor_subdir", "TEST_DAG_FOLDER", "msg"]], "drs": [["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["len", "drs"], ["dr", "drs"]], "expected_callback": [["expected_callback", "DagCallbackRequest", "full_filepath", "dr", "dag", "fileloc", "dag_id", "dr", "dag_id", "is_failure_callback", "True", "run_id", "dr", "run_id", "processor_subdir", "TEST_DAG_FOLDER", "msg"], ["callback", "expected_callback"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["callback", "self", "job_runner", "_schedule_dag_run", "dr", "session"]], "orm_dag": [["orm_dag", "session", "get", "DagModel", "dag", "dag_id"], ["orm_dag", "None"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["orm_dag", "next_dagrun_create_after", "None"], ["isinstance", "orm_dag", "next_dagrun", "datetime", "datetime"], ["isinstance", "orm_dag", "next_dagrun_data_interval_start", "datetime", "datetime"], ["isinstance", "orm_dag", "next_dagrun_data_interval_end", "datetime", "datetime"], ["session", "refresh", "orm_dag"], ["isinstance", "orm_dag", "next_dagrun", "datetime", "datetime"], ["isinstance", "orm_dag", "next_dagrun_data_interval_start", "datetime", "datetime"], ["isinstance", "orm_dag", "next_dagrun_data_interval_end", "datetime", "datetime"], ["isinstance", "orm_dag", "next_dagrun_create_after", "datetime", "datetime"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["orm_dag", "session", "get", "DagModel", "dag", "dag_id"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["session", "flush"], ["callback", "self", "job_runner", "_schedule_dag_run", "dr", "session"], ["session", "flush"], ["session", "refresh", "dr"], ["session", "refresh", "orm_dag"], ["session", "rollback"], ["session", "close"]], "start_date": [["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "max_active_runs", "processor_subdir", "TEST_DAG_FOLDER", "dagrun_timeout", "datetime", "timedelta", "seconds", "dag"], ["dr", "start_date", "timezone", "utcnow", "datetime", "timedelta", "days"]]}, "name": "test_dagrun_timeout_verify_max_active_runs", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "max_active_runs", "processor_subdir", "TEST_DAG_FOLDER", "dagrun_timeout", "datetime", "timedelta", "seconds", "dag"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["callback", "self", "job_runner", "_schedule_dag_run", "dr", "session"]]}, "params_p": {"args": [], "dag_maker": [["raiden.utils.Address", 0.30006357519817795], ["raiden.utils.ChannelID", 0.30006357519817795], ["raiden.utils.MessageID", 0.30006357519817795]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_dagrun_timeout_verify_max_active_runs", "ret_exprs": [], "ret_type": "", "variables": {"callback": "", "dr": "", "drs": "", "expected_callback": "", "job_runner": "", "orm_dag": "", "scheduler_job": "", "session": "", "start_date": ""}, "variables_p": {"callback": [["dict", 0.1274832321106892], ["Type[ajapaik.ajapaik.models.MyXtdCommenWikimediaCommonsUpload]", 0.09049793884893675], ["Dict[str, Any]", 0.09018306366173086], ["List[str]", 0.088843002962085], ["bool", 0.08829902781402252]], "dr": [["datetime.datetime", 0.2469545053683651], ["datetime.datetime.timedelta", 0.21995278824917902], ["datetime.date.time.timedelta", 0.20747806166796046], ["datetime.date", 0.11999657463468139], ["datetime.datetime.datetime", 0.11843866644820375], ["str", 0.0871794036316103]], "drs": [["str", 0.20433591560014966], ["int", 0.1918793717997031], ["List[Dict[str, Any]]", 0.1180607231227876], ["datetime.datetime.datetime", 0.09511633429537675], ["Type[manager.projects.models.snapshots.Snapshot]", 0.09366430555487672]], "expected_callback": [["str", 0.09266058252731267], ["Dict[str, Any]", 0.08680338384272024], ["parsl.executors.high_throughpumac_safe_queue.MacSafeQueue", 0.08661998416221439], ["Dict[str, Union[bool, str]]", 0.08438485099352826]], "job_runner": [["Dict[str, Sequence[Any]]", 0.11708304313056428], ["dict", 0.11394495924991106], ["Dict[str, Dict[str, str]]", 0.09913717721296468], ["float", 0.09876466792619185], ["Dict[str, str]", 0.09700020363267496], ["str", 0.09301597094828466], ["Type[int]", 0.08605775764451828]], "orm_dag": [["str", 0.42523330494184136], ["pydynasync.models.Changes", 0.11426184521037192], ["List[str]", 0.10085695025855539], ["set", 0.08714938268938077], ["int", 0.08490695776479068]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["Dict[str, Any]", 0.15262218010585668], ["dict", 0.07631109005292834], ["Dict[str, str]", 0.07325989024916654]], "start_date": [["datetime.datetime", 0.40472419509954793], ["datetime.datetime.datetime", 0.27647302342958113], ["datetime.date", 0.12797217041412254], ["Type[leasing.models.vaVat]", 0.0881670762933388]]}}, {"docstring": {"func": "Test if a a dagrun will be set failed if timeout, even without max_active_runs", "long_descr": null, "ret": null}, "fn_lc": [[1848, 4], [1890, 23]], "fn_var_ln": {"callback": [[1871, 8], [1871, 16]], "dr": [[1861, 8], [1861, 10]], "expected_callback": [[1877, 8], [1877, 25]], "job_runner": [[1864, 8], [1864, 23]], "scheduler_job": [[1863, 8], [1863, 21]], "session": [[1852, 8], [1852, 15]]}, "fn_var_occur": {"callback": [["callback", "self", "job_runner", "_schedule_dag_run", "dr", "session"], ["callback", "expected_callback"]], "dr": [["dr", "dag_maker", "create_dagrun", "start_date", "timezone", "utcnow", "datetime", "timedelta", "days"], ["callback", "self", "job_runner", "_schedule_dag_run", "dr", "session"], ["session", "refresh", "dr"], ["dr", "state", "State", "FAILED"], ["expected_callback", "DagCallbackRequest", "full_filepath", "dr", "dag", "fileloc", "dag_id", "dr", "dag_id", "is_failure_callback", "True", "run_id", "dr", "run_id", "processor_subdir", "TEST_DAG_FOLDER", "msg"]], "expected_callback": [["expected_callback", "DagCallbackRequest", "full_filepath", "dr", "dag", "fileloc", "dag_id", "dr", "dag_id", "is_failure_callback", "True", "run_id", "dr", "run_id", "processor_subdir", "TEST_DAG_FOLDER", "msg"], ["callback", "expected_callback"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["callback", "self", "job_runner", "_schedule_dag_run", "dr", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["dag_maker", "dag_id", "dagrun_timeout", "datetime", "timedelta", "seconds", "processor_subdir", "TEST_DAG_FOLDER", "session", "session"], ["callback", "self", "job_runner", "_schedule_dag_run", "dr", "session"], ["session", "flush"], ["session", "refresh", "dr"], ["session", "rollback"], ["session", "close"]]}, "name": "test_dagrun_timeout_fails_run", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dagrun_timeout", "datetime", "timedelta", "seconds", "processor_subdir", "TEST_DAG_FOLDER", "session", "session"], ["dr", "dag_maker", "create_dagrun", "start_date", "timezone", "utcnow", "datetime", "timedelta", "days"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["callback", "self", "job_runner", "_schedule_dag_run", "dr", "session"]]}, "params_p": {"args": [], "dag_maker": [["Tuple[int, int]", 0.09936994785522106]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_dagrun_timeout_fails_run", "ret_exprs": [], "ret_type": "", "variables": {"callback": "", "dr": "", "expected_callback": "", "job_runner": "", "scheduler_job": "", "session": ""}, "variables_p": {"callback": [["dict", 0.1274832321106892], ["Type[ajapaik.ajapaik.models.MyXtdCommenWikimediaCommonsUpload]", 0.09049793884893675], ["Dict[str, Any]", 0.09018306366173086], ["List[str]", 0.088843002962085], ["bool", 0.08829902781402252]], "dr": [["datetime.datetime", 0.3800857190378034], ["datetime.time", 0.1901797541101588], ["datetime.date", 0.11222221401222109], ["datetime.date.time.date", 0.09784744520784158], ["datetime.datetime.datetime", 0.0975115336439905]], "expected_callback": [["str", 0.09266058252731267], ["Dict[str, Any]", 0.08680338384272024], ["parsl.executors.high_throughpumac_safe_queue.MacSafeQueue", 0.08661998416221439], ["Dict[str, Union[bool, str]]", 0.08438485099352826]], "job_runner": [["Dict[str, Sequence[Any]]", 0.11708304313056428], ["dict", 0.11394495924991106], ["Dict[str, Dict[str, str]]", 0.09913717721296468], ["float", 0.09876466792619185], ["Dict[str, str]", 0.09700020363267496], ["str", 0.09301597094828466], ["Type[int]", 0.08605775764451828]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["unittesmock.MagicMock", 0.2140099738963002], ["dict", 0.11441306475416047], ["raiden.transfer.state.HopState", 0.09287084139393988], ["legistar.models.MatterStatus", 0.08785242691203568], ["Optional[raiden.transfer.state.NettingChannelState]", 0.08718372621298254]]}}, {"docstring": {"func": "Test that dagrun timeout fails run and update the next dagrun", "long_descr": null, "ret": null}, "fn_lc": [[1892, 4], [1926, 9]], "fn_var_ln": {"dr": [[1904, 8], [1904, 10]], "executor": [[1911, 8], [1911, 30]], "job_runner": [[1908, 8], [1908, 23]], "scheduler_job": [[1907, 8], [1907, 21]], "session": [[1896, 8], [1896, 15]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun", "start_date", "timezone", "utcnow", "datetime", "timedelta", "days"], ["dag_maker", "dag_model", "next_dagrun", "dr", "execution_date"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["session", "refresh", "dr"], ["dr", "state", "State", "FAILED"], ["dag_maker", "dag_model", "next_dagrun_create_after", "dr", "execution_date", "timedelta", "days"]], "executor": [["scheduler_job", "executor", "MockExecutor"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor"]], "session": [["session", "settings", "Session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["session", "flush"], ["session", "refresh", "dr"], ["session", "query", "DagRun", "filter", "DagRun", "state", "in_", "DagRunState", "RUNNING", "DagRunState", "QUEUED", "count"]]}, "name": "test_dagrun_timeout_fails_run_and_update_next_dagrun", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "max_active_runs", "dag_id", "dagrun_timeout", "datetime", "timedelta", "seconds"], ["dr", "dag_maker", "create_dagrun", "start_date", "timezone", "utcnow", "datetime", "timedelta", "days"], ["dag_maker", "dag_model", "next_dagrun", "dr", "execution_date"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["dag_maker", "dag_model", "next_dagrun_create_after", "dr", "execution_date", "timedelta", "days"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]]}, "params_p": {"args": [], "dag_maker": [["core.models.Grouping", 0.08811055401587033]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_dagrun_timeout_fails_run_and_update_next_dagrun", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "executor": "", "job_runner": "", "scheduler_job": "", "session": ""}, "variables_p": {"dr": [["datetime.datetime.datetime", 0.3704775782222934], ["datetime.datetime.timedelta", 0.2820666500531672], ["datetime.timedelta", 0.11504611123519358], ["datetime.datetime", 0.09047533258902046]], "executor": [["unittesmock.MagicMock", 0.49999999995400857], ["list", 2.1664709224561442e-11], ["List[str]", 8.116995576045707e-12], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 8.007660674688464e-12]], "job_runner": [["Dict[str, Sequence[Any]]", 0.11708304313056428], ["dict", 0.11394495924991106], ["Dict[str, Dict[str, str]]", 0.09913717721296468], ["float", 0.09876466792619185], ["Dict[str, str]", 0.09700020363267496], ["str", 0.09301597094828466], ["Type[int]", 0.08605775764451828]], "scheduler_job": [["Dict[str, List[str]]", 0.2866423692826576], ["cincoconfig.config.Schema", 0.08246538960069358], ["raiden.utils.Any", 0.07557206833854697]], "session": [["dict", 0.06851362543901152]]}}, {"docstring": {"func": "Test if DagRun is successful, and if Success callbacks is defined, it is sent to DagFileProcessor.", "long_descr": null, "ret": null}, "fn_lc": [[1931, 4], [1971, 23]], "fn_var_ln": {"dr": [[1951, 8], [1951, 10]], "executor": [[1946, 8], [1946, 30]], "expected_callback": [[1959, 8], [1959, 25]], "job_runner": [[1944, 8], [1944, 23]], "scheduler_job": [[1943, 8], [1943, 21]], "session": [[1950, 8], [1950, 15]], "ti": [[1953, 8], [1953, 10]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun"], ["ti", "dr", "get_task_instance"], ["expected_callback", "DagCallbackRequest", "full_filepath", "dag", "fileloc", "dag_id", "dr", "dag_id", "is_failure_callback", "bool", "state", "State", "FAILED", "run_id", "dr", "run_id", "processor_subdir", "TEST_DAG_FOLDER", "msg", "expected_callback_msg"]], "executor": [["scheduler_job", "executor", "MockExecutor"], ["scheduler_job", "executor", "callback_sink", "send", "assert_called_once_with", "expected_callback"]], "expected_callback": [["expected_callback", "DagCallbackRequest", "full_filepath", "dag", "fileloc", "dag_id", "dr", "dag_id", "is_failure_callback", "bool", "state", "State", "FAILED", "run_id", "dr", "run_id", "processor_subdir", "TEST_DAG_FOLDER", "msg", "expected_callback_msg"], ["scheduler_job", "executor", "callback_sink", "send", "assert_called_once_with", "expected_callback"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["self", "job_runner", "_do_scheduling", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor"], ["scheduler_job", "executor", "callback_sink", "send", "assert_called_once_with", "expected_callback"]], "session": [["session", "settings", "Session"], ["ti", "set_state", "state", "session"], ["self", "job_runner", "_do_scheduling", "session"], ["session", "rollback"], ["session", "close"]], "ti": [["ti", "dr", "get_task_instance"], ["ti", "set_state", "state", "session"]]}, "name": "test_dagrun_callbacks_are_called", "params": {"dag_maker": "", "expected_callback_msg": "", "self": "", "state": ""}, "params_descr": {"dag_maker": "", "expected_callback_msg": "", "self": "", "state": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "on_success_callback", "x", "print", "on_failure_callback", "x", "print", "processor_subdir", "TEST_DAG_FOLDER", "dag"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["dr", "dag_maker", "create_dagrun"]], "expected_callback_msg": [["expected_callback", "DagCallbackRequest", "full_filepath", "dag", "fileloc", "dag_id", "dr", "dag_id", "is_failure_callback", "bool", "state", "State", "FAILED", "run_id", "dr", "run_id", "processor_subdir", "TEST_DAG_FOLDER", "msg", "expected_callback_msg"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["self", "job_runner", "_do_scheduling", "session"]], "state": [["ti", "set_state", "state", "session"], ["expected_callback", "DagCallbackRequest", "full_filepath", "dag", "fileloc", "dag_id", "dr", "dag_id", "is_failure_callback", "bool", "state", "State", "FAILED", "run_id", "dr", "run_id", "processor_subdir", "TEST_DAG_FOLDER", "msg", "expected_callback_msg"]]}, "params_p": {"args": [], "dag_maker": [["raiden.utils.Secret", 0.10599548458933043], ["int", 0.097792698203018], ["raiden.utils.List[raiden.utils.FeeAmount]", 0.09345812014837486], ["str", 0.09226532057555209]], "expected_callback_msg": [["str", 0.3053984391760194], ["rotkehlchen.db.dbhandler.DBHandler", 0.17881422226506571], ["Optional[Mapping[str, Any]]", 0.09097607700489092]], "kwargs": [], "self": [], "state": [["str", 0.29593086803914853]]}, "q_name": "TestSchedulerJob.test_dagrun_callbacks_are_called", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "executor": "", "expected_callback": "", "job_runner": "", "scheduler_job": "", "session": "", "ti": ""}, "variables_p": {"dr": [["dict", 0.1940576840555115]], "executor": [["list", 0.3479516816112661], ["Dict[int, Dict[str, Any]]", 0.09971005085400375], ["str", 0.09971005085400375], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.09180802435433325]], "expected_callback": [["str", 0.28665648284303635], ["Dict[str, Any]", 0.11384690907064302], ["bytes", 0.10412385717073089], ["Dict[str, Union[int, str]]", 0.09696497171202353]], "job_runner": [["Dict[str, Sequence[Any]]", 0.11708304313056428], ["dict", 0.11394495924991106], ["Dict[str, Dict[str, str]]", 0.09913717721296468], ["float", 0.09876466792619185], ["Dict[str, str]", 0.09700020363267496], ["str", 0.09301597094828466], ["Type[int]", 0.08605775764451828]], "scheduler_job": [["Dict[str, List[str]]", 0.2866423692826576], ["cincoconfig.config.Schema", 0.08246538960069358], ["raiden.utils.Any", 0.07557206833854697]], "session": [["dict", 0.3003762999196161], ["Dict[Any, dict]", 0.09843549681209644], ["cmk.gui.plugins.visuals.utils.Filter", 0.09239619792222736], ["Union[Literal, dict]", 0.08977729422325847]], "ti": [["str", 0.18263523598046633], ["raiden.utils.SecretHash", 0.0873932948353416], ["Dict[str, Union[Any, Any]]", 0.08598658108316391]]}}, {"docstring": {"func": "Test if DagRun is successful, and if Success callbacks is defined, it is sent to DagFileProcessor.", "long_descr": null, "ret": null}, "fn_lc": [[1976, 4], [2012, 23]], "fn_var_ln": {"dr": [[1999, 8], [1999, 10]], "executor": [[1994, 8], [1994, 30]], "failure": [[2010, 8], [2010, 28]], "job_runner": [[1992, 8], [1992, 23]], "scheduler_job": [[1991, 8], [1991, 21]], "session": [[1998, 8], [1998, 15]], "success": [[2009, 8], [2009, 28]], "ti": [[2001, 8], [2001, 10]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun"], ["ti", "dr", "get_task_instance"]], "executor": [["scheduler_job", "executor", "MockExecutor"]], "failure": [["len", "dag_listener", "success", "len", "dag_listener", "failure"], ["dag_listener", "failure"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["self", "job_runner", "_do_scheduling", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor"]], "session": [["session", "settings", "Session"], ["ti", "set_state", "state", "session"], ["self", "job_runner", "_do_scheduling", "session"], ["session", "rollback"], ["session", "close"]], "success": [["len", "dag_listener", "success", "len", "dag_listener", "failure"], ["dag_listener", "success"]], "ti": [["ti", "dr", "get_task_instance"], ["ti", "set_state", "state", "session"]]}, "name": "test_dagrun_plugins_are_notified", "params": {"dag_maker": "", "expected_callback_msg": "", "self": "", "state": ""}, "params_descr": {"dag_maker": "", "expected_callback_msg": "", "self": "", "state": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "on_success_callback", "x", "print", "on_failure_callback", "x", "print", "processor_subdir", "TEST_DAG_FOLDER"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["dr", "dag_maker", "create_dagrun"]], "expected_callback_msg": [], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["self", "job_runner", "_do_scheduling", "session"]], "state": [["ti", "set_state", "state", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.18928304817490732], ["raiden.utils.Secret", 0.09915949855967418], ["raiden.utils.List[raiden.utils.FeeAmount]", 0.09054959300295863]], "expected_callback_msg": [["bool", 0.14370222701397878], ["Sequence[Hashable]", 0.10015248431571891], ["List[Tuple[int, int]]", 0.10015248431571891], ["raiden.utils.List[raiden.utils.Address]", 0.07716409526155699], ["str", 0.07716409526155699]], "kwargs": [], "self": [], "state": [["mythril.laser.ethereum.state.constraints.Constraints", 0.14017562812914977]]}, "q_name": "TestSchedulerJob.test_dagrun_plugins_are_notified", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "executor": "", "failure": "", "job_runner": "", "scheduler_job": "", "session": "", "success": "", "ti": ""}, "variables_p": {"dr": [["str", 0.23405725462441018], ["dict", 0.14742638979729528], ["int", 0.07880597083004143], ["Union[int, str]", 0.0773423533267002]], "executor": [["unittesmock.MagicMock", 0.49999999995400857], ["list", 2.1664709224561442e-11], ["List[str]", 8.116995576045707e-12], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 8.007660674688464e-12]], "failure": [["list", 0.9999999998131175], ["List[int]", 7.479605870227034e-11], ["int", 5.4781237183280974e-11], ["str", 3.2373105741985684e-11], ["Set[str]", 2.493201956742345e-11]], "job_runner": [["Dict[str, Sequence[Any]]", 0.11708304313056428], ["dict", 0.11394495924991106], ["Dict[str, Dict[str, str]]", 0.09913717721296468], ["float", 0.09876466792619185], ["Dict[str, str]", 0.09700020363267496], ["str", 0.09301597094828466], ["Type[int]", 0.08605775764451828]], "scheduler_job": [["Dict[str, List[str]]", 0.2866423692826576], ["cincoconfig.config.Schema", 0.08246538960069358], ["raiden.utils.Any", 0.07557206833854697]], "session": [["dict", 0.3003762999196161], ["Dict[Any, dict]", 0.09843549681209644], ["cmk.gui.plugins.visuals.utils.Filter", 0.09239619792222736], ["Union[Literal, dict]", 0.08977729422325847]], "success": [["list", 0.9999999998131175], ["List[int]", 7.479605870227034e-11], ["int", 5.4781237183280974e-11], ["str", 3.2373105741985684e-11], ["Set[str]", 2.493201956742345e-11]], "ti": [["str", 0.18263523598046633], ["raiden.utils.SecretHash", 0.0873932948353416], ["Dict[str, Union[Any, Any]]", 0.08598658108316391]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[2014, 4], [2052, 44]], "fn_var_ln": {"callback": [[2036, 8], [2036, 16]], "dr": [[2031, 8], [2031, 10]], "executor": [[2026, 8], [2026, 30]], "expected_callback": [[2043, 8], [2043, 25]], "job_runner": [[2024, 8], [2024, 23]], "scheduler_job": [[2023, 8], [2023, 21]]}, "fn_var_occur": {"callback": [["callback", "session", "query", "DbCallbackRequest", "order_by", "DbCallbackRequest", "id", "desc", "first", "get_callback_request"], ["callback", "expected_callback"]], "dr": [["dr", "dag_maker", "create_dagrun", "start_date", "DEFAULT_DATE"], ["expected_callback", "DagCallbackRequest", "full_filepath", "dag", "fileloc", "dag_id", "dr", "dag_id", "is_failure_callback", "True", "run_id", "dr", "run_id", "processor_subdir", "TEST_DAG_FOLDER", "msg"]], "executor": [["scheduler_job", "executor", "MockExecutor"], ["scheduler_job", "executor", "callback_sink", "DatabaseCallbackSink"]], "expected_callback": [["expected_callback", "DagCallbackRequest", "full_filepath", "dag", "fileloc", "dag_id", "dr", "dag_id", "is_failure_callback", "True", "run_id", "dr", "run_id", "processor_subdir", "TEST_DAG_FOLDER", "msg"], ["callback", "expected_callback"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["self", "job_runner", "_do_scheduling", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor"], ["scheduler_job", "executor", "callback_sink", "DatabaseCallbackSink"]]}, "name": "test_dagrun_timeout_callbacks_are_stored_in_database", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "on_failure_callback", "x", "print", "dagrun_timeout", "timedelta", "hours", "processor_subdir", "TEST_DAG_FOLDER", "dag"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["dr", "dag_maker", "create_dagrun", "start_date", "DEFAULT_DATE"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["self", "job_runner", "_do_scheduling", "session"]], "session": [["self", "job_runner", "_do_scheduling", "session"], ["callback", "session", "query", "DbCallbackRequest", "order_by", "DbCallbackRequest", "id", "desc", "first", "get_callback_request"]]}, "params_p": {"args": [], "dag_maker": [["raiden.utils.Address", 0.20592105818213893], ["vehicles.models.Vehicle", 0.10323504762951129], ["bool", 0.10071452262986207], ["zam_repondeur.models.Dossier", 0.10006410795277482], ["str", 0.09911339879965227], ["homeassistanauth.models.User", 0.09673633635627896]], "kwargs": [], "self": [], "session": [["str", 0.31146481316468966], ["zerver.models.UserProfile", 0.29974042857897065], ["sqlalchemy.orm.session.Session", 0.09485017776354708]]}, "q_name": "TestSchedulerJob.test_dagrun_timeout_callbacks_are_stored_in_database", "ret_exprs": [], "ret_type": "", "variables": {"callback": "", "dr": "", "executor": "", "expected_callback": "", "job_runner": "", "scheduler_job": ""}, "variables_p": {"callback": [["str", 0.32514602834334455], ["list", 0.18566241306647482], ["Dict[int, str]", 0.12679096544298712], ["Dict[str, Dict[str, Any]]", 0.0921240354363639], ["dict", 0.07130699227032057]], "dr": [["Type[backend.server.models.match.Match]", 0.19479494570562791], ["str", 0.18956278903378515], ["raiden.utils.PaymentID", 0.16640969817836346], ["List[str]", 0.14207865027491107], ["Dict[str, str]", 0.1313591870173073], ["List[Tuple[str, Any]]", 0.09250597227182258], ["int", 0.08328875751818256]], "executor": [["unittesmock.MagicMock", 0.49999999995400857], ["list", 2.1664709224561442e-11], ["List[str]", 8.116995576045707e-12], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 8.007660674688464e-12]], "expected_callback": [["str", 0.2890400029604402], ["Dict[str, Any]", 0.09698782247222223], ["Dict[str, Union[int, str]]", 0.09545278754620395]], "job_runner": [["Dict[str, Sequence[Any]]", 0.11708304313056428], ["dict", 0.11394495924991106], ["Dict[str, Dict[str, str]]", 0.09913717721296468], ["float", 0.09876466792619185], ["Dict[str, str]", 0.09700020363267496], ["str", 0.09301597094828466], ["Type[int]", 0.08605775764451828]], "scheduler_job": [["Dict[str, List[str]]", 0.2866423692826576], ["cincoconfig.config.Schema", 0.08246538960069358], ["raiden.utils.Any", 0.07557206833854697]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[2080, 12], [2082, 27]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "mock_schedule_dag_run", "params": {"args": "", "kwargs": ""}, "params_descr": {"args": "", "kwargs": ""}, "params_occur": {"args": [], "kwargs": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_dagrun_callbacks_commited_before_sent.<locals>.mock_schedule_dag_run", "ret_exprs": ["return None"], "ret_type": "", "ret_type_p": [["Optional[bool]", 0.29425466948972856], ["Optional[int]", 0.20248126105830563], ["str", 0.1682299308154001], ["Optional[str]", 0.1498015786066468], ["bool", 0.10409507632453555]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[2084, 12], [2085, 85]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "mock_send_dag_callbacks_to_processor", "params": {"args": "", "kwargs": ""}, "params_descr": {"args": "", "kwargs": ""}, "params_occur": {"args": [], "kwargs": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_dagrun_callbacks_commited_before_sent.<locals>.mock_send_dag_callbacks_to_processor", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Tests that before any callbacks are sent to the processor, the session is committed. This ensures", "long_descr": "that the dagrun details are up to date when the callbacks are run.", "ret": null}, "fn_lc": [[2054, 4], [2099, 23]], "fn_var_ln": {"dr": [[2069, 8], [2069, 10]], "job_runner": [[2063, 8], [2063, 23]], "scheduler_job": [[2062, 8], [2062, 21]], "session": [[2070, 8], [2070, 15]], "ti": [[2072, 8], [2072, 10]]}, "fn_var_occur": {"dr": [], "job_runner": [["self", "job_runner", "_send_dag_callbacks_to_processor", "side_effect", "mock_send_dag_callbacks_to_processor"], ["self", "job_runner", "_schedule_dag_run", "side_effect", "mock_schedule_dag_run"], ["self", "job_runner", "_do_scheduling", "session"], ["self", "job_runner", "_send_dag_callbacks_to_processor", "assert_called_once"]], "scheduler_job": [], "session": [["self", "job_runner", "_do_scheduling", "session"], ["session", "rollback"], ["session", "close"]], "ti": []}, "name": "test_dagrun_callbacks_commited_before_sent", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [], "self": [["self", "job_runner", "_send_dag_callbacks_to_processor", "side_effect", "mock_send_dag_callbacks_to_processor"], ["self", "job_runner", "_schedule_dag_run", "side_effect", "mock_schedule_dag_run"], ["self", "job_runner", "_do_scheduling", "session"], ["self", "job_runner", "_send_dag_callbacks_to_processor", "assert_called_once"]]}, "params_p": {"args": [], "dag_maker": [["tests.basilisp.helpers.CompileFn", 0.2], ["str", 0.2], ["tests.async_mock.MagicMock", 0.1], ["tests.async_mock.Mock", 0.1], ["Mapping[str, Any]", 0.1]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_dagrun_callbacks_commited_before_sent", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "job_runner": "", "scheduler_job": "", "session": "", "ti": ""}, "variables_p": {"dr": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "job_runner": [["int", 0.4343434302793772], ["str", 0.28598578261472574], ["List[str]", 0.09536330815948665], ["Tuple[Literal, Literal]", 0.09517004121661644]], "scheduler_job": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "session": [["sqlalchemy.orm.session.Session", 0.1586725960616235]], "ti": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]]}}, {"docstring": {"func": "Test if no on_*_callback are defined on DAG, Callbacks not registered and sent to DAG Processor", "long_descr": null, "ret": null}, "fn_lc": [[2102, 4], [2132, 23]], "fn_var_ln": {"call_args": [[2127, 8], [2127, 17]], "dr": [[2118, 8], [2118, 10]], "job_runner": [[2112, 8], [2112, 23]], "scheduler_job": [[2111, 8], [2111, 21]], "session": [[2117, 8], [2117, 15]], "ti": [[2119, 8], [2119, 10]]}, "fn_var_occur": {"call_args": [["call_args", "self", "job_runner", "_send_dag_callbacks_to_processor", "call_args", "args"], ["call_args", "dag_id", "dr", "dag_id"], ["call_args", "None"]], "dr": [["dr", "dag_maker", "create_dagrun"], ["ti", "dr", "get_task_instance"], ["call_args", "dag_id", "dr", "dag_id"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["self", "job_runner", "_send_dag_callbacks_to_processor", "mock", "Mock"], ["self", "job_runner", "_do_scheduling", "session"], ["self", "job_runner", "_send_dag_callbacks_to_processor", "assert_called_once"], ["call_args", "self", "job_runner", "_send_dag_callbacks_to_processor", "call_args", "args"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["ti", "set_state", "state", "session"], ["self", "job_runner", "_do_scheduling", "session"], ["session", "rollback"], ["session", "close"]], "ti": [["ti", "dr", "get_task_instance"], ["ti", "set_state", "state", "session"]]}, "name": "test_dagrun_callbacks_are_not_added_when_callbacks_are_not_defined", "params": {"dag_maker": "", "self": "", "state": ""}, "params_descr": {"dag_maker": "", "self": "", "state": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id"], ["dr", "dag_maker", "create_dagrun"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["self", "job_runner", "_send_dag_callbacks_to_processor", "mock", "Mock"], ["self", "job_runner", "_do_scheduling", "session"], ["self", "job_runner", "_send_dag_callbacks_to_processor", "assert_called_once"], ["call_args", "self", "job_runner", "_send_dag_callbacks_to_processor", "call_args", "args"]], "state": [["ti", "set_state", "state", "session"]]}, "params_p": {"args": [], "dag_maker": [["raiden.transfer.state.ChainState", 0.1226237248454424], ["raiden.utils.TokenNetworkID", 0.10667127515947632], ["mythril.laser.ethereum.state.global_state.GlobalState", 0.10001458350287784], ["List[raiden.utils.Address]", 0.08583975466493424]], "kwargs": [], "self": [], "state": [["Optional[dict]", 0.14773257096848613], ["sqlalchemy.orm.Session", 0.12597339601471136], ["str", 0.08742537717713594], ["agent_based_api.v1.state", 0.08742537717713594], ["homeassistancore.State", 0.08738431491343818], ["app.models.farm.Farm", 0.0836326197611303]]}, "q_name": "TestSchedulerJob.test_dagrun_callbacks_are_not_added_when_callbacks_are_not_defined", "ret_exprs": [], "ret_type": "", "variables": {"call_args": "", "dr": "", "job_runner": "", "scheduler_job": "", "session": "", "ti": ""}, "variables_p": {"call_args": [["Dict[str, Any]", 0.4188831097230028], ["str", 0.1725701036937809], ["List[str]", 0.10737864285323899], ["dict", 0.10191921494702677], ["OrderedDict[str, Any]", 0.09395800075378268]], "dr": [["str", 0.7939533672469699], ["list", 0.07254768298381777]], "job_runner": [["list", 0.20149718734998578], ["Dict[Tuple[str, str], int]", 0.19769466362817298], ["float", 0.10014221533967715], ["List[Dict[str, str]]", 0.09779765061906415]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["dict", 0.3003762999196161], ["Dict[Any, dict]", 0.09843549681209644], ["cmk.gui.plugins.visuals.utils.Filter", 0.09239619792222736], ["Union[Literal, dict]", 0.08977729422325847]], "ti": [["str", 0.18263523598046633], ["raiden.utils.SecretHash", 0.0873932948353416], ["Dict[str, Union[Any, Any]]", 0.08598658108316391]]}}, {"docstring": {"func": "Test if on_*_callback are defined on DAG, Callbacks ARE registered and sent to DAG Processor", "long_descr": null, "ret": null}, "fn_lc": [[2135, 4], [2167, 23]], "fn_var_ln": {"call_args": [[2162, 8], [2162, 17]], "dr": [[2153, 8], [2153, 10]], "job_runner": [[2147, 8], [2147, 23]], "scheduler_job": [[2146, 8], [2146, 21]], "session": [[2152, 8], [2152, 15]], "ti": [[2154, 8], [2154, 10]]}, "fn_var_occur": {"call_args": [["call_args", "self", "job_runner", "_send_dag_callbacks_to_processor", "call_args", "args"], ["call_args", "dag_id", "dr", "dag_id"], ["call_args", "None"], ["call_args", "msg", "msg"]], "dr": [["dr", "dag_maker", "create_dagrun"], ["ti", "dr", "get_task_instance"], ["call_args", "dag_id", "dr", "dag_id"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["self", "job_runner", "_send_dag_callbacks_to_processor", "mock", "Mock"], ["self", "job_runner", "_do_scheduling", "session"], ["self", "job_runner", "_send_dag_callbacks_to_processor", "assert_called_once"], ["call_args", "self", "job_runner", "_send_dag_callbacks_to_processor", "call_args", "args"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["ti", "set_state", "state", "session"], ["self", "job_runner", "_do_scheduling", "session"], ["session", "rollback"], ["session", "close"]], "ti": [["ti", "dr", "get_task_instance"], ["ti", "set_state", "state", "session"]]}, "name": "test_dagrun_callbacks_are_added_when_callbacks_are_defined", "params": {"dag_maker": "", "msg": "", "self": "", "state": ""}, "params_descr": {"dag_maker": "", "msg": "", "self": "", "state": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "on_failure_callback", "True", "on_success_callback", "True"], ["dr", "dag_maker", "create_dagrun"]], "msg": [["call_args", "msg", "msg"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "Mock"], ["self", "job_runner", "_send_dag_callbacks_to_processor", "mock", "Mock"], ["self", "job_runner", "_do_scheduling", "session"], ["self", "job_runner", "_send_dag_callbacks_to_processor", "assert_called_once"], ["call_args", "self", "job_runner", "_send_dag_callbacks_to_processor", "call_args", "args"]], "state": [["ti", "set_state", "state", "session"]]}, "params_p": {"args": [], "dag_maker": [["raiden.utils.TokenNetworkID", 0.10528325277591628]], "kwargs": [], "msg": [["dict", 0.1479494208611099], ["django.conf.settings.AUTH_USER_MODEL", 0.09162714349138038], ["models.Project", 0.08490052524954314], ["models.Category", 0.08490052524954314]], "self": [], "state": [["sqlalchemy.orm.Session", 0.13571804599492915], ["Optional[dict]", 0.1320592594991593], ["homeassistancore.State", 0.08959638361083508], ["str", 0.08490394436119582], ["agent_based_api.v1.state", 0.08490394436119582], ["Dict[str, float]", 0.08071872831218066]]}, "q_name": "TestSchedulerJob.test_dagrun_callbacks_are_added_when_callbacks_are_defined", "ret_exprs": [], "ret_type": "", "variables": {"call_args": "", "dr": "", "job_runner": "", "scheduler_job": "", "session": "", "ti": ""}, "variables_p": {"call_args": [["Dict[str, Any]", 0.4188831097230028], ["str", 0.1725701036937809], ["List[str]", 0.10737864285323899], ["dict", 0.10191921494702677], ["OrderedDict[str, Any]", 0.09395800075378268]], "dr": [["str", 0.7939533672469699], ["list", 0.07254768298381777]], "job_runner": [["list", 0.20149718734998578], ["Dict[Tuple[str, str], int]", 0.19769466362817298], ["float", 0.10014221533967715], ["List[Dict[str, str]]", 0.09779765061906415]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["dict", 0.3003762999196161], ["Dict[Any, dict]", 0.09843549681209644], ["cmk.gui.plugins.visuals.utils.Filter", 0.09239619792222736], ["Union[Literal, dict]", 0.08977729422325847]], "ti": [["str", 0.18263523598046633], ["raiden.utils.SecretHash", 0.0873932948353416], ["Dict[str, Union[Any, Any]]", 0.08598658108316391]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[2169, 4], [2199, 67]], "fn_var_ln": {"dr": [[2189, 8], [2189, 10]], "executor": [[2181, 8], [2181, 16]], "job_runner": [[2184, 8], [2184, 23]], "scheduler_job": [[2183, 8], [2183, 21]], "session": [[2188, 8], [2188, 15]], "ti": [[2191, 8], [2191, 10]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun"], ["ti", "dr", "get_task_instance"], ["dag_listener", "success", "dag_id", "dr", "dag_id"], ["dag_listener", "success", "run_id", "dr", "run_id"]], "executor": [["executor", "MockExecutor", "do_update", "False"], ["scheduler_job", "Job", "executor", "executor"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_do_scheduling", "session"]], "scheduler_job": [["scheduler_job", "Job", "executor", "executor"], ["self", "job_runner", "SchedulerJobRunner", "scheduler_job"]], "session": [["session", "settings", "Session"], ["ti", "set_state", "State", "SUCCESS", "session"], ["self", "job_runner", "_do_scheduling", "session"]], "ti": [["ti", "dr", "get_task_instance"], ["ti", "set_state", "State", "SUCCESS", "session"]]}, "name": "test_dagrun_notify_called_success", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "on_success_callback", "x", "print", "on_failure_callback", "x", "print", "processor_subdir", "TEST_DAG_FOLDER"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["dr", "dag_maker", "create_dagrun"]], "self": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_do_scheduling", "session"]]}, "params_p": {"args": [], "dag_maker": [["tests.async_mock.Mock", 0.18301846200292646], ["Set[int]", 0.16905864307911717], ["datasets.opencl.device_mapping.opencl_device_mapping_dataseOpenClDeviceMappingsDataset", 0.09004268578177768]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_dagrun_notify_called_success", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "executor": "", "job_runner": "", "scheduler_job": "", "session": "", "ti": ""}, "variables_p": {"dr": [["str", 0.27794707889316206], ["bytes", 0.14533102663181852], ["list", 0.1026031134898111], ["dict", 0.0919484508527111]], "executor": [["Dict[int, Dict[str, Any]]", 0.20966581378063906], ["str", 0.19574799186968853], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.12131013413775384], ["mock.MagicMock", 0.10573321053503261]], "job_runner": [["str", 0.42419953020872714], ["Dict[str, str]", 0.19388523789538176], ["dict", 0.10191755121164975], ["list", 0.09527559048318762], ["Dict[str, Union[Any, bool, str]]", 0.09399679528996309], ["int", 0.09072529491109059]], "scheduler_job": [["dict", 0.2814798551909752], ["bool", 0.224208947328532], ["Dict[str, Union[Any, Any, Any]]", 0.12585281134008208], ["str", 0.09503156588393918], ["Dict[str, int]", 0.0931865856894567], ["Dict[str, Any]", 0.09002645422134034]], "session": [["Dict[cmk.utils.type_defs.UserId, Dict[str, Any]]", 0.5722305888383199], ["Dict[str, Any]", 0.10434871991296227], ["Dict[str, Union[Any, str]]", 0.10434871991296227]], "ti": [["str", 0.18263523598046633], ["raiden.utils.SecretHash", 0.0873932948353416], ["Dict[str, Union[Any, Any]]", 0.08598658108316391]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[2201, 4], [2229, 24]], "fn_var_ln": {"dr": [[2211, 8], [2211, 10]], "job_runner": [[2225, 8], [2225, 23]], "res": [[2227, 8], [2227, 11]], "schedule_interval": [[2202, 8], [2202, 25]], "scheduler_job": [[2224, 8], [2224, 21]], "session": [[2209, 8], [2209, 15]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun"], ["dr", "None"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "res": [["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "schedule_interval": [["schedule_interval", "datetime", "timedelta", "days"], ["dag_maker", "dag_id", "schedule", "schedule_interval"], ["dag_maker", "dag_id", "schedule", "schedule_interval", "start_date", "DEFAULT_DATE", "schedule_interval"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["session", "query", "DagModel", "delete"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "name": "test_do_not_schedule_removed_task", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "schedule", "schedule_interval"], ["dr", "dag_maker", "create_dagrun"], ["dag_maker", "dag_id", "schedule", "schedule_interval", "start_date", "DEFAULT_DATE", "schedule_interval"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["res", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["raiden.utils.Address", 0.11530311155545252]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_do_not_schedule_removed_task", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "job_runner": "", "res": "", "schedule_interval": "", "scheduler_job": "", "session": ""}, "variables_p": {"dr": [["str", 0.7877526869529744], ["Dict[int, Dict[str, Any]]", 0.2122473130470255]], "job_runner": [["dict", 0.3037145263420105], ["float", 0.10468499733468752], ["Dict[str, Dict[str, str]]", 0.10283904063149174], ["str", 0.10047778707760027], ["Type[int]", 0.08656371816736502]], "res": [["list", 0.21951785094762066], ["geode.models.geocoding.Result", 0.17906533966105254], ["dict", 0.12805878479738664], ["raiden_contracts.tests.test_channel_update_transfer.test_update_invalid_balance_proof_arguments.balance_proof", 0.09223822284591446], ["Dict[str, Union[Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any]]", 0.0896509644891061], ["Dict[str, Union[int, str]]", 0.08916664473495861]], "schedule_interval": [["datetime.timedelta", 0.6982145756242223], ["str", 0.10821180047448166], ["float", 0.10067713749326727], ["int", 0.09289648640802878]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["sqlalchemy.orm.session.Session", 0.32884350848612487], ["sqlalchemy.orm.scoped_session", 0.08495421102226428], ["Optional[str]", 0.08019890643271727], ["kedro.framework.session.session.KedroSession", 0.07502748710080356]]}}, {"docstring": {"func": "Helper for testing DagRun states with simple two-task DAGs.", "long_descr": "This is hackish: a dag run is created but its tasks are\nrun by a backfill.", "ret": null}, "fn_lc": [[2232, 4], [2295, 45]], "fn_var_ln": {"dag": [[2288, 8], [2288, 14]], "dagrun_info": [[2250, 8], [2250, 19]], "dr": [[2287, 8], [2287, 10]], "ex_date": [[2268, 8], [2268, 15]], "run_kwargs": [[2247, 12], [2247, 22]], "ti": [[2294, 12], [2294, 14]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["dagrun_info", "dag", "next_dagrun_info", "None"], ["dr", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "dagrun_info", "logical_date", "state", "None", "session", "session"], ["dr", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "dr", "data_interval_end", "state", "None", "session", "session"], ["dag", "DagBag", "get_dag", "dag", "dag_id"], ["isinstance", "dag", "SerializedDAG"], ["dag", "run", "start_date", "ex_date", "end_date", "ex_date", "executor", "self", "null_exec", "run_kwargs"], ["dr", "dag", "dag"]], "dagrun_info": [["dagrun_info", "dag", "next_dagrun_info", "None"], ["dagrun_info", "None"], ["dr", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "dagrun_info", "logical_date", "state", "None", "session", "session"]], "dr": [["dr", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "dagrun_info", "logical_date", "state", "None", "session", "session"], ["dr", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "dr", "data_interval_end", "state", "None", "session", "session"], ["ex_date", "dr", "execution_date"], ["self", "null_exec", "mock_task_fail", "dag_id", "tid", "dr", "run_id"], ["dr", "DagRun", "find", "dag_id", "dag_id", "execution_date", "ex_date", "session", "session"], ["dr", "dr"], ["dr", "dag", "dag"], ["dr", "state", "dagrun_state"], ["ti", "dr", "get_task_instance", "task_id"]], "ex_date": [["ex_date", "dr", "execution_date"], ["dag", "run", "start_date", "ex_date", "end_date", "ex_date", "executor", "self", "null_exec", "run_kwargs"], ["dr", "DagRun", "find", "dag_id", "dag_id", "execution_date", "ex_date", "session", "session"]], "run_kwargs": [["run_kwargs", "None"], ["dag", "run", "start_date", "ex_date", "end_date", "ex_date", "executor", "self", "null_exec", "run_kwargs"]], "ti": [["ti", "dr", "get_task_instance", "task_id"], ["ti", "state", "expected_state"]]}, "name": "evaluate_dagrun", "params": {"advance_execution_date": "", "dag_id": "", "dagrun_state": "", "expected_task_states": "", "run_kwargs": "", "self": "", "session": ""}, "params_descr": {"advance_execution_date": "", "dag_id": "", "dagrun_state": "", "expected_task_states": "", "run_kwargs": "", "self": "", "session": ""}, "params_occur": {"advance_execution_date": [], "dag_id": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["self", "null_exec", "mock_task_fail", "dag_id", "tid", "dr", "run_id"], ["dag", "DagBag", "get_dag", "dag", "dag_id"], ["dr", "DagRun", "find", "dag_id", "dag_id", "execution_date", "ex_date", "session", "session"]], "dagrun_state": [["dr", "state", "dagrun_state"]], "expected_task_states": [["expected_task_states", "items"], ["expected_task_states", "items"]], "run_kwargs": [["run_kwargs", "None"], ["dag", "run", "start_date", "ex_date", "end_date", "ex_date", "executor", "self", "null_exec", "run_kwargs"]], "self": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["self", "null_exec", "mock_task_fail", "dag_id", "tid", "dr", "run_id"], ["dag", "run", "start_date", "ex_date", "end_date", "ex_date", "executor", "self", "null_exec", "run_kwargs"]], "session": [["dr", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "dagrun_info", "logical_date", "state", "None", "session", "session"], ["dr", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "dr", "data_interval_end", "state", "None", "session", "session"], ["dr", "DagRun", "find", "dag_id", "dag_id", "execution_date", "ex_date", "session", "session"]]}, "params_p": {"advance_execution_date": [["bool", 0.4816429069932744], ["Union[None, str, Iterable[str]]", 0.2366633115690385], ["List[Dict[str, Any]]", 0.10713854119965222], ["Callable", 0.08839218735412496], ["mode.utils.times.Seconds", 0.08616305288391005]], "args": [], "dag_id": [["int", 0.19107142474521097], ["raiden.transfer.mediated_transfer.state.LockedTransferUnsignedState", 0.1045979366184078], ["raiden.transfer.mediated_transfer.state.LockedTransferSignedState", 0.1045979366184078], ["raiden.transfer.state.NettingChannelState", 0.1045979366184078], ["raiden.utils.SecreHash", 0.09901492497109123], ["dict", 0.09667639227152845], ["models.User", 0.09548241686576801]], "dagrun_state": [["int", 0.3754422484325693], ["bool", 0.2983042087607423], ["dict", 0.083110930143801], ["float", 0.07908769211422084]], "expected_task_states": [["dict", 0.42479109690120886], ["Dict[str, Any]", 0.29425411024326625], ["T", 0.10070785569386283], ["str", 0.09012346858083095], ["datetime.datetime", 0.09012346858083095]], "kwargs": [], "run_kwargs": [["List[recidiviz.persistence.entity.state.entities.StateIncarcerationPeriod]", 0.1003051582761579], ["List[recidiviz.persistence.entity.state.entities.StateAssessment]", 0.09127203363000862], ["datetime.date", 0.09127203363000862], ["str", 0.08507940806515552], ["sqlalchemy.engine.Engine", 0.08194419164096423], ["datetime.datetime", 0.08194419164096423]], "self": [], "session": [["datetime.datetime", 0.28948853147397124], ["str", 0.20457676677300685], ["Optional[datetime.datetime]", 0.1191950830891878], ["types.ModuleType", 0.09725108718986303], ["recidiviz.persistence.database.session.Session", 0.09725108718986303], ["bool", 0.09611872214205411], ["sqlalchemy.engine.Engine", 0.09611872214205411]]}, "q_name": "TestSchedulerJob.evaluate_dagrun", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dagrun_info": "", "dr": "", "ex_date": "", "run_kwargs": "", "ti": ""}, "variables_p": {"dag": [["dict", 0.2922112199717366], ["str", 0.10359184085969765]], "dagrun_info": [["Dict[str, None]", 0.22526809621935034], ["Tuple[None, Tuple[None, None]]", 0.20048728510510547], ["str", 0.0818584884810027], ["Dict[str, str]", 0.07523959369224123]], "dr": [["byceps.services.user.transfer.models.User", 0.13036413502047436], ["Tuple[Any, Any, Any, Any, Any, Any, Any, Any, Any, Any]", 0.1292190158510542], ["dict", 0.10788557684182044], ["float", 0.10108053840423742], ["str", 0.09410898830319878], ["datetime.datetime", 0.09323474647995444], ["byceps.services.party.transfer.models.Party", 0.09242432812816544], ["viewer.models.Gallery", 0.08833254885600264]], "ex_date": [["datetime.datetime", 0.2021585858084377], ["datetime.date", 0.14283763352716417], ["str", 0.13527014782940175], ["datetime.datetime.date", 0.11673445248040003], ["Pattern[str]", 0.10893731402279806], ["list", 0.08083616976238009], ["Dict[Any, List[str]]", 0.0727233400545409]], "run_kwargs": [["int", 0.23559145732442469], ["datetime.datetime", 0.20690192031827842], ["List[str]", 0.09358787561834854]], "ti": [["List[unittesmock.MagicMock]", 0.12401140901309665], ["Optional[List[Any]]", 0.10831346586921775]]}}, {"docstring": {"func": "DagRuns with one failed and one incomplete root task -> FAILED", "long_descr": null, "ret": null}, "fn_lc": [[2297, 4], [2308, 9]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_dagrun_fail", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "evaluate_dagrun", "dag_id", "expected_task_states", "State", "FAILED", "State", "UPSTREAM_FAILED", "dagrun_state", "State", "FAILED"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_dagrun_fail", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "DagRuns with one failed and one successful root task -> SUCCESS", "long_descr": null, "ret": null}, "fn_lc": [[2310, 4], [2321, 9]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_dagrun_success", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "evaluate_dagrun", "dag_id", "expected_task_states", "State", "FAILED", "State", "SUCCESS", "dagrun_state", "State", "SUCCESS"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_dagrun_success", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "DagRuns with one successful and one failed root task -> FAILED", "long_descr": null, "ret": null}, "fn_lc": [[2323, 4], [2334, 9]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_dagrun_root_fail", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "evaluate_dagrun", "dag_id", "expected_task_states", "State", "SUCCESS", "State", "FAILED", "dagrun_state", "State", "FAILED"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_dagrun_root_fail", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "DagRuns with one unfinished and one failed root task -> RUNNING", "long_descr": null, "ret": null}, "fn_lc": [[2336, 4], [2361, 40]], "fn_var_ln": {"dag": [[2343, 8], [2343, 11]], "dag_id": [[2342, 8], [2342, 14]], "dr": [[2344, 8], [2344, 10]], "state": [[2358, 12], [2358, 20]], "ti": [[2357, 12], [2357, 14]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["dr", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "state", "None"], ["dag", "run", "start_date", "dr", "execution_date", "end_date", "dr", "execution_date", "executor", "self", "null_exec"]], "dag_id": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["self", "null_exec", "mock_task_fail", "dag_id", "dr", "run_id"]], "dr": [["dr", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "state", "None"], ["self", "null_exec", "mock_task_fail", "dag_id", "dr", "run_id"], ["dag", "run", "start_date", "dr", "execution_date", "end_date", "dr", "execution_date", "executor", "self", "null_exec"], ["ti", "dr", "get_task_instance", "session", "session"], ["dr", "update_state"], ["dr", "state", "State", "RUNNING"]], "state": [["dr", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "state", "None"], ["ti", "state", "State", "NONE"], ["dr", "state", "State", "RUNNING"]], "ti": [["ti", "dr", "get_task_instance", "session", "session"], ["ti", "state", "State", "NONE"]]}, "name": "test_dagrun_root_fail_unfinished", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["self", "null_exec", "mock_task_fail", "dag_id", "dr", "run_id"], ["dag", "run", "start_date", "dr", "execution_date", "end_date", "dr", "execution_date", "executor", "self", "null_exec"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_dagrun_root_fail_unfinished", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_id": "", "dr": "", "state": "", "ti": ""}, "variables_p": {"dag": [["int", 0.20598512622881143], ["str", 0.19173817158885662], ["Dict[str, Any]", 0.11959359464493083], ["List[Dict[str, Any]]", 0.08257111020410406], ["List[str]", 0.07908125064900758]], "dag_id": [["str", 0.28616759807911496], ["int", 0.26743315585398886], ["list", 0.1699503829864769], ["Set[str]", 0.10508133951305866], ["datetime.datetime.datetime", 0.09164361403871675], ["set", 0.07972390952864393]], "dr": [["viewer.models.Gallery", 0.1220181450491472], ["str", 0.10060635082785759], ["Optional[excars.models.rides.Ride]", 0.09663938636964606]], "state": [["dict", 0.3268045129999334], ["str", 0.3184314030393503], ["datetime.timedelta", 0.19074600976750922], ["Type[hypha.apply.projects.models.Report]", 0.07632442080768687]], "ti": [["str", 0.1128090197739507], ["List[str]", 0.10672986309906232], ["golem.rpc.session.WebSocketAddress", 0.1037254916604468], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.0931513634173588]]}}, {"docstring": {"func": "DagRuns with one successful and one future root task -> SUCCESS", "long_descr": "Noted: the DagRun state could be still in running state during CI.", "ret": null}, "fn_lc": [[2363, 4], [2382, 64]], "fn_var_ln": {"dag": [[2371, 8], [2371, 11]], "dag_id": [[2370, 8], [2370, 14]], "first_run": [[2378, 8], [2378, 17]], "job_runner": [[2375, 8], [2375, 23]], "scheduler_job": [[2374, 8], [2374, 21]], "ti_ids": [[2379, 8], [2379, 14]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["dag", "sync_to_db"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "num_runs", "subdir", "dag", "fileloc"]], "dag_id": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["first_run", "DagRun", "find", "dag_id", "dag_id", "execution_date", "DEFAULT_DATE"]], "first_run": [["first_run", "DagRun", "find", "dag_id", "dag_id", "execution_date", "DEFAULT_DATE"], ["ti_ids", "ti", "task_id", "ti", "state", "ti", "first_run", "get_task_instances"], ["first_run", "state", "State", "SUCCESS", "State", "RUNNING"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "num_runs", "subdir", "dag", "fileloc"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]], "scheduler_job": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "num_runs", "subdir", "dag", "fileloc"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]], "ti_ids": [["ti_ids", "ti", "task_id", "ti", "state", "ti", "first_run", "get_task_instances"], ["ti_ids", "State", "SUCCESS"]]}, "name": "test_dagrun_root_after_dagrun_unfinished", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "num_runs", "subdir", "dag", "fileloc"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_dagrun_root_after_dagrun_unfinished", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_id": "", "first_run": "", "job_runner": "", "scheduler_job": "", "ti_ids": ""}, "variables_p": {"dag": [["bytearray", 0.10701509297480291], ["set", 0.09924400124647591], ["int", 0.09037961213982888], ["List[str]", 0.08889841750418898]], "dag_id": [["int", 0.20868723631208208], ["Type[Tuple[str, Any]]", 0.1812775849813789], ["Tuple[int]", 0.12142391053326725], ["set", 0.0975963084357558]], "first_run": [["Optional[magic.models.deck.Deck]", 0.22007235224256944], ["int", 0.1948518599460879], ["list", 0.09774251149026485]], "job_runner": [["str", 0.27881813504862507], ["int", 0.18587875669908338], ["Dict[str, int]", 0.10093969336086317]], "scheduler_job": [["str", 0.19207730237348897], ["cincoconfig.config.Schema", 0.07599492366047417]], "ti_ids": [["int", 0.23406684730936234], ["tagstore.models.entity.EntityId", 0.20535524477134265], ["list", 0.10167628891940442], ["Dict[str, int]", 0.10009894809814375], ["KeysView[str]", 0.08619876008409322], ["dict", 0.07913910955239511]]}}, {"docstring": {"func": "DagRun is marked a success if ignore_first_depends_on_past=True", "long_descr": "Test that an otherwise-deadlocked dagrun is marked as a success\nif ignore_first_depends_on_past=True and the dagrun execution_date\nis after the start_date.", "ret": null}, "fn_lc": [[2384, 4], [2401, 9]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_dagrun_deadlock_ignore_depends_on_past_advance_ex_date", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "evaluate_dagrun", "dag_id", "expected_task_states", "State", "SUCCESS", "State", "SUCCESS", "dagrun_state", "State", "SUCCESS", "advance_execution_date", "True", "run_kwargs", "dict", "ignore_first_depends_on_past", "True"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_dagrun_deadlock_ignore_depends_on_past_advance_ex_date", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Test that ignore_first_depends_on_past doesn't affect results", "long_descr": "(this is the same test as\ntest_dagrun_deadlock_ignore_depends_on_past_advance_ex_date except\nthat start_date == execution_date so depends_on_past is irrelevant).", "ret": null}, "fn_lc": [[2403, 4], [2418, 9]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_dagrun_deadlock_ignore_depends_on_past", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "evaluate_dagrun", "dag_id", "expected_task_states", "State", "SUCCESS", "State", "SUCCESS", "dagrun_state", "State", "SUCCESS", "run_kwargs", "dict", "ignore_first_depends_on_past", "True"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_dagrun_deadlock_ignore_depends_on_past", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Test that the scheduler respects start_dates, even when DAGs have run", "long_descr": null, "ret": null}, "fn_lc": [[2427, 4], [2484, 56]], "fn_var_ln": {"backfill_job": [[2459, 16], [2459, 28]], "bf_exec": [[2458, 16], [2458, 23]], "dag": [[2434, 16], [2434, 19]], "dag_id": [[2433, 16], [2433, 22]], "is_paused_upon_creation": [[2440, 16], [2440, 49]], "job_runner": [[2478, 16], [2478, 31]], "other_dag": [[2439, 16], [2439, 25]], "scheduler_job": [[2475, 16], [2475, 29]]}, "fn_var_occur": {"backfill_job": [["backfill_job", "Job", "executor", "bf_exec"], ["job_runner", "BackfillJobRunner", "job", "backfill_job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["run_job", "job", "backfill_job", "execute_callable", "job_runner", "_execute"]], "bf_exec": [["bf_exec", "MockExecutor"], ["backfill_job", "Job", "executor", "bf_exec"], ["TaskInstanceKey", "dag", "dag_id", "DEFAULT_DATE", "isoformat", "State", "SUCCESS", "None", "bf_exec", "sorted_tasks"]], "dag": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["dag", "clear"], ["dag", "start_date", "datetime", "datetime", "now", "timezone", "utc"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "dag", "fileloc", "num_runs"], ["job_runner", "BackfillJobRunner", "job", "backfill_job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["TaskInstanceKey", "dag", "dag_id", "DEFAULT_DATE", "isoformat", "State", "SUCCESS", "None", "bf_exec", "sorted_tasks"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "dag", "fileloc", "num_runs"]], "dag_id": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["len", "session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag_id", "all"], ["len", "session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag_id", "all"], ["TaskInstanceKey", "dag", "dag_id", "DEFAULT_DATE", "isoformat", "State", "SUCCESS", "None", "bf_exec", "sorted_tasks"], ["len", "session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag_id", "all"]], "is_paused_upon_creation": [["other_dag", "is_paused_upon_creation", "True"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "dag", "fileloc", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"], ["job_runner", "BackfillJobRunner", "job", "backfill_job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["run_job", "job", "backfill_job", "execute_callable", "job_runner", "_execute"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "dag", "fileloc", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]], "other_dag": [["other_dag", "self", "dagbag", "get_dag"], ["other_dag", "is_paused_upon_creation", "True"], ["other_dag", "sync_to_db"]], "scheduler_job": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "dag", "fileloc", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"], ["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "dag", "fileloc", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]]}, "name": "test_scheduler_start_date", "params": {"configs": "", "self": ""}, "params_descr": {"configs": "", "self": ""}, "params_occur": {"configs": [["conf_vars", "configs"]], "self": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["other_dag", "self", "dagbag", "get_dag"], ["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "dag", "fileloc", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"], ["self", "null_exec", "sorted_tasks"], ["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "dag", "fileloc", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"], ["self", "null_exec", "sorted_tasks"]]}, "params_p": {"args": [], "configs": [["tests.basilisp.helpers.CompileFn", 0.7233745323690253], ["str", 0.12332110123316922]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_scheduler_start_date", "ret_exprs": [], "ret_type": "", "variables": {"backfill_job": "", "bf_exec": "", "dag": "", "dag_id": "", "is_paused_upon_creation": "", "job_runner": "", "other_dag": "", "scheduler_job": ""}, "variables_p": {"backfill_job": [["Dict[str, None]", 0.1642773211040583]], "bf_exec": [["dict", 0.11264629321308432]], "dag": [["grpy.core.models.Grouping", 0.21802853488678686], ["dict", 0.136701734588801], ["str", 0.09931876152337174], ["track.tests.factories.RecordFactory", 0.07762067561255626], ["Sequence[byceps.services.ticketing.models.tickeTicket]", 0.0755266766282523], ["Tuple[Any, Any, Any, Any, Any, Any, Any, Any, Any, Any]", 0.07166201197602466], ["byceps.services.shop.storefrontransfer.models.Storefront", 0.0692908529718182]], "dag_id": [["list", 0.8033216865921294], ["str", 0.10720400464566078], ["Type[str]", 0.0894743087622097]], "is_paused_upon_creation": [["bool", 0.8156554334915593], ["faustypes.models.CoercionMapping", 0.09217228325422039], ["str", 0.09217228325422039]], "job_runner": [["Dict[starfish.core.types._constants.Axes, int]", 0.2803333952867187], ["bool", 0.10582823866309138], ["str", 0.1027756267881065], ["dict", 0.09356440654136576]], "other_dag": [["int", 0.40026608982411876], ["str", 0.1921705582657005], ["float", 0.11707363315226658], ["Dict[str, int]", 0.10715880008641418], ["Dict[str, Optional[str]]", 0.09719253009928822], ["Pattern[str]", 0.08613838857221175]], "scheduler_job": [["str", 0.2954646169677089]]}}, {"docstring": {"func": "Test that the scheduler respects task start dates that are different from DAG start dates", "long_descr": null, "ret": null}, "fn_lc": [[2493, 4], [2527, 50]], "fn_var_ln": {"dag": [[2503, 12], [2503, 15]], "dag_id": [[2502, 12], [2502, 18]], "dagbag": [[2498, 12], [2498, 18]], "is_paused_upon_creation": [[2509, 12], [2509, 45]], "job_runner": [[2517, 12], [2517, 27]], "other_dag": [[2508, 12], [2508, 21]], "scheduler_job": [[2514, 12], [2514, 25]], "session": [[2520, 12], [2520, 19]], "ti1s": [[2522, 12], [2522, 16]], "ti2s": [[2523, 12], [2523, 16]], "tiq": [[2521, 12], [2521, 15]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["dag", "is_paused_upon_creation", "False"], ["dagbag", "bag_dag", "dag", "dag", "root_dag", "dag"], ["dagbag", "bag_dag", "dag", "other_dag", "root_dag", "other_dag"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "dag", "fileloc", "num_runs"]], "dag_id": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["tiq", "session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag_id"]], "dagbag": [["dagbag", "DagBag", "dag_folder", "os", "path", "join", "settings", "DAGS_FOLDER", "include_examples", "False"], ["dag", "self", "dagbag", "get_dag", "dag_id"], ["dagbag", "bag_dag", "dag", "dag", "root_dag", "dag"], ["other_dag", "self", "dagbag", "get_dag"], ["dagbag", "bag_dag", "dag", "other_dag", "root_dag", "other_dag"], ["dagbag", "sync_to_db"]], "is_paused_upon_creation": [["dag", "is_paused_upon_creation", "False"], ["other_dag", "is_paused_upon_creation", "True"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "dag", "fileloc", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]], "other_dag": [["other_dag", "self", "dagbag", "get_dag"], ["other_dag", "is_paused_upon_creation", "True"], ["dagbag", "bag_dag", "dag", "other_dag", "root_dag", "other_dag"]], "scheduler_job": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "dag", "fileloc", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]], "session": [["session", "settings", "Session"], ["tiq", "session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag_id"]], "ti1s": [["ti1s", "tiq", "filter", "TaskInstance", "task_id", "all"], ["len", "ti1s"]], "ti2s": [["ti2s", "tiq", "filter", "TaskInstance", "task_id", "all"], ["len", "ti2s"]], "tiq": [["tiq", "session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag_id"], ["ti1s", "tiq", "filter", "TaskInstance", "task_id", "all"], ["ti2s", "tiq", "filter", "TaskInstance", "task_id", "all"]]}, "name": "test_scheduler_task_start_date", "params": {"configs": "", "self": ""}, "params_descr": {"configs": "", "self": ""}, "params_occur": {"configs": [["conf_vars", "configs"]], "self": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["other_dag", "self", "dagbag", "get_dag"], ["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "dag", "fileloc", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]]}, "params_p": {"args": [], "configs": [["tests.basilisp.helpers.CompileFn", 0.7567926974970864], ["str", 0.14066445598022134]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_scheduler_task_start_date", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_id": "", "dagbag": "", "is_paused_upon_creation": "", "job_runner": "", "other_dag": "", "scheduler_job": "", "session": "", "ti1s": "", "ti2s": "", "tiq": ""}, "variables_p": {"dag": [["int", 0.29450752433179406], ["set", 0.12077276922489943], ["str", 0.11390423252833799], ["bytearray", 0.09164759431936867], ["List[Optional[str]]", 0.08959206128697801]], "dag_id": [["tagstore.models.entity.EntityId", 0.2693006545482235], ["str", 0.19304229700355363], ["Callable(id)[[object], int]", 0.10941865800255897], ["dict", 0.0881464353874502], ["int", 0.08405498418173077]], "dagbag": [["str", 0.5804523777725634], ["bool", 0.22534091876512494], ["int", 0.19420670346231172]], "is_paused_upon_creation": [["bool", 0.8201923351145132], ["Set[str]", 0.0824169208015331]], "job_runner": [["Dict[starfish.core.types._constants.Axes, int]", 0.2803333952867187], ["bool", 0.10582823866309138], ["str", 0.1027756267881065], ["dict", 0.09356440654136576]], "other_dag": [["int", 0.37182120208491465], ["str", 0.11403143150070218], ["list", 0.10197502278008409], ["Pattern[Any]", 0.09862426064431695], ["Pattern[str]", 0.09403070025506109]], "scheduler_job": [["str", 0.2954646169677089]], "session": [["dict", 0.13983645869551795], ["Optional[str]", 0.09684526445888042], ["SMSShell.models.session.Session", 0.08986525033500743], ["unittesmock.MagicMock", 0.07950133751397774]], "ti1s": [["int", 0.3150841954757191], ["List[str]", 0.22255645483775374], ["list", 0.17642353237398345], ["List[int]", 0.08617000542027521]], "ti2s": [["int", 0.3150841954757191], ["List[str]", 0.22255645483775374], ["list", 0.17642353237398345], ["List[int]", 0.08617000542027521]], "tiq": [["int", 0.4502601486057767], ["app.models.Tweet", 0.12446497046539937], ["float", 0.11590603440247811]]}}, {"docstring": {"func": "Test that the scheduler can successfully queue multiple dags in parallel", "long_descr": null, "ret": null}, "fn_lc": [[2536, 4], [2559, 100]], "fn_var_ln": {"dag": [[2543, 16], [2543, 19]], "dag_id": [[2557, 12], [2557, 18]], "dag_ids": [[2541, 12], [2541, 19]], "job_runner": [[2549, 12], [2549, 27]], "scheduler_job": [[2546, 12], [2546, 25]], "session": [[2558, 12], [2558, 19]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["dag", "clear"]], "dag_id": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["len", "session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag_id", "all"]], "dag_ids": [], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "path", "join", "TEST_DAG_FOLDER", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]], "scheduler_job": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "path", "join", "TEST_DAG_FOLDER", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]], "session": [["session", "settings", "Session"], ["len", "session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag_id", "all"]]}, "name": "test_scheduler_multiprocessing", "params": {"configs": "", "self": ""}, "params_descr": {"configs": "", "self": ""}, "params_occur": {"configs": [["conf_vars", "configs"]], "self": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "path", "join", "TEST_DAG_FOLDER", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]]}, "params_p": {"args": [], "configs": [["tests.basilisp.helpers.CompileFn", 0.9999999999391641], ["str", 3.5654909528445366e-11]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_scheduler_multiprocessing", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_id": "", "dag_ids": "", "job_runner": "", "scheduler_job": "", "session": ""}, "variables_p": {"dag": [["int", 0.5241788825013294], ["Type[range]", 0.26383815714380304], ["Counter[int]", 0.12160012102355267], ["Type[str]", 0.09038283933131495]], "dag_id": [["list", 0.729250721693088], ["str", 0.09970203284972569]], "dag_ids": [["Optional[str]", 0.09999999999999999], ["int", 0.09999999999999999], ["List[int]", 0.09999999999999999], ["services.ticketing.transfer.models.TicketID", 0.09999999999999999], ["Type[models.User]", 0.09999999999999999], ["shop.transfer.models.ShopID", 0.09999999999999999], ["Type[pipeline.netfile.models.AbstractSchedule]", 0.09999999999999999]], "job_runner": [["dict", 0.40714088556170025], ["str", 0.3835479568498672], ["list", 0.10299815699635022]], "scheduler_job": [["str", 0.09965639791845374], ["python.jobs.Job", 0.09447108520431027]], "session": [["List[str]", 0.13932644144610623], ["Dict[str, Any]", 0.11340103106742726], ["trakcore.config.TraktCredentials", 0.10226649775151964], ["dict", 0.09421504016728277]]}}, {"docstring": {"func": "Test task instances not queued when pool is full", "long_descr": null, "ret": null}, "fn_lc": [[2568, 4], [2601, 48]], "fn_var_ln": {"dr": [[2594, 12], [2594, 14]], "job_runner": [[2586, 12], [2586, 27]], "pool": [[2581, 12], [2581, 16]], "scheduler_job": [[2585, 12], [2585, 25]], "session": [[2580, 12], [2580, 19]], "task_instances_list": [[2597, 12], [2597, 31]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["dr", "dag_maker", "create_dagrun_after", "dr", "run_type", "DagRunType", "SCHEDULED", "state", "State", "RUNNING"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["task_instances_list", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "pool": [["BashOperator", "task_id", "pool", "bash_command"], ["pool", "Pool", "pool", "slots"], ["session", "add", "pool"]], "scheduler_job": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"]], "session": [["session", "settings", "Session"], ["session", "add", "pool"], ["session", "flush"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["session", "flush"], ["task_instances_list", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "task_instances_list": [["task_instances_list", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "task_instances_list"]]}, "name": "test_scheduler_verify_pool_full", "params": {"configs": "", "dag_maker": "", "self": ""}, "params_descr": {"configs": "", "dag_maker": "", "self": ""}, "params_occur": {"configs": [["conf_vars", "configs"]], "dag_maker": [["dag_maker", "dag_id"], ["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr", "dag_maker", "create_dagrun_after", "dr", "run_type", "DagRunType", "SCHEDULED", "state", "State", "RUNNING"]], "self": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["task_instances_list", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "configs": [["tests.basilisp.helpers.CompileFn", 0.9999999999391641], ["str", 3.5654909528445366e-11]], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_scheduler_verify_pool_full", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "job_runner": "", "pool": "", "scheduler_job": "", "session": "", "task_instances_list": ""}, "variables_p": {"dr": [["str", 0.3276462601237258], ["Dict[str, Any]", 0.10127098800801435], ["dict", 0.09474485896768242], ["raiden.utils.Address", 0.08762605530622433]], "job_runner": [["MagicMock[Union[mock.AsyncMock, mock.MagicMock]]", 0.2974210203756613], ["unittesmock._patch[Union[unittesmock.AsyncMock, unittesmock.MagicMock]]", 0.297225070103302], ["os._Environ[str]", 0.09056093154225765], ["Dict[Any, Union[Any, Any]]", 0.08461451467904778]], "pool": [["dict", 0.3221525614412669], ["pydynasync.models.Changes", 0.11113917321604161], ["set", 0.08854018839338602], ["str", 0.07480369015282017]], "scheduler_job": [["str", 0.3289320251700398]], "session": [["users.models.JustfixUser", 0.09916762054798134]], "task_instances_list": [["dict", 0.1327508515897508], ["List[None]", 0.13233730731023197], ["Dict[str, Any]", 0.09029780874614485], ["raiden.transfer.state.PendingLocksState", 0.08980445660624374], ["Generator[Any, None, None]", 0.08619396211856936], ["tuple", 0.08619396211856936], ["int", 0.08609150239908649], ["List[int]", 0.08423883014729164]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[2632, 8], [2637, 24]], "fn_var_ln": {"dr": [[2636, 16], [2636, 18]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr", "dag_maker", "create_dagrun_after", "dr", "run_type", "DagRunType", "SCHEDULED"]]}, "name": "_create_dagruns", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_scheduler_verify_pool_full_2_slots_per_task.<locals>._create_dagruns", "ret_exprs": [], "ret_type": "", "variables": {"dr": ""}, "variables_p": {"dr": [["str", 0.681251074607625], ["Set[str]", 0.11617581937022295], ["List[str]", 0.09946341575061407]]}}, {"docstring": {"func": "Test task instances not queued when pool is full.", "long_descr": "Variation with non-default pool_slots", "ret": null}, "fn_lc": [[2604, 4], [2647, 44]], "fn_var_ln": {"job_runner": [[2627, 8], [2627, 23]], "pool": [[2622, 8], [2622, 12]], "scheduler_job": [[2626, 8], [2626, 21]], "task_instances_list": [[2642, 8], [2642, 27]]}, "fn_var_occur": {"job_runner": [["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["task_instances_list", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "pool": [], "scheduler_job": [], "task_instances_list": [["task_instances_list", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "task_instances_list"]]}, "name": "test_scheduler_verify_pool_full_2_slots_per_task", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [], "self": [["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["task_instances_list", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "session": [["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["task_instances_list", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["bool", 0.14829848245138652], ["List[List[int]]", 0.06265197973102365]], "kwargs": [], "self": [], "session": [["str", 0.23476253242571288], ["Dict[str, Any]", 0.09940754624096232], ["django.conf.settings.AUTH_USER_MODEL", 0.0979349409399482]]}, "q_name": "TestSchedulerJob.test_scheduler_verify_pool_full_2_slots_per_task", "ret_exprs": [], "ret_type": "", "variables": {"job_runner": "", "pool": "", "scheduler_job": "", "task_instances_list": ""}, "variables_p": {"job_runner": [["vendor.pipenv.vendor.psutil._common.NicDuplex", 0.27902399954087875], ["Set[Tuple[Any, Any]]", 0.22708361675385894], ["DefaultDict[Any, dict]", 0.2084289513927878], ["OrderedDict", 0.09416935896594424], ["Dict[str, Set]", 0.08942533846667604]], "pool": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "scheduler_job": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "task_instances_list": [["dict", 0.1327508515897508], ["List[None]", 0.13233730731023197], ["Dict[str, Any]", 0.09029780874614485], ["raiden.transfer.state.PendingLocksState", 0.08980445660624374], ["Generator[Any, None, None]", 0.08619396211856936], ["tuple", 0.08619396211856936], ["int", 0.08609150239908649], ["List[int]", 0.08423883014729164]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[2686, 8], [2698, 25]], "fn_var_ln": {"next_info": [[2696, 16], [2696, 25]]}, "fn_var_occur": {"next_info": [["next_info", "dag", "next_dagrun_info", "None"], ["next_info", "None"], ["dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "next_info", "logical_date", "data_interval", "next_info", "data_interval", "state", "DagRunState", "RUNNING"], ["next_info", "dag", "next_dagrun_info", "next_info", "data_interval"], ["next_info", "None"]]}, "name": "_create_dagruns", "params": {"dag": "airflow.models.DAG"}, "params_descr": {"dag": ""}, "params_occur": {"dag": [["dag_d1", "dag_maker", "dag"], ["dag_d2", "dag_maker", "dag"], ["next_info", "dag", "next_dagrun_info", "None"], ["dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "next_info", "logical_date", "data_interval", "next_info", "data_interval", "state", "DagRunState", "RUNNING"], ["next_info", "dag", "next_dagrun_info", "next_info", "data_interval"]]}, "params_p": {"args": [], "dag": [["opentrons.types.Point", 0.13544937473478863], ["cmk.utils.type_defs.HostName", 0.10252329155064266], ["Dict[str, str]", 0.09712976180994458], ["Optional[str]", 0.08874189250797938], ["dict", 0.08606211647027236], ["Any", 0.08511024738868964], ["cmk.utils.type_defs.EventRule", 0.0845729990190733]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_scheduler_keeps_scheduling_pool_full.<locals>._create_dagruns", "ret_exprs": [], "ret_type": "", "variables": {"next_info": ""}, "variables_p": {"next_info": [["dict", 0.3766132842727505], ["Dict[str, None]", 0.23817576803003607], ["Tuple[None, Tuple[None, None]]", 0.14040854972240482], ["Optional[Dict[str, Any]]", 0.07858514622753783]]}}, {"docstring": {"func": "Test task instances in a pool that isn't full keep getting scheduled even when a pool is full.", "long_descr": null, "ret": null}, "fn_lc": [[2649, 4], [2718, 9]], "fn_var_ln": {"dag_d1": [[2662, 8], [2662, 14]], "dag_d2": [[2673, 8], [2673, 14]], "job_runner": [[2683, 8], [2683, 23]], "pool_p1": [[2676, 8], [2676, 15]], "pool_p2": [[2677, 8], [2677, 15]], "scheduler_job": [[2682, 8], [2682, 21]], "session": [[2675, 8], [2675, 15]], "task_instances_list2": [[2709, 8], [2709, 28]]}, "fn_var_occur": {"dag_d1": [["_create_dagruns", "dag_d1"]], "dag_d2": [["_create_dagruns", "dag_d2"]], "job_runner": [["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["task_instances_list2", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "pool_p1": [], "pool_p2": [], "scheduler_job": [], "session": [["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["task_instances_list2", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "task_instances_list2": [["task_instances_list2", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "task_instances_list2"], ["all", "task_instance", "pool", "task_instance", "task_instances_list2"]]}, "name": "test_scheduler_keeps_scheduling_pool_full", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [], "self": [["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["task_instances_list2", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["tests.basilisp.helpers.CompileFn", 0.2], ["str", 0.2], ["tests.async_mock.MagicMock", 0.1], ["tests.async_mock.Mock", 0.1], ["Mapping[str, Any]", 0.1]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_scheduler_keeps_scheduling_pool_full", "ret_exprs": [], "ret_type": "", "variables": {"dag_d1": "", "dag_d2": "", "job_runner": "", "pool_p1": "", "pool_p2": "", "scheduler_job": "", "session": "", "task_instances_list2": ""}, "variables_p": {"dag_d1": [["int", 5.821456607631447e-11]], "dag_d2": [["int", 5.821456607631447e-11]], "job_runner": [["dict", 0.5298113045912027], ["Dict[str, Dict[str, Any]]", 0.10801600839066051], ["Dict[Any, Union[Any, Any, Any]]", 0.09978655447092714], ["Optional[List[Any]]", 0.08201405078592582], ["Type[int]", 0.08017465712521601]], "pool_p1": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "pool_p2": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "scheduler_job": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "session": [["dict", 0.2998285946388304], ["Dict[str, Any]", 0.11294510693052796], ["Dict[str, int]", 0.09810800626777849], ["config.Config", 0.09641034864888325], ["cmk.gui.plugins.visuals.utils.Filter", 0.09525060810748329], ["Dict[KT, VT]", 0.09469758955313085], ["Dict[str, List[str]]", 0.09443603094289796]], "task_instances_list2": [["dict", 0.2901879547390544], ["Dict[Any, List[str]]", 0.11351872368956738], ["raiden.transfer.state.PendingLocksState", 0.10533664278709443], ["List[None]", 0.09894626599484908]]}}, {"docstring": {"func": "Test task instances with higher priority are not queued", "long_descr": "when pool does not have enough slots.\n\nThough tasks with lower priority might be executed.", "ret": null}, "fn_lc": [[2720, 4], [2795, 40]], "fn_var_ln": {"dr": [[2763, 8], [2763, 10]], "job_runner": [[2759, 8], [2759, 23]], "pool": [[2754, 8], [2754, 12]], "scheduler_job": [[2758, 8], [2758, 21]], "session": [[2753, 8], [2753, 15]], "state": [[2765, 12], [2765, 20]], "task_instances_list": [[2769, 8], [2769, 27]], "ti0": [[2776, 8], [2776, 11]], "ti1": [[2783, 8], [2783, 11]], "ti2": [[2790, 8], [2790, 11]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun"], ["dr", "task_instances"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["task_instances_list", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]], "pool": [["BashOperator", "task_id", "pool", "pool_slots", "priority_weight", "bash_command"], ["BashOperator", "task_id", "pool", "pool_slots", "priority_weight", "bash_command"], ["BashOperator", "task_id", "pool", "pool_slots", "priority_weight", "bash_command"], ["pool", "Pool", "pool", "slots"], ["session", "add", "pool"]], "scheduler_job": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"]], "session": [["session", "settings", "Session"], ["session", "add", "pool"], ["session", "flush"], ["session", "merge", "ti"], ["session", "flush"], ["task_instances_list", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["ti0", "session", "query", "TaskInstance", "filter", "TaskInstance", "task_id", "first"], ["ti1", "session", "query", "TaskInstance", "filter", "TaskInstance", "task_id", "first"], ["ti2", "session", "query", "TaskInstance", "filter", "TaskInstance", "task_id", "first"]], "state": [["ti", "state", "State", "SCHEDULED"], ["ti0", "state", "State", "SCHEDULED"], ["ti1", "state", "State", "QUEUED"], ["ti2", "state", "State", "QUEUED"]], "task_instances_list": [["task_instances_list", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"], ["len", "task_instances_list"]], "ti0": [["ti0", "session", "query", "TaskInstance", "filter", "TaskInstance", "task_id", "first"], ["ti0", "state", "State", "SCHEDULED"]], "ti1": [["ti1", "session", "query", "TaskInstance", "filter", "TaskInstance", "task_id", "first"], ["ti1", "state", "State", "QUEUED"]], "ti2": [["ti2", "session", "query", "TaskInstance", "filter", "TaskInstance", "task_id", "first"], ["ti2", "state", "State", "QUEUED"]]}, "name": "test_scheduler_verify_priority_and_slots", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id"], ["dr", "dag_maker", "create_dagrun"]], "self": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["task_instances_list", "self", "job_runner", "_executable_task_instances_to_queued", "max_tis", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.07926480079532093]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_scheduler_verify_priority_and_slots", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "job_runner": "", "pool": "", "scheduler_job": "", "session": "", "state": "", "task_instances_list": "", "ti0": "", "ti1": "", "ti2": ""}, "variables_p": {"dr": [["int", 0.7847390489753022], ["dict", 0.12536666804398294], ["datetime.datetime.datetime", 0.08989428298071471]], "job_runner": [["Dict[int, unittesmock.MagicMock]", 0.3563318575989892], ["str", 0.18514075150508674], ["Dict[Any, Union[Any, Any]]", 0.09411618934890616], ["Dict[str, Union[None, Any, Any]]", 0.09361763632384622], ["flask.config.Config", 0.08713895267152803]], "pool": [["dict", 0.706224432501801], ["str", 0.10491282397643222], ["Dict[int, object]", 0.09987525724866214]], "scheduler_job": [["str", 0.3289320251700398]], "session": [["sqlalchemy.orm.session.Session", 0.20285238021472546], ["SMSShell.models.session.Session", 0.10190999304202282]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task_instances_list": [["dict", 0.1327508515897508], ["List[None]", 0.13233730731023197], ["Dict[str, Any]", 0.09029780874614485], ["raiden.transfer.state.PendingLocksState", 0.08980445660624374], ["Generator[Any, None, None]", 0.08619396211856936], ["tuple", 0.08619396211856936], ["int", 0.08609150239908649], ["List[int]", 0.08423883014729164]], "ti0": [["int", 0.3471305791836527], ["app.models.Tweet", 0.1166228898488138], ["str", 0.09650491339867265], ["Dict[str, str]", 0.08029587886221048], ["List[str]", 0.0797570613119198]], "ti1": [["int", 0.3471305791836527], ["app.models.Tweet", 0.1166228898488138], ["str", 0.09650491339867265], ["Dict[str, str]", 0.08029587886221048], ["List[str]", 0.0797570613119198]], "ti2": [["int", 0.3471305791836527], ["app.models.Tweet", 0.1166228898488138], ["str", 0.09650491339867265], ["Dict[str, str]", 0.08029587886221048], ["List[str]", 0.0797570613119198]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[2797, 4], [2847, 23]], "fn_var_ln": {"dag": [[2818, 8], [2818, 11]], "dr": [[2823, 8], [2823, 10]], "drs": [[2821, 8], [2821, 11]], "job_runner": [[2815, 8], [2815, 23]], "latest_dag_version": [[2843, 8], [2843, 26]], "orm_dag": [[2811, 8], [2811, 15]], "scheduler_job": [[2814, 8], [2814, 21]], "session": [[2810, 8], [2810, 15]], "tis_count": [[2831, 8], [2831, 17]]}, "fn_var_occur": {"dag": [["dag_maker", "dag_id", "dag"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["tis_count", "session", "query", "func", "count", "TaskInstance", "task_id", "filter", "TaskInstance", "dag_id", "dr", "dag_id", "TaskInstance", "execution_date", "dr", "execution_date", "TaskInstance", "task_id", "dr", "dag", "tasks", "task_id", "TaskInstance", "state", "State", "SCHEDULED", "scalar"]], "dr": [["dr", "drs"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["tis_count", "session", "query", "func", "count", "TaskInstance", "task_id", "filter", "TaskInstance", "dag_id", "dr", "dag_id", "TaskInstance", "execution_date", "dr", "execution_date", "TaskInstance", "task_id", "dr", "dag", "tasks", "task_id", "TaskInstance", "state", "State", "SCHEDULED", "scalar"], ["latest_dag_version", "SerializedDagModel", "get_latest_version_hash", "dr", "dag_id", "session", "session"], ["dr", "dag_hash", "latest_dag_version"]], "drs": [["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["len", "drs"], ["dr", "drs"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "latest_dag_version": [["latest_dag_version", "SerializedDagModel", "get_latest_version_hash", "dr", "dag_id", "session", "session"], ["dr", "dag_hash", "latest_dag_version"]], "orm_dag": [["orm_dag", "dag_maker", "dag_model"], ["orm_dag", "None"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["create_session", "session"], ["session", "query", "SerializedDagModel", "filter", "SerializedDagModel", "dag_id", "delete", "synchronize_session", "False"], ["session", "settings", "Session"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["session", "flush"], ["tis_count", "session", "query", "func", "count", "TaskInstance", "task_id", "filter", "TaskInstance", "dag_id", "dr", "dag_id", "TaskInstance", "execution_date", "dr", "execution_date", "TaskInstance", "task_id", "dr", "dag", "tasks", "task_id", "TaskInstance", "state", "State", "SCHEDULED", "scalar"], ["latest_dag_version", "SerializedDagModel", "get_latest_version_hash", "dr", "dag_id", "session", "session"], ["session", "rollback"], ["session", "close"]], "tis_count": [["tis_count", "session", "query", "func", "count", "TaskInstance", "task_id", "filter", "TaskInstance", "dag_id", "dr", "dag_id", "TaskInstance", "execution_date", "dr", "execution_date", "TaskInstance", "task_id", "dr", "dag", "tasks", "task_id", "TaskInstance", "state", "State", "SCHEDULED", "scalar"]]}, "name": "test_verify_integrity_if_dag_not_changed", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag"], ["orm_dag", "dag_maker", "dag_model"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.37868750548254126], ["zerver.models.UserMessage", 0.19591628648180523]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_verify_integrity_if_dag_not_changed", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dr": "", "drs": "", "job_runner": "", "latest_dag_version": "", "orm_dag": "", "scheduler_job": "", "session": "", "tis_count": ""}, "variables_p": {"dag": [["str", 0.5674645865867447], ["List[str]", 0.23291185185718166], ["Optional[List[Any]]", 0.10503611879225032], ["list", 0.09458744276382325]], "dr": [["dict", 0.35935261145310515], ["List[tuple]", 0.0886855143069513], ["Anaconda3.Lib.site-packages.conda.models.match_spec.MatchSpec", 0.08646379845989839]], "drs": [["str", 0.20433591560014966], ["int", 0.1918793717997031], ["List[Dict[str, Any]]", 0.1180607231227876], ["datetime.datetime.datetime", 0.09511633429537675], ["Type[manager.projects.models.snapshots.Snapshot]", 0.09366430555487672]], "job_runner": [["dict", 0.5364378867502324], ["Dict[str, Sequence[Any]]", 0.10833874228461585], ["List[str]", 0.09223841999240498], ["str", 0.08771532634347315], ["Dict[str, Dict[str, str]]", 0.08755429828580043]], "latest_dag_version": [["str", 0.20076738229040098], ["int", 0.11959733588417873], ["Set[str]", 0.10825596796477738], ["raiden.transfer.mediated_transfer.state.TransferDescriptionWithSecretState", 0.08637545940272343]], "orm_dag": [], "scheduler_job": [["List[str]", 0.09910368840659015]], "session": [["sqlalchemy.orm.session.Session", 0.12581884147569863], ["Optional[str]", 0.10007760539377525], ["SMSShell.models.session.Session", 0.09865270564384528]], "tis_count": [["int", 0.20191531013437242], ["app.models.Tweet", 0.14594178219716492], ["notifications.models.Notification", 0.07587349609649213], ["List[str]", 0.07294369327258227], ["Union[Literal, int]", 0.06756068554767107]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[2849, 4], [2914, 23]], "fn_var_ln": {"dag": [[2870, 8], [2870, 11]], "dag_version_1": [[2877, 8], [2877, 21]], "dag_version_2": [[2886, 8], [2886, 21]], "dr": [[2894, 8], [2894, 10]], "drs": [[2892, 8], [2892, 11]], "job_runner": [[2867, 8], [2867, 23]], "latest_dag_version": [[2910, 8], [2910, 26]], "orm_dag": [[2863, 8], [2863, 15]], "scheduler_job": [[2866, 8], [2866, 21]], "session": [[2862, 8], [2862, 15]], "tis_count": [[2899, 8], [2899, 17]]}, "fn_var_occur": {"dag": [["dag_maker", "dag_id", "dag"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["self", "job_runner", "dagbag", "dags", "dag"], ["BashOperator", "task_id", "dag", "dag", "bash_command"], ["SerializedDagModel", "write_dag", "dag", "dag"], ["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["self", "job_runner", "dagbag", "dags", "dag"]], "dag_version_1": [["dag_version_1", "SerializedDagModel", "get_latest_version_hash", "dr", "dag_id", "session", "session"], ["dr", "dag_hash", "dag_version_1"], ["dag_version_2", "dag_version_1"]], "dag_version_2": [["dag_version_2", "SerializedDagModel", "get_latest_version_hash", "dr", "dag_id", "session", "session"], ["dag_version_2", "dag_version_1"], ["dr", "dag_hash", "dag_version_2"]], "dr": [["dr", "drs"], ["dag_version_1", "SerializedDagModel", "get_latest_version_hash", "dr", "dag_id", "session", "session"], ["dr", "dag_hash", "dag_version_1"], ["dag_version_2", "SerializedDagModel", "get_latest_version_hash", "dr", "dag_id", "session", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["dr", "drs"], ["dr", "dag_hash", "dag_version_2"], ["tis_count", "session", "query", "func", "count", "TaskInstance", "task_id", "filter", "TaskInstance", "dag_id", "dr", "dag_id", "TaskInstance", "execution_date", "dr", "execution_date", "TaskInstance", "state", "State", "SCHEDULED", "scalar"], ["latest_dag_version", "SerializedDagModel", "get_latest_version_hash", "dr", "dag_id", "session", "session"], ["dr", "dag_hash", "latest_dag_version"]], "drs": [["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["len", "drs"], ["dr", "drs"], ["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["len", "drs"], ["dr", "drs"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "dagbag", "dags", "dag"], ["len", "self", "job_runner", "dagbag", "dags", "get", "tasks"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "dagbag", "dags", "dag"], ["len", "self", "job_runner", "dagbag", "dags", "get", "tasks"]], "latest_dag_version": [["latest_dag_version", "SerializedDagModel", "get_latest_version_hash", "dr", "dag_id", "session", "session"], ["dr", "dag_hash", "latest_dag_version"]], "orm_dag": [["orm_dag", "dag_maker", "dag_model"], ["orm_dag", "None"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["create_session", "session"], ["session", "query", "SerializedDagModel", "filter", "SerializedDagModel", "dag_id", "delete", "synchronize_session", "False"], ["session", "settings", "Session"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["dag_version_1", "SerializedDagModel", "get_latest_version_hash", "dr", "dag_id", "session", "session"], ["dag_version_2", "SerializedDagModel", "get_latest_version_hash", "dr", "dag_id", "session", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["session", "flush"], ["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["tis_count", "session", "query", "func", "count", "TaskInstance", "task_id", "filter", "TaskInstance", "dag_id", "dr", "dag_id", "TaskInstance", "execution_date", "dr", "execution_date", "TaskInstance", "state", "State", "SCHEDULED", "scalar"], ["latest_dag_version", "SerializedDagModel", "get_latest_version_hash", "dr", "dag_id", "session", "session"], ["session", "rollback"], ["session", "close"]], "tis_count": [["tis_count", "session", "query", "func", "count", "TaskInstance", "task_id", "filter", "TaskInstance", "dag_id", "dr", "dag_id", "TaskInstance", "execution_date", "dr", "execution_date", "TaskInstance", "state", "State", "SCHEDULED", "scalar"]]}, "name": "test_verify_integrity_if_dag_changed", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag"], ["orm_dag", "dag_maker", "dag_model"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "dagbag", "dags", "dag"], ["len", "self", "job_runner", "dagbag", "dags", "get", "tasks"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "dagbag", "dags", "dag"], ["len", "self", "job_runner", "dagbag", "dags", "get", "tasks"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.37868750548254126], ["zerver.models.UserMessage", 0.19591628648180523]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_verify_integrity_if_dag_changed", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_version_1": "", "dag_version_2": "", "dr": "", "drs": "", "job_runner": "", "latest_dag_version": "", "orm_dag": "", "scheduler_job": "", "session": "", "tis_count": ""}, "variables_p": {"dag": [["str", 0.5674645865867447], ["List[str]", 0.23291185185718166], ["Optional[List[Any]]", 0.10503611879225032], ["list", 0.09458744276382325]], "dag_version_1": [["str", 0.6657842719467966], ["int", 0.16237142039602717], ["Pattern[str]", 0.08968378847415961], ["List[Pattern[str]]", 0.08216051918301667]], "dag_version_2": [["str", 0.6657842719467966], ["int", 0.16237142039602717], ["Pattern[str]", 0.08968378847415961], ["List[Pattern[str]]", 0.08216051918301667]], "dr": [["List[str]", 0.28511903592933363], ["int", 0.10116524901100506]], "drs": [["str", 0.31276345550654766], ["List[Dict[str, Any]]", 0.10682113393114338], ["Union[Literal, Literal]", 0.10308525247983902], ["int", 0.10140250690882163], ["Dict[str, str]", 0.08869450900436825]], "job_runner": [["dict", 0.5364378867502324], ["Dict[str, Sequence[Any]]", 0.10833874228461585], ["List[str]", 0.09223841999240498], ["str", 0.08771532634347315], ["Dict[str, Dict[str, str]]", 0.08755429828580043]], "latest_dag_version": [["str", 0.20076738229040098], ["int", 0.11959733588417873], ["Set[str]", 0.10825596796477738], ["raiden.transfer.mediated_transfer.state.TransferDescriptionWithSecretState", 0.08637545940272343]], "orm_dag": [], "scheduler_job": [["List[str]", 0.09910368840659015]], "session": [["sqlalchemy.orm.session.Session", 0.12581884147569863], ["Optional[str]", 0.10007760539377525], ["SMSShell.models.session.Session", 0.09865270564384528]], "tis_count": [["int", 0.20191531013437242], ["app.models.Tweet", 0.14594178219716492], ["notifications.models.Notification", 0.07587349609649213], ["List[str]", 0.07294369327258227], ["Union[Literal, int]", 0.06756068554767107]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[2916, 4], [2961, 23]], "fn_var_ln": {"callback": [[2955, 12], [2955, 20]], "dag": [[2950, 8], [2950, 11]], "dag_id": [[2939, 8], [2939, 14]], "dag_version_1": [[2944, 8], [2944, 21]], "dr": [[2942, 8], [2942, 10]], "drs": [[2940, 8], [2940, 11]], "job_runner": [[2934, 8], [2934, 23]], "orm_dag": [[2930, 8], [2930, 15]], "scheduler_job": [[2933, 8], [2933, 21]], "session": [[2929, 8], [2929, 15]]}, "fn_var_occur": {"callback": [["callback", "self", "job_runner", "_schedule_dag_run", "dr", "session"], ["callback", "None"]], "dag": [["dag_maker", "dag_id", "dag"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["dag_id", "dag", "dag_id"], ["self", "job_runner", "dagbag", "dags", "dag"], ["dag", "self", "job_runner", "dagbag", "dags", "dag_id"], ["self", "job_runner", "dagbag", "dags", "get", "side_effect", "dag", "None"]], "dag_id": [["session", "query", "SerializedDagModel", "filter", "SerializedDagModel", "dag_id", "delete", "synchronize_session", "False"], ["dag_maker", "dag_id", "dag"], ["dag_id", "dag", "dag_id"], ["drs", "DagRun", "find", "dag_id", "dag_id", "session", "session"], ["dag_version_1", "SerializedDagModel", "get_latest_version_hash", "dag_id", "session", "session"], ["SerializedDagModel", "remove_dag", "dag_id", "dag_id"], ["dag", "self", "job_runner", "dagbag", "dags", "dag_id"]], "dag_version_1": [["dag_version_1", "SerializedDagModel", "get_latest_version_hash", "dag_id", "session", "session"], ["dr", "dag_hash", "dag_version_1"]], "dr": [["dr", "drs"], ["dr", "dag_hash", "dag_version_1"], ["callback", "self", "job_runner", "_schedule_dag_run", "dr", "session"]], "drs": [["drs", "DagRun", "find", "dag_id", "dag_id", "session", "session"], ["len", "drs"], ["dr", "drs"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "dagbag", "dags", "dag"], ["len", "self", "job_runner", "dagbag", "dags", "get", "tasks"], ["dag", "self", "job_runner", "dagbag", "dags", "dag_id"], ["self", "job_runner", "dagbag", "dags", "MagicMock"], ["self", "job_runner", "dagbag", "dags", "get", "side_effect", "dag", "None"], ["callback", "self", "job_runner", "_schedule_dag_run", "dr", "session"]], "orm_dag": [["orm_dag", "dag_maker", "dag_model"], ["orm_dag", "None"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["create_session", "session"], ["session", "query", "SerializedDagModel", "filter", "SerializedDagModel", "dag_id", "delete", "synchronize_session", "False"], ["session", "settings", "Session"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["drs", "DagRun", "find", "dag_id", "dag_id", "session", "session"], ["dag_version_1", "SerializedDagModel", "get_latest_version_hash", "dag_id", "session", "session"], ["session", "flush"], ["callback", "self", "job_runner", "_schedule_dag_run", "dr", "session"], ["session", "rollback"], ["session", "close"]]}, "name": "test_verify_integrity_if_dag_disappeared", "params": {"caplog": "", "dag_maker": "", "self": ""}, "params_descr": {"caplog": "", "dag_maker": "", "self": ""}, "params_occur": {"caplog": [["caplog", "at_level", "logging", "WARNING"], ["caplog", "text"]], "dag_maker": [["dag_maker", "dag_id", "dag"], ["orm_dag", "dag_maker", "dag_model"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "dagbag", "dags", "dag"], ["len", "self", "job_runner", "dagbag", "dags", "get", "tasks"], ["dag", "self", "job_runner", "dagbag", "dags", "dag_id"], ["self", "job_runner", "dagbag", "dags", "MagicMock"], ["self", "job_runner", "dagbag", "dags", "get", "side_effect", "dag", "None"], ["callback", "self", "job_runner", "_schedule_dag_run", "dr", "session"]]}, "params_p": {"args": [], "caplog": [["tests.basilisp.helpers.CompileFn", 0.6865388842956376]], "dag_maker": [["str", 0.37868750548254126], ["zerver.models.UserMessage", 0.19591628648180523]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_verify_integrity_if_dag_disappeared", "ret_exprs": [], "ret_type": "", "variables": {"callback": "", "dag": "", "dag_id": "", "dag_version_1": "", "dr": "", "drs": "", "job_runner": "", "orm_dag": "", "scheduler_job": "", "session": ""}, "variables_p": {"callback": [["Optional[magic.models.deck.Deck]", 0.17911097350319635], ["tests.factories.model.TaskPayment", 0.17202011960880842], ["int", 0.14382352379490393], ["Union[Literal, Literal]", 0.10683758437850153], ["Sequence[byceps.services.ticketing.models.tickeTicket]", 0.09235623390040329]], "dag": [["str", 0.4283818378928366], ["bool", 0.10542875888226722], ["list", 0.09377548002310915], ["dict", 0.09056938836306055]], "dag_id": [["int", 0.5394179698258571], ["Type[Tuple[str, Any]]", 0.27732545295268446], ["set", 0.08513459965185845]], "dag_version_1": [["str", 0.673992306292636], ["int", 0.15449325920909163], ["List[Pattern[str]]", 0.09567784109358368], ["Pattern[str]", 0.0758365934046888]], "dr": [], "drs": [["str", 0.30970317300914163], ["int", 0.23406788214781454], ["Type[manager.projects.models.snapshots.Snapshot]", 0.11083461836508676], ["datetime.datetime.datetime", 0.09373341584664376], ["Anaconda3.Lib.site-packages.pandas.tests.io.test_common.CustomFSPath", 0.08392487517940708], ["pandas-master.pandas.tests.io.test_common.CustomFSPath", 0.08392487517940708], ["Tuple[Any, Any]", 0.08381116027249905]], "job_runner": [["dict", 0.5364378867502324], ["Dict[str, Sequence[Any]]", 0.10833874228461585], ["List[str]", 0.09223841999240498], ["str", 0.08771532634347315], ["Dict[str, Dict[str, str]]", 0.08755429828580043]], "orm_dag": [], "scheduler_job": [["List[str]", 0.09910368840659015]], "session": [["sqlalchemy.orm.session.Session", 0.12581884147569863], ["Optional[str]", 0.10007760539377525], ["SMSShell.models.session.Session", 0.09865270564384528]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[2985, 8], [2998, 81]], "fn_var_ln": {"heartrate": [[2994, 12], [2994, 35]], "job_runner": [[2992, 12], [2992, 27]], "scheduler_job": [[2989, 12], [2989, 25]]}, "fn_var_occur": {"heartrate": [["scheduler_job", "heartrate"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "num_runs", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]], "scheduler_job": [["scheduler_job", "Job", "executor", "executor"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "num_runs", "subdir", "os", "devnull"], ["scheduler_job", "heartrate"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]]}, "name": "do_schedule", "params": {"session": ""}, "params_descr": {"session": ""}, "params_occur": {"session": [["create_session", "session"], ["dag_maker", "dag_id", "schedule", "session", "session"]]}, "params_p": {"args": [], "kwargs": [], "self": [], "session": [["sqlalchemy.orm.session.Session", 0.39213756804125577], ["sqlalchemy.orm.Session", 0.23580899113873294], ["str", 0.13792080398409895], ["sqlalchemy.orm.scoping.scoped_session", 0.07973911814236534], ["recidiviz.persistence.database.session.Session", 0.07817886061616847], ["grouper.models.base.session.Session", 0.07621465807737861]]}, "q_name": "TestSchedulerJob.test_retry_still_in_executor.<locals>.do_schedule", "ret_exprs": [], "ret_type": "", "variables": {"heartrate": "", "job_runner": "", "scheduler_job": ""}, "variables_p": {"heartrate": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "job_runner": [["dict", 0.29069583585696923], ["bytes", 0.28821856404565427], ["int", 0.10843830518676147]], "scheduler_job": [["dict", 0.21663117181177738], ["cincoconfig.config.Schema", 0.07852437968397741]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[3013, 8], [3017, 20]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "run_with_error", "params": {"ignore_ti_state": "", "ti": ""}, "params_descr": {"ignore_ti_state": "", "ti": ""}, "params_occur": {"ignore_ti_state": [["ti", "run", "ignore_ti_state", "ignore_ti_state"]], "ti": [["ti", "session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "TaskInstance", "task_id", "first"], ["ti", "None"], ["ti", "task", "dag_task1"], ["ti", "run", "ignore_ti_state", "ignore_ti_state"]]}, "params_p": {"args": [], "ignore_ti_state": [["raiden.utils.TokenNetworkAddress", 0.10242048253788798], ["raiden.utils.TokenNetworkRegistryAddress", 0.09044218677746073]], "kwargs": [], "self": [], "ti": [["models.State", 0.16117124175904857], ["raiden.utils.Dict[str, raiden.utils.Any]", 0.08760278964859174], ["src.models.todoist_task.TodoistTask", 0.08648197520868416]]}, "q_name": "TestSchedulerJob.test_retry_still_in_executor.<locals>.run_with_error", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Checks if the scheduler does not put a task in limbo, when a task is retried", "long_descr": "but is still present in the executor.", "ret": null}, "fn_lc": [[2964, 4], [3038, 40]], "fn_var_ln": {"dag_task1": [[2977, 16], [2977, 25]], "do_update": [[3035, 8], [3035, 26]], "executor": [[2969, 8], [2969, 16]], "state": [[3031, 12], [3031, 20]], "task": [[3011, 8], [3011, 15]], "ti": [[3002, 12], [3002, 14]]}, "fn_var_occur": {"dag_task1": [], "do_update": [["executor", "do_update", "True"]], "executor": [["executor", "do_update", "True"]], "state": [["ti", "state", "State", "UP_FOR_RETRY"], ["ti", "state", "State", "SCHEDULED"], ["ti", "state", "State", "SUCCESS"]], "task": [], "ti": [["ti", "try_number"], ["run_with_error", "ti", "ignore_ti_state", "True"], ["ti", "state", "State", "UP_FOR_RETRY"], ["ti", "try_number"], ["ti", "refresh_from_db", "lock_for_update", "True", "session", "session"], ["ti", "state", "State", "SCHEDULED"], ["session", "merge", "ti"], ["ti", "refresh_from_db"], ["ti", "state", "State", "SUCCESS"]]}, "name": "test_retry_still_in_executor", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [], "self": []}, "params_p": {"args": [], "dag_maker": [["tests.async_mock.Mock", 0.49999999317664046], ["tests.basilisp.helpers.CompileFn", 1.3646719094500881e-08]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_retry_still_in_executor", "ret_exprs": [], "ret_type": "", "variables": {"dag_task1": "", "do_update": "", "executor": "", "state": "", "task": "", "ti": ""}, "variables_p": {"dag_task1": [["bool", 0.5], ["int", 0.2], ["Iterable[str]", 0.1], ["float", 0.1], ["str", 0.1]], "do_update": [["float", 0.3725188090528603], ["bytes", 0.22913955120339946], ["List[str]", 0.21473576276279868], ["str", 0.1004519230359021], ["List[Tuple[Any, Any]]", 0.08315395394503948]], "executor": [["str", 0.5202433103125648], ["Dict[str, str]", 0.09625286415391882], ["Dict[str, Union[Any, Any, Any, Any]]", 0.09389729614127444], ["set", 0.09134679533829913], ["List[str]", 0.08734388471694109]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task": [["str", 0.19999999999999998], ["annofabapi.models.TaskPhase", 0.09999999999999999], ["List[Dict[str, Any]]", 0.09999999999999999], ["bool", 0.09999999999999999], ["Type[src.app.models.TaskDevice]", 0.09999999999999999], ["Dict[str, Any]", 0.09999999999999999]], "ti": [["datetime.timedelta", 0.206608757186874], ["dss.config.Replica", 0.14192141167406955], ["int", 0.09483217959240806], ["bool", 0.09401764587869392], ["Dict[str, str]", 0.09167927739834168], ["supertunnel.ssh.config.SSHConfiguration", 0.09114439164705516]]}}, {"docstring": {"func": "Integration test of the scheduler not accidentally resetting", "long_descr": "the try_numbers for a task", "ret": null}, "fn_lc": [[3041, 4], [3062, 45]], "fn_var_ln": {"dag": [[3046, 8], [3046, 11]], "dag_task1": [[3047, 8], [3047, 17]], "job_runner": [[3051, 8], [3051, 23]], "scheduler_job": [[3050, 8], [3050, 21]], "session": [[3054, 8], [3054, 15]], "ti": [[3055, 8], [3055, 10]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag"], ["dag_task1", "dag", "get_task"], ["dag", "clear"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "dag_id", "dag", "dag_id", "num_runs"], ["ti", "session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag", "dag_id", "TaskInstance", "task_id", "dag_task1", "task_id", "first"]], "dag_task1": [["dag_task1", "dag", "get_task"], ["ti", "session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag", "dag_id", "TaskInstance", "task_id", "dag_task1", "task_id", "first"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "dag_id", "dag", "dag_id", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]], "scheduler_job": [["scheduler_job", "Job", "jobe_type", "SchedulerJobRunner", "job_type", "heartrate"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "dag_id", "dag", "dag_id", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]], "session": [["session", "settings", "Session"], ["ti", "session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag", "dag_id", "TaskInstance", "task_id", "dag_task1", "task_id", "first"]], "ti": [["ti", "session", "query", "TaskInstance", "filter", "TaskInstance", "dag_id", "dag", "dag_id", "TaskInstance", "task_id", "dag_task1", "task_id", "first"], ["ti", "try_number"], ["ti", "state", "State", "UP_FOR_RETRY"]]}, "name": "test_retry_handling_job", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["dag", "self", "dagbag", "get_dag"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "dag_id", "dag", "dag_id", "num_runs"], ["run_job", "scheduler_job", "execute_callable", "self", "job_runner", "_execute"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_retry_handling_job", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_task1": "", "job_runner": "", "scheduler_job": "", "session": "", "ti": ""}, "variables_p": {"dag": [["Tuple[List[str], Tuple[Literal, Literal], List[str]]", 0.4104801934980466], ["list", 0.16830412588121418]], "dag_task1": [["src.models.generic_task.GenericTask", 0.12814564544659485]], "job_runner": [["Dict[str, Set[str]]", 0.1773447121222287], ["dict", 0.123217507506261], ["Dict[str, Any]", 0.10207664873101673], ["str", 0.10207298231297339], ["int", 0.09003556104234202], ["List[List[str]]", 0.08918447825425477], ["Dict[str, str]", 0.08911181777862238]], "scheduler_job": [["dict", 0.12858445391124118], ["Anaconda3.Lib.site-packages.conda.models.match_spec.MatchSpec", 0.09856452324763612]], "session": [["sqlalchemy.orm.session.Session", 0.2811056297934169], ["dict", 0.11840915136449565], ["SMSShell.models.session.Session", 0.09581584022974579], ["Optional[str]", 0.08861549022141159]], "ti": [["int", 0.27851593056679447], ["float", 0.18953946926743606], ["List[Tuple[str, Any]]", 0.08337332579184634], ["lists.models.Todo", 0.08021334931026479], ["dict", 0.0800150685287175], ["Tuple[Any, Any]", 0.0800150685287175]]}}, {"docstring": {"func": "Test to check that a DAG returns its active runs", "long_descr": null, "ret": null}, "fn_lc": [[3064, 4], [3099, 87]], "fn_var_ln": {"dag_name1": [[3075, 8], [3075, 17]], "default_args": [[3077, 8], [3077, 20]], "dr": [[3085, 8], [3085, 10]], "execution_date": [[3090, 8], [3090, 22]], "now": [[3069, 8], [3069, 11]], "run_this_1": [[3079, 12], [3079, 22]], "run_this_2": [[3080, 12], [3080, 22]], "run_this_3": [[3082, 12], [3082, 22]], "running_date": [[3097, 12], [3097, 24]], "running_dates": [[3092, 8], [3092, 21]], "six_hours_ago_to_the_hour": [[3070, 8], [3070, 33]], "start_date": [[3074, 8], [3074, 18]]}, "fn_var_occur": {"dag_name1": [["dag_maker", "dag_name1", "schedule", "max_active_runs", "default_args", "default_args", "dag1"]], "default_args": [["default_args", "False", "start_date"], ["dag_maker", "dag_name1", "schedule", "max_active_runs", "default_args", "default_args", "dag1"]], "dr": [["dr", "dag_maker", "create_dagrun"], ["dr", "None"], ["execution_date", "dr", "execution_date"]], "execution_date": [["execution_date", "dr", "execution_date"], ["execution_date", "running_date"]], "now": [["now", "timezone", "utcnow"], ["six_hours_ago_to_the_hour", "now", "datetime", "timedelta", "hours", "replace", "minute", "second", "microsecond"]], "run_this_1": [["run_this_1", "EmptyOperator", "task_id"], ["run_this_2", "set_upstream", "run_this_1"]], "run_this_2": [["run_this_2", "EmptyOperator", "task_id"], ["run_this_2", "set_upstream", "run_this_1"], ["run_this_3", "set_upstream", "run_this_2"]], "run_this_3": [["run_this_3", "EmptyOperator", "task_id"], ["run_this_3", "set_upstream", "run_this_2"]], "running_date": [["running_date", "running_dates"], ["execution_date", "running_date"]], "running_dates": [["running_dates", "dag1", "get_active_runs"], ["running_date", "running_dates"]], "six_hours_ago_to_the_hour": [["six_hours_ago_to_the_hour", "now", "datetime", "timedelta", "hours", "replace", "minute", "second", "microsecond"], ["start_date", "six_hours_ago_to_the_hour"]], "start_date": [["start_date", "six_hours_ago_to_the_hour"], ["default_args", "False", "start_date"]]}, "name": "test_dag_get_active_runs", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_name1", "schedule", "max_active_runs", "default_args", "default_args", "dag1"], ["dr", "dag_maker", "create_dagrun"]], "self": []}, "params_p": {"args": [], "dag_maker": [["lms.lmsdb.models.Comment", 0.1856197985126941]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_dag_get_active_runs", "ret_exprs": [], "ret_type": "", "variables": {"dag_name1": "", "default_args": "", "dr": "", "execution_date": "", "now": "", "run_this_1": "", "run_this_2": "", "run_this_3": "", "running_date": "", "running_dates": "", "six_hours_ago_to_the_hour": "", "start_date": ""}, "variables_p": {"dag_name1": [["str", 0.5541219189836698], ["Final", 0.13625939843754217], ["Union[Literal, str]", 0.12545903978310807], ["Optional[taxonomy.db.models.name.Name]", 0.0940504581392384], ["Optional[str]", 0.09010918465644159]], "default_args": [["int", 0.5161107245596777], ["Dict[int, Optional[int]]", 0.19781712479905794], ["Dict[str, int]", 0.1010251246418969], ["Dict[str, List[Any]]", 0.09587316155325294], ["Dict[str, Union[Any, None, Any, Any, bool]]", 0.0891738644461145]], "dr": [["int", 0.18993838591038167], ["Type[str]", 0.09772378263463936], ["Union[Literal, Literal]", 0.09677591584688942], ["Type[Dict[str, Any]]", 0.09210858567519623], ["Tuple[str, str, str, str, str]", 0.08361154951594209], ["Tuple[str, str, str]", 0.08361154951594209]], "execution_date": [["str", 0.4984504934451134], ["datetime.datetime.datetime", 0.3999096650028861], ["datetime.datetime", 0.10163984155200032]], "now": [["int", 0.417837828171635], ["List[str]", 0.11520142837749914], ["str", 0.10489951067041099], ["list", 0.09611243687142232], ["List[Tuple[Any, bool]]", 0.08320190789741908]], "run_this_1": [["int", 0.5601504132921054], ["Dict[str, Dict[str, Any]]", 0.18850188057743283], ["str", 0.07973020772269586]], "run_this_2": [["int", 0.6015682181788723], ["Dict[str, Dict[str, Any]]", 0.10559883560528781], ["str", 0.09777935931267003], ["Dict[str, Union[int, Any]]", 0.09253156164935498]], "run_this_3": [["int", 0.5601504132921054], ["Dict[str, Dict[str, Any]]", 0.18850188057743283], ["str", 0.07973020772269586]], "running_date": [["datetime.datetime", 0.29945817278418085], ["Dict[Any, List[str]]", 0.13296482487474207], ["int", 0.1053898805206672], ["datetime.date", 0.09118770292470536], ["datetime.datetime.timedelta", 0.07967830176873403], ["Pattern[str]", 0.071415277993555], ["datetime.datetime.datetime", 0.07113600810079126]], "running_dates": [["datetime.datetime", 0.47242939037777176], ["datetime.date", 0.27552772467699393]], "six_hours_ago_to_the_hour": [["int", 0.26567322018463746], ["Dict[int, datetime.datetime]", 0.11721409373787114], ["datetime.datetime.datetime", 0.11582080115516415], ["datetime", 0.10595428042715896], ["str", 0.10427762368810313], ["datetime.timedelta", 0.09396275762041535], ["float", 0.08727603898781576]], "start_date": [["datetime.datetime.datetime", 0.3081701003845907], ["datetime.date", 0.2938761931021673], ["datetime.timedelta", 0.10388428072034875], ["int", 0.08753071978903376]]}}, {"docstring": {"func": "[JIRA-1357] Test the 'list_py_file_paths' function used by the", "long_descr": "scheduler to list and load DAGs.", "ret": null}, "fn_lc": [[3101, 4], [3140, 47]], "fn_var_ln": {"detected_files": [[3106, 8], [3106, 22]], "example_dag_folder": [[3131, 8], [3131, 26]], "expected_files": [[3107, 8], [3107, 22]], "ignored_files": [[3128, 8], [3128, 21]]}, "fn_var_occur": {"detected_files": [["detected_files", "set"], ["detected_files", "add", "file_path"], ["detected_files", "expected_files"], ["detected_files", "clear"], ["detected_files", "add", "file_path"], ["detected_files", "expected_files"]], "example_dag_folder": [["example_dag_folder", "airflow", "example_dags", "__path__"], ["os", "walk", "example_dag_folder"]], "expected_files": [["expected_files", "set"], ["expected_files", "add", "root", "file_name"], ["detected_files", "expected_files"], ["expected_files", "add", "os", "path", "join", "root", "file_name"], ["detected_files", "expected_files"]], "ignored_files": [["file_name", "ignored_files"], ["file_name", "file_name", "ignored_files"]]}, "name": "test_list_py_file_paths", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_list_py_file_paths", "ret_exprs": [], "ret_type": "", "variables": {"detected_files": "", "example_dag_folder": "", "expected_files": "", "ignored_files": ""}, "variables_p": {"detected_files": [["str", 0.30017434025596346], ["Set[str]", 0.27339934623113354], ["vimiv.api.settings.Setting", 0.20060233006645736], ["Dict[str, str]", 0.14721875500005838]], "example_dag_folder": [["Callable(os.path.join)[..., Any][[[Named(a, Union[_PathLike[str], str]), Variable(Union[_PathLike[str], str])], str][Any, Any]]", 0.17901116476247808], ["List[str]", 0.17314690943074063], ["str", 0.10535646364085322], ["dict", 0.0941318147773896], ["taxonomy.config.Options", 0.09024190754751105]], "expected_files": [["str", 0.2538034234915648], ["dict", 0.21915089084493589], ["List[Union[Any, Any]]", 0.08886225834246048], ["list", 0.08848126960937748], ["Dict[str, str]", 0.0845710478640205]], "ignored_files": [["str", 0.7215186502504694], ["Optional[str]", 0.09858636846314821]]}}, {"docstring": {"func": "Try with nothing.", "long_descr": null, "ret": null}, "fn_lc": [[3142, 4], [3147, 82]], "fn_var_ln": {"job_runner": [[3145, 8], [3145, 23]], "scheduler_job": [[3144, 8], [3144, 21]], "session": [[3146, 8], [3146, 15]]}, "fn_var_occur": {"job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"]], "session": [["session", "settings", "Session"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]]}, "name": "test_adopt_or_reset_orphaned_tasks_nothing", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_adopt_or_reset_orphaned_tasks_nothing", "ret_exprs": [], "ret_type": "", "variables": {"job_runner": "", "scheduler_job": "", "session": ""}, "variables_p": {"job_runner": [["dict", 0.5888386811515661], ["Dict[Any, Union[Any, Any, Any]]", 0.11310004786630815], ["Dict[Optional[str], Any]", 0.1062988132842538], ["Dict[str, str]", 0.10477966994885694], ["Dict[str, Dict[str, Any]]", 0.08698278774901505]], "scheduler_job": [["Dict[str, List[str]]", 0.2808583377388484], ["monkq.config.Setting", 0.16710196149190437], ["List[str]", 0.10487098364507653], ["list", 0.09519930087162272], ["dict", 0.09212898711041512], ["Dict[str, str]", 0.08317114524812075], ["str", 0.07227228426442679]], "session": [["Dict[str, Any]", 0.28880072932779544], ["sqlalchemy.orm.Session", 0.16065377510793705]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[3149, 4], [3167, 33]], "fn_var_ln": {"dag_id": [[3150, 8], [3150, 14]], "dr1": [[3159, 8], [3159, 11]], "job_runner": [[3156, 8], [3156, 23]], "num_reset_tis": [[3166, 8], [3166, 21]], "scheduler_job": [[3155, 8], [3155, 21]], "session": [[3157, 8], [3157, 15]], "state": [[3161, 8], [3161, 16]], "task_id": [[3152, 12], [3152, 19]], "ti": [[3160, 8], [3160, 10]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "schedule"], ["task_id", "dag_id"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "external_trigger", "True"], ["ti", "dr1", "get_task_instances", "session", "session"], ["session", "merge", "dr1"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["num_reset_tis", "self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]], "num_reset_tis": [["num_reset_tis", "self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["ti", "dr1", "get_task_instances", "session", "session"], ["session", "merge", "ti"], ["session", "merge", "dr1"], ["session", "commit"], ["num_reset_tis", "self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]], "state": [["ti", "state", "State", "QUEUED"]], "task_id": [["task_id", "dag_id"], ["EmptyOperator", "task_id", "task_id"]], "ti": [["ti", "dr1", "get_task_instances", "session", "session"], ["ti", "state", "State", "QUEUED"], ["session", "merge", "ti"]]}, "name": "test_adopt_or_reset_orphaned_tasks_external_triggered_dag", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "schedule"], ["dr1", "dag_maker", "create_dagrun", "external_trigger", "True"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["num_reset_tis", "self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.08846341192347554]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_adopt_or_reset_orphaned_tasks_external_triggered_dag", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "job_runner": "", "num_reset_tis": "", "scheduler_job": "", "session": "", "state": "", "task_id": "", "ti": ""}, "variables_p": {"dag_id": [["int", 0.5372546228437749], ["List[str]", 0.19157063514138967], ["list", 0.1174672674114586], ["Type[Tuple[str, Any]]", 0.0764330258981126]], "dr1": [["str", 1.0000000000000002]], "job_runner": [["int", 0.3887289433791961], ["str", 0.10703350480402456], ["float", 0.09718223584479903], ["Dict[int, int]", 0.09718223584479903]], "num_reset_tis": [["int", 0.21139466352210068], ["bytearray", 0.1016633156000384], ["bool", 0.10047582297183419], ["sicp_bodb.models.Cowboy", 0.0907278953245622]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["sqlalchemy.orm.session.Session", 0.37702482174351654], ["kedro.framework.session.session.KedroSession", 0.1111217919954482], ["Optional[str]", 0.0840241545706549]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task_id": [["list", 0.3294961584155063], ["int", 0.2290771926756323], ["str", 0.18940461128355593], ["Type[int]", 0.08589229691869056], ["bytes", 0.08280841418811523]], "ti": [["golem.rpc.session.WebSocketAddress", 0.13612623358007303], ["str", 0.12053009853258365], ["List[str]", 0.08766747818082522], ["Optional[Dict[str, str]]", 0.07899850595645856]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[3169, 4], [3191, 26]], "fn_var_ln": {"dag_id": [[3170, 8], [3170, 14]], "dr1": [[3181, 8], [3181, 11]], "job_runner": [[3176, 8], [3176, 23]], "scheduler_job": [[3175, 8], [3175, 21]], "session": [[3177, 8], [3177, 15]], "state": [[3184, 8], [3184, 16]], "task_id": [[3172, 12], [3172, 19]], "ti": [[3183, 8], [3183, 10]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "schedule"], ["task_id", "dag_id"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "BACKFILL_JOB"], ["ti", "dr1", "get_task_instances", "session", "session"], ["session", "merge", "dr1"], ["dr1", "is_backfill"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["session", "add", "scheduler_job"]], "session": [["session", "settings", "Session"], ["session", "add", "scheduler_job"], ["session", "flush"], ["ti", "dr1", "get_task_instances", "session", "session"], ["session", "merge", "ti"], ["session", "merge", "dr1"], ["session", "flush"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"], ["session", "rollback"]], "state": [["ti", "state", "State", "SCHEDULED"]], "task_id": [["task_id", "dag_id"], ["EmptyOperator", "task_id", "task_id"]], "ti": [["ti", "dr1", "get_task_instances", "session", "session"], ["ti", "state", "State", "SCHEDULED"], ["session", "merge", "ti"]]}, "name": "test_adopt_or_reset_orphaned_tasks_backfill_dag", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "schedule"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "BACKFILL_JOB"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_adopt_or_reset_orphaned_tasks_backfill_dag", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "job_runner": "", "scheduler_job": "", "session": "", "state": "", "task_id": "", "ti": ""}, "variables_p": {"dag_id": [["int", 0.5372546228437749], ["List[str]", 0.19157063514138967], ["list", 0.1174672674114586], ["Type[Tuple[str, Any]]", 0.0764330258981126]], "dr1": [["str", 0.304991709100498], ["dict", 0.09406393689384325], ["Dict[str, Dict[str, int]]", 0.09324794525973525], ["Optional[types.TracebackType]", 0.09030103202793506], ["Dict[str, str]", 0.08495472009900468]], "job_runner": [["dict", 0.42443516263042685], ["Dict[str, str]", 0.18745683620046688], ["Dict[str, Sequence[Any]]", 0.11005552626358776], ["float", 0.08497804937146662]], "scheduler_job": [["str", 0.19174977858785724], ["dict", 0.18666355949103158]], "session": [["sqlalchemy.orm.session.Session", 0.5258515192009465], ["Optional[str]", 0.08587475167071337]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "task_id": [["list", 0.3294961584155063], ["int", 0.2290771926756323], ["str", 0.18940461128355593], ["Type[int]", 0.08589229691869056], ["bytes", 0.08280841418811523]], "ti": [["golem.rpc.session.WebSocketAddress", 0.13612623358007303], ["str", 0.12053009853258365], ["List[str]", 0.08766747818082522], ["Optional[Dict[str, str]]", 0.07899850595645856]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[3193, 4], [3215, 44]], "fn_var_ln": {"dag_id": [[3194, 8], [3194, 14]], "dr1": [[3205, 8], [3205, 11]], "job_runner": [[3200, 8], [3200, 23]], "scheduler_job": [[3199, 8], [3199, 21]], "session": [[3201, 8], [3201, 15]], "task_id": [[3196, 12], [3196, 19]], "tis": [[3206, 8], [3206, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "schedule"], ["task_id", "dag_id"]], "dr1": [["dr1", "dag_maker", "create_dagrun"], ["tis", "dr1", "get_task_instances", "session", "session"], ["session", "merge", "dr1"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["session", "add", "scheduler_job"], ["tis", "queued_by_job_id", "scheduler_job", "id"]], "session": [["session", "settings", "Session"], ["session", "add", "scheduler_job"], ["session", "flush"], ["tis", "dr1", "get_task_instances", "session", "session"], ["session", "merge", "dr1"], ["session", "merge", "tis"], ["session", "flush"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]], "task_id": [["task_id", "dag_id"], ["EmptyOperator", "task_id", "task_id"]], "tis": [["tis", "dr1", "get_task_instances", "session", "session"], ["tis", "state", "State", "RUNNING"], ["tis", "queued_by_job_id", "scheduler_job", "id"], ["session", "merge", "tis"], ["tis", "refresh_from_db"], ["State", "RUNNING", "tis", "state"]]}, "name": "test_reset_orphaned_tasks_no_orphans", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "schedule"], ["dr1", "dag_maker", "create_dagrun"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.07958210743477684]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_reset_orphaned_tasks_no_orphans", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "job_runner": "", "scheduler_job": "", "session": "", "task_id": "", "tis": ""}, "variables_p": {"dag_id": [["int", 0.5372546228437749], ["List[str]", 0.19157063514138967], ["list", 0.1174672674114586], ["Type[Tuple[str, Any]]", 0.0764330258981126]], "dr1": [["str", 0.5874102936575083], ["int", 0.1108922156420106], ["List[str]", 0.09895525483900922], ["bool", 0.097242359948398]], "job_runner": [["dict", 0.42443516263042685], ["Dict[str, str]", 0.18745683620046688], ["Dict[str, Sequence[Any]]", 0.11005552626358776], ["float", 0.08497804937146662]], "scheduler_job": [["str", 0.19174977858785724], ["dict", 0.18666355949103158]], "session": [["sqlalchemy.orm.session.Session", 0.5258515192009465], ["Optional[str]", 0.08587475167071337]], "task_id": [["list", 0.3294961584155063], ["int", 0.2290771926756323], ["str", 0.18940461128355593], ["Type[int]", 0.08589229691869056], ["bytes", 0.08280841418811523]], "tis": [["Optional[str]", 0.1360785316136773], ["golem.rpc.session.WebSocketAddress", 0.1155576696879938], ["Dict[str, Any]", 0.0946251471218073], ["golem.rpc.session.Publisher", 0.0843247095157204]]}}, {"docstring": {"func": "Ensure orphaned tasks with non-running dagruns are not reset.", "long_descr": null, "ret": null}, "fn_lc": [[3217, 4], [3240, 26]], "fn_var_ln": {"dag_id": [[3219, 8], [3219, 14]], "dr1": [[3230, 8], [3230, 11]], "job_runner": [[3225, 8], [3225, 23]], "scheduler_job": [[3224, 8], [3224, 21]], "session": [[3226, 8], [3226, 15]], "task_id": [[3221, 12], [3221, 19]], "tis": [[3231, 8], [3231, 11]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "schedule"], ["task_id", "dag_id"]], "dr1": [["dr1", "dag_maker", "create_dagrun"], ["tis", "dr1", "get_task_instances", "session", "session"], ["session", "merge", "dr1"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["session", "add", "scheduler_job"], ["tis", "queued_by_job_id", "scheduler_job", "id"]], "session": [["session", "settings", "Session"], ["session", "add", "scheduler_job"], ["session", "flush"], ["tis", "dr1", "get_task_instances", "session", "session"], ["session", "merge", "dr1"], ["session", "merge", "tis"], ["session", "flush"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"], ["session", "rollback"]], "task_id": [["task_id", "dag_id"], ["EmptyOperator", "task_id", "task_id"]], "tis": [["tis", "dr1", "get_task_instances", "session", "session"], ["len", "tis"], ["tis", "state", "State", "SCHEDULED"], ["tis", "queued_by_job_id", "scheduler_job", "id"], ["session", "merge", "tis"]]}, "name": "test_reset_orphaned_tasks_non_running_dagruns", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "schedule"], ["dr1", "dag_maker", "create_dagrun"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["tests.test_util.aiohttp.AiohttpClientMocker", 0.07568011779152756]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_reset_orphaned_tasks_non_running_dagruns", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "job_runner": "", "scheduler_job": "", "session": "", "task_id": "", "tis": ""}, "variables_p": {"dag_id": [["int", 0.5372546228437749], ["List[str]", 0.19157063514138967], ["list", 0.1174672674114586], ["Type[Tuple[str, Any]]", 0.0764330258981126]], "dr1": [["str", 0.5874102936575083], ["int", 0.1108922156420106], ["List[str]", 0.09895525483900922], ["bool", 0.097242359948398]], "job_runner": [["dict", 0.42443516263042685], ["Dict[str, str]", 0.18745683620046688], ["Dict[str, Sequence[Any]]", 0.11005552626358776], ["float", 0.08497804937146662]], "scheduler_job": [["str", 0.19174977858785724], ["dict", 0.18666355949103158]], "session": [["sqlalchemy.orm.session.Session", 0.5258515192009465], ["Optional[str]", 0.08587475167071337]], "task_id": [["list", 0.3294961584155063], ["int", 0.2290771926756323], ["str", 0.18940461128355593], ["Type[int]", 0.08589229691869056], ["bytes", 0.08280841418811523]], "tis": [["Type[int]", 0.2283639812908947], ["dict", 0.18170349718151513], ["Dict[str, Set[str]]", 0.10397066183080723], ["str", 0.10066865493700544], ["list", 0.09415280666641376], ["Dict[str, str]", 0.09009602716400797]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[3242, 4], [3290, 48]], "fn_var_ln": {"dag_id": [[3243, 8], [3243, 14]], "dr1": [[3262, 8], [3262, 11]], "job_runner": [[3249, 8], [3249, 23]], "latest_heartbeat": [[3258, 8], [3258, 32]], "num_reset_tis": [[3280, 8], [3280, 21]], "old_job": [[3255, 8], [3255, 15]], "old_job_runner": [[3256, 8], [3256, 22]], "queued_by_job_id": [[3276, 8], [3276, 28]], "scheduler_job": [[3248, 8], [3248, 21]], "session": [[3250, 8], [3250, 15]], "state": [[3275, 8], [3275, 17]], "ti1": [[3268, 8], [3268, 11]], "ti2": [[3268, 13], [3268, 16]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "schedule"]], "dr1": [["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "start_date", "timezone", "utcnow"], ["ti1", "ti2", "dr1", "get_task_instances", "session", "session"], ["dr1", "state", "State", "RUNNING"], ["session", "merge", "dr1"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["num_reset_tis", "self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]], "latest_heartbeat": [["scheduler_job", "latest_heartbeat", "timezone", "utcnow"], ["old_job", "latest_heartbeat", "timezone", "utcnow", "timedelta", "minutes"]], "num_reset_tis": [["num_reset_tis", "self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]], "old_job": [["old_job", "Job"], ["old_job_runner", "SchedulerJobRunner", "job", "old_job", "subdir", "os", "devnull"], ["old_job", "state", "State", "RUNNING"], ["old_job", "latest_heartbeat", "timezone", "utcnow", "timedelta", "minutes"], ["session", "add", "old_job"], ["ti1", "queued_by_job_id", "old_job", "id"]], "old_job_runner": [["old_job_runner", "SchedulerJobRunner", "job", "old_job", "subdir", "os", "devnull"], ["old_job_runner", "processor_agent"], ["old_job_runner", "processor_agent", "end"]], "queued_by_job_id": [["ti1", "queued_by_job_id", "old_job", "id"], ["ti2", "queued_by_job_id", "scheduler_job", "id"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "state", "State", "RUNNING"], ["scheduler_job", "latest_heartbeat", "timezone", "utcnow"], ["session", "add", "scheduler_job"], ["ti2", "queued_by_job_id", "scheduler_job", "id"]], "session": [["session", "settings", "Session"], ["session", "add", "scheduler_job"], ["session", "add", "old_job"], ["session", "flush"], ["ti1", "ti2", "dr1", "get_task_instances", "session", "session"], ["session", "merge", "dr1"], ["session", "merge", "ti1"], ["session", "merge", "ti2"], ["session", "flush"], ["num_reset_tis", "self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"], ["session", "refresh", "ti1"], ["session", "refresh", "ti2"], ["session", "rollback"]], "state": [["scheduler_job", "state", "State", "RUNNING"], ["old_job", "state", "State", "RUNNING"], ["dr1", "state", "State", "RUNNING"], ["ti1", "state", "State", "QUEUED"], ["ti2", "state", "State", "QUEUED"], ["ti1", "state", "None"], ["ti2", "state", "State", "QUEUED"]], "ti1": [["ti1", "ti2", "dr1", "get_task_instances", "session", "session"], ["ti1", "state", "State", "QUEUED"], ["ti1", "queued_by_job_id", "old_job", "id"], ["session", "merge", "ti1"], ["session", "refresh", "ti1"], ["ti1", "state", "None"]], "ti2": [["ti1", "ti2", "dr1", "get_task_instances", "session", "session"], ["ti2", "state", "State", "QUEUED"], ["ti2", "queued_by_job_id", "scheduler_job", "id"], ["session", "merge", "ti2"], ["session", "refresh", "ti2"], ["ti2", "state", "State", "QUEUED"]]}, "name": "test_adopt_or_reset_orphaned_tasks_stale_scheduler_jobs", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "schedule"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "start_date", "timezone", "utcnow"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["num_reset_tis", "self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_adopt_or_reset_orphaned_tasks_stale_scheduler_jobs", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dr1": "", "job_runner": "", "latest_heartbeat": "", "num_reset_tis": "", "old_job": "", "old_job_runner": "", "queued_by_job_id": "", "scheduler_job": "", "session": "", "state": "", "ti1": "", "ti2": ""}, "variables_p": {"dag_id": [["int", 0.5784179031930052], ["list", 0.1848914798641481], ["Set[str]", 0.07872132975991047]], "dr1": [["str", 0.5006381762278806], ["int", 0.18940313781974358], ["Sequence[byceps.services.ticketing.models.tickeTicket]", 0.12378907865620954], ["Dict[str, Union[int, str]]", 0.09313334716357347]], "job_runner": [["int", 0.3887289433791961], ["str", 0.10703350480402456], ["float", 0.09718223584479903], ["Dict[int, int]", 0.09718223584479903]], "latest_heartbeat": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "num_reset_tis": [["int", 0.21139466352210068], ["bytearray", 0.1016633156000384], ["bool", 0.10047582297183419], ["sicp_bodb.models.Cowboy", 0.0907278953245622]], "old_job": [["raiden.transfer.state.BalanceProofSignedState", 0.17608715838738537], ["int", 0.097036669291139], ["tuple", 0.09422359391253543]], "old_job_runner": [], "queued_by_job_id": [["int", 0.29569493303681077], ["str", 0.2579527139637555], ["Optional[str]", 0.09117248365880712], ["medtagger.types.ScanID", 0.09024285370916327], ["medtagger.types.SliceID", 0.08659289913552201]], "scheduler_job": [["cincoconfig.config.Schema", 0.09237566639865474], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.08630243192636021]], "session": [["sqlalchemy.orm.session.Session", 0.12924987222241807]], "state": [["str", 0.28557918120054204], ["Optional[str]", 0.20360624304183253], ["List[str]", 0.10868901460557231], ["Tuple[Literal]", 0.09736855415728321]], "ti1": [["golem.rpc.session.WebSocketAddress", 0.10300110966302736], ["raiden.utils.Address", 0.10038896921176635], ["golem.rpc.session.Publisher", 0.0955170698004376], ["Optional[str]", 0.09186077640471815], ["Dict[str, Any]", 0.08661420490957694]], "ti2": [["golem.rpc.session.WebSocketAddress", 0.10300110966302736], ["raiden.utils.Address", 0.10038896921176635], ["golem.rpc.session.Publisher", 0.0955170698004376], ["Optional[str]", 0.09186077640471815], ["Dict[str, Any]", 0.08661420490957694]]}}, {"docstring": {"func": "Make sure we only set SchedulerJobs to failed, not all jobs", "long_descr": null, "ret": null}, "fn_lc": [[3292, 4], [3322, 77]], "fn_var_ln": {"job_runner": [[3305, 8], [3305, 23]], "latest_heartbeat": [[3312, 8], [3312, 37]], "old_job": [[3304, 8], [3304, 15]], "old_task_job": [[3311, 8], [3311, 20]], "scheduler_job": [[3296, 8], [3296, 21]], "session": [[3294, 8], [3294, 15]], "state": [[3306, 8], [3306, 21]]}, "fn_var_occur": {"job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "SchedulerJobRunner", "job", "old_job", "subdir", "os", "devnull"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]], "latest_heartbeat": [["scheduler_job", "latest_heartbeat", "timezone", "utcnow"], ["old_job", "latest_heartbeat", "timezone", "utcnow", "timedelta", "minutes"], ["old_task_job", "latest_heartbeat", "timezone", "utcnow", "timedelta", "minutes"]], "old_job": [["old_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "old_job", "subdir", "os", "devnull"], ["old_job", "state", "State", "RUNNING"], ["old_job", "latest_heartbeat", "timezone", "utcnow", "timedelta", "minutes"], ["session", "add", "old_job"], ["old_job", "state", "State", "FAILED"]], "old_task_job": [["old_task_job", "Job", "state", "State", "RUNNING"], ["old_task_job", "latest_heartbeat", "timezone", "utcnow", "timedelta", "minutes"], ["session", "add", "old_task_job"], ["old_task_job", "state", "State", "RUNNING"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "state", "State", "RUNNING"], ["scheduler_job", "latest_heartbeat", "timezone", "utcnow"], ["session", "add", "scheduler_job"]], "session": [["session", "settings", "Session"], ["session", "add", "scheduler_job"], ["session", "flush"], ["session", "add", "old_job"], ["session", "flush"], ["session", "add", "old_task_job"], ["session", "flush"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"], ["session", "expire_all"]], "state": [["scheduler_job", "state", "State", "RUNNING"], ["old_job", "state", "State", "RUNNING"], ["old_task_job", "Job", "state", "State", "RUNNING"], ["old_job", "state", "State", "FAILED"], ["old_task_job", "state", "State", "RUNNING"]]}, "name": "test_adopt_or_reset_orphaned_tasks_only_fails_scheduler_jobs", "params": {"caplog": "", "self": ""}, "params_descr": {"caplog": "", "self": ""}, "params_occur": {"caplog": [["caplog", "at_level", "logger"], ["caplog", "messages"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "SchedulerJobRunner", "job", "old_job", "subdir", "os", "devnull"], ["self", "job_runner", "adopt_or_reset_orphaned_tasks", "session", "session"]]}, "params_p": {"args": [], "caplog": [["logging.Logger", 0.2597503020339186]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_adopt_or_reset_orphaned_tasks_only_fails_scheduler_jobs", "ret_exprs": [], "ret_type": "", "variables": {"job_runner": "", "latest_heartbeat": "", "old_job": "", "old_task_job": "", "scheduler_job": "", "session": "", "state": ""}, "variables_p": {"job_runner": [["dict", 0.5364378867502324], ["Dict[str, Sequence[Any]]", 0.10833874228461585], ["List[str]", 0.09223841999240498], ["str", 0.08771532634347315], ["Dict[str, Dict[str, str]]", 0.08755429828580043]], "latest_heartbeat": [["float", 0.0870458634695988]], "old_job": [["tests.entities.DataclassWithOptionalNested", 0.24890701961166328], ["Tuple[Any, Any]", 0.2305431561175214], ["Dict[str, float]", 0.09102041839106269], ["Union[Literal, Literal]", 0.0855040548914668], ["Dict[str, int]", 0.08066980257377925], ["dict", 0.08037026013043287]], "old_task_job": [["app.models.user.User", 0.2822670910021202], ["Dict[str, dict]", 0.1245246509987124], ["Dict[str, int]", 0.10974894007966762], ["dict", 0.10482338641233062], ["List[Dict[str, Any]]", 0.08900174260042679]], "scheduler_job": [["cincoconfig.config.Schema", 0.09237566639865474], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.08630243192636021]], "session": [["sqlalchemy.orm.session.Session", 0.11113441814754497]], "state": [["str", 0.3754026923413849], ["Optional[str]", 0.2603996669899014], ["Tuple[Literal]", 0.09277217940342947]]}}, {"docstring": {"func": "Test SLA Callbacks are not sent when check_slas is False", "long_descr": null, "ret": null}, "fn_lc": [[3324, 4], [3335, 73]], "fn_var_ln": {"dag_id": [[3326, 8], [3326, 14]], "executor": [[3333, 12], [3333, 34]], "job_runner": [[3332, 12], [3332, 27]], "scheduler_job": [[3331, 12], [3331, 25]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "schedule", "dag"]], "executor": [["scheduler_job", "executor", "MockExecutor"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_send_sla_callbacks_to_processor", "dag"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"]]}, "name": "test_send_sla_callbacks_to_processor_sla_disabled", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "schedule", "dag"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_send_sla_callbacks_to_processor", "dag"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.20521109635590812], ["core.models.Recipe", 0.1147565565499521]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_send_sla_callbacks_to_processor_sla_disabled", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "executor": "", "job_runner": "", "scheduler_job": ""}, "variables_p": {"dag_id": [["int", 0.5784179031930052], ["list", 0.1848914798641481], ["Set[str]", 0.07872132975991047]], "executor": [["list", 0.32801189064443725], ["Dict[int, Dict[str, Any]]", 0.1039876737293437], ["str", 0.1039876737293437], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.09066198910962747]], "job_runner": [["dict", 0.5941532520091851], ["Dict[str, Union[Any, Any, Any]]", 0.11649027929132093], ["List[str]", 0.10554696164226073], ["Dict[str, Any]", 0.09411731759623172], ["Dict[starfish.types._constants.Axes, int]", 0.08969218946100141]], "scheduler_job": [["Dict[str, List[str]]", 0.2866423692826576], ["cincoconfig.config.Schema", 0.08246538960069358], ["raiden.utils.Any", 0.07557206833854697]]}}, {"docstring": {"func": "Test SLA Callbacks are not sent when no task SLAs are defined", "long_descr": null, "ret": null}, "fn_lc": [[3337, 4], [3348, 73]], "fn_var_ln": {"dag_id": [[3339, 8], [3339, 14]], "executor": [[3346, 12], [3346, 34]], "job_runner": [[3345, 12], [3345, 27]], "scheduler_job": [[3344, 12], [3344, 25]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "schedule", "dag"]], "executor": [["scheduler_job", "executor", "MockExecutor"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_send_sla_callbacks_to_processor", "dag"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"]]}, "name": "test_send_sla_callbacks_to_processor_sla_no_task_slas", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "schedule", "dag"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_send_sla_callbacks_to_processor", "dag"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.25971951077975186], ["core.models.Recipe", 0.09567215537709614]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_send_sla_callbacks_to_processor_sla_no_task_slas", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "executor": "", "job_runner": "", "scheduler_job": ""}, "variables_p": {"dag_id": [["int", 0.5784179031930052], ["list", 0.1848914798641481], ["Set[str]", 0.07872132975991047]], "executor": [["list", 0.32801189064443725], ["Dict[int, Dict[str, Any]]", 0.1039876737293437], ["str", 0.1039876737293437], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.09066198910962747]], "job_runner": [["dict", 0.5941532520091851], ["Dict[str, Union[Any, Any, Any]]", 0.11649027929132093], ["List[str]", 0.10554696164226073], ["Dict[str, Any]", 0.09411731759623172], ["Dict[starfish.types._constants.Axes, int]", 0.08969218946100141]], "scheduler_job": [["Dict[str, List[str]]", 0.2866423692826576], ["cincoconfig.config.Schema", 0.08246538960069358], ["raiden.utils.Any", 0.07557206833854697]]}}, {"docstring": {"func": "Test SLA Callbacks are sent to the DAG Processor when SLAs are defined on tasks", "long_descr": null, "ret": null}, "fn_lc": [[3358, 4], [3378, 96]], "fn_var_ln": {"dag_id": [[3360, 8], [3360, 14]], "executor": [[3371, 12], [3371, 34]], "expected_callback": [[3373, 12], [3373, 29]], "job_runner": [[3370, 12], [3370, 27]], "scheduler_job": [[3369, 12], [3369, 25]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "schedule", "schedule", "processor_subdir", "TEST_DAG_FOLDER", "dag"], ["expected_callback", "SlaCallbackRequest", "full_filepath", "dag", "fileloc", "dag_id", "dag", "dag_id", "processor_subdir", "TEST_DAG_FOLDER"]], "executor": [["scheduler_job", "executor", "MockExecutor"], ["scheduler_job", "executor", "callback_sink", "send", "assert_called_once_with", "expected_callback"]], "expected_callback": [["expected_callback", "SlaCallbackRequest", "full_filepath", "dag", "fileloc", "dag_id", "dag", "dag_id", "processor_subdir", "TEST_DAG_FOLDER"], ["scheduler_job", "executor", "callback_sink", "send", "assert_called_once_with", "expected_callback"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_send_sla_callbacks_to_processor", "dag"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor"], ["scheduler_job", "executor", "callback_sink", "send", "assert_called_once_with", "expected_callback"]]}, "name": "test_send_sla_callbacks_to_processor_sla_with_task_slas", "params": {"dag_maker": "", "schedule": "", "self": ""}, "params_descr": {"dag_maker": "", "schedule": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "schedule", "schedule", "processor_subdir", "TEST_DAG_FOLDER", "dag"]], "schedule": [["dag_maker", "dag_id", "dag_id", "schedule", "schedule", "processor_subdir", "TEST_DAG_FOLDER", "dag"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_send_sla_callbacks_to_processor", "dag"]]}, "params_p": {"args": [], "dag_maker": [], "kwargs": [], "schedule": [], "self": []}, "q_name": "TestSchedulerJob.test_send_sla_callbacks_to_processor_sla_with_task_slas", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "executor": "", "expected_callback": "", "job_runner": "", "scheduler_job": ""}, "variables_p": {"dag_id": [["str", 0.5652360292682498], ["Dict[str, Union[Any, Any]]", 0.07202757415122493]], "executor": [["list", 0.3479516816112661], ["Dict[int, Dict[str, Any]]", 0.09971005085400375], ["str", 0.09971005085400375], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.09180802435433325]], "expected_callback": [["Dict[str, Any]", 0.11176230578632991], ["bytes", 0.10523676350164034], ["List[aw_core.models.Event]", 0.10240113245928996], ["str", 0.0984362398958588], ["Dict[str, Union[int, str]]", 0.09501904220067439], ["list", 0.09417374327172139]], "job_runner": [["dict", 0.5941532520091851], ["Dict[str, Union[Any, Any, Any]]", 0.11649027929132093], ["List[str]", 0.10554696164226073], ["Dict[str, Any]", 0.09411731759623172], ["Dict[starfish.types._constants.Axes, int]", 0.08969218946100141]], "scheduler_job": [["Dict[str, List[str]]", 0.2866423692826576], ["cincoconfig.config.Schema", 0.08246538960069358], ["raiden.utils.Any", 0.07557206833854697]]}}, {"docstring": {"func": "Test SLA Callbacks are not sent when DAG isn't scheduled", "long_descr": null, "ret": null}, "fn_lc": [[3387, 4], [3398, 73]], "fn_var_ln": {"dag_id": [[3389, 8], [3389, 14]], "executor": [[3396, 12], [3396, 34]], "job_runner": [[3395, 12], [3395, 27]], "scheduler_job": [[3394, 12], [3394, 25]]}, "fn_var_occur": {"dag_id": [["dag_maker", "dag_id", "dag_id", "schedule", "schedule", "dag"]], "executor": [["scheduler_job", "executor", "MockExecutor"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_send_sla_callbacks_to_processor", "dag"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"]]}, "name": "test_send_sla_callbacks_to_processor_sla_dag_not_scheduled", "params": {"dag_maker": "", "schedule": "", "self": ""}, "params_descr": {"dag_maker": "", "schedule": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag_id", "schedule", "schedule", "dag"]], "schedule": [["dag_maker", "dag_id", "dag_id", "schedule", "schedule", "dag"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_send_sla_callbacks_to_processor", "dag"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.20521109635590812], ["core.models.Recipe", 0.1147565565499521]], "kwargs": [], "schedule": [["str", 0.20521109635590812], ["core.models.Recipe", 0.1147565565499521]], "self": []}, "q_name": "TestSchedulerJob.test_send_sla_callbacks_to_processor_sla_dag_not_scheduled", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "executor": "", "job_runner": "", "scheduler_job": ""}, "variables_p": {"dag_id": [["int", 0.5784179031930052], ["list", 0.1848914798641481], ["Set[str]", 0.07872132975991047]], "executor": [["list", 0.32801189064443725], ["Dict[int, Dict[str, Any]]", 0.1039876737293437], ["str", 0.1039876737293437], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.09066198910962747]], "job_runner": [["dict", 0.5941532520091851], ["Dict[str, Union[Any, Any, Any]]", 0.11649027929132093], ["List[str]", 0.10554696164226073], ["Dict[str, Any]", 0.09411731759623172], ["Dict[starfish.types._constants.Axes, int]", 0.08969218946100141]], "scheduler_job": [["Dict[str, List[str]]", 0.2866423692826576], ["cincoconfig.config.Schema", 0.08246538960069358], ["raiden.utils.Any", 0.07557206833854697]]}}, {"docstring": {"func": "Test if really required to update next dagrun or possible to save run time", "long_descr": null, "ret": null}, "fn_lc": [[3409, 4], [3434, 9]], "fn_var_ln": {"dag_model": [[3417, 8], [3417, 17]], "job_runner": [[3430, 8], [3430, 23]], "scheduler_job": [[3429, 8], [3429, 21]]}, "fn_var_occur": {"dag_model": [["dag_model", "dag_maker", "dag_model"], ["excepted", "self", "job_runner", "_should_update_dag_next_dagruns", "dag", "dag_model", "number_running", "session", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["excepted", "self", "job_runner", "_should_update_dag_next_dagruns", "dag", "dag_model", "number_running", "session", "session"]], "scheduler_job": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"]]}, "name": "test_should_update_dag_next_dagruns", "params": {"dag_maker": "", "excepted": "", "number_running": "", "schedule": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "excepted": "", "number_running": "", "schedule": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "schedule", "schedule", "max_active_runs", "dag"], ["dag_model", "dag_maker", "dag_model"], ["dag_maker", "create_dagrun", "run_id", "index", "execution_date", "DEFAULT_DATE", "timedelta", "days", "index", "start_date", "timezone", "utcnow", "state", "State", "RUNNING", "session", "session"]], "excepted": [["excepted", "self", "job_runner", "_should_update_dag_next_dagruns", "dag", "dag_model", "number_running", "session", "session"]], "number_running": [["excepted", "self", "job_runner", "_should_update_dag_next_dagruns", "dag", "dag_model", "number_running", "session", "session"]], "schedule": [["dag_maker", "dag_id", "schedule", "schedule", "max_active_runs", "dag"]], "self": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["excepted", "self", "job_runner", "_should_update_dag_next_dagruns", "dag", "dag_model", "number_running", "session", "session"]], "session": [["dag_maker", "create_dagrun", "run_id", "index", "execution_date", "DEFAULT_DATE", "timedelta", "days", "index", "start_date", "timezone", "utcnow", "state", "State", "RUNNING", "session", "session"], ["session", "flush"], ["excepted", "self", "job_runner", "_should_update_dag_next_dagruns", "dag", "dag_model", "number_running", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["raiden.utils.BlockNumber", 0.2118219927089835], ["tuple", 0.11194055023772378], ["raiden.utils.TokenAmount", 0.10591099635449175], ["raiden.utils.ChannelID", 0.09656213927989181], ["opentrons.protocols.execution.types.LoadedLabware", 0.08783891680943051], ["List[Dict[str, Any]]", 0.07010336880197632]], "excepted": [["str", 0.20203289335365254], ["bool", 0.09719007194018454], ["int", 0.09442814154748069], ["dict", 0.09034104864738478]], "kwargs": [], "number_running": [["str", 0.20203289335365254], ["bool", 0.09719007194018454], ["int", 0.09442814154748069], ["dict", 0.09034104864738478]], "schedule": [["raiden.utils.BlockNumber", 0.1961828861000829], ["str", 0.18848573807862906], ["raiden.utils.ChannelID", 0.12005331373559454], ["bool", 0.10420207117164376], ["raiden.transfer.state.BalanceProofUnsignedState", 0.0992581387140862], ["raiden.utils.TokenAmount", 0.09809144305004144], ["zerver.models.Realm", 0.09563496609988066]], "self": [], "session": [["Optional[Dict[str, Any]]", 0.11601924189519393], ["app.models.models.User", 0.09942726803839325], ["django.contrib.auth.models.AbstractBaseUser", 0.09900053882968979], ["models.User", 0.09760519309403577], ["datetime.datetime", 0.09322635430616466], ["Optional[zerver.models.UserProfile]", 0.08911384914959167], ["Dict[datetime.date, Dict[str, Any]]", 0.08886548777893816], ["Dict[str, Any]", 0.08826171662213993]]}, "q_name": "TestSchedulerJob.test_should_update_dag_next_dagruns", "ret_exprs": [], "ret_type": "", "variables": {"dag_model": "", "job_runner": "", "scheduler_job": ""}, "variables_p": {"dag_model": [["entity_framework.storages.sqlalchemy.constructing_model.raw_model.RawModel", 0.20137717384651505], ["list", 0.18646261711083784]], "job_runner": [["dict", 0.546114976496493], ["Dict[str, Any]", 0.453885023503507]], "scheduler_job": [["str", 0.3289320251700398]]}}, {"docstring": {"func": "Test various invariants of _create_dag_runs.", "long_descr": "- That the run created has the creating_job_id set\n- That the run created is on QUEUED State\n- That dag_model has next_dagrun", "ret": null}, "fn_lc": [[3436, 4], [3462, 72]], "fn_var_ln": {"dag_model": [[3447, 8], [3447, 17]], "dr": [[3457, 8], [3457, 10]], "job_runner": [[3450, 8], [3450, 23]], "scheduler_job": [[3449, 8], [3449, 21]]}, "fn_var_occur": {"dag_model": [["dag_model", "dag_maker", "dag_model"], ["self", "job_runner", "_create_dag_runs", "dag_model", "session"]], "dr": [["dr", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "dag", "dag_id", "first"], ["dr", "state", "State", "QUEUED"], ["dr", "start_date", "None"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_create_dag_runs", "dag_model", "session"]], "scheduler_job": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["dag", "get_last_dagrun", "creating_job_id", "scheduler_job", "id"]]}, "name": "test_create_dag_runs", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag"], ["dag_model", "dag_maker", "dag_model"]], "self": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_create_dag_runs", "dag_model", "session"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.2575308903538498], ["zerver.models.UserMessage", 0.07732173030148087]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_create_dag_runs", "ret_exprs": [], "ret_type": "", "variables": {"dag_model": "", "dr": "", "job_runner": "", "scheduler_job": ""}, "variables_p": {"dag_model": [], "dr": [["int", 0.4424910647601312], ["lists.models.Todo", 0.10390069208889338], ["list", 0.08843608050148079], ["str", 0.08168430968211778], ["Dict[str, int]", 0.08106496530251875]], "job_runner": [["Dict[str, Any]", 0.09755443514998693], ["tests.utils.MockCoroutine", 0.09617464174519835], ["tests.utils.MockFileMetadata", 0.09501983498677548]], "scheduler_job": [["str", 0.294860898841657]]}}, {"docstring": {"func": "Get dict of column attrs from SqlAlchemy object.", "long_descr": null, "ret": null}, "fn_lc": [[3536, 8], [3538, 84]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "dict_from_obj", "params": {"obj": ""}, "params_descr": {"obj": ""}, "params_occur": {"obj": [["k", "key", "obj", "__dict__", "get", "k", "k", "obj", "__mapper__", "column_attrs"]]}, "params_p": {"args": [], "kwargs": [], "obj": [["dict", 0.5377537319665986], ["Dict[str, Any]", 0.4622462680334015]], "self": []}, "q_name": "TestSchedulerJob.test_create_dag_runs_datasets.<locals>.dict_from_obj", "ret_exprs": ["return {k.key: obj.__dict__.get(k) for k in obj.__mapper__.column_attrs}"], "ret_type": "", "ret_type_p": [["Dict[str, Set[str]]", 0.20511196148922944], ["galaxy.api.types.Authentication", 0.10662214970803754], ["Dict[str, Any]", 0.1015180143289766], ["dict", 0.09686743221820851], ["bool", 0.09555700817182601]], "variables": {}, "variables_p": {}}, {"docstring": {"func": "Test various invariants of _create_dag_runs.", "long_descr": "- That the run created has the creating_job_id set\n- That the run created is on QUEUED State\n- That dag_model has next_dagrun", "ret": null}, "fn_lc": [[3465, 4], [3559, 73]], "fn_var_ln": {"created_run": [[3541, 8], [3541, 19]], "dag2": [[3514, 8], [3514, 12]], "dag3": [[3517, 8], [3517, 12]], "dataset1": [[3474, 8], [3474, 16]], "dataset2": [[3475, 8], [3475, 16]], "dr": [[3497, 8], [3497, 10]], "ds1_id": [[3485, 8], [3485, 14]], "event1": [[3487, 8], [3487, 14]], "event2": [[3503, 8], [3503, 14]], "job_runner": [[3529, 8], [3529, 23]], "scheduler_job": [[3528, 8], [3528, 21]], "session": [[3519, 8], [3519, 15]]}, "fn_var_occur": {"created_run": [["created_run", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "dag3", "dag_id", "one"], ["created_run", "state", "State", "QUEUED"], ["created_run", "start_date", "None"], ["list", "map", "dict_from_obj", "created_run", "consumed_dataset_events", "list", "map", "dict_from_obj", "event1", "event2"], ["created_run", "data_interval_start", "DEFAULT_DATE", "timedelta", "days"], ["created_run", "data_interval_end", "DEFAULT_DATE", "timedelta", "days"]], "dag2": [["session", "query", "DatasetDagRunQueue", "filter_by", "target_dag_id", "dag2", "dag_id", "one", "None"], ["session", "query", "DagRun", "filter", "DagRun", "dag_id", "dag2", "dag_id", "one_or_none", "None"]], "dag3": [["created_run", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "dag3", "dag_id", "one"], ["session", "query", "DatasetDagRunQueue", "filter_by", "target_dag_id", "dag3", "dag_id", "one_or_none", "None"], ["dag3", "get_last_dagrun", "creating_job_id", "scheduler_job", "id"]], "dataset1": [], "dataset2": [], "dr": [], "ds1_id": [], "event1": [["list", "map", "dict_from_obj", "created_run", "consumed_dataset_events", "list", "map", "dict_from_obj", "event1", "event2"]], "event2": [["list", "map", "dict_from_obj", "created_run", "consumed_dataset_events", "list", "map", "dict_from_obj", "event1", "event2"]], "job_runner": [], "scheduler_job": [["dag3", "get_last_dagrun", "creating_job_id", "scheduler_job", "id"]], "session": [["created_run", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "dag3", "dag_id", "one"], ["session", "query", "DatasetDagRunQueue", "filter_by", "target_dag_id", "dag2", "dag_id", "one", "None"], ["session", "query", "DagRun", "filter", "DagRun", "dag_id", "dag2", "dag_id", "one_or_none", "None"], ["session", "query", "DatasetDagRunQueue", "filter_by", "target_dag_id", "dag3", "dag_id", "one_or_none", "None"]]}, "name": "test_create_dag_runs_datasets", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [], "self": [], "session": [["created_run", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "dag3", "dag_id", "one"], ["session", "query", "DatasetDagRunQueue", "filter_by", "target_dag_id", "dag2", "dag_id", "one", "None"], ["session", "query", "DagRun", "filter", "DagRun", "dag_id", "dag2", "dag_id", "one_or_none", "None"], ["session", "query", "DatasetDagRunQueue", "filter_by", "target_dag_id", "dag3", "dag_id", "one_or_none", "None"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.1026284773815582], ["bool", 0.090110732997304]], "kwargs": [], "self": [], "session": [["sqlalchemy.orm.Session", 0.3291758503278422], ["str", 0.18637174936790699], ["sqlalchemy.orm.session.Session", 0.18443691017820385], ["sqlalchemy.orm.scoping.scoped_session", 0.09669220709336634]]}, "q_name": "TestSchedulerJob.test_create_dag_runs_datasets", "ret_exprs": [], "ret_type": "", "variables": {"created_run": "", "dag2": "", "dag3": "", "dataset1": "", "dataset2": "", "dr": "", "ds1_id": "", "event1": "", "event2": "", "job_runner": "", "scheduler_job": "", "session": ""}, "variables_p": {"created_run": [["int", 0.30848870126725486], ["Dict[str, str]", 0.10787394919896966], ["Dict[str, Dict[str, Any]]", 0.09649237590894502], ["Dict[str, Optional[str]]", 0.09025625146480172], ["str", 0.08472696367414963]], "dag2": [["int", 0.2749027084069353], ["str", 0.2547448335652073], ["Optional[Match[str]]", 0.1250904722885077], ["list", 0.09055314584888041], ["Dict[int, str]", 0.08879810770673771]], "dag3": [["list", 0.294282016905667], ["dict", 0.2373410267884506], ["abilian.core.models.subjects.User", 0.07797149223784365], ["Dict[str, str]", 0.06655737730931872], ["Optional[\"Lecture\"]", 0.06062099077176916]], "dataset1": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "dataset2": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "dr": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "ds1_id": [["str", 0.49538690753754855], ["int", 0.19613244144376757], ["Type[str]", 0.1123482095749162]], "event1": [["list", 0.18312611245599808], ["str", 0.17543123028273316], ["legistar.models.Event", 0.0939458836233078]], "event2": [["list", 0.18312611245599808], ["str", 0.17543123028273316], ["legistar.models.Event", 0.0939458836233078]], "job_runner": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "scheduler_job": [["str", 0.3825675081844747], ["geode.models.common.Address", 0.1445712164316876], ["raiden.utils.PaymentID", 0.09700032743783435], ["Dict[str, str]", 0.09603193938469523], ["zerver.models.Realm", 0.09321886558382782]], "session": [["dict", 0.14283418620533164], ["sqlalchemy.orm.session.Session", 0.08199688293629999]]}}, {"docstring": {"func": "Test that _start_dagrun:", "long_descr": "- moves runs to RUNNING State\n- emit the right DagRun metrics", "ret": null}, "fn_lc": [[3563, 4], [3604, 72]], "fn_var_ln": {"dag_model": [[3575, 8], [3575, 17]], "dr": [[3586, 8], [3586, 10]], "job_runner": [[3578, 8], [3578, 23]], "scheduler_job": [[3577, 8], [3577, 21]]}, "fn_var_occur": {"dag_model": [["dag_model", "dag_maker", "dag_model"], ["self", "job_runner", "_create_dag_runs", "dag_model", "session"]], "dr": [["dr", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "dag", "dag_id", "first"], ["dr", "state", "State", "RUNNING"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_create_dag_runs", "dag_model", "session"], ["self", "job_runner", "_start_queued_dagruns", "session"]], "scheduler_job": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["dag", "get_last_dagrun", "creating_job_id", "scheduler_job", "id"]]}, "name": "test_start_dagruns", "params": {"dag_maker": "", "self": "", "stats_timing": ""}, "params_descr": {"dag_maker": "", "self": "", "stats_timing": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag"], ["dag_model", "dag_maker", "dag_model"]], "self": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_create_dag_runs", "dag_model", "session"], ["self", "job_runner", "_start_queued_dagruns", "session"]], "stats_timing": [["stats_timing", "assert_has_calls", "mock", "call", "datetime", "timedelta", "seconds", "mock", "call", "datetime", "timedelta", "seconds", "tags"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.16647213852795562], ["raiden.utils.ChannelID", 0.10259999587862043], ["sqlalchemy.orm.session.Session", 0.09776830090058608], ["dict", 0.09251756977968359], ["Optional[str]", 0.09144478197464433]], "kwargs": [], "self": [], "stats_timing": [["unittesmock.MagicMock", 0.1051972093777393]]}, "q_name": "TestSchedulerJob.test_start_dagruns", "ret_exprs": [], "ret_type": "", "variables": {"dag_model": "", "dr": "", "job_runner": "", "scheduler_job": ""}, "variables_p": {"dag_model": [], "dr": [["int", 0.684317571197407], ["lists.models.Todo", 0.11392257170163883], ["list", 0.09969969553701623]], "job_runner": [["Dict[str, Any]", 0.09755443514998693], ["tests.utils.MockCoroutine", 0.09617464174519835], ["tests.utils.MockFileMetadata", 0.09501983498677548]], "scheduler_job": [["str", 0.294860898841657]]}}, {"docstring": {"func": "Test that Operator links are not loaded inside the Scheduling Loop (that does not include", "long_descr": "DagFileProcessorProcess) especially the critical loop of the Scheduler.\n\nThis is to avoid running User code in the Scheduler and prevent any deadlocks", "ret": null}, "fn_lc": [[3606, 4], [3633, 51]], "fn_var_ln": {"_": [[3615, 12], [3615, 13]], "custom_task": [[3631, 8], [3631, 19]], "job_runner": [[3623, 8], [3623, 23]], "s_dag_2": [[3630, 8], [3630, 15]], "scheduler_job": [[3622, 8], [3622, 21]], "session": [[3621, 8], [3621, 15]]}, "fn_var_occur": {"_": [["_", "CustomOperator", "task_id"]], "custom_task": [["custom_task", "dag", "task_dict"], ["custom_task", "operator_extra_links"], ["custom_task", "s_dag_2", "task_dict"], ["custom_task", "operator_extra_links"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["s_dag_2", "self", "job_runner", "dagbag", "get_dag", "dag", "dag_id"]], "s_dag_2": [["s_dag_2", "self", "job_runner", "dagbag", "get_dag", "dag", "dag_id"], ["custom_task", "s_dag_2", "task_dict"]], "scheduler_job": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"]], "session": [["session", "settings", "Session"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["session", "flush"]]}, "name": "test_extra_operator_links_not_loaded_in_scheduler_loop", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag"]], "self": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["s_dag_2", "self", "job_runner", "dagbag", "get_dag", "dag", "dag_id"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.2673394618422569], ["zerver.models.UserMessage", 0.07964627338823692]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_extra_operator_links_not_loaded_in_scheduler_loop", "ret_exprs": [], "ret_type": "", "variables": {"_": "", "custom_task": "", "job_runner": "", "s_dag_2": "", "scheduler_job": "", "session": ""}, "variables_p": {"_": [["int", 0.3284984714440715], ["str", 0.29098736869439745], ["List[str]", 0.09827562852874114]], "custom_task": [["deque[Any]", 0.11012413386233764]], "job_runner": [["MagicMock[Union[mock.AsyncMock, mock.MagicMock]]", 0.2984654599851849], ["unittesmock._patch[Union[unittesmock.AsyncMock, unittesmock.MagicMock]]", 0.27983458426678104], ["Dict[str, Dict[str, Any]]", 0.09229877204358039]], "s_dag_2": [["magic.models.deck.Deck", 0.09183134504717964]], "scheduler_job": [["str", 0.3289320251700398]], "session": [["sqlalchemy.orm.session.Session", 0.30029597432040733]]}}, {"docstring": {"func": "Test that scheduler._create_dag_runs does not raise an error when the DAG does not exist", "long_descr": "in serialized_dag table", "ret": null}, "fn_lc": [[3635, 4], [3658, 13]], "fn_var_ln": {"job_runner": [[3646, 8], [3646, 23]], "scheduler_job": [[3645, 8], [3645, 21]]}, "fn_var_occur": {"job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_create_dag_runs", "dag_maker", "dag_model", "session"]], "scheduler_job": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]]}, "name": "test_scheduler_create_dag_runs_does_not_raise_error", "params": {"caplog": "", "dag_maker": "", "self": ""}, "params_descr": {"caplog": "", "dag_maker": "", "self": ""}, "params_occur": {"caplog": [["caplog", "set_level"], ["caplog", "clear"], ["caplog", "messages"]], "dag_maker": [["dag_maker", "dag_id", "serialized", "False"], ["self", "job_runner", "_create_dag_runs", "dag_maker", "dag_model", "session"]], "self": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_create_dag_runs", "dag_maker", "dag_model", "session"]]}, "params_p": {"args": [], "caplog": [["core.models.Grouping", 0.18920257912280475]], "dag_maker": [["int", 0.12959283593664733], ["str", 0.09924557688205446]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_scheduler_create_dag_runs_does_not_raise_error", "ret_exprs": [], "ret_type": "", "variables": {"job_runner": "", "scheduler_job": ""}, "variables_p": {"job_runner": [["Dict[str, Dict[str, str]]", 0.3504442058993599], ["Dict[Tuple[str, str], float]", 0.09787558721746727], ["Dict[Tuple[Any, Any], Any]", 0.09329523424504117], ["Dict[int, int]", 0.09078845316495282], ["Dict[Tuple[str, int], Dict[Any, Any]]", 0.09002545157520937], ["Dict[str, int]", 0.08935010783940378], ["Dict[Type[Any], int]", 0.08700999130504251]], "scheduler_job": [["str", 0.10240347659272943]]}}, {"docstring": {"func": "Test that externally triggered Dag Runs should not affect (by skipping) next", "long_descr": "scheduled DAG runs", "ret": null}, "fn_lc": [[3660, 4], [3720, 93]], "fn_var_ln": {"dag_model": [[3717, 8], [3717, 17]], "dr": [[3704, 8], [3704, 10]], "dr1": [[3690, 8], [3690, 11]], "executor": [[3684, 8], [3684, 30]], "job_runner": [[3682, 8], [3682, 23]], "scheduler_job": [[3681, 8], [3681, 21]], "session": [[3673, 8], [3673, 15]]}, "fn_var_occur": {"dag_model": [["dag_model", "dag_maker", "dag_model"], ["dag_model", "next_dagrun", "DEFAULT_DATE"], ["dag_model", "next_dagrun_data_interval_start", "DEFAULT_DATE"], ["dag_model", "next_dagrun_data_interval_end", "DEFAULT_DATE", "timedelta", "minutes"], ["dag_model", "session", "get", "DagModel", "dag", "dag_id"], ["dag_model", "next_dagrun", "DEFAULT_DATE", "timedelta", "minutes"], ["dag_model", "next_dagrun_data_interval_start", "DEFAULT_DATE", "timedelta", "minutes"], ["dag_model", "next_dagrun_data_interval_end", "DEFAULT_DATE", "timedelta", "minutes"], ["dag_model", "session", "get", "DagModel", "dag", "dag_id"], ["dag_model", "next_dagrun", "DEFAULT_DATE", "timedelta", "minutes"], ["dag_model", "next_dagrun_data_interval_start", "DEFAULT_DATE", "timedelta", "minutes"], ["dag_model", "next_dagrun_data_interval_end", "DEFAULT_DATE", "timedelta", "minutes"]], "dr": [["dr", "dag", "create_dagrun", "state", "State", "RUNNING", "execution_date", "timezone", "utcnow", "run_type", "DagRunType", "MANUAL", "session", "session", "external_trigger", "True"], ["dr", "None"]], "dr1": [["dr1", "dag", "get_dagrun", "DEFAULT_DATE", "session", "session"], ["dr1", "None"], ["dr1", "state", "State", "RUNNING"], ["dr1", "execution_date", "DEFAULT_DATE"], ["dr1", "data_interval_start", "DEFAULT_DATE"], ["dr1", "data_interval_end", "DEFAULT_DATE", "timedelta", "minutes"]], "executor": [["scheduler_job", "executor", "MockExecutor", "do_update", "False"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_do_scheduling", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor", "do_update", "False"]], "session": [["session", "settings", "Session"], ["self", "job_runner", "_do_scheduling", "session"], ["dr1", "dag", "get_dagrun", "DEFAULT_DATE", "session", "session"], ["dag_model", "session", "get", "DagModel", "dag", "dag_id"], ["dr", "dag", "create_dagrun", "state", "State", "RUNNING", "execution_date", "timezone", "utcnow", "run_type", "DagRunType", "MANUAL", "session", "session", "external_trigger", "True"], ["DAG", "bulk_write_to_db", "dag", "session", "session"], ["dag_model", "session", "get", "DagModel", "dag", "dag_id"]]}, "name": "test_bulk_write_to_db_external_trigger_dont_skip_scheduled_run", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "schedule", "max_active_runs", "catchup", "True", "dag"], ["dag_model", "dag_maker", "dag_model"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_do_scheduling", "session"]]}, "params_p": {"args": [], "dag_maker": [["lms.lmsdb.models.Comment", 0.25316570198406296], ["str", 0.10194643659012005]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_bulk_write_to_db_external_trigger_dont_skip_scheduled_run", "ret_exprs": [], "ret_type": "", "variables": {"dag_model": "", "dr": "", "dr1": "", "executor": "", "job_runner": "", "scheduler_job": "", "session": ""}, "variables_p": {"dag_model": [], "dr": [["str", 0.37931086761692123], ["datetime.datetime.datetime", 0.09375421381360671], ["Dict[str, Any]", 0.08871922648517669]], "dr1": [["grpy.core.models.Grouping", 0.401114616906799], ["byceps.services.user.transfer.models.User", 0.11301978582104613], ["Optional[excars.models.rides.Ride]", 0.09048860807617118], ["byceps.services.party.transfer.models.Party", 0.0843687457449636]], "executor": [["str", 0.31096650407401494], ["List[str]", 0.12065073157184032], ["Dict[str, Union[Any, str]]", 0.10330524061801215], ["property", 0.09848795076438545]], "job_runner": [["Dict[int, unittesmock.MagicMock]", 0.30329157117213373], ["Dict[str, dict]", 0.28424197978021976], ["Dict[str, Union[Any, str]]", 0.24656529010642908], ["Dict[Any, Tuple[Any, Any]]", 0.08678261286278287]], "scheduler_job": [["List[str]", 0.11681852065930069], ["list", 0.10535177221245147], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.09208030321930663], ["cincoconfig.config.Schema", 0.08921463292742349]], "session": []}}, {"docstring": {"func": "Test that if a dag run exists, scheduler._create_dag_runs does not raise an error.", "long_descr": "And if a Dag Run does not exist it creates next Dag Run. In both cases the Scheduler\nsets next execution date as DagModel.next_dagrun", "ret": null}, "fn_lc": [[3722, 4], [3768, 26]], "fn_var_ln": {"dag_model": [[3739, 8], [3739, 17]], "dagrun": [[3744, 8], [3744, 14]], "job_runner": [[3758, 8], [3758, 23]], "scheduler_job": [[3757, 8], [3757, 21]], "session": [[3736, 8], [3736, 15]]}, "fn_var_occur": {"dag_model": [["dag_model", "dag_maker", "dag_model"], ["dag_model", "next_dagrun", "DEFAULT_DATE"], ["dagrun", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "dag_model", "next_dagrun", "start_date", "timezone", "utcnow", "state", "State", "RUNNING", "external_trigger", "False", "session", "session", "creating_job_id"], ["self", "job_runner", "_create_dag_runs", "dag_model", "session"], ["dag_model", "next_dagrun_data_interval_start", "DEFAULT_DATE", "timedelta", "days"], ["dag_model", "next_dagrun_data_interval_end", "DEFAULT_DATE", "timedelta", "days"], ["dag_model", "next_dagrun", "DEFAULT_DATE", "timedelta", "days"]], "dagrun": [["dagrun", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "dag_model", "next_dagrun", "start_date", "timezone", "utcnow", "state", "State", "RUNNING", "external_trigger", "False", "session", "session", "creating_job_id"], ["dag", "get_last_dagrun", "session", "dagrun"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_create_dag_runs", "dag_model", "session"]], "scheduler_job": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["dag", "get_last_dagrun", "session", "None"], ["dagrun", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "dag_model", "next_dagrun", "start_date", "timezone", "utcnow", "state", "State", "RUNNING", "external_trigger", "False", "session", "session", "creating_job_id"], ["session", "flush"], ["dag", "get_last_dagrun", "session", "dagrun"], ["self", "job_runner", "_create_dag_runs", "dag_model", "session"], ["session", "rollback"]]}, "name": "test_scheduler_create_dag_runs_check_existing_run", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "schedule", "timedelta", "days", "dag"], ["dag_model", "dag_maker", "dag_model"], ["dagrun", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "dag_model", "next_dagrun", "start_date", "timezone", "utcnow", "state", "State", "RUNNING", "external_trigger", "False", "session", "session", "creating_job_id"]], "self": [["scheduler_job", "Job", "executor", "self", "null_exec"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_create_dag_runs", "dag_model", "session"]]}, "params_p": {"args": [], "dag_maker": [["core.models.Recipe", 0.10160121345779448], ["int", 0.09255127131290292]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_scheduler_create_dag_runs_check_existing_run", "ret_exprs": [], "ret_type": "", "variables": {"dag_model": "", "dagrun": "", "job_runner": "", "scheduler_job": "", "session": ""}, "variables_p": {"dag_model": [["speedwagon.models.WorkflowListModel2", 0.2090377810866207]], "dagrun": [["str", 0.5074270082816142], ["Sequence[byceps.services.ticketing.models.tickeTicket]", 0.10683243975761358], ["Dict[str, Union[int, str]]", 0.1022415022460632], ["int", 0.09524614140836338], ["geode.models.common.Address", 0.09306620345728467]], "job_runner": [["Dict[str, Dict[str, str]]", 0.3504442058993599], ["Dict[Tuple[str, str], float]", 0.09787558721746727], ["Dict[Tuple[Any, Any], Any]", 0.09329523424504117], ["Dict[int, int]", 0.09078845316495282], ["Dict[Tuple[str, int], Dict[Any, Any]]", 0.09002545157520937], ["Dict[str, int]", 0.08935010783940378], ["Dict[Type[Any], int]", 0.08700999130504251]], "scheduler_job": [["str", 0.10240347659272943]], "session": [["str", 0.2093298254283029], ["Optional[str]", 0.17840615194675505], ["kedro.framework.session.session.KedroSession", 0.1153716454928613], ["sqlalchemy.orm.session.Session", 0.10560946809563855], ["kedro.framework.session.store.BaseSessionStore", 0.09449017674051469]]}}, {"docstring": {"func": "Test that tasks are set to a finished state when their DAG times out", "long_descr": null, "ret": null}, "fn_lc": [[3771, 4], [3829, 47]], "fn_var_ln": {"executor": [[3809, 8], [3809, 30]], "job_runner": [[3807, 8], [3807, 23]], "my_dag": [[3812, 8], [3812, 14]], "run1": [[3816, 8], [3816, 12]], "run1_ti": [[3796, 8], [3796, 15]], "run2": [[3824, 8], [3824, 12]], "run2_ti": [[3828, 8], [3828, 15]], "scheduler_job": [[3806, 8], [3806, 21]], "session": [[3786, 8], [3786, 15]], "state": [[3797, 8], [3797, 21]], "task1": [[3781, 12], [3781, 17]]}, "fn_var_occur": {"executor": [["scheduler_job", "executor", "MockExecutor"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_create_dag_runs", "my_dag", "session"], ["self", "job_runner", "_schedule_dag_run", "run1", "session"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["self", "job_runner", "_schedule_dag_run", "run2", "session"]], "my_dag": [["my_dag", "session", "get", "DagModel", "dag", "dag_id"], ["self", "job_runner", "_create_dag_runs", "my_dag", "session"]], "run1": [["run1", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "state", "State", "RUNNING", "start_date", "timezone", "utcnow", "timedelta", "seconds", "session", "session"], ["run1_ti", "run1", "get_task_instance", "task1", "task_id", "session"], ["self", "job_runner", "_schedule_dag_run", "run1", "session"], ["run1", "session", "merge", "run1"], ["session", "refresh", "run1"], ["run1", "state", "State", "FAILED"]], "run1_ti": [["run1_ti", "run1", "get_task_instance", "task1", "task_id", "session"], ["run1_ti", "state", "State", "RUNNING"], ["run1_ti", "state", "State", "SKIPPED"]], "run2": [["run2", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "timedelta", "seconds", "state", "State", "QUEUED", "session", "session"], ["run2", "session", "merge", "run2"], ["session", "refresh", "run2"], ["run2", "state", "State", "RUNNING"], ["self", "job_runner", "_schedule_dag_run", "run2", "session"], ["run2_ti", "run2", "get_task_instance", "task1", "task_id", "session"]], "run2_ti": [["run2_ti", "run2", "get_task_instance", "task1", "task_id", "session"], ["run2_ti", "state", "State", "SCHEDULED"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor"]], "session": [["session", "settings", "Session"], ["run1", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "state", "State", "RUNNING", "start_date", "timezone", "utcnow", "timedelta", "seconds", "session", "session"], ["run1_ti", "run1", "get_task_instance", "task1", "task_id", "session"], ["run2", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "timedelta", "seconds", "state", "State", "QUEUED", "session", "session"], ["my_dag", "session", "get", "DagModel", "dag", "dag_id"], ["self", "job_runner", "_create_dag_runs", "my_dag", "session"], ["self", "job_runner", "_schedule_dag_run", "run1", "session"], ["run1", "session", "merge", "run1"], ["session", "refresh", "run1"], ["session", "flush"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["session", "flush"], ["run2", "session", "merge", "run2"], ["session", "refresh", "run2"], ["self", "job_runner", "_schedule_dag_run", "run2", "session"], ["run2_ti", "run2", "get_task_instance", "task1", "task_id", "session"]], "state": [["run1", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "state", "State", "RUNNING", "start_date", "timezone", "utcnow", "timedelta", "seconds", "session", "session"], ["run1_ti", "state", "State", "RUNNING"], ["run2", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "timedelta", "seconds", "state", "State", "QUEUED", "session", "session"], ["run1", "state", "State", "FAILED"], ["run1_ti", "state", "State", "SKIPPED"], ["run2", "state", "State", "RUNNING"], ["run2_ti", "state", "State", "SCHEDULED"]], "task1": [["task1", "BashOperator", "task_id", "bash_command"], ["run1_ti", "run1", "get_task_instance", "task1", "task_id", "session"], ["run2_ti", "run2", "get_task_instance", "task1", "task_id", "session"]]}, "name": "test_do_schedule_max_active_runs_dag_timed_out", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "schedule", "max_active_runs", "catchup", "True", "dagrun_timeout", "datetime", "timedelta", "seconds", "dag"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_create_dag_runs", "my_dag", "session"], ["self", "job_runner", "_schedule_dag_run", "run1", "session"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["self", "job_runner", "_schedule_dag_run", "run2", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.28774452612149815], ["raiden.utils.ChannelID", 0.09462439269317115]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_do_schedule_max_active_runs_dag_timed_out", "ret_exprs": [], "ret_type": "", "variables": {"executor": "", "job_runner": "", "my_dag": "", "run1": "", "run1_ti": "", "run2": "", "run2_ti": "", "scheduler_job": "", "session": "", "state": "", "task1": ""}, "variables_p": {"executor": [["unittesmock.MagicMock", 0.49999999995400857], ["list", 2.1664709224561442e-11], ["List[str]", 8.116995576045707e-12], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 8.007660674688464e-12]], "job_runner": [["Dict[int, unittesmock.MagicMock]", 0.30329157117213373], ["Dict[str, dict]", 0.28424197978021976], ["Dict[str, Union[Any, str]]", 0.24656529010642908], ["Dict[Any, Tuple[Any, Any]]", 0.08678261286278287]], "my_dag": [["str", 0.500158507327605], ["Union[Literal, str]", 0.12216583435594501], ["Dict[Any, str]", 0.09970337011522365], ["Dict[int, str]", 0.09893633267621123]], "run1": [["int", 0.3621115268183935], ["Pattern[str]", 0.2030811116581102], ["str", 0.18047961058501666], ["Dict[str, Dict[str, Any]]", 0.08134607063089028]], "run1_ti": [["str", 0.329297430968389], ["Dict[str, Dict[str, Any]]", 0.1138451948888769], ["int", 0.09505795072111874], ["Dict[str, str]", 0.09143078598672776]], "run2": [["int", 0.20612896969444566], ["str", 0.19489761667559985], ["Pattern[str]", 0.13896692107518693], ["correios.models.posting.TrackingCode", 0.08654027916666737]], "run2_ti": [["str", 0.31327324607793416], ["Dict[str, Dict[str, Any]]", 0.13234656144245296], ["Dict[str, str]", 0.1001726741598644], ["int", 0.09406116554255531], ["Dict[str, int]", 0.08589322775947701]], "scheduler_job": [["Dict[str, List[str]]", 0.2866423692826576], ["cincoconfig.config.Schema", 0.08246538960069358], ["raiden.utils.Any", 0.07557206833854697]], "session": [["kedro.framework.session.store.BaseSessionStore", 0.19238199062213407], ["str", 0.17002210157969186], ["kedro.framework.session.session.KedroSession", 0.09358951383003439], ["sqlalchemy.orm.session.Session", 0.09226204610273409], ["Dict[str, Any]", 0.08690665815246576]], "state": [["str", 0.3867499526390696], ["dict", 0.3619556789733456], ["datetime.datetime", 0.09221928289796616], ["datetime.timedelta", 0.07918108726218788]], "task1": [["dict", 0.2169201035668618], ["taskiapplication.models.task.Task", 0.09723801852208415], ["List[None]", 0.08288619831390298]]}}, {"docstring": {"func": "Test that tasks in removed state don't count as actively running.", "long_descr": null, "ret": null}, "fn_lc": [[3831, 4], [3861, 39]], "fn_var_ln": {"executor": [[3852, 8], [3852, 30]], "job_runner": [[3850, 8], [3850, 23]], "num_queued": [[3855, 8], [3855, 18]], "run1": [[3843, 8], [3843, 12]], "scheduler_job": [[3849, 8], [3849, 21]], "ti": [[3859, 8], [3859, 10]]}, "fn_var_occur": {"executor": [["scheduler_job", "executor", "MockExecutor", "do_update", "False"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["num_queued", "self", "job_runner", "_do_scheduling", "session"]], "num_queued": [["num_queued", "self", "job_runner", "_do_scheduling", "session"]], "run1": [["run1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "timedelta", "hours", "state", "State", "RUNNING"], ["ti", "run1", "task_instances"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor", "do_update", "False"]], "ti": [["ti", "run1", "task_instances"], ["ti", "refresh_from_db", "session", "session"], ["ti", "state", "State", "QUEUED"]]}, "name": "test_do_schedule_max_active_runs_task_removed", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "schedule", "max_active_runs", "session", "session"], ["run1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "timedelta", "hours", "state", "State", "RUNNING"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["num_queued", "self", "job_runner", "_do_scheduling", "session"]], "session": [["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "schedule", "max_active_runs", "session", "session"], ["num_queued", "self", "job_runner", "_do_scheduling", "session"], ["session", "flush"], ["ti", "refresh_from_db", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.29970588762675743], ["zerver.models.UserProfile", 0.11159344202914855], ["zerver.models.PreregistrationUser", 0.09274426708384], ["zerver.models.Stream", 0.09202030632693803], ["sqlalchemy.orm.session.Session", 0.09182843519743594]], "kwargs": [], "self": [], "session": [["recidiviz.persistence.database.session.Session", 0.20735575916484383], ["grouper.models.user.User", 0.1797226199708139], ["grouper.models.base.session.Session", 0.08986130998540695]]}, "q_name": "TestSchedulerJob.test_do_schedule_max_active_runs_task_removed", "ret_exprs": [], "ret_type": "", "variables": {"executor": "", "job_runner": "", "num_queued": "", "run1": "", "scheduler_job": "", "ti": ""}, "variables_p": {"executor": [["str", 0.31096650407401494], ["List[str]", 0.12065073157184032], ["Dict[str, Union[Any, str]]", 0.10330524061801215], ["property", 0.09848795076438545]], "job_runner": [["Dict[int, unittesmock.MagicMock]", 0.30329157117213373], ["Dict[str, dict]", 0.28424197978021976], ["Dict[str, Union[Any, str]]", 0.24656529010642908], ["Dict[Any, Tuple[Any, Any]]", 0.08678261286278287]], "num_queued": [["int", 0.3137699185178795], ["list", 0.17556534904337656], ["Dict[str, Dict[str, Any]]", 0.10922249014445078], ["str", 0.10454519906388489], ["Tuple[Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal]", 0.0824265960149345]], "run1": [["str", 0.3155862788528755], ["int", 0.2828537221274584], ["List[Optional[int]]", 0.19603192201840694], ["datetime.date.time", 0.09288825817373435]], "scheduler_job": [["List[str]", 0.11681852065930069], ["list", 0.10535177221245147], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.09208030321930663], ["cincoconfig.config.Schema", 0.08921463292742349]], "ti": [["str", 0.18256761729617227], ["golem.rpc.session.WebSocketAddress", 0.09739229999620629], ["geode.models.common.Address", 0.09500021759583539], ["Dict[str, str]", 0.08668959931579914]]}}, {"docstring": {"func": "This tests that when max_active_runs is reached, _create_dag_runs doesn't create", "long_descr": "more dagruns", "ret": null}, "fn_lc": [[3863, 4], [3911, 9]], "fn_var_ln": {"_": [[3903, 15], [3903, 16]], "dag_models": [[3878, 8], [3878, 18]], "dr": [[3893, 8], [3893, 10]], "executor": [[3873, 8], [3873, 30]], "job_runner": [[3871, 8], [3871, 23]], "query": [[3903, 8], [3903, 13]], "scheduler_job": [[3870, 8], [3870, 21]], "session": [[3875, 8], [3875, 15]], "state": [[3896, 8], [3896, 16]], "ti": [[3895, 8], [3895, 10]]}, "fn_var_occur": {"_": [["query", "_", "DagModel", "dags_needing_dagruns", "session"], ["query", "_", "DagModel", "dags_needing_dagruns", "session"], ["query", "_", "DagModel", "dags_needing_dagruns", "session"]], "dag_models": [["dag_models", "query", "all"], ["self", "job_runner", "_create_dag_runs", "dag_models", "session"], ["self", "job_runner", "_create_dag_runs", "dag_models", "session"]], "dr": [["dr", "session", "query", "DagRun", "one"], ["dr", "state", "DagRunState", "QUEUED"], ["dr", "session", "query", "DagRun", "one"], ["dr", "state", "DagRunState", "SUCCESS"], ["ti", "dr", "get_task_instance", "session"], ["session", "merge", "dr"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "executor": [["scheduler_job", "executor", "MockExecutor", "do_update", "False"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_create_dag_runs", "dag_models", "session"], ["self", "job_runner", "_create_dag_runs", "dag_models", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "query": [["session", "query", "DagRun", "count"], ["query", "_", "DagModel", "dags_needing_dagruns", "session"], ["dag_models", "query", "all"], ["dr", "session", "query", "DagRun", "one"], ["session", "query", "DagRun", "count"], ["query", "_", "DagModel", "dags_needing_dagruns", "session"], ["len", "query", "all"], ["session", "query", "DagRun", "count"], ["dr", "session", "query", "DagRun", "one"], ["query", "_", "DagModel", "dags_needing_dagruns", "session"], ["len", "query", "all"], ["session", "query", "DagRun", "filter", "DagRun", "state", "in_", "DagRunState", "RUNNING", "DagRunState", "QUEUED", "count"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor", "do_update", "False"]], "session": [["session", "settings", "Session"], ["session", "query", "DagRun", "count"], ["query", "_", "DagModel", "dags_needing_dagruns", "session"], ["self", "job_runner", "_create_dag_runs", "dag_models", "session"], ["dr", "session", "query", "DagRun", "one"], ["session", "query", "DagRun", "count"], ["session", "flush"], ["query", "_", "DagModel", "dags_needing_dagruns", "session"], ["self", "job_runner", "_create_dag_runs", "dag_models", "session"], ["session", "query", "DagRun", "count"], ["dr", "session", "query", "DagRun", "one"], ["ti", "dr", "get_task_instance", "session"], ["session", "merge", "ti"], ["session", "merge", "dr"], ["session", "flush"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["session", "flush"], ["query", "_", "DagModel", "dags_needing_dagruns", "session"], ["session", "query", "DagRun", "filter", "DagRun", "state", "in_", "DagRunState", "RUNNING", "DagRunState", "QUEUED", "count"]], "state": [["dr", "state", "DagRunState", "QUEUED"], ["dr", "state", "DagRunState", "SUCCESS"], ["ti", "state", "TaskInstanceState", "SUCCESS"], ["session", "query", "DagRun", "filter", "DagRun", "state", "in_", "DagRunState", "RUNNING", "DagRunState", "QUEUED", "count"]], "ti": [["ti", "dr", "get_task_instance", "session"], ["ti", "state", "TaskInstanceState", "SUCCESS"], ["session", "merge", "ti"]]}, "name": "test_more_runs_are_not_created_when_max_active_runs_is_reached", "params": {"caplog": "", "dag_maker": "", "self": ""}, "params_descr": {"caplog": "", "dag_maker": "", "self": ""}, "params_occur": {"caplog": [], "dag_maker": [["dag_maker", "max_active_runs"], ["dag_maker", "dag_model", "next_dagrun_create_after", "None"], ["dag_maker", "dag_model", "next_dagrun_create_after", "None"], ["dag_maker", "dag_model", "next_dagrun", "DEFAULT_DATE"], ["dag_maker", "dag_model", "next_dagrun", "DEFAULT_DATE", "timedelta", "days"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_create_dag_runs", "dag_models", "session"], ["self", "job_runner", "_create_dag_runs", "dag_models", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]]}, "params_p": {"args": [], "caplog": [["tests.basilisp.helpers.CompileFn", 0.5616423411514435], ["str", 0.09411831674585158]], "dag_maker": [["int", 0.4058512090265256], ["datasets.opencl.device_mapping.opencl_device_mapping_dataseOpenClDeviceMappingsDataset", 0.09901166611831816], ["str", 0.08736793502263529]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_more_runs_are_not_created_when_max_active_runs_is_reached", "ret_exprs": [], "ret_type": "", "variables": {"_": "", "dag_models": "", "dr": "", "executor": "", "job_runner": "", "query": "", "scheduler_job": "", "session": "", "state": "", "ti": ""}, "variables_p": {"_": [["int", 0.29248470087204925], ["list", 0.17516167628456789], ["datetime.datetime.datetime", 0.14876306525695124], ["dict", 0.11983168985073155], ["DefaultDict[str, Set[str]]", 0.08544607571165286]], "dag_models": [["Set[dep_check.models.Dependency]", 0.5168358602034708], ["set", 0.21655671915660196], ["list", 0.08922480324961224], ["int", 0.08922480324961224]], "dr": [["int", 0.34651054503488454], ["app.models.Tweet", 0.21142962141962], ["app.models.UserModel", 0.07745002316148007], ["notifications.models.Notification", 0.06563809596933202]], "executor": [["str", 0.31096650407401494], ["List[str]", 0.12065073157184032], ["Dict[str, Union[Any, str]]", 0.10330524061801215], ["property", 0.09848795076438545]], "job_runner": [["Dict[int, unittesmock.MagicMock]", 0.30329157117213373], ["Dict[str, dict]", 0.28424197978021976], ["Dict[str, Union[Any, str]]", 0.24656529010642908], ["Dict[Any, Tuple[Any, Any]]", 0.08678261286278287]], "query": [["int", 0.2836203507994344], ["str", 0.19024677497447473], ["Dict[str, int]", 0.11817472335800262], ["list", 0.10233396618275725], ["List[str]", 0.09844229669144249]], "scheduler_job": [["List[str]", 0.11681852065930069], ["list", 0.10535177221245147], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.09208030321930663], ["cincoconfig.config.Schema", 0.08921463292742349]], "session": [], "state": [["raiden.transfer.mediated_transfer.state.MediatorTransferState", 0.3978183942154344], ["raiden.transfer.mediated_transfer.state.LockedTransferSignedState", 0.09954336875412428], ["pyshgp.push.state.PushState", 0.09413829769169237], ["raiden.transfer.state.ChainState", 0.0928694842195544]], "ti": [["str", 0.4612324427861321], ["int", 0.17319082786696324], ["geode.models.common.Address", 0.1332620389271478], ["List[dict]", 0.1290984154398812]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[3919, 8], [3929, 31]], "fn_var_ln": {"state": [[3928, 16], [3928, 24]], "ti": [[3920, 12], [3920, 14]]}, "fn_var_occur": {"state": [["ti", "session", "query", "TaskInstance", "join", "TaskInstance", "dag_run", "filter", "TaskInstance", "state", "State", "SUCCESS", "order_by", "DagRun", "execution_date", "first"], ["ti", "state", "State", "SUCCESS"]], "ti": [["ti", "session", "query", "TaskInstance", "join", "TaskInstance", "dag_run", "filter", "TaskInstance", "state", "State", "SUCCESS", "order_by", "DagRun", "execution_date", "first"], ["ti", "state", "State", "SUCCESS"]]}, "name": "complete_one_dagrun", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_max_active_runs_creation_phasing.<locals>.complete_one_dagrun", "ret_exprs": [], "ret_type": "", "variables": {"state": "", "ti": ""}, "variables_p": {"state": [["Dict[str, Any]", 0.19183676069547395], ["str", 0.19145083959785736], ["Dict[str, str]", 0.13075190869502232], ["cmk.utils.type_defs.UserId", 0.12644585869138647], ["Optional[grouper.models.user_metadata.UserMetadata]", 0.10824857735866368], ["Dict[int, Any]", 0.09253596110857121], ["kippo.tasks.models.KippoTaskStatus", 0.07788960902395453]], "ti": [["Dict[str, str]", 0.10505292868303474], ["geode.models.common.Address", 0.08338931946522089]]}}, {"docstring": {"func": "Test that when creating runs once max_active_runs is reached that the runs come in the right order", "long_descr": "without gaps", "ret": null}, "fn_lc": [[3913, 4], [3968, 65]], "fn_var_ln": {"_": [[3943, 15], [3943, 16]], "dagrun_execution_dates": [[3965, 8], [3965, 30]], "executor": [[3940, 8], [3940, 30]], "expected_execution_dates": [[3964, 8], [3964, 32]], "job_runner": [[3938, 8], [3938, 23]], "model": [[3948, 8], [3948, 13]], "query": [[3943, 8], [3943, 13]], "scheduler_job": [[3937, 8], [3937, 21]]}, "fn_var_occur": {"_": [["query", "_", "DagModel", "dags_needing_dagruns", "session"]], "dagrun_execution_dates": [["dagrun_execution_dates", "dr", "execution_date", "dr", "session", "query", "DagRun", "order_by", "DagRun", "execution_date", "all"], ["dagrun_execution_dates", "expected_execution_dates"]], "executor": [["scheduler_job", "executor", "MockExecutor", "do_update", "True"]], "expected_execution_dates": [["expected_execution_dates", "datetime", "datetime", "d", "tzinfo", "timezone", "utc", "d", "range"], ["dagrun_execution_dates", "expected_execution_dates"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_do_scheduling", "session"], ["self", "job_runner", "_do_scheduling", "session"]], "model": [["model", "airflow", "models", "DagModel", "session", "get", "DagModel", "dag", "dag_id"], ["model", "next_dagrun", "timezone", "DateTime", "tzinfo", "UTC"], ["model", "next_dagrun_create_after", "None"]], "query": [["query", "_", "DagModel", "dags_needing_dagruns", "session"], ["query", "all"], ["dagrun_execution_dates", "dr", "execution_date", "dr", "session", "query", "DagRun", "order_by", "DagRun", "execution_date", "all"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor", "do_update", "True"]]}, "name": "test_max_active_runs_creation_phasing", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [["dag_maker", "max_active_runs", "session", "session", "dag"]], "self": [["self", "clean_db"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_do_scheduling", "session"], ["self", "job_runner", "_do_scheduling", "session"]], "session": [["dag_maker", "max_active_runs", "session", "session", "dag"], ["query", "_", "DagModel", "dags_needing_dagruns", "session"], ["self", "job_runner", "_do_scheduling", "session"], ["model", "airflow", "models", "DagModel", "session", "get", "DagModel", "dag", "dag_id"], ["DagRun", "active_runs_of_dags", "session", "session"], ["DagRun", "active_runs_of_dags", "session", "session"], ["self", "job_runner", "_do_scheduling", "session"], ["dagrun_execution_dates", "dr", "execution_date", "dr", "session", "query", "DagRun", "order_by", "DagRun", "execution_date", "all"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.23370703315933505], ["sqlalchemy.orm.Session", 0.23104086933295678], ["app.models.Game", 0.09321306783484631], ["core_lib.core.models.Event", 0.09229218654184383]], "kwargs": [], "self": [], "session": [["int", 0.28857250187826117], ["sqlalchemy.orm.Session", 0.1923028127895154], ["str", 0.11800202058079601], ["Callable", 0.10475020624516541], ["datetime.datetime", 0.10339596855433679], ["bool", 0.09694336625115568]]}, "q_name": "TestSchedulerJob.test_max_active_runs_creation_phasing", "ret_exprs": [], "ret_type": "", "variables": {"_": "", "dagrun_execution_dates": "", "executor": "", "expected_execution_dates": "", "job_runner": "", "model": "airflow.models.DagModel", "query": "", "scheduler_job": ""}, "variables_p": {"_": [["int", 0.19999999999999998], ["str", 0.19999999999999998], ["List[str]", 0.09999999999999999], ["Union[bytes, int]", 0.09999999999999999], ["bool", 0.09999999999999999], ["Tuple[int, int]", 0.09999999999999999]], "dagrun_execution_dates": [["list", 0.1189961820090708], ["Optional[datetime.date]", 0.11786230005648035], ["str", 0.11120684950998865], ["datetime.datetime.date", 0.10395827274964924], ["datetime.datetime", 0.09957588094987421], ["List[recidiviz.persistence.entity.state.entities.SentenceType]", 0.08993692548668088], ["datetime.date", 0.08993692548668088], ["Union[str, datetime.datetime]", 0.08650574762538932]], "executor": [["int", 0.1104714411875731], ["str", 0.10028627431253338], ["Union[Literal, str]", 0.09889204419015628], ["list", 0.09707821138615018]], "expected_execution_dates": [["datetime.datetime", 0.5272458792680201], ["datetime.datetime.datetime", 0.37516556128828826], ["datetime.date.time.datetime", 0.09758855944369157]], "job_runner": [["Dict[int, unittesmock.MagicMock]", 0.30329157117213373], ["Dict[str, dict]", 0.28424197978021976], ["Dict[str, Union[Any, str]]", 0.24656529010642908], ["Dict[Any, Tuple[Any, Any]]", 0.08678261286278287]], "model": [["easy_gscv.models.GSCV", 0.4440563897511919]], "query": [["str", 0.2469675978289359], ["list", 0.1323797325272857], ["Set[str]", 0.09656835458703045], ["types.XMLDict", 0.09366307111916548], ["django.utils.six.moves.str", 0.09237970598583], ["int", 0.09010637480204547], ["Dict[str, str]", 0.08280185152714653]], "scheduler_job": [["List[str]", 0.11681852065930069], ["list", 0.10535177221245147], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.09208030321930663], ["cincoconfig.config.Schema", 0.08921463292742349]]}}, {"docstring": {"func": "Make sure that when a DAG is already at max_active_runs, that manually triggered", "long_descr": "dagruns don't start running.", "ret": null}, "fn_lc": [[3970, 4], [4027, 92]], "fn_var_ln": {"dag_run": [[4006, 8], [4006, 15]], "executor": [[4000, 8], [4000, 30]], "job_runner": [[3998, 8], [3998, 23]], "num_queued": [[4003, 8], [4003, 18]], "scheduler_job": [[3997, 8], [3997, 21]], "session": [[3989, 8], [3989, 15]], "task1": [[3982, 12], [3982, 17]], "task2": [[3983, 12], [3983, 17]]}, "fn_var_occur": {"dag_run": [["dag_run", "dag_maker", "create_dagrun", "state", "State", "QUEUED", "session", "session"], ["dag_run", "session", "merge", "dag_run"], ["session", "refresh", "dag_run"], ["dag_run", "state", "State", "RUNNING"]], "executor": [["scheduler_job", "executor", "MockExecutor", "do_update", "False"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["num_queued", "self", "job_runner", "_do_scheduling", "session"], ["self", "job_runner", "_do_scheduling", "session"]], "num_queued": [["num_queued", "self", "job_runner", "_do_scheduling", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor", "do_update", "False"]], "session": [["session", "settings", "Session"], ["dag_run", "dag_maker", "create_dagrun", "state", "State", "QUEUED", "session", "session"], ["dag", "sync_to_db", "session", "session"], ["num_queued", "self", "job_runner", "_do_scheduling", "session"], ["dag_run", "session", "merge", "dag_run"], ["session", "refresh", "dag_run"], ["dag_maker", "create_dagrun", "run_type", "DagRunType", "MANUAL", "execution_date", "DEFAULT_DATE", "timedelta", "hours", "state", "State", "QUEUED", "session", "session"], ["session", "flush"], ["self", "job_runner", "_do_scheduling", "session"], ["len", "DagRun", "find", "dag_id", "dag", "dag_id", "state", "State", "RUNNING", "session", "session"], ["len", "DagRun", "find", "dag_id", "dag", "dag_id", "state", "State", "QUEUED", "session", "session"]], "task1": [["task1", "BashOperator", "task_id", "bash_command"], ["task1", "task2"]], "task2": [["task2", "BashOperator", "task_id", "bash_command"], ["task1", "task2"]]}, "name": "test_do_schedule_max_active_runs_and_manual_trigger", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "schedule", "max_active_runs", "dag"], ["dag_run", "dag_maker", "create_dagrun", "state", "State", "QUEUED", "session", "session"], ["dag_maker", "create_dagrun", "run_type", "DagRunType", "MANUAL", "execution_date", "DEFAULT_DATE", "timedelta", "hours", "state", "State", "QUEUED", "session", "session"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["num_queued", "self", "job_runner", "_do_scheduling", "session"], ["self", "job_runner", "_do_scheduling", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.10015779862203966]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_do_schedule_max_active_runs_and_manual_trigger", "ret_exprs": [], "ret_type": "", "variables": {"dag_run": "", "executor": "", "job_runner": "", "num_queued": "", "scheduler_job": "", "session": "", "task1": "", "task2": ""}, "variables_p": {"dag_run": [], "executor": [["str", 0.31096650407401494], ["List[str]", 0.12065073157184032], ["Dict[str, Union[Any, str]]", 0.10330524061801215], ["property", 0.09848795076438545]], "job_runner": [["Dict[int, unittesmock.MagicMock]", 0.30329157117213373], ["Dict[str, dict]", 0.28424197978021976], ["Dict[str, Union[Any, str]]", 0.24656529010642908], ["Dict[Any, Tuple[Any, Any]]", 0.08678261286278287]], "num_queued": [["int", 0.3137699185178795], ["list", 0.17556534904337656], ["Dict[str, Dict[str, Any]]", 0.10922249014445078], ["str", 0.10454519906388489], ["Tuple[Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal]", 0.0824265960149345]], "scheduler_job": [["List[str]", 0.11681852065930069], ["list", 0.10535177221245147], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.09208030321930663], ["cincoconfig.config.Schema", 0.08921463292742349]], "session": [["Optional[str]", 0.2584416974609986], ["sqlalchemy.orm.session.Session", 0.10651638905654413], ["unittesmock.MagicMock", 0.09617112140415109], ["kedro.framework.session.session.KedroSession", 0.09443448281779385], ["dict", 0.08856882319126536]], "task1": [["list", 0.14312848793700353], ["int", 0.09696272221088784], ["Dict[str, Union[Any, Any]]", 0.08099515222946348], ["str", 0.07884328882822485]], "task2": [["list", 0.14312848793700353], ["int", 0.09696272221088784], ["Dict[str, Union[Any, Any]]", 0.08099515222946348], ["str", 0.07884328882822485]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[4029, 4], [4072, 34]], "fn_var_ln": {"dag1_running_count": [[4065, 8], [4065, 26]], "dr": [[4052, 12], [4052, 14]], "executor": [[4057, 8], [4057, 30]], "job_runner": [[4055, 8], [4055, 23]], "running_count": [[4070, 8], [4070, 21]], "scheduler_job": [[4054, 8], [4054, 21]], "session": [[4030, 8], [4030, 15]]}, "fn_var_occur": {"dag1_running_count": [["dag1_running_count", "session", "query", "func", "count", "DagRun", "id", "filter", "DagRun", "dag_id", "DagRun", "state", "State", "RUNNING", "scalar"]], "dr": [["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"], ["dr", "dag_maker", "create_dagrun_after", "dr", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"], ["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"], ["dr", "dag_maker", "create_dagrun_after", "dr", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"]], "executor": [["scheduler_job", "executor", "MockExecutor", "do_update", "False"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["self", "job_runner", "_start_queued_dagruns", "session"]], "running_count": [["running_count", "session", "query", "func", "count", "DagRun", "id", "filter", "DagRun", "state", "State", "RUNNING", "scalar"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor", "do_update", "False"]], "session": [["session", "settings", "Session"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["session", "flush"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["session", "flush"], ["dag1_running_count", "session", "query", "func", "count", "DagRun", "id", "filter", "DagRun", "dag_id", "DagRun", "state", "State", "RUNNING", "scalar"], ["running_count", "session", "query", "func", "count", "DagRun", "id", "filter", "DagRun", "state", "State", "RUNNING", "scalar"]]}, "name": "test_max_active_runs_in_a_dag_doesnt_stop_running_dagruns_in_otherdags", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "start_date", "DEFAULT_DATE", "schedule", "timedelta", "hours", "max_active_runs"], ["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"], ["dr", "dag_maker", "create_dagrun_after", "dr", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"], ["dag_maker", "start_date", "timezone", "datetime", "schedule", "timedelta", "hours"], ["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"], ["dr", "dag_maker", "create_dagrun_after", "dr", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["self", "job_runner", "_start_queued_dagruns", "session"]]}, "params_p": {"args": [], "dag_maker": [["Callable", 0.09902675108899828], ["int", 0.09332091900443937], ["dict", 0.0896616144523866]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_max_active_runs_in_a_dag_doesnt_stop_running_dagruns_in_otherdags", "ret_exprs": [], "ret_type": "", "variables": {"dag1_running_count": "", "dr": "", "executor": "", "job_runner": "", "running_count": "", "scheduler_job": "", "session": ""}, "variables_p": {"dag1_running_count": [["int", 0.4420814453392896], ["datetime.datetime", 0.09666667845449228], ["Dict[str, Dict[str, Any]]", 0.09011314855662214], ["app.models.Tweet", 0.08760064119884729]], "dr": [["str", 0.3057481442275511], ["int", 0.20617658641168843], ["list", 0.1858427544048101], ["Dict[str, Union[int, str]]", 0.12334609146232423], ["Tuple[str, str, str, str, str, str, str]", 0.09084567470905663], ["Dict[str, Any]", 0.0880407487845695]], "executor": [["str", 0.31096650407401494], ["List[str]", 0.12065073157184032], ["Dict[str, Union[Any, str]]", 0.10330524061801215], ["property", 0.09848795076438545]], "job_runner": [["Dict[int, unittesmock.MagicMock]", 0.30329157117213373], ["Dict[str, dict]", 0.28424197978021976], ["Dict[str, Union[Any, str]]", 0.24656529010642908], ["Dict[Any, Tuple[Any, Any]]", 0.08678261286278287]], "running_count": [["int", 0.2959733307886241], ["aw_core.models.Event", 0.2403975267143804], ["set", 0.1043922277989205], ["Pattern[str]", 0.0982939463538865], ["List[int]", 0.09054044809562321], ["datetime.timedelta", 0.087892838157667]], "scheduler_job": [["List[str]", 0.11681852065930069], ["list", 0.10535177221245147], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.09208030321930663], ["cincoconfig.config.Schema", 0.08921463292742349]], "session": [["Dict[str, str]", 0.10540622401122847], ["Dict[str, Any]", 0.10540622401122847], ["sqlalchemy.orm.Session", 0.09190814027870778]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[4074, 4], [4107, 43]], "fn_var_ln": {"date": [[4083, 12], [4083, 16]], "dr": [[4104, 8], [4104, 10]], "executor": [[4087, 8], [4087, 30]], "job_runner": [[4085, 8], [4085, 23]], "scheduler_job": [[4084, 8], [4084, 21]], "session": [[4075, 8], [4075, 15]], "state": [[4094, 8], [4094, 16]], "ti": [[4093, 8], [4093, 10]]}, "fn_var_occur": {"date": [["date", "dag", "following_schedule", "DEFAULT_DATE"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED", "execution_date", "date"], ["date", "dr", "execution_date", "timedelta", "hours"]], "dr": [["dr", "dag_maker", "create_dagrun", "run_id", "i", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED", "execution_date", "date"], ["date", "dr", "execution_date", "timedelta", "hours"], ["dr", "DagRun", "find", "run_id"], ["ti", "dr", "get_task_instance", "task_id", "session", "session"], ["dr", "state", "State", "RUNNING"], ["dr", "state", "State", "SUCCESS"], ["session", "merge", "dr"], ["dr", "state", "State", "SUCCESS"], ["dr", "DagRun", "find", "run_id"], ["dr", "state", "State", "RUNNING"]], "executor": [["scheduler_job", "executor", "MockExecutor", "do_update", "False"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["self", "job_runner", "_start_queued_dagruns", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor", "do_update", "False"]], "session": [["session", "settings", "Session"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["session", "flush"], ["ti", "dr", "get_task_instance", "task_id", "session", "session"], ["session", "merge", "ti"], ["session", "commit"], ["session", "merge", "dr"], ["session", "flush"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["session", "flush"], ["len", "session", "query", "DagRun", "filter", "DagRun", "state", "State", "RUNNING", "all"]], "state": [["dr", "dag_maker", "create_dagrun", "run_id", "i", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED", "execution_date", "date"], ["ti", "state", "State", "SUCCESS"], ["dr", "state", "State", "RUNNING"], ["dr", "state", "State", "SUCCESS"], ["dr", "state", "State", "SUCCESS"], ["len", "session", "query", "DagRun", "filter", "DagRun", "state", "State", "RUNNING", "all"], ["dr", "state", "State", "RUNNING"]], "ti": [["ti", "dr", "get_task_instance", "task_id", "session", "session"], ["ti", "state", "State", "SUCCESS"], ["session", "merge", "ti"]]}, "name": "test_start_queued_dagruns_do_follow_execution_date_order", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "max_active_runs", "dag"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED", "execution_date", "date"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["self", "job_runner", "_start_queued_dagruns", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.19806851201795656]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_start_queued_dagruns_do_follow_execution_date_order", "ret_exprs": [], "ret_type": "", "variables": {"date": "", "dr": "", "executor": "", "job_runner": "", "scheduler_job": "", "session": "", "state": "", "ti": ""}, "variables_p": {"date": [["str", 0.72633739654885], ["Pattern[str]", 0.09777891209886043], ["datetime.date", 0.09079316853645962], ["list", 0.08509052281582992]], "dr": [["str", 0.3680618874814698], ["Tuple[str, str, str]", 0.30444504544504647], ["Dict[str, Union[int, str]]", 0.1680164069438739], ["datetime.date", 0.0824786250038398], ["int", 0.07699803512577005]], "executor": [["str", 0.31096650407401494], ["List[str]", 0.12065073157184032], ["Dict[str, Union[Any, str]]", 0.10330524061801215], ["property", 0.09848795076438545]], "job_runner": [["Dict[int, unittesmock.MagicMock]", 0.30329157117213373], ["Dict[str, dict]", 0.28424197978021976], ["Dict[str, Union[Any, str]]", 0.24656529010642908], ["Dict[Any, Tuple[Any, Any]]", 0.08678261286278287]], "scheduler_job": [["List[str]", 0.11681852065930069], ["list", 0.10535177221245147], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.09208030321930663], ["cincoconfig.config.Schema", 0.08921463292742349]], "session": [["sqlalchemy.orm.session.Session", 0.09597555481155354]], "state": [["str", 0.5304088872967538], ["Optional[int]", 0.10100386810493503], ["dict", 0.09416756412668612], ["Optional[str]", 0.09398735389516524], ["Type[catalog.models.Category]", 0.0908052034686418], ["Type[hypha.apply.projects.models.Report]", 0.08962712310781787]], "ti": [["geode.models.common.Address", 0.10694601452547967], ["golem.rpc.session.WebSocketAddress", 0.10004161262905006], ["Optional[Dict[str, str]]", 0.08908374785306489]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[4109, 4], [4172, 72]], "fn_var_ln": {"date": [[4153, 12], [4153, 16]], "dr": [[4152, 12], [4152, 14]], "dr16": [[4149, 8], [4149, 12]], "dr1_running": [[4123, 8], [4123, 19]], "executor": [[4158, 8], [4158, 30]], "job_runner": [[4156, 8], [4156, 23]], "scheduler_job": [[4155, 8], [4155, 21]], "session": [[4117, 8], [4117, 15]], "state": [[4163, 8], [4163, 16]], "task1": [[4121, 12], [4121, 17]], "ti": [[4161, 8], [4161, 10]]}, "fn_var_occur": {"date": [["date", "timezone", "datetime"], ["dag_maker", "max_active_runs", "start_date", "date", "dag"], ["dr1_running", "dag_maker", "create_dagrun", "run_id", "execution_date", "date"], ["date", "timezone", "datetime"], ["dag_maker", "start_date", "date", "dag"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "RUNNING", "execution_date", "date"], ["date", "dr", "execution_date", "timedelta", "hours"], ["date", "dr16", "execution_date", "timedelta", "hours"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "QUEUED", "execution_date", "date"], ["date", "dr", "execution_date", "timedelta", "hours"], ["date", "timezone", "datetime"], ["dag_maker", "start_date", "date", "dag"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "RUNNING", "execution_date", "date"], ["date", "dr", "execution_date", "timedelta", "hours"], ["date", "dr16", "execution_date", "timedelta", "hours"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "QUEUED", "execution_date", "date"], ["date", "dr", "execution_date", "timedelta", "hours"]], "dr": [["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "RUNNING", "execution_date", "date"], ["date", "dr", "execution_date", "timedelta", "hours"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "QUEUED", "execution_date", "date"], ["date", "dr", "execution_date", "timedelta", "hours"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "RUNNING", "execution_date", "date"], ["date", "dr", "execution_date", "timedelta", "hours"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "QUEUED", "execution_date", "date"], ["date", "dr", "execution_date", "timedelta", "hours"]], "dr16": [["dr16", "DagRun", "find", "run_id"], ["date", "dr16", "execution_date", "timedelta", "hours"], ["dr16", "DagRun", "find", "run_id"], ["date", "dr16", "execution_date", "timedelta", "hours"]], "dr1_running": [["dr1_running", "dag_maker", "create_dagrun", "run_id", "execution_date", "date"], ["dag_maker", "create_dagrun", "run_id", "state", "State", "QUEUED", "execution_date", "dag", "following_schedule", "dr1_running", "execution_date"]], "executor": [["scheduler_job", "executor", "MockExecutor", "do_update", "False"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_do_scheduling", "session"], ["self", "job_runner", "_do_scheduling", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor", "do_update", "False"]], "session": [["session", "settings", "Session"], ["session", "merge", "ti"], ["session", "flush"], ["self", "job_runner", "_do_scheduling", "session"], ["self", "job_runner", "_do_scheduling", "session"]], "state": [["dag_maker", "create_dagrun", "run_id", "state", "State", "QUEUED", "execution_date", "dag", "following_schedule", "dr1_running", "execution_date"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "RUNNING", "execution_date", "date"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "QUEUED", "execution_date", "date"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "RUNNING", "execution_date", "date"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "QUEUED", "execution_date", "date"], ["ti", "state", "State", "SUCCESS"], ["DagRun", "find", "run_id", "state", "State", "SUCCESS"], ["DagRun", "find", "run_id", "state", "State", "RUNNING"]], "task1": [["task1", "EmptyOperator", "task_id"], ["ti", "TaskInstance", "task", "task1", "execution_date", "DEFAULT_DATE"]], "ti": [["ti", "TaskInstance", "task", "task1", "execution_date", "DEFAULT_DATE"], ["ti", "refresh_from_db"], ["ti", "state", "State", "SUCCESS"], ["session", "merge", "ti"]]}, "name": "test_no_dagruns_would_stuck_in_running", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "max_active_runs", "start_date", "date", "dag"], ["dr1_running", "dag_maker", "create_dagrun", "run_id", "execution_date", "date"], ["dag_maker", "create_dagrun", "run_id", "state", "State", "QUEUED", "execution_date", "dag", "following_schedule", "dr1_running", "execution_date"], ["dag_maker", "start_date", "date", "dag"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "RUNNING", "execution_date", "date"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "QUEUED", "execution_date", "date"], ["dag_maker", "start_date", "date", "dag"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "RUNNING", "execution_date", "date"], ["dr", "dag_maker", "create_dagrun", "run_id", "i", "state", "State", "QUEUED", "execution_date", "date"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_do_scheduling", "session"], ["self", "job_runner", "_do_scheduling", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.2935417332549449], ["raiden.utils.Address", 0.09110093807021998]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_no_dagruns_would_stuck_in_running", "ret_exprs": [], "ret_type": "", "variables": {"date": "", "dr": "", "dr16": "", "dr1_running": "", "executor": "", "job_runner": "", "scheduler_job": "", "session": "", "state": "", "task1": "", "ti": ""}, "variables_p": {"date": [["datetime.date", 0.5553794854311035], ["datetime.datetime.datetime", 0.1592607305467973], ["str", 0.12544505441681778], ["datetime.datetime", 0.08052341323434449], ["datetime.date.time.datetime", 0.07939131637093712]], "dr": [["str", 0.19499411392943622], ["Optional[hpaction.models.HPActionDocuments]", 0.11635552717624972], ["byceps.services.user.transfer.models.User", 0.11235311427838901], ["Dict[str, Any]", 0.1078682851692261], ["int", 0.09483119607671774], ["float", 0.08743532232175344]], "dr16": [["int", 0.32420134171973036], ["datetime.datetime.datetime", 0.2641644795090271], ["dict", 0.11261957395134992], ["datetime.datetime", 0.07151930499144378], ["str", 0.07151930499144378]], "dr1_running": [["int", 0.1700186690745338], ["list", 0.09045734867339565]], "executor": [["str", 0.31096650407401494], ["List[str]", 0.12065073157184032], ["Dict[str, Union[Any, str]]", 0.10330524061801215], ["property", 0.09848795076438545]], "job_runner": [["Dict[int, unittesmock.MagicMock]", 0.30329157117213373], ["Dict[str, dict]", 0.28424197978021976], ["Dict[str, Union[Any, str]]", 0.24656529010642908], ["Dict[Any, Tuple[Any, Any]]", 0.08678261286278287]], "scheduler_job": [["List[str]", 0.11681852065930069], ["list", 0.10535177221245147], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.09208030321930663], ["cincoconfig.config.Schema", 0.08921463292742349]], "session": [["Dict[str, str]", 0.13699533330699437], ["kedro.framework.session.session.KedroSession", 0.13610878730136147], ["sqlalchemy.orm.session.Session", 0.07842514427644959]], "state": [["str", 0.20267976761516454], ["dict", 0.19423675394643164], ["Optional[raiden.utils.TokenNetworkAddress]", 0.1790845131151656], ["src.scrape.models.Product", 0.08593792885835268], ["grpy.core.models.User", 0.08158396332263966], ["Optional[raiden.transfer.state.TokenNetworkState]", 0.0793979030144979]], "task1": [["Dict[str, str]", 0.0870697641010713], ["str", 0.08250912223055362]], "ti": [["int", 0.27140060936482746], ["buza.models.Subject", 0.23939909678603308], ["byceps.services.user.transfer.models.User", 0.1411156135017364], ["accounts.models.Account", 0.0864973195347068], ["List[Tuple[Any, Any]]", 0.08582684611470219], ["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.07944673498923993]]}}, {"docstring": {"func": "Test if _process_task_instances puts the right task instances into the", "long_descr": "mock_list.", "ret": null}, "fn_lc": [[4190, 4], [4216, 46]], "fn_var_ln": {"dr": [[4203, 8], [4203, 10]], "end_date": [[4210, 12], [4210, 23]], "job_runner": [[4199, 8], [4199, 23]], "scheduler_job": [[4198, 8], [4198, 21]], "start_date": [[4209, 12], [4209, 25]], "state": [[4208, 12], [4208, 20]], "ti": [[4207, 12], [4207, 14]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr", "None"], ["ti", "dr", "get_task_instances", "session", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "end_date": [["ti", "end_date", "end_date"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "start_date": [["ti", "start_date", "start_date"]], "state": [["ti", "state", "state"], ["session", "query", "TaskInstance", "filter_by", "state", "State", "SCHEDULED", "count"], ["ti", "state", "State", "SCHEDULED"]], "ti": [["ti", "dr", "get_task_instances", "session", "session"], ["ti", "state", "state"], ["ti", "start_date", "start_date"], ["ti", "end_date", "end_date"], ["session", "refresh", "ti"], ["ti", "state", "State", "SCHEDULED"]]}, "name": "test_dag_file_processor_process_task_instances", "params": {"dag_maker": "", "end_date": "", "self": "", "start_date": "", "state": ""}, "params_descr": {"dag_maker": "", "end_date": "", "self": "", "start_date": "", "state": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id"], ["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"]], "end_date": [["ti", "end_date", "end_date"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "start_date": [["ti", "start_date", "start_date"]], "state": [["ti", "state", "state"], ["session", "query", "TaskInstance", "filter_by", "state", "State", "SCHEDULED", "count"], ["ti", "state", "State", "SCHEDULED"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.19715149876879667], ["accounts.models.Account", 0.09406580380152785]], "end_date": [["str", 0.4672919867366992], ["datetime.datetime", 0.2511758873601425], ["Union[str, int, float]", 0.09456048255632818], ["int", 0.09241116079050186]], "kwargs": [], "self": [], "start_date": [["str", 0.9218582263205031], ["int", 0.07814177367949707]], "state": [["sqlalchemy.orm.Session", 0.2142213968623195], ["aw_core.models.Event", 0.11234649280745908], ["int", 0.098871399319148], ["str", 0.09508951370488662], ["app.models.user.User.InDB", 0.09464004916349757]]}, "q_name": "TestSchedulerJob.test_dag_file_processor_process_task_instances", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "end_date": "", "job_runner": "", "scheduler_job": "", "start_date": "", "state": "", "ti": ""}, "variables_p": {"dr": [["str", 0.378159518391354], ["Dict[str, str]", 0.09336105042853186]], "end_date": [["datetime.datetime", 0.4713988925935927], ["Pattern[str]", 0.21318627372173918], ["datetime.date", 0.16179990267199007], ["datetime.date.time.date", 0.08494984745800095], ["datetime.datetime.datetime", 0.06866508355467726]], "job_runner": [["Dict[str, Dict[str, str]]", 0.3504442058993599], ["Dict[Tuple[str, str], float]", 0.09787558721746727], ["Dict[Tuple[Any, Any], Any]", 0.09329523424504117], ["Dict[int, int]", 0.09078845316495282], ["Dict[Tuple[str, int], Dict[Any, Any]]", 0.09002545157520937], ["Dict[str, int]", 0.08935010783940378], ["Dict[Type[Any], int]", 0.08700999130504251]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "start_date": [["datetime.date", 0.4643992733783985], ["datetime.datetime", 0.3605219956105628], ["Dict[Any, List[str]]", 0.08879241356943021], ["int", 0.08628631744160839]], "state": [["correios.models.posting.ShippingLabel", 0.5517920706845237], ["str", 0.12051728657629754], ["models.File", 0.11091115672829734], ["src.scrape.models.Product", 0.1101804783858367]], "ti": [["grpy.core.models.Grouping", 0.6300412331573358], ["dict", 0.09297978651925913], ["golem.rpc.session.WebSocketAddress", 0.09237495089222787]]}}, {"docstring": {"func": "Test if _process_task_instances puts the right task instances into the", "long_descr": "mock_list.", "ret": null}, "fn_lc": [[4234, 4], [4264, 46]], "fn_var_ln": {"dr": [[4249, 8], [4249, 10]], "end_date": [[4258, 12], [4258, 23]], "job_runner": [[4245, 8], [4245, 23]], "scheduler_job": [[4244, 8], [4244, 21]], "start_date": [[4257, 12], [4257, 25]], "state": [[4256, 12], [4256, 20]], "ti": [[4255, 12], [4255, 14]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr", "None"], ["ti", "dr", "get_task_instances", "session", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "end_date": [["ti", "end_date", "end_date"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "start_date": [["ti", "start_date", "start_date"]], "state": [["ti", "state", "state"], ["session", "query", "TaskInstance", "filter_by", "state", "State", "SCHEDULED", "count"], ["ti", "state", "State", "SCHEDULED"]], "ti": [["ti", "dr", "get_task_instances", "session", "session"], ["ti", "state", "state"], ["ti", "start_date", "start_date"], ["ti", "end_date", "end_date"], ["session", "refresh", "ti"], ["ti", "state", "State", "SCHEDULED"]]}, "name": "test_dag_file_processor_process_task_instances_with_max_active_tis_per_dag", "params": {"dag_maker": "", "end_date": "", "self": "", "start_date": "", "state": ""}, "params_descr": {"dag_maker": "", "end_date": "", "self": "", "start_date": "", "state": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id"], ["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"]], "end_date": [["ti", "end_date", "end_date"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "start_date": [["ti", "start_date", "start_date"]], "state": [["ti", "state", "state"], ["session", "query", "TaskInstance", "filter_by", "state", "State", "SCHEDULED", "count"], ["ti", "state", "State", "SCHEDULED"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.19715149876879667], ["accounts.models.Account", 0.09406580380152785]], "end_date": [["str", 0.4672919867366992], ["datetime.datetime", 0.2511758873601425], ["Union[str, int, float]", 0.09456048255632818], ["int", 0.09241116079050186]], "kwargs": [], "self": [], "start_date": [["str", 0.9218582263205031], ["int", 0.07814177367949707]], "state": [["sqlalchemy.orm.Session", 0.2142213968623195], ["aw_core.models.Event", 0.11234649280745908], ["int", 0.098871399319148], ["str", 0.09508951370488662], ["app.models.user.User.InDB", 0.09464004916349757]]}, "q_name": "TestSchedulerJob.test_dag_file_processor_process_task_instances_with_max_active_tis_per_dag", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "end_date": "", "job_runner": "", "scheduler_job": "", "start_date": "", "state": "", "ti": ""}, "variables_p": {"dr": [["str", 0.378159518391354], ["Dict[str, str]", 0.09336105042853186]], "end_date": [["datetime.datetime", 0.4713988925935927], ["Pattern[str]", 0.21318627372173918], ["datetime.date", 0.16179990267199007], ["datetime.date.time.date", 0.08494984745800095], ["datetime.datetime.datetime", 0.06866508355467726]], "job_runner": [["Dict[str, Dict[str, str]]", 0.3504442058993599], ["Dict[Tuple[str, str], float]", 0.09787558721746727], ["Dict[Tuple[Any, Any], Any]", 0.09329523424504117], ["Dict[int, int]", 0.09078845316495282], ["Dict[Tuple[str, int], Dict[Any, Any]]", 0.09002545157520937], ["Dict[str, int]", 0.08935010783940378], ["Dict[Type[Any], int]", 0.08700999130504251]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "start_date": [["datetime.date", 0.4643992733783985], ["datetime.datetime", 0.3605219956105628], ["Dict[Any, List[str]]", 0.08879241356943021], ["int", 0.08628631744160839]], "state": [["correios.models.posting.ShippingLabel", 0.5517920706845237], ["str", 0.12051728657629754], ["models.File", 0.11091115672829734], ["src.scrape.models.Product", 0.1101804783858367]], "ti": [["grpy.core.models.Grouping", 0.6300412331573358], ["dict", 0.09297978651925913], ["golem.rpc.session.WebSocketAddress", 0.09237495089222787]]}}, {"docstring": {"func": "Test if _process_task_instances puts the right task instances into the", "long_descr": "mock_list.", "ret": null}, "fn_lc": [[4282, 4], [4312, 46]], "fn_var_ln": {"dr": [[4297, 8], [4297, 10]], "end_date": [[4306, 12], [4306, 23]], "job_runner": [[4293, 8], [4293, 23]], "scheduler_job": [[4292, 8], [4292, 21]], "start_date": [[4305, 12], [4305, 25]], "state": [[4304, 12], [4304, 20]], "ti": [[4303, 12], [4303, 14]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr", "None"], ["ti", "dr", "get_task_instances", "session", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "end_date": [["ti", "end_date", "end_date"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "start_date": [["ti", "start_date", "start_date"]], "state": [["ti", "state", "state"], ["session", "query", "TaskInstance", "filter_by", "state", "State", "SCHEDULED", "count"], ["ti", "state", "State", "SCHEDULED"]], "ti": [["ti", "dr", "get_task_instances", "session", "session"], ["ti", "state", "state"], ["ti", "start_date", "start_date"], ["ti", "end_date", "end_date"], ["session", "refresh", "ti"], ["ti", "state", "State", "SCHEDULED"]]}, "name": "test_dag_file_processor_process_task_instances_with_max_active_tis_per_dagrun", "params": {"dag_maker": "", "end_date": "", "self": "", "start_date": "", "state": ""}, "params_descr": {"dag_maker": "", "end_date": "", "self": "", "start_date": "", "state": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id"], ["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"]], "end_date": [["ti", "end_date", "end_date"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "start_date": [["ti", "start_date", "start_date"]], "state": [["ti", "state", "state"], ["session", "query", "TaskInstance", "filter_by", "state", "State", "SCHEDULED", "count"], ["ti", "state", "State", "SCHEDULED"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.19715149876879667], ["accounts.models.Account", 0.09406580380152785]], "end_date": [["str", 0.4672919867366992], ["datetime.datetime", 0.2511758873601425], ["Union[str, int, float]", 0.09456048255632818], ["int", 0.09241116079050186]], "kwargs": [], "self": [], "start_date": [["str", 0.9218582263205031], ["int", 0.07814177367949707]], "state": [["sqlalchemy.orm.Session", 0.2142213968623195], ["aw_core.models.Event", 0.11234649280745908], ["int", 0.098871399319148], ["str", 0.09508951370488662], ["app.models.user.User.InDB", 0.09464004916349757]]}, "q_name": "TestSchedulerJob.test_dag_file_processor_process_task_instances_with_max_active_tis_per_dagrun", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "end_date": "", "job_runner": "", "scheduler_job": "", "start_date": "", "state": "", "ti": ""}, "variables_p": {"dr": [["str", 0.378159518391354], ["Dict[str, str]", 0.09336105042853186]], "end_date": [["datetime.datetime", 0.4713988925935927], ["Pattern[str]", 0.21318627372173918], ["datetime.date", 0.16179990267199007], ["datetime.date.time.date", 0.08494984745800095], ["datetime.datetime.datetime", 0.06866508355467726]], "job_runner": [["Dict[str, Dict[str, str]]", 0.3504442058993599], ["Dict[Tuple[str, str], float]", 0.09787558721746727], ["Dict[Tuple[Any, Any], Any]", 0.09329523424504117], ["Dict[int, int]", 0.09078845316495282], ["Dict[Tuple[str, int], Dict[Any, Any]]", 0.09002545157520937], ["Dict[str, int]", 0.08935010783940378], ["Dict[Type[Any], int]", 0.08700999130504251]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "start_date": [["datetime.date", 0.4643992733783985], ["datetime.datetime", 0.3605219956105628], ["Dict[Any, List[str]]", 0.08879241356943021], ["int", 0.08628631744160839]], "state": [["correios.models.posting.ShippingLabel", 0.5517920706845237], ["str", 0.12051728657629754], ["models.File", 0.11091115672829734], ["src.scrape.models.Product", 0.1101804783858367]], "ti": [["grpy.core.models.Grouping", 0.6300412331573358], ["dict", 0.09297978651925913], ["golem.rpc.session.WebSocketAddress", 0.09237495089222787]]}}, {"docstring": {"func": "Test if _process_task_instances puts the right task instances into the", "long_descr": "mock_list.", "ret": null}, "fn_lc": [[4330, 4], [4368, 50]], "fn_var_ln": {"dr": [[4350, 8], [4350, 10]], "end_date": [[4360, 16], [4360, 27]], "job_runner": [[4347, 8], [4347, 23]], "scheduler_job": [[4346, 8], [4346, 21]], "start_date": [[4359, 16], [4359, 29]], "state": [[4358, 16], [4358, 24]], "tis": [[4356, 12], [4356, 15]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"], ["dr", "None"], ["tis", "dr", "get_task_instances", "session", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "end_date": [["ti", "end_date", "end_date"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "start_date": [["ti", "start_date", "start_date"]], "state": [["ti", "state", "state"], ["session", "query", "TaskInstance", "filter_by", "state", "State", "SCHEDULED", "count"], ["tis", "state", "State", "SCHEDULED"], ["tis", "state", "State", "SCHEDULED"]], "tis": [["tis", "dr", "get_task_instances", "session", "session"], ["session", "refresh", "tis"], ["session", "refresh", "tis"], ["tis", "state", "State", "SCHEDULED"], ["tis", "state", "State", "SCHEDULED"]]}, "name": "test_dag_file_processor_process_task_instances_depends_on_past", "params": {"dag_maker": "", "end_date": "", "self": "", "start_date": "", "state": ""}, "params_descr": {"dag_maker": "", "end_date": "", "self": "", "start_date": "", "state": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "default_args", "True"], ["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED"]], "end_date": [["ti", "end_date", "end_date"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "start_date": [["ti", "start_date", "start_date"]], "state": [["ti", "state", "state"], ["session", "query", "TaskInstance", "filter_by", "state", "State", "SCHEDULED", "count"], ["tis", "state", "State", "SCHEDULED"], ["tis", "state", "State", "SCHEDULED"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.32121326598591804], ["Optional[str]", 0.18883223844381575], ["raiden_contracts.utils.type_aliases.ChainID", 0.18570386076177606]], "end_date": [["str", 0.4672919867366992], ["datetime.datetime", 0.2511758873601425], ["Union[str, int, float]", 0.09456048255632818], ["int", 0.09241116079050186]], "kwargs": [], "self": [], "start_date": [["str", 0.9218582263205031], ["int", 0.07814177367949707]], "state": [["sqlalchemy.orm.Session", 0.2142213968623195], ["aw_core.models.Event", 0.11234649280745908], ["int", 0.098871399319148], ["str", 0.09508951370488662], ["app.models.user.User.InDB", 0.09464004916349757]]}, "q_name": "TestSchedulerJob.test_dag_file_processor_process_task_instances_depends_on_past", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "end_date": "", "job_runner": "", "scheduler_job": "", "start_date": "", "state": "", "tis": ""}, "variables_p": {"dr": [["str", 0.378159518391354], ["Dict[str, str]", 0.09336105042853186]], "end_date": [["datetime.datetime", 0.4713988925935927], ["Pattern[str]", 0.21318627372173918], ["datetime.date", 0.16179990267199007], ["datetime.date.time.date", 0.08494984745800095], ["datetime.datetime.datetime", 0.06866508355467726]], "job_runner": [["Dict[str, Dict[str, str]]", 0.3504442058993599], ["Dict[Tuple[str, str], float]", 0.09787558721746727], ["Dict[Tuple[Any, Any], Any]", 0.09329523424504117], ["Dict[int, int]", 0.09078845316495282], ["Dict[Tuple[str, int], Dict[Any, Any]]", 0.09002545157520937], ["Dict[str, int]", 0.08935010783940378], ["Dict[Type[Any], int]", 0.08700999130504251]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "start_date": [["datetime.date", 0.4643992733783985], ["datetime.datetime", 0.3605219956105628], ["Dict[Any, List[str]]", 0.08879241356943021], ["int", 0.08628631744160839]], "state": [["correios.models.posting.ShippingLabel", 0.5517920706845237], ["str", 0.12051728657629754], ["models.File", 0.11091115672829734], ["src.scrape.models.Product", 0.1101804783858367]], "tis": [["Optional[str]", 0.11848525904967559], ["golem.rpc.session.WebSocketAddress", 0.11164668330766676], ["str", 0.09655070788063749], ["golem.rpc.session.Publisher", 0.09174927300687656]]}}, {"docstring": {"func": "Test if a task instance will be added if the dag is updated", "long_descr": null, "ret": null}, "fn_lc": [[4370, 4], [4414, 28]], "fn_var_ln": {"dag": [[4392, 8], [4392, 11]], "dr": [[4411, 8], [4411, 10]], "drs": [[4409, 8], [4409, 11]], "job_runner": [[4389, 8], [4389, 23]], "orm_dag": [[4383, 8], [4383, 15]], "scheduler_job": [[4388, 8], [4388, 21]], "session": [[4382, 8], [4382, 15]], "tis": [[4413, 8], [4413, 11]]}, "fn_var_occur": {"dag": [["dag_maker", "dag_id", "dag"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["BashOperator", "task_id", "dag", "dag", "bash_command"], ["SerializedDagModel", "write_dag", "dag", "dag"], ["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"]], "dr": [["dr", "drs"], ["tis", "dr", "get_task_instances"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["dr", "drs"], ["tis", "dr", "get_task_instances"]], "drs": [["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["len", "drs"], ["dr", "drs"], ["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["len", "drs"], ["dr", "drs"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "processor_agent"], ["self", "job_runner", "processor_agent", "end"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "orm_dag": [["orm_dag", "dag_maker", "dag_model"], ["orm_dag", "None"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["session", "query", "TaskInstance", "filter_by", "state", "State", "SCHEDULED", "count"], ["session", "flush"], ["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"]], "tis": [["tis", "dr", "get_task_instances"], ["len", "tis"], ["tis", "dr", "get_task_instances"], ["len", "tis"]]}, "name": "test_scheduler_job_add_new_task", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "dag"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["orm_dag", "dag_maker", "dag_model"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "dagbag", "dag_maker", "dagbag"], ["self", "job_runner", "processor_agent"], ["self", "job_runner", "processor_agent", "end"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["dag", "self", "job_runner", "dagbag", "get_dag", "session", "session"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.29549769876157317], ["core.models.Grouping", 0.08464703943120855]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_scheduler_job_add_new_task", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dr": "", "drs": "", "job_runner": "", "orm_dag": "", "scheduler_job": "", "session": "", "tis": ""}, "variables_p": {"dag": [["str", 0.5674645865867447], ["List[str]", 0.23291185185718166], ["Optional[List[Any]]", 0.10503611879225032], ["list", 0.09458744276382325]], "dr": [["dict", 0.089368525174708]], "drs": [["str", 0.31276345550654766], ["List[Dict[str, Any]]", 0.10682113393114338], ["Union[Literal, Literal]", 0.10308525247983902], ["int", 0.10140250690882163], ["Dict[str, str]", 0.08869450900436825]], "job_runner": [["Dict[str, Sequence[Any]]", 0.11708304313056428], ["dict", 0.11394495924991106], ["Dict[str, Dict[str, str]]", 0.09913717721296468], ["float", 0.09876466792619185], ["Dict[str, str]", 0.09700020363267496], ["str", 0.09301597094828466], ["Type[int]", 0.08605775764451828]], "orm_dag": [], "scheduler_job": [["List[str]", 0.09910368840659015]], "session": [["Dict[str, Any]", 0.40566377197222586], ["dict", 0.19787368883849765], ["str", 0.09125353197872602], ["Dict[str, str]", 0.08443291615671582]], "tis": [["list", 0.30936229868901094], ["str", 0.19693152313028695], ["int", 0.09330969569419027]]}}, {"docstring": {"func": "Test dag after dag.clear, max_active_runs is respected", "long_descr": null, "ret": null}, "fn_lc": [[4416, 4], [4446, 92]], "fn_var_ln": {"dr": [[4434, 8], [4434, 10]], "job_runner": [[4428, 8], [4428, 23]], "scheduler_job": [[4427, 8], [4427, 21]], "session": [[4440, 8], [4440, 15]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"], ["dr", "dag_maker", "create_dagrun_after", "dr", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"], ["dag_maker", "create_dagrun_after", "dr", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_start_queued_dagruns", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["len", "DagRun", "find", "dag_id", "dag", "dag_id", "state", "State", "QUEUED", "session", "session"], ["session", "settings", "Session"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["session", "flush"], ["len", "DagRun", "find", "dag_id", "dag", "dag_id", "state", "State", "RUNNING", "session", "session"], ["len", "DagRun", "find", "dag_id", "dag", "dag_id", "state", "State", "QUEUED", "session", "session"]]}, "name": "test_runs_respected_after_clear", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "max_active_runs", "dag"], ["dr", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"], ["dr", "dag_maker", "create_dagrun_after", "dr", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"], ["dag_maker", "create_dagrun_after", "dr", "run_type", "DagRunType", "SCHEDULED", "state", "State", "QUEUED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_start_queued_dagruns", "session"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.5087237922008492], ["Callable", 0.11245235665969387], ["salon.models.Stylist", 0.10074300115558023], ["Optional[Dict[str, Any]]", 0.09352697845133214]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_runs_respected_after_clear", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "job_runner": "", "scheduler_job": "", "session": ""}, "variables_p": {"dr": [["str", 0.3057481442275511], ["int", 0.20617658641168843], ["list", 0.1858427544048101], ["Dict[str, Union[int, str]]", 0.12334609146232423], ["Tuple[str, str, str, str, str, str, str]", 0.09084567470905663], ["Dict[str, Any]", 0.0880407487845695]], "job_runner": [["Dict[str, Dict[str, str]]", 0.3504442058993599], ["Dict[Tuple[str, str], float]", 0.09787558721746727], ["Dict[Tuple[Any, Any], Any]", 0.09329523424504117], ["Dict[int, int]", 0.09078845316495282], ["Dict[Tuple[str, int], Dict[Any, Any]]", 0.09002545157520937], ["Dict[str, int]", 0.08935010783940378], ["Dict[Type[Any], int]", 0.08700999130504251]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["Dict[str, Any]", 0.19149737201043093], ["Dict[str, Dict[str, int]]", 0.1758280243290073], ["Dict[Any, str]", 0.082635298970379]]}}, {"docstring": {"func": "Tests that tasks in the deferred state, but whose trigger timeout", "long_descr": "has expired, are correctly failed.", "ret": null}, "fn_lc": [[4448, 4], [4492, 42]], "fn_var_ln": {"dr1": [[4469, 8], [4469, 11]], "dr2": [[4470, 8], [4470, 11]], "job_runner": [[4483, 8], [4483, 23]], "scheduler_job": [[4482, 8], [4482, 21]], "session": [[4455, 8], [4455, 15]], "state": [[4477, 8], [4477, 17]], "ti1": [[4473, 8], [4473, 11]], "ti2": [[4474, 8], [4474, 11]], "trigger_timeout": [[4478, 8], [4478, 27]]}, "fn_var_occur": {"dr1": [["dr1", "dag_maker", "create_dagrun"], ["ti1", "dr1", "get_task_instance", "session"]], "dr2": [["dr2", "dag_maker", "create_dagrun", "run_id", "execution_date", "DEFAULT_DATE", "datetime", "timedelta", "seconds"], ["ti2", "dr2", "get_task_instance", "session"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "check_trigger_timeouts", "session", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "schedule", "max_active_runs", "session", "session"], ["ti1", "dr1", "get_task_instance", "session"], ["ti2", "dr2", "get_task_instance", "session"], ["session", "flush"], ["self", "job_runner", "check_trigger_timeouts", "session", "session"], ["session", "refresh", "ti1"], ["session", "refresh", "ti2"]], "state": [["ti1", "state", "State", "DEFERRED"], ["ti2", "state", "State", "DEFERRED"], ["ti1", "state", "State", "SCHEDULED"], ["ti2", "state", "State", "DEFERRED"]], "ti1": [["ti1", "dr1", "get_task_instance", "session"], ["ti1", "state", "State", "DEFERRED"], ["ti1", "trigger_timeout", "timezone", "utcnow", "datetime", "timedelta", "seconds"], ["session", "refresh", "ti1"], ["ti1", "state", "State", "SCHEDULED"], ["ti1", "next_method"]], "ti2": [["ti2", "dr2", "get_task_instance", "session"], ["ti2", "state", "State", "DEFERRED"], ["ti2", "trigger_timeout", "timezone", "utcnow", "datetime", "timedelta", "seconds"], ["session", "refresh", "ti2"], ["ti2", "state", "State", "DEFERRED"]], "trigger_timeout": [["ti1", "trigger_timeout", "timezone", "utcnow", "datetime", "timedelta", "seconds"], ["ti2", "trigger_timeout", "timezone", "utcnow", "datetime", "timedelta", "seconds"]]}, "name": "test_timeout_triggers", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "schedule", "max_active_runs", "session", "session"], ["dr1", "dag_maker", "create_dagrun"], ["dr2", "dag_maker", "create_dagrun", "run_id", "execution_date", "DEFAULT_DATE", "datetime", "timedelta", "seconds"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "check_trigger_timeouts", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["zam_repondeur.models.Dossier", 0.09566171594914251], ["datetime.datetime", 0.09460737134394605]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_timeout_triggers", "ret_exprs": [], "ret_type": "", "variables": {"dr1": "", "dr2": "", "job_runner": "", "scheduler_job": "", "session": "", "state": "", "ti1": "", "ti2": "", "trigger_timeout": ""}, "variables_p": {"dr1": [["dict", 0.24568358880449573], ["Union[int, str]", 0.09625795849992479], ["qutebrowser.utils.usertypes.KeyMode", 0.07942276139270577], ["str", 0.07260038900962647], ["int", 0.06748953320454816]], "dr2": [["dict", 0.2549727028349619], ["Dict[str, Any]", 0.12569555323660764], ["Optional[hpaction.models.HPActionDocuments]", 0.08979225985061431], ["list", 0.08815389224618853], ["byceps.services.user.transfer.models.User", 0.08610488709766631]], "job_runner": [["Dict[str, Union[None, Any, str]]", 0.14025290789295566], ["Dict[str, Sequence[Any]]", 0.11953000617822547], ["Pattern[str]", 0.10076946257558404], ["dict", 0.09395979339239445], ["Dict[str, str]", 0.09063257857616276], ["Dict[str, Dict[str, str]]", 0.08920956702667852]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["datetime.timedelta", 0.13132815618476582], ["Optional[raiden.transfer.state.NettingChannelState]", 0.11498936615969957], ["datetime.datetime.datetime", 0.10824219890898415], ["unittesmock.MagicMock", 0.09469209572218086], ["bool", 0.09230804711885075], ["server.models.user.User", 0.0906848310084718]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "ti1": [["grpy.core.models.Grouping", 0.16874477984610092], ["Optional[aw_core.models.Event]", 0.1651788653765043], ["geode.models.common.Address", 0.0839653434451894], ["golem.rpc.session.Publisher", 0.0828403479773478]], "ti2": [["grpy.core.models.Grouping", 0.16874477984610092], ["Optional[aw_core.models.Event]", 0.1651788653765043], ["geode.models.common.Address", 0.0839653434451894], ["golem.rpc.session.Publisher", 0.0828403479773478]], "trigger_timeout": [["int", 0.6129003445058153], ["datetime.datetime.datetime", 0.10503053340639884], ["float", 0.10214183828766193], ["datetime.datetime", 0.09018353555492467]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[4494, 4], [4502, 69]], "fn_var_ln": {"executor": [[4495, 8], [4495, 16]], "job_runner": [[4497, 8], [4497, 23]], "scheduler_job": [[4496, 8], [4496, 21]]}, "fn_var_occur": {"executor": [["executor", "MockExecutor", "do_update", "False"], ["scheduler_job", "Job", "executor", "executor"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_find_zombies"]], "scheduler_job": [["scheduler_job", "Job", "executor", "executor"], ["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["scheduler_job", "executor", "callback_sink", "send", "assert_not_called"]]}, "name": "test_find_zombies_nothing", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "job_runner", "SchedulerJobRunner", "scheduler_job"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_find_zombies"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_zombies_nothing", "ret_exprs": [], "ret_type": "", "variables": {"executor": "", "job_runner": "", "scheduler_job": ""}, "variables_p": {"executor": [["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.10195041780483675]], "job_runner": [["MagicMock[Union[mock.AsyncMock, mock.MagicMock]]", 0.4683717732588181], ["Tuple[Literal, Literal]", 0.18452776179321992], ["property", 0.09397577367069262]], "scheduler_job": [["dict", 0.20336741560115645], ["Dict[str, Union[Any, Any]]", 0.12182445757889099], ["OrderedDict[str, Any]", 0.08112912091189835]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[4504, 4], [4563, 39]], "fn_var_ln": {"dag": [[4508, 12], [4508, 15]], "dag_run": [[4511, 12], [4511, 19]], "dagbag": [[4505, 8], [4505, 14]], "executor": [[4520, 12], [4520, 34]], "job_id": [[4538, 16], [4538, 25]], "job_runner": [[4519, 12], [4519, 27]], "local_job": [[4531, 16], [4531, 25]], "queued_by_job_id": [[4544, 12], [4544, 31]], "requests": [[4550, 8], [4550, 16]], "scheduler_job": [[4518, 12], [4518, 25]], "state": [[4533, 16], [4533, 31]], "task": [[4527, 16], [4527, 20]], "tasks_to_setup": [[4524, 12], [4524, 26]], "ti": [[4528, 16], [4528, 18]]}, "fn_var_occur": {"dag": [["dag", "dagbag", "get_dag"], ["dag", "sync_to_db"], ["dag_run", "dag", "create_dagrun", "state", "DagRunState", "RUNNING", "execution_date", "DEFAULT_DATE", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["task", "dag", "get_task", "task_id", "task_id"], ["requests", "full_filepath", "dag", "fileloc"]], "dag_run": [["dag_run", "dag", "create_dagrun", "state", "DagRunState", "RUNNING", "execution_date", "DEFAULT_DATE", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["ti", "TaskInstance", "task", "run_id", "dag_run", "run_id", "state", "State", "RUNNING"]], "dagbag": [["dagbag", "DagBag", "TEST_DAG_FOLDER", "read_dags_from_db", "False"], ["dag", "dagbag", "get_dag"]], "executor": [["scheduler_job", "executor", "MockExecutor"], ["scheduler_job", "executor", "callback_sink", "send", "assert_called_once"], ["requests", "scheduler_job", "executor", "callback_sink", "send", "call_args", "args"]], "job_id": [["ti", "job_id", "local_job", "id"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_find_zombies"], ["requests", "msg", "str", "self", "job_runner", "_generate_zombie_message_details", "ti"]], "local_job": [["local_job", "Job", "dag_id", "ti", "dag_id"], ["LocalTaskJobRunner", "job", "local_job", "task_instance", "ti"], ["local_job", "state", "State", "SHUTDOWN"], ["session", "add", "local_job"], ["ti", "job_id", "local_job", "id"]], "queued_by_job_id": [["ti", "queued_by_job_id"], ["ti", "queued_by_job_id", "scheduler_job", "id"]], "requests": [["requests", "scheduler_job", "executor", "callback_sink", "send", "call_args", "args"], ["len", "requests"], ["requests", "full_filepath", "dag", "fileloc"], ["requests", "msg", "str", "self", "job_runner", "_generate_zombie_message_details", "ti"], ["requests", "is_failure_callback", "True"], ["isinstance", "requests", "simple_task_instance", "SimpleTaskInstance"], ["ti", "dag_id", "requests", "simple_task_instance", "dag_id"], ["ti", "task_id", "requests", "simple_task_instance", "task_id"], ["ti", "run_id", "requests", "simple_task_instance", "run_id"], ["ti", "map_index", "requests", "simple_task_instance", "map_index"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor"], ["ti", "queued_by_job_id", "scheduler_job", "id"], ["scheduler_job", "executor", "callback_sink", "send", "assert_called_once"], ["requests", "scheduler_job", "executor", "callback_sink", "send", "call_args", "args"]], "state": [["dag_run", "dag", "create_dagrun", "state", "DagRunState", "RUNNING", "execution_date", "DEFAULT_DATE", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["ti", "TaskInstance", "task", "run_id", "dag_run", "run_id", "state", "State", "RUNNING"], ["local_job", "state", "State", "SHUTDOWN"]], "task": [["task", "dag", "get_task", "task_id", "task_id"], ["ti", "TaskInstance", "task", "run_id", "dag_run", "run_id", "state", "State", "RUNNING"], ["task", "task_id"]], "tasks_to_setup": [], "ti": [["ti", "TaskInstance", "task", "run_id", "dag_run", "run_id", "state", "State", "RUNNING"], ["ti", "queued_by_job_id"], ["local_job", "Job", "dag_id", "ti", "dag_id"], ["LocalTaskJobRunner", "job", "local_job", "task_instance", "ti"], ["ti", "job_id", "local_job", "id"], ["session", "add", "ti"], ["ti", "queued_by_job_id", "scheduler_job", "id"], ["requests", "msg", "str", "self", "job_runner", "_generate_zombie_message_details", "ti"], ["ti", "dag_id", "requests", "simple_task_instance", "dag_id"], ["ti", "task_id", "requests", "simple_task_instance", "task_id"], ["ti", "run_id", "requests", "simple_task_instance", "run_id"], ["ti", "map_index", "requests", "simple_task_instance", "map_index"]]}, "name": "test_find_zombies", "params": {"load_examples": "", "self": ""}, "params_descr": {"load_examples": "", "self": ""}, "params_occur": {"load_examples": [], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_find_zombies"], ["requests", "msg", "str", "self", "job_runner", "_generate_zombie_message_details", "ti"]]}, "params_p": {"args": [], "kwargs": [], "load_examples": [["bool", 0.44762256789195193], ["int", 0.19792509118509996], ["List[str]", 0.13371069348886247], ["List[Tuple[str, str]]", 0.08703095394522305]], "self": []}, "q_name": "TestSchedulerJob.test_find_zombies", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_run": "", "dagbag": "", "executor": "", "job_id": "", "job_runner": "", "local_job": "", "queued_by_job_id": "", "requests": "", "scheduler_job": "", "state": "", "task": "", "tasks_to_setup": "", "ti": ""}, "variables_p": {"dag": [["str", 0.10748816177142315], ["decksite.data.models.person.Person", 0.09537347147002409]], "dag_run": [["str", 0.18946940810346347], ["Dict[str, str]", 0.17341066117296092], ["list", 0.09397528892181072], ["sqlalchemy.Table", 0.09290217162941428]], "dagbag": [["PY_AWS.chalice.tests.unideploy.test_deployer.LeafResource", 0.47864956108783446], ["kedro.framework.cli.utils.CommandCollection", 0.07808495653027417], ["Tuple[Literal, Dict[str, Any]]", 0.06781840185711371]], "executor": [["str", 0.3210208985274812]], "job_id": [["int", 0.30281774381282267], ["Set[int]", 0.2057589423312317], ["str", 0.10914591329335904], ["Optional[str]", 0.09977424276279748]], "job_runner": [["Dict[str, Dict[str, str]]", 0.3504442058993599], ["Dict[Tuple[str, str], float]", 0.09787558721746727], ["Dict[Tuple[Any, Any], Any]", 0.09329523424504117], ["Dict[int, int]", 0.09078845316495282], ["Dict[Tuple[str, int], Dict[Any, Any]]", 0.09002545157520937], ["Dict[str, int]", 0.08935010783940378], ["Dict[Type[Any], int]", 0.08700999130504251]], "local_job": [["list", 0.16989559556271217], ["Dict[str, Any]", 0.1681921193219836], ["alerta.models.alerAlert", 0.08809233288901037], ["List[Dict[str, Any]]", 0.08607930831903947], ["float", 0.07726176711453847]], "queued_by_job_id": [["int", 0.4220317697454573], ["bytes", 0.10847286357103973], ["list", 0.10066960287600352], ["Pattern[Any]", 0.09460424583778275], ["str", 0.09294431334471712]], "requests": [["PyLibs.objection.utils.frida_transporRunnerMessage", 0.19796898920325104]], "scheduler_job": [["Dict[str, List[str]]", 0.2866423692826576], ["cincoconfig.config.Schema", 0.08246538960069358], ["raiden.utils.Any", 0.07557206833854697]], "state": [["Optional[str]", 0.47768560770798596], ["str", 0.18749491123039114], ["list", 0.08699157605803531], ["Optional[hpaction.models.UploadToken]", 0.08264037078918597]], "task": [["kippo.tasks.models.KippoTask", 0.1970615983488098], ["taskiapplication.models.task.Task", 0.10463621439133364]], "tasks_to_setup": [["str", 0.6321084778565341], ["int", 0.18737989587622295], ["Type[weighvisits.models.visits.Visit]", 0.10007139388132234], ["frozenset[str]", 0.08044023238592049]], "ti": [["int", 0.3351951735481855], ["str", 0.2671761917431881], ["Dict[int, str]", 0.1264435818666907], ["List[dict]", 0.09926926986876383], ["List[str]", 0.0879537824848838]]}}, {"docstring": {"func": "Check that the zombie message comes out as expected", "long_descr": null, "ret": null}, "fn_lc": [[4565, 4], [4629, 13]], "fn_var_ln": {"dag": [[4573, 12], [4573, 15]], "dag_run": [[4576, 12], [4576, 19]], "dagbag": [[4570, 8], [4570, 14]], "external_executor_id": [[4619, 12], [4619, 35]], "hostname": [[4617, 12], [4617, 23]], "job_id": [[4601, 16], [4601, 25]], "job_runner": [[4584, 12], [4584, 27]], "local_job": [[4595, 16], [4595, 25]], "map_index": [[4618, 12], [4618, 24]], "queued_by_job_id": [[4607, 12], [4607, 31]], "scheduler_job": [[4583, 12], [4583, 25]], "state": [[4596, 16], [4596, 31]], "task": [[4591, 16], [4591, 20]], "tasks_to_setup": [[4588, 12], [4588, 26]], "ti": [[4592, 16], [4592, 18]], "zombie_message": [[4621, 12], [4621, 26]]}, "fn_var_occur": {"dag": [["dag", "dagbag", "get_dag"], ["dag", "sync_to_db"], ["dag_run", "dag", "create_dagrun", "state", "DagRunState", "RUNNING", "execution_date", "DEFAULT_DATE", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["task", "dag", "get_task", "task_id", "task_id"]], "dag_run": [["dag_run", "dag", "create_dagrun", "state", "DagRunState", "RUNNING", "execution_date", "DEFAULT_DATE", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["ti", "TaskInstance", "task", "run_id", "dag_run", "run_id", "state", "State", "RUNNING"]], "dagbag": [["dagbag", "DagBag", "TEST_DAG_FOLDER", "read_dags_from_db", "False"], ["dag", "dagbag", "get_dag"]], "external_executor_id": [["ti", "external_executor_id"]], "hostname": [["ti", "hostname"]], "job_id": [["ti", "job_id", "local_job", "id"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["zombie_message", "self", "job_runner", "_generate_zombie_message_details", "ti"], ["zombie_message", "self", "job_runner", "_generate_zombie_message_details", "ti"]], "local_job": [["local_job", "Job", "dag_id", "ti", "dag_id"], ["local_job", "state", "State", "SHUTDOWN"], ["session", "add", "local_job"], ["ti", "job_id", "local_job", "id"]], "map_index": [["ti", "map_index"]], "queued_by_job_id": [["ti", "queued_by_job_id"], ["ti", "queued_by_job_id", "scheduler_job", "id"]], "scheduler_job": [["scheduler_job", "Job", "executor", "MockExecutor"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["ti", "queued_by_job_id", "scheduler_job", "id"]], "state": [["dag_run", "dag", "create_dagrun", "state", "DagRunState", "RUNNING", "execution_date", "DEFAULT_DATE", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["ti", "TaskInstance", "task", "run_id", "dag_run", "run_id", "state", "State", "RUNNING"], ["local_job", "state", "State", "SHUTDOWN"]], "task": [["task", "dag", "get_task", "task_id", "task_id"], ["ti", "TaskInstance", "task", "run_id", "dag_run", "run_id", "state", "State", "RUNNING"], ["task", "task_id"]], "tasks_to_setup": [], "ti": [["ti", "TaskInstance", "task", "run_id", "dag_run", "run_id", "state", "State", "RUNNING"], ["ti", "queued_by_job_id"], ["local_job", "Job", "dag_id", "ti", "dag_id"], ["ti", "job_id", "local_job", "id"], ["session", "add", "ti"], ["ti", "queued_by_job_id", "scheduler_job", "id"], ["zombie_message", "self", "job_runner", "_generate_zombie_message_details", "ti"], ["ti", "hostname"], ["ti", "map_index"], ["ti", "external_executor_id"], ["zombie_message", "self", "job_runner", "_generate_zombie_message_details", "ti"]], "zombie_message": [["zombie_message", "self", "job_runner", "_generate_zombie_message_details", "ti"], ["zombie_message", "self", "job_runner", "_generate_zombie_message_details", "ti"]]}, "name": "test_zombie_message", "params": {"load_examples": "", "self": ""}, "params_descr": {"load_examples": "", "self": ""}, "params_occur": {"load_examples": [], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["zombie_message", "self", "job_runner", "_generate_zombie_message_details", "ti"], ["zombie_message", "self", "job_runner", "_generate_zombie_message_details", "ti"]]}, "params_p": {"args": [], "kwargs": [], "load_examples": [["bool", 0.3009859718902426], ["int", 0.16039953552955563], ["List[str]", 0.16039953552955563], ["List[Tuple[str, str]]", 0.09100947989757574], ["str", 0.06340297081175741], ["dict", 0.06340297081175741]], "self": []}, "q_name": "TestSchedulerJob.test_zombie_message", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_run": "", "dagbag": "", "external_executor_id": "", "hostname": "", "job_id": "", "job_runner": "", "local_job": "", "map_index": "", "queued_by_job_id": "", "scheduler_job": "", "state": "", "task": "", "tasks_to_setup": "", "ti": "", "zombie_message": ""}, "variables_p": {"dag": [["str", 0.10748816177142315], ["decksite.data.models.person.Person", 0.09537347147002409]], "dag_run": [["str", 0.18946940810346347], ["Dict[str, str]", 0.17341066117296092], ["list", 0.09397528892181072], ["sqlalchemy.Table", 0.09290217162941428]], "dagbag": [["PY_AWS.chalice.tests.unideploy.test_deployer.LeafResource", 0.47864956108783446], ["kedro.framework.cli.utils.CommandCollection", 0.07808495653027417], ["Tuple[Literal, Dict[str, Any]]", 0.06781840185711371]], "external_executor_id": [["str", 0.8309518441065099], ["int", 0.11556409045997561]], "hostname": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "job_id": [["int", 0.30281774381282267], ["Set[int]", 0.2057589423312317], ["str", 0.10914591329335904], ["Optional[str]", 0.09977424276279748]], "job_runner": [["Dict[str, Dict[str, str]]", 0.2982621980036016], ["Dict[Any, List[Any]]", 0.10133528363781372], ["Dict[int, str]", 0.09687766731087497], ["Dict[Any, Type[Any]]", 0.09634216618485274], ["Dict[Any, Optional[Any]]", 0.09634216618485274]], "local_job": [["str", 0.20212572168267537], ["Dict[str, Any]", 0.13009716264701135], ["raiden.utils.Any", 0.09812676065041888], ["int", 0.0885830827409115], ["fal.models.Season", 0.08329120591505872], ["Dict[int, Set[Any]]", 0.08324905773497164]], "map_index": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "queued_by_job_id": [["int", 0.4220317697454573], ["bytes", 0.10847286357103973], ["list", 0.10066960287600352], ["Pattern[Any]", 0.09460424583778275], ["str", 0.09294431334471712]], "scheduler_job": [["Dict[str, Union[Any, Any, str]]", 0.08949021136620434]], "state": [["Optional[str]", 0.47768560770798596], ["str", 0.18749491123039114], ["list", 0.08699157605803531], ["Optional[hpaction.models.UploadToken]", 0.08264037078918597]], "task": [["kippo.tasks.models.KippoTask", 0.1970615983488098], ["taskiapplication.models.task.Task", 0.10463621439133364]], "tasks_to_setup": [["str", 0.6321084778565341], ["int", 0.18737989587622295], ["Type[weighvisits.models.visits.Visit]", 0.10007139388132234], ["frozenset[str]", 0.08044023238592049]], "ti": [["int", 0.3351951735481855], ["str", 0.2671761917431881], ["Dict[int, str]", 0.1264435818666907], ["List[dict]", 0.09926926986876383], ["List[str]", 0.0879537824848838]], "zombie_message": [["float", 0.0930545080087667]]}}, {"docstring": {"func": "Check that the same set of failure callback with zombies are passed to the dag", "long_descr": "file processors until the next zombie detection logic is invoked.", "ret": null}, "fn_lc": [[4631, 4], [4692, 76]], "fn_var_ln": {"callback_requests": [[4685, 8], [4685, 25]], "dag": [[4642, 12], [4642, 15]], "dag_run": [[4645, 12], [4645, 19]], "dagbag": [[4637, 12], [4637, 18]], "executor": [[4670, 8], [4670, 30]], "expected_failure_callback_requests": [[4677, 8], [4677, 42]], "job_id": [[4664, 12], [4664, 21]], "job_runner": [[4668, 8], [4668, 23]], "local_job": [[4655, 12], [4655, 21]], "scheduler_job": [[4667, 8], [4667, 21]], "state": [[4657, 12], [4657, 27]], "task": [[4651, 12], [4651, 16]], "ti": [[4653, 12], [4653, 14]]}, "fn_var_occur": {"callback_requests": [["callback_requests", "scheduler_job", "executor", "callback_sink", "send", "call_args", "args"], ["len", "callback_requests"], ["zombie", "simple_task_instance", "key", "zombie", "expected_failure_callback_requests", "result", "simple_task_instance", "key", "result", "callback_requests"], ["callback_requests", "simple_task_instance", "None"], ["expected_failure_callback_requests", "callback_requests"]], "dag": [["dag", "dagbag", "get_dag"], ["dag", "sync_to_db", "processor_subdir", "TEST_DAG_FOLDER"], ["dag_run", "dag", "create_dagrun", "state", "DagRunState", "RUNNING", "execution_date", "DEFAULT_DATE", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["task", "dag", "get_task", "task_id"], ["expected_failure_callback_requests", "TaskCallbackRequest", "full_filepath", "dag", "fileloc", "simple_task_instance", "SimpleTaskInstance", "from_ti", "ti", "processor_subdir", "TEST_DAG_FOLDER", "msg", "str", "self", "job_runner", "_generate_zombie_message_details", "ti"]], "dag_run": [["dag_run", "dag", "create_dagrun", "state", "DagRunState", "RUNNING", "execution_date", "DEFAULT_DATE", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["ti", "TaskInstance", "task", "run_id", "dag_run", "run_id", "state", "State", "RUNNING"]], "dagbag": [["dagbag", "DagBag", "dag_folder", "os", "path", "join", "settings", "DAGS_FOLDER", "read_dags_from_db", "False"], ["dag", "dagbag", "get_dag"]], "executor": [["scheduler_job", "executor", "MockExecutor"], ["scheduler_job", "executor", "callback_sink", "send", "assert_called_once"], ["callback_requests", "scheduler_job", "executor", "callback_sink", "send", "call_args", "args"]], "expected_failure_callback_requests": [["expected_failure_callback_requests", "TaskCallbackRequest", "full_filepath", "dag", "fileloc", "simple_task_instance", "SimpleTaskInstance", "from_ti", "ti", "processor_subdir", "TEST_DAG_FOLDER", "msg", "str", "self", "job_runner", "_generate_zombie_message_details", "ti"], ["zombie", "simple_task_instance", "key", "zombie", "expected_failure_callback_requests", "result", "simple_task_instance", "key", "result", "callback_requests"], ["expected_failure_callback_requests", "simple_task_instance", "None"], ["expected_failure_callback_requests", "callback_requests"]], "job_id": [["ti", "job_id", "local_job", "id"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_find_zombies"], ["expected_failure_callback_requests", "TaskCallbackRequest", "full_filepath", "dag", "fileloc", "simple_task_instance", "SimpleTaskInstance", "from_ti", "ti", "processor_subdir", "TEST_DAG_FOLDER", "msg", "str", "self", "job_runner", "_generate_zombie_message_details", "ti"]], "local_job": [["local_job", "Job", "dag_id", "ti", "dag_id"], ["LocalTaskJobRunner", "job", "local_job", "task_instance", "ti"], ["local_job", "state", "State", "SHUTDOWN"], ["session", "add", "local_job"], ["ti", "job_id", "local_job", "id"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor"], ["scheduler_job", "executor", "callback_sink", "send", "assert_called_once"], ["callback_requests", "scheduler_job", "executor", "callback_sink", "send", "call_args", "args"]], "state": [["dag_run", "dag", "create_dagrun", "state", "DagRunState", "RUNNING", "execution_date", "DEFAULT_DATE", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["ti", "TaskInstance", "task", "run_id", "dag_run", "run_id", "state", "State", "RUNNING"], ["local_job", "state", "State", "SHUTDOWN"]], "task": [["task", "dag", "get_task", "task_id"], ["ti", "TaskInstance", "task", "run_id", "dag_run", "run_id", "state", "State", "RUNNING"]], "ti": [["ti", "TaskInstance", "task", "run_id", "dag_run", "run_id", "state", "State", "RUNNING"], ["local_job", "Job", "dag_id", "ti", "dag_id"], ["LocalTaskJobRunner", "job", "local_job", "task_instance", "ti"], ["session", "add", "ti"], ["ti", "job_id", "local_job", "id"], ["expected_failure_callback_requests", "TaskCallbackRequest", "full_filepath", "dag", "fileloc", "simple_task_instance", "SimpleTaskInstance", "from_ti", "ti", "processor_subdir", "TEST_DAG_FOLDER", "msg", "str", "self", "job_runner", "_generate_zombie_message_details", "ti"]]}, "name": "test_find_zombies_handle_failure_callbacks_are_correctly_passed_to_dag_processor", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_find_zombies"], ["expected_failure_callback_requests", "TaskCallbackRequest", "full_filepath", "dag", "fileloc", "simple_task_instance", "SimpleTaskInstance", "from_ti", "ti", "processor_subdir", "TEST_DAG_FOLDER", "msg", "str", "self", "job_runner", "_generate_zombie_message_details", "ti"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_find_zombies_handle_failure_callbacks_are_correctly_passed_to_dag_processor", "ret_exprs": [], "ret_type": "", "variables": {"callback_requests": "", "dag": "", "dag_run": "", "dagbag": "", "executor": "", "expected_failure_callback_requests": "", "job_id": "", "job_runner": "", "local_job": "", "scheduler_job": "", "state": "", "task": "", "ti": ""}, "variables_p": {"callback_requests": [], "dag": [["tests.helpers.Callback", 0.323355156874938], ["tests.unitest_base_command.FakeCommand", 0.3140010081556988], ["integration-tests.teswaiHasAtLeastPeers", 0.0948494942624362], ["tests.test_model.ExplicitRawMapAsMemberOfSubClass", 0.0781434660954699]], "dag_run": [["str", 0.18946940810346347], ["Dict[str, str]", 0.17341066117296092], ["list", 0.09397528892181072], ["sqlalchemy.Table", 0.09290217162941428]], "dagbag": [["str", 0.5026807044980119], ["List[str]", 0.0966422166184901], ["list", 0.09538661400160066]], "executor": [["str", 0.3797070258278932], ["list", 0.32993994296153856], ["Dict[int, Dict[str, Any]]", 0.09028679469394035]], "expected_failure_callback_requests": [], "job_id": [["int", 0.30281774381282267], ["Set[int]", 0.2057589423312317], ["str", 0.10914591329335904], ["Optional[str]", 0.09977424276279748]], "job_runner": [["Dict[str, Dict[str, str]]", 0.3504442058993599], ["Dict[Tuple[str, str], float]", 0.09787558721746727], ["Dict[Tuple[Any, Any], Any]", 0.09329523424504117], ["Dict[int, int]", 0.09078845316495282], ["Dict[Tuple[str, int], Dict[Any, Any]]", 0.09002545157520937], ["Dict[str, int]", 0.08935010783940378], ["Dict[Type[Any], int]", 0.08700999130504251]], "local_job": [["list", 0.16989559556271217], ["Dict[str, Any]", 0.1681921193219836], ["alerta.models.alerAlert", 0.08809233288901037], ["List[Dict[str, Any]]", 0.08607930831903947], ["float", 0.07726176711453847]], "scheduler_job": [["Dict[str, List[str]]", 0.2866423692826576], ["cincoconfig.config.Schema", 0.08246538960069358], ["raiden.utils.Any", 0.07557206833854697]], "state": [["Optional[str]", 0.47768560770798596], ["str", 0.18749491123039114], ["list", 0.08699157605803531], ["Optional[hpaction.models.UploadToken]", 0.08264037078918597]], "task": [["kippo.tasks.models.KippoTask", 0.20149459364010128], ["taskiapplication.models.task.Task", 0.0916785630307061]], "ti": [["str", 0.5131183429516346], ["Dict[int, str]", 0.10834649182796124], ["raiden.utils.PaymentID", 0.09186461338434161]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[4694, 4], [4722, 40]], "fn_var_ln": {"active_dag_count": [[4721, 12], [4721, 28]], "dag": [[4705, 12], [4705, 15]], "dagbag": [[4695, 8], [4695, 14]], "dm": [[4699, 12], [4699, 14]], "job_runner": [[4711, 12], [4711, 27]], "last_parsed_time": [[4701, 12], [4701, 31]], "scheduler_job": [[4710, 12], [4710, 25]]}, "fn_var_occur": {"active_dag_count": [["active_dag_count", "session", "query", "func", "count", "DagModel", "dag_id", "filter", "DagModel", "is_active", "scalar"], ["active_dag_count", "session", "query", "func", "count", "DagModel", "dag_id", "filter", "DagModel", "is_active", "scalar"]], "dag": [["dag", "dagbag", "get_dag"], ["dag", "sync_to_db"], ["dag", "dagbag", "get_dag"], ["dag", "sync_to_db"]], "dagbag": [["dagbag", "DagBag", "TEST_DAG_FOLDER", "read_dags_from_db", "False"], ["dag", "dagbag", "get_dag"], ["dag", "dagbag", "get_dag"]], "dm": [["dm", "DagModel", "get_current"], ["dm", "last_parsed_time", "timezone", "utcnow", "timedelta", "minutes"], ["session", "merge", "dm"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_cleanup_stale_dags", "session"]], "last_parsed_time": [["dm", "last_parsed_time", "timezone", "utcnow", "timedelta", "minutes"]], "scheduler_job": [["scheduler_job", "Job", "executor", "MockExecutor"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]]}, "name": "test_cleanup_stale_dags", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["self", "job_runner", "_cleanup_stale_dags", "session"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_cleanup_stale_dags", "ret_exprs": [], "ret_type": "", "variables": {"active_dag_count": "", "dag": "", "dagbag": "", "dm": "", "job_runner": "", "last_parsed_time": "", "scheduler_job": ""}, "variables_p": {"active_dag_count": [["grpy.core.models.Grouping", 0.6123384727580109], ["dict", 0.12738520296772676], ["golem.rpc.session.Publisher", 0.09495152901004675]], "dag": [], "dagbag": [["PY_AWS.chalice.tests.unideploy.test_deployer.LeafResource", 0.43429130935762156]], "dm": [["decksite.data.models.person.Person", 0.1623433329933801], ["Dict[str, Dict[str, Any]]", 0.10434739530412997], ["str", 0.09143518242968346], ["lms.lmsdb.models.Solution", 0.09057489009146998], ["ajapaik.ajapaik.models.Album", 0.08227984950079523]], "job_runner": [["Dict[str, Dict[str, str]]", 0.3504442058993599], ["Dict[Tuple[str, str], float]", 0.09787558721746727], ["Dict[Tuple[Any, Any], Any]", 0.09329523424504117], ["Dict[int, int]", 0.09078845316495282], ["Dict[Tuple[str, int], Dict[Any, Any]]", 0.09002545157520937], ["Dict[str, int]", 0.08935010783940378], ["Dict[Type[Any], int]", 0.08700999130504251]], "last_parsed_time": [["dict", 0.8149312961224391], ["List[datetime.date]", 0.055183968085235485], ["list", 0.044969642251596824], ["datetime.date", 0.044155314837332434], ["datetime.datetime", 0.040759778703396164]], "scheduler_job": [["Dict[str, Union[Any, Any, str]]", 0.08949021136620434]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[4741, 12], [4744, 26]], "fn_var_ln": {"ret": [[4742, 16], [4742, 19]]}, "fn_var_occur": {"ret": [["ret", "orig", "args", "kwargs"], ["result", "append", "ret"]]}, "name": "spy", "params": {"args": "", "kwargs": ""}, "params_descr": {"args": "", "kwargs": ""}, "params_occur": {"args": [["ret", "orig", "args", "kwargs"]], "kwargs": [["ret", "orig", "args", "kwargs"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.run_scheduler_until_dagrun_terminal.<locals>.spy_on_return.<locals>.spy", "ret_exprs": ["return ret"], "ret_type": "", "ret_type_p": [["bool", 0.2395657390539261], ["List[str]", 0.23338568586490194], ["Set[str]", 0.16051642331466923], ["Dict[str, Any]", 0.08608815791117343], ["str", 0.08416976611412513]], "variables": {"ret": ""}, "variables_p": {"ret": [["str", 0.3181169245578904], ["List[Tuple[str, ...]]", 0.2968076413436007], ["Dict[str, List[str]]", 0.10704657820272574], ["Generator[str, None, None]", 0.09276217990790248], ["List[str]", 0.09250982193818501]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[4740, 8], [4746, 22]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "spy_on_return", "params": {"orig": "", "result": ""}, "params_descr": {"orig": "", "result": ""}, "params_occur": {"orig": [], "result": []}, "params_p": {"args": [], "kwargs": [], "orig": [["List[dict]", 0.22339666765237498], ["travelfootprininsta.types.FeedItem", 0.12738660779506136], ["Exception", 0.10720878452488806], ["List[cmk.gui.plugins.visuals.utils.Filter]", 0.07981069167128524], ["Dict[str, str]", 0.0789130595888921], ["Iterable[str]", 0.0789130595888921]], "result": [["List[dict]", 0.22339666765237498], ["travelfootprininsta.types.FeedItem", 0.12738660779506136], ["Exception", 0.10720878452488806], ["List[cmk.gui.plugins.visuals.utils.Filter]", 0.07981069167128524], ["Dict[str, str]", 0.0789130595888921], ["Iterable[str]", 0.0789130595888921]], "self": []}, "q_name": "TestSchedulerJob.run_scheduler_until_dagrun_terminal.<locals>.spy_on_return", "ret_exprs": ["return spy"], "ret_type": "", "ret_type_p": [["int", 0.6008123029409831], ["Optional[str]", 0.20027076764699436], ["str", 0.19891692941202266]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[4764, 8], [4768, 49]], "fn_var_ln": {"num_runs": [[4767, 16], [4767, 35]]}, "fn_var_occur": {"num_runs": [["job_runner", "num_runs"]]}, "name": "watch_set_state", "params": {"kwargs": "", "self": "airflow.models.dagrun.DagRun", "state": ""}, "params_descr": {"kwargs": "", "self": "", "state": ""}, "params_occur": {"kwargs": [["orig_set_state", "self", "state", "kwargs"]], "self": [["orig_set_state", "self", "state", "kwargs"]], "state": [["state", "DagRunState", "SUCCESS", "DagRunState", "FAILED"], ["orig_set_state", "self", "state", "kwargs"]]}, "params_p": {"args": [], "kwargs": [], "self": [], "state": [["float", 0.20009066248047], ["Tuple[int]", 0.1198053760633873]]}, "q_name": "TestSchedulerJob.run_scheduler_until_dagrun_terminal.<locals>.watch_set_state", "ret_exprs": [], "ret_type": "", "variables": {"num_runs": ""}, "variables_p": {"num_runs": [["int", 1.0]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[4770, 8], [4777, 72]], "fn_var_ln": {"finished_any_events": [[4774, 12], [4774, 31]], "queued_any_tis": [[4773, 12], [4773, 26]]}, "fn_var_occur": {"finished_any_events": [["finished_any_events", "any", "val", "val", "num_finished_events"], ["queued_any_tis", "finished_any_events"]], "queued_any_tis": [["queued_any_tis", "any", "val", "val", "num_queued_tis"], ["queued_any_tis", "finished_any_events"]]}, "name": "watch_heartbeat", "params": {"args": "", "kwargs": ""}, "params_descr": {"args": "", "kwargs": ""}, "params_occur": {"args": [], "kwargs": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.run_scheduler_until_dagrun_terminal.<locals>.watch_heartbeat", "ret_exprs": ["return"], "ret_type": "", "ret_type_p": [["Union[tuple, list]", 0.12326783261663934], ["List[int]", 0.09124591253820835], ["Dict[str, Any]", 0.08769568774684897], ["str", 0.08682447752895113]], "variables": {"finished_any_events": "", "queued_any_tis": ""}, "variables_p": {"finished_any_events": [["str", 0.2700802717808073], ["int", 0.1809988431269059], ["bool", 0.11781292031575509], ["list", 0.10709760513786948], ["deeplearning.ml4pl.models.checkpoints.CheckpointReference", 0.09716844245700815]], "queued_any_tis": [["int", 0.5828793426982006], ["List[int]", 0.08848974682122637], ["Tuple[Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal]", 0.08678576386688816], ["str", 0.08109574021640992], ["Type[tuple]", 0.07965366618086514]]}}, {"docstring": {"func": "Run a scheduler until any dag run reaches a terminal state, or the scheduler becomes \"idle\".", "long_descr": "This needs a DagRun to be pre-created (it can be in running or queued state) as no more will be\ncreated as we turn off creating new DagRuns via setting USE_JOB_SCHEDULE to false\n\nNote: This doesn't currently account for tasks that go into retry -- the scheduler would be detected\nas idle in that circumstance", "ret": null}, "fn_lc": [[4725, 4], [4783, 73]], "fn_var_ln": {"do_scheduling_spy": [[4751, 8], [4751, 25]], "executor_events_spy": [[4756, 8], [4756, 27]], "heartbeat_spy": [[4780, 8], [4780, 21]], "num_finished_events": [[4749, 8], [4749, 27]], "num_queued_tis": [[4748, 8], [4748, 22]], "orig_set_state": [[4762, 8], [4762, 22]], "set_state_spy": [[4779, 8], [4779, 21]]}, "fn_var_occur": {"do_scheduling_spy": [], "executor_events_spy": [], "heartbeat_spy": [["heartbeat_spy", "mock", "patch", "object", "job_runner", "new", "watch_heartbeat"]], "num_finished_events": [], "num_queued_tis": [], "orig_set_state": [], "set_state_spy": [["set_state_spy", "mock", "patch", "object", "DagRun", "new", "watch_set_state"]]}, "name": "run_scheduler_until_dagrun_terminal", "params": {"job_runner": "airflow.jobs.scheduler_job_runner.SchedulerJobRunner", "self": ""}, "params_descr": {"job_runner": "", "self": ""}, "params_occur": {"job_runner": [["heartbeat_spy", "mock", "patch", "object", "job_runner", "new", "watch_heartbeat"], ["run_job", "job_runner", "job", "execute_callable", "job_runner", "_execute"]], "self": []}, "params_p": {"args": [], "job_runner": [["src.core.manager.script_manager.ScriptManager", 0.2557589195864974], ["rouver.types.WSGIEnvironment", 0.126988743924317], ["bytes", 0.126988743924317]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.run_scheduler_until_dagrun_terminal", "ret_exprs": [], "ret_type": "", "variables": {"do_scheduling_spy": "", "executor_events_spy": "", "heartbeat_spy": "", "num_finished_events": "collections.deque[builtins.int]", "num_queued_tis": "collections.deque[builtins.int]", "orig_set_state": "", "set_state_spy": ""}, "variables_p": {"do_scheduling_spy": [["bool", 0.49999999999999994], ["int", 0.3], ["str", 0.19999999999999998]], "executor_events_spy": [["cmk.gui.plugins.openapi.livestatus_helpers.types.Column", 0.19999999999999998], ["dict", 0.09999999999999999], ["str", 0.09999999999999999], ["bool", 0.09999999999999999]], "heartbeat_spy": [["unittesmock.MagicMock", 0.16966830422541126], ["List[int]", 0.16307782646655905], ["str", 0.09833621313850882], ["mock.MagicMock", 0.07482250290237723], ["int", 0.05868973909633094], ["list", 0.05868973909633094]], "num_finished_events": [["str", 0.42555588605846195], ["Optional[str]", 0.24158445249083774], ["float", 0.0880844365023555], ["int", 0.08256720303791405], ["bool", 0.08252707068377596], ["ClassVar[bool]", 0.07968095122665492]], "num_queued_tis": [["int", 0.8999999999999999], ["List[int]", 0.1]], "orig_set_state": [["str", 0.9250942875250522], ["Final", 0.07490571247494783]], "set_state_spy": [["list", 0.5389359625593463], ["Dict[str, Any]", 0.09786920220946425], ["mock.Mock", 0.09248119027305325], ["Tuple[int, int]", 0.09113299126392714], ["mock._Call", 0.08970084960691324]]}}, {"docstring": {"func": "End-to-end test of a simple mapped dag", "long_descr": null, "ret": null}, "fn_lc": [[4787, 4], [4810, 46]], "fn_var_ln": {"dag": [[4793, 8], [4793, 11]], "dr": [[4795, 8], [4795, 10]], "executor": [[4803, 8], [4803, 16]], "job": [[4805, 8], [4805, 11]], "job_runner": [[4806, 8], [4806, 23]]}, "fn_var_occur": {"dag": [["dag", "self", "dagbag", "get_dag", "dag_id"], ["dr", "dag", "create_dagrun", "run_type", "DagRunType", "MANUAL", "start_date", "timezone", "utcnow", "state", "State", "RUNNING", "execution_date", "timezone", "utcnow", "datetime", "timedelta", "days", "session", "session"], ["self", "job_runner", "SchedulerJobRunner", "job", "job", "subdir", "dag", "fileloc"]], "dr": [["dr", "dag", "create_dagrun", "run_type", "DagRunType", "MANUAL", "start_date", "timezone", "utcnow", "state", "State", "RUNNING", "execution_date", "timezone", "utcnow", "datetime", "timedelta", "days", "session", "session"], ["dr", "refresh_from_db", "session"], ["dr", "state", "DagRunState", "SUCCESS"]], "executor": [["executor", "SequentialExecutor"], ["job", "Job", "executor", "executor"]], "job": [["job", "Job", "executor", "executor"], ["self", "job_runner", "SchedulerJobRunner", "job", "job", "subdir", "dag", "fileloc"], ["self", "run_scheduler_until_dagrun_terminal", "job"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "job", "subdir", "dag", "fileloc"]]}, "name": "test_mapped_dag", "params": {"dag_id": "", "self": "", "session": ""}, "params_descr": {"dag_id": "", "self": "", "session": ""}, "params_occur": {"dag_id": [["self", "dagbag", "process_file", "str", "TEST_DAGS_FOLDER", "dag_id"], ["dag", "self", "dagbag", "get_dag", "dag_id"]], "self": [["self", "dagbag", "process_file", "str", "TEST_DAGS_FOLDER", "dag_id"], ["dag", "self", "dagbag", "get_dag", "dag_id"], ["self", "job_runner", "SchedulerJobRunner", "job", "job", "subdir", "dag", "fileloc"], ["self", "run_scheduler_until_dagrun_terminal", "job"]], "session": [["dr", "dag", "create_dagrun", "run_type", "DagRunType", "MANUAL", "start_date", "timezone", "utcnow", "state", "State", "RUNNING", "execution_date", "timezone", "utcnow", "datetime", "timedelta", "days", "session", "session"], ["dr", "refresh_from_db", "session"]]}, "params_p": {"args": [], "dag_id": [["str", 0.2367848603324131], ["int", 0.10129687985003474], ["Dict[str, str]", 0.08962965653255059]], "kwargs": [], "self": [], "session": [["str", 0.40649726158591726], ["Optional[str]", 0.10485897181464196], ["int", 0.10339172348825383], ["Callable[[], None]", 0.09535459479405685]]}, "q_name": "TestSchedulerJob.test_mapped_dag", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dr": "", "executor": "", "job": "", "job_runner": ""}, "variables_p": {"dag": [["str", 0.3067273053123622], ["int", 0.19383001210977094], ["Dict[str, Any]", 0.10355445104375886], ["Pattern[str]", 0.09509179686781001]], "dr": [["str", 0.3264730303322253], ["int", 0.19612699447457266], ["Optional[hpaction.models.HPActionDocuments]", 0.10938979738376213], ["Union[Literal, Literal]", 0.1063560050170481], ["Dict[str, Union[int, str]]", 0.09107061102455852], ["Dict[str, str]", 0.08544082458597901], ["list", 0.08514273718185439]], "executor": [["dict", 0.1295458810440194], ["str", 0.0929808479062989], ["Dict[str, Union[Any, Any, Any, str]]", 0.0926185820673981], ["meeshkan.core.job.jobs.SageMakerJob", 0.08924384288282367]], "job": [["str", 0.20998546561135994], ["Dict[str, Union[Any, Any, Any, Any, Any, Any, str]]", 0.1086764391297732], ["Dict[str, Tuple[str, str]]", 0.08621912453247232], ["Dict[str, str]", 0.08471063025743711]], "job_runner": [["dict", 0.3116897324810451], ["Mapping[Any, Any]", 0.12060917025896153], ["Dict[str, Any]", 0.09576425346081681], ["OrderedDict", 0.08979442160686114]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[4812, 4], [4887, 39]], "fn_var_ln": {"dag": [[4825, 8], [4825, 11]], "dag_file": [[4813, 8], [4813, 16]], "dagbag": [[4818, 8], [4818, 14]], "dags": [[4841, 8], [4841, 12]], "dr": [[4834, 8], [4834, 10]], "drs": [[4832, 8], [4832, 11]], "job_runner": [[4822, 8], [4822, 23]], "orm_dag": [[4829, 8], [4829, 15]], "scheduler_job": [[4821, 8], [4821, 21]], "session": [[4828, 8], [4828, 15]], "tis": [[4866, 12], [4866, 15]]}, "fn_var_occur": {"dag": [["dag", "self", "job_runner", "dagbag", "get_dag"], ["orm_dag", "session", "get", "DagModel", "dag", "dag_id"], ["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["dag", "dag_id", "dag", "dags"]], "dag_file": [["dag_file", "os", "path", "join", "os", "path", "dirname", "os", "path", "realpath", "__file__"], ["dagbag", "DagBag", "dag_folder", "dag_file", "include_examples", "False", "read_dags_from_db", "False"]], "dagbag": [["dagbag", "DagBag", "dag_folder", "dag_file", "include_examples", "False", "read_dags_from_db", "False"], ["dagbag", "sync_to_db"], ["dag", "self", "job_runner", "dagbag", "get_dag"], ["dags", "self", "job_runner", "dagbag", "dags", "values"]], "dags": [["dags", "self", "job_runner", "dagbag", "dags", "values"], ["dag", "dag_id", "dag", "dags"]], "dr": [["dr", "drs"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "drs": [["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["len", "drs"], ["dr", "drs"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["dag", "self", "job_runner", "dagbag", "get_dag"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["dags", "self", "job_runner", "dagbag", "dags", "values"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "orm_dag": [["orm_dag", "session", "get", "DagModel", "dag", "dag_id"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "session": [["session", "settings", "Session"], ["orm_dag", "session", "get", "DagModel", "dag", "dag_id"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["drs", "DagRun", "find", "dag_id", "dag", "dag_id", "session", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["create_session", "session"], ["tis", "session", "query", "TaskInstance", "all"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["create_session", "session"], ["tis", "session", "query", "TaskInstance", "all"]], "tis": [["tis", "session", "query", "TaskInstance", "all"], ["len", "tis"], ["None", "ti", "task_id", "ti", "state", "ti", "tis"], ["ti", "state", "ti", "start_date", "ti", "end_date", "ti", "duration", "ti", "tis"], ["tis", "session", "query", "TaskInstance", "all"], ["len", "tis"], ["ti", "task_id", "ti", "state", "ti", "tis"], ["ti", "state", "ti", "start_date", "ti", "end_date", "ti", "duration", "ti", "tis"]]}, "name": "test_should_mark_empty_task_as_success", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock"], ["dag", "self", "job_runner", "dagbag", "get_dag"], ["self", "job_runner", "_create_dag_runs", "orm_dag", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["dags", "self", "job_runner", "dagbag", "dags", "values"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_should_mark_empty_task_as_success", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_file": "", "dagbag": "", "dags": "", "dr": "", "drs": "", "job_runner": "", "orm_dag": "", "scheduler_job": "", "session": "", "tis": ""}, "variables_p": {"dag": [["Dict[str, Any]", 0.1188979300726312], ["str", 0.09185496604181169]], "dag_file": [["str", 0.7720682348981874], ["List[str]", 0.13860073793967445], ["list", 0.089331027162138]], "dagbag": [["str", 0.4708678978534015]], "dags": [["int", 0.3086058326249587], ["str", 0.273361240203586], ["Dict[int, Any]", 0.25742527179469205]], "dr": [["Dict[str, str]", 0.8703008052079635], ["List[Tuple[str, str, str]]", 0.12969919479203634]], "drs": [["str", 0.20433591560014966], ["int", 0.1918793717997031], ["List[Dict[str, Any]]", 0.1180607231227876], ["datetime.datetime.datetime", 0.09511633429537675], ["Type[manager.projects.models.snapshots.Snapshot]", 0.09366430555487672]], "job_runner": [["Dict[str, Dict[str, str]]", 0.2982621980036016], ["Dict[Any, List[Any]]", 0.10133528363781372], ["Dict[int, str]", 0.09687766731087497], ["Dict[Any, Type[Any]]", 0.09634216618485274], ["Dict[Any, Optional[Any]]", 0.09634216618485274]], "orm_dag": [["int", 0.30130998917332014], ["list", 0.17312161992100503], ["str", 0.0972545386320458], ["List[Dict[str, str]]", 0.09109210181326534]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]], "session": [["Dict[str, Any]", 0.15262218010585668], ["dict", 0.07631109005292834], ["Dict[str, str]", 0.07325989024916654]], "tis": [["list", 0.12199943970986189], ["List[str]", 0.12078544821132095], ["Type[Tuple[str, Any]]", 0.11176896361188167], ["abilian.core.models.subjects.User", 0.09985749442724053], ["int", 0.08819111484002735], ["Optional[float]", 0.08296597559897093]]}}, {"docstring": {"func": "Test that catchup works correctly", "long_descr": null, "ret": null}, "fn_lc": [[4890, 4], [4938, 51]], "fn_var_ln": {"catchup": [[4925, 8], [4925, 19]], "dm": [[4929, 8], [4929, 10]], "dr": [[4912, 8], [4912, 10]], "executor": [[4906, 8], [4906, 30]], "job_runner": [[4904, 8], [4904, 23]], "scheduler_job": [[4903, 8], [4903, 21]], "session": [[4892, 8], [4892, 15]], "state": [[4914, 8], [4914, 16]], "ti": [[4913, 8], [4913, 10]]}, "fn_var_occur": {"catchup": [["dag_maker", "dag_id", "schedule", "timedelta", "days", "start_date", "DEFAULT_DATE", "catchup", "True", "max_active_runs", "session", "session", "dag"], ["dag", "catchup", "False"], ["dag", "catchup"]], "dm": [["dm", "DagModel", "get_dagmodel", "dag", "dag_id"], ["self", "job_runner", "_create_dag_runs", "dm", "session"]], "dr": [["dr", "DagRun", "find", "execution_date", "DEFAULT_DATE", "session", "session"], ["ti", "dr", "get_task_instance", "task_id"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"]], "executor": [["scheduler_job", "executor", "MockExecutor"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_create_dag_runs", "dag_maker", "dag_model", "session"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "_create_dag_runs", "dm", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor"]], "session": [["session", "settings", "Session"], ["dag_maker", "dag_id", "schedule", "timedelta", "days", "start_date", "DEFAULT_DATE", "catchup", "True", "max_active_runs", "session", "session", "dag"], ["self", "job_runner", "_create_dag_runs", "dag_maker", "dag_model", "session"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["dr", "DagRun", "find", "execution_date", "DEFAULT_DATE", "session", "session"], ["session", "merge", "ti"], ["session", "flush"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["session", "flush"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["session", "flush"], ["self", "job_runner", "_create_dag_runs", "dm", "session"], ["session", "query", "DagRun", "execution_date", "filter", "DagRun", "execution_date", "DEFAULT_DATE", "scalar", "timezone", "utcnow", "timedelta", "days"]], "state": [["ti", "state", "State", "SUCCESS"]], "ti": [["ti", "dr", "get_task_instance", "task_id"], ["ti", "state", "State", "SUCCESS"], ["session", "merge", "ti"]]}, "name": "test_catchup_works_correctly", "params": {"dag_maker": "", "self": ""}, "params_descr": {"dag_maker": "", "self": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "schedule", "timedelta", "days", "start_date", "DEFAULT_DATE", "catchup", "True", "max_active_runs", "session", "session", "dag"], ["self", "job_runner", "_create_dag_runs", "dag_maker", "dag_model", "session"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "processor_agent", "mock", "MagicMock", "spec", "DagFileProcessorAgent"], ["self", "job_runner", "_create_dag_runs", "dag_maker", "dag_model", "session"], ["self", "job_runner", "_start_queued_dagruns", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "_schedule_dag_run", "dr", "session"], ["self", "job_runner", "_create_dag_runs", "dm", "session"]]}, "params_p": {"args": [], "dag_maker": [["zerver.models.Realm", 0.20751071738015323], ["List[str]", 0.1008659016354972]], "kwargs": [], "self": []}, "q_name": "TestSchedulerJob.test_catchup_works_correctly", "ret_exprs": [], "ret_type": "", "variables": {"catchup": "", "dm": "", "dr": "", "executor": "", "job_runner": "", "scheduler_job": "", "session": "", "state": "", "ti": ""}, "variables_p": {"catchup": [["str", 0.20960387363493624], ["Tuple[int]", 0.09790765208425078], ["raiden.utils.SecretHash", 0.09328543013514991]], "dm": [["dict", 0.3911790060858199], ["str", 0.09177523107108712]], "dr": [["jinete.models.services.Service", 0.47165197674769854], ["byceps.services.email.transfer.models.Message", 0.12961365181863554]], "executor": [["unittesmock.MagicMock", 0.49999999995400857], ["list", 2.1664709224561442e-11], ["List[str]", 8.116995576045707e-12], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 8.007660674688464e-12]], "job_runner": [["Dict[int, unittesmock.MagicMock]", 0.30329157117213373], ["Dict[str, dict]", 0.28424197978021976], ["Dict[str, Union[Any, str]]", 0.24656529010642908], ["Dict[Any, Tuple[Any, Any]]", 0.08678261286278287]], "scheduler_job": [["Dict[str, List[str]]", 0.2866423692826576], ["cincoconfig.config.Schema", 0.08246538960069358], ["raiden.utils.Any", 0.07557206833854697]], "session": [["grpy.core.models.User", 0.14074230757689482], ["Optional[raiden.transfer.state.NettingChannelState]", 0.12689365341371772], ["datetime.datetime.datetime", 0.09916268007750909], ["Optional[zam_repondeur.models.User]", 0.09803147608521258]], "state": [["str", 0.7999999999999999], ["Dict[str, str]", 0.1]], "ti": [["zerver.models.Realm", 0.1226341553009481], ["List[unittesmock.MagicMock]", 0.09666875312438553], ["str", 0.09301970387262129], ["list", 0.08686421118550333], ["geode.models.common.Address", 0.08240797010071305]]}}, {"docstring": {"func": "Test that _update_dagrun_state_for_paused_dag puts DagRuns in terminal states", "long_descr": null, "ret": null}, "fn_lc": [[4940, 4], [4984, 51]], "fn_var_ln": {"dm": [[4953, 8], [4953, 10]], "executor": [[4964, 8], [4964, 30]], "is_paused": [[4954, 8], [4954, 20]], "job_runner": [[4962, 8], [4962, 23]], "last_scheduling_decision": [[4950, 8], [4950, 46]], "prior_last_scheduling_decision": [[4971, 8], [4971, 38]], "scheduled_run": [[4983, 9], [4983, 22]], "scheduler_job": [[4961, 8], [4961, 21]], "ti": [[4951, 8], [4951, 10]]}, "fn_var_occur": {"dm": [["dm", "DagModel", "get_dagmodel", "dag", "dag_id"], ["dm", "is_paused", "True"], ["session", "merge", "dm"]], "executor": [["scheduler_job", "executor", "MockExecutor"]], "is_paused": [["dm", "is_paused", "True"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_update_dag_run_state_for_paused_dags", "session", "session"], ["self", "job_runner", "_update_dag_run_state_for_paused_dags", "session", "session"], ["self", "job_runner", "_update_dag_run_state_for_paused_dags", "session", "session"]], "last_scheduling_decision": [["scheduled_run", "last_scheduling_decision", "datetime", "datetime", "now", "timezone", "utc", "timedelta", "minutes"], ["prior_last_scheduling_decision", "scheduled_run", "last_scheduling_decision"], ["prior_last_scheduling_decision", "scheduled_run", "last_scheduling_decision"]], "prior_last_scheduling_decision": [["prior_last_scheduling_decision", "scheduled_run", "last_scheduling_decision"], ["prior_last_scheduling_decision", "scheduled_run", "last_scheduling_decision"]], "scheduled_run": [["scheduled_run", "dag_maker", "create_dagrun", "execution_date", "datetime", "datetime", "run_type", "DagRunType", "SCHEDULED"], ["scheduled_run", "last_scheduling_decision", "datetime", "datetime", "now", "timezone", "utc", "timedelta", "minutes"], ["ti", "scheduled_run", "get_task_instances"], ["scheduled_run", "state", "State", "RUNNING"], ["scheduled_run", "DagRun", "find", "dag_id", "dag", "dag_id", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["scheduled_run", "state", "State", "RUNNING"], ["prior_last_scheduling_decision", "scheduled_run", "last_scheduling_decision"], ["scheduled_run", "DagRun", "find", "dag_id", "dag", "dag_id", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["scheduled_run", "state", "State", "RUNNING"], ["prior_last_scheduling_decision", "scheduled_run", "last_scheduling_decision"], ["scheduled_run", "DagRun", "find", "dag_id", "dag", "dag_id", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["scheduled_run", "state", "State", "SUCCESS"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor"]], "ti": [["ti", "scheduled_run", "get_task_instances"], ["ti", "set_state", "TaskInstanceState", "RUNNING"], ["session", "merge", "ti"], ["ti", "set_state", "TaskInstanceState", "SUCCESS"]]}, "name": "test_update_dagrun_state_for_paused_dag", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag"], ["scheduled_run", "dag_maker", "create_dagrun", "execution_date", "datetime", "datetime", "run_type", "DagRunType", "SCHEDULED"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_update_dag_run_state_for_paused_dags", "session", "session"], ["self", "job_runner", "_update_dag_run_state_for_paused_dags", "session", "session"], ["self", "job_runner", "_update_dag_run_state_for_paused_dags", "session", "session"]], "session": [["session", "merge", "dm"], ["session", "merge", "ti"], ["session", "flush"], ["self", "job_runner", "_update_dag_run_state_for_paused_dags", "session", "session"], ["session", "flush"], ["scheduled_run", "DagRun", "find", "dag_id", "dag", "dag_id", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["self", "job_runner", "_update_dag_run_state_for_paused_dags", "session", "session"], ["scheduled_run", "DagRun", "find", "dag_id", "dag", "dag_id", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["self", "job_runner", "_update_dag_run_state_for_paused_dags", "session", "session"], ["scheduled_run", "DagRun", "find", "dag_id", "dag", "dag_id", "run_type", "DagRunType", "SCHEDULED", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.10558289036350055], ["Callable", 0.10404802089728114], ["int", 0.10326350684090362], ["float", 0.09622503925520635], ["zerver.models.Recipient", 0.09206594520461255], ["models.Payment", 0.09126194551951089]], "kwargs": [], "self": [], "session": [["sqlalchemy.orm.Session", 0.21938850685855268], ["tnadmin.models.GvOrganisation", 0.13146679901415562], ["Iterator[Tuple[hermes.types.UserType, hermes.types.EmailAddressType]]", 0.09781951375083957], ["core.models.User", 0.08878639139037374], ["str", 0.08823280573906303], ["django.conf.settings.AUTH_USER_MODEL", 0.08557369109024478]]}, "q_name": "TestSchedulerJob.test_update_dagrun_state_for_paused_dag", "ret_exprs": [], "ret_type": "", "variables": {"dm": "", "executor": "", "is_paused": "", "job_runner": "", "last_scheduling_decision": "", "prior_last_scheduling_decision": "", "scheduled_run": "", "scheduler_job": "", "ti": ""}, "variables_p": {"dm": [["str", 0.39621986761658096], ["Dict[str, Callable]", 0.12626402346025367], ["dict", 0.09545984181044521], ["Dict[str, str]", 0.08937834707014092], ["decksite.data.models.person.Person", 0.08348022262063076]], "executor": [["unittesmock.MagicMock", 0.49999999995400857], ["list", 2.1664709224561442e-11], ["List[str]", 8.116995576045707e-12], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 8.007660674688464e-12]], "is_paused": [["bool", 1.0000000000000002]], "job_runner": [["Dict[str, Dict[str, str]]", 0.1216791991270129], ["Dict[str, Union[None, Any, str]]", 0.10188678506502317], ["dict", 0.09974578103636508], ["Dict[str, Any]", 0.09707933965071423], ["str", 0.09445726780147333]], "last_scheduling_decision": [["datetime.datetime", 0.7268648584324631], ["datetime.datetime.datetime", 0.17165683008033616], ["datetime.date", 0.10147831148720082]], "prior_last_scheduling_decision": [["Optional[Match[str]]", 0.31814328056216085], ["Pattern[str]", 0.2854498218223706], ["str", 0.1206116839846012], ["Tuple[Literal]", 0.09876413221741132]], "scheduled_run": [["int", 0.2937050337565835], ["datetime.date", 0.208410354167972], ["str", 0.18687954355003444], ["Dict[str, List[str]]", 0.11581049426133715], ["Union[Literal, Literal]", 0.09597663480161216]], "scheduler_job": [["Dict[str, List[str]]", 0.2866423692826576], ["cincoconfig.config.Schema", 0.08246538960069358], ["raiden.utils.Any", 0.07557206833854697]], "ti": [["Dict[str, Union[Any, Any]]", 0.09180347429189291]]}}, {"docstring": {"func": "Test that the _update_dagrun_state_for_paused_dag does not affect backfilled dagruns", "long_descr": null, "ret": null}, "fn_lc": [[4986, 4], [5013, 50]], "fn_var_ln": {"backfill_run": [[5012, 9], [5012, 21]], "dm": [[4997, 8], [4997, 10]], "executor": [[5008, 8], [5008, 30]], "is_paused": [[4998, 8], [4998, 20]], "job_runner": [[5006, 8], [5006, 23]], "last_scheduling_decision": [[4994, 8], [4994, 45]], "scheduler_job": [[5005, 8], [5005, 21]], "ti": [[4995, 8], [4995, 10]]}, "fn_var_occur": {"backfill_run": [["backfill_run", "dag_maker", "create_dagrun", "run_type", "DagRunType", "BACKFILL_JOB"], ["backfill_run", "last_scheduling_decision", "datetime", "datetime", "now", "timezone", "utc", "timedelta", "minutes"], ["ti", "backfill_run", "get_task_instances"], ["backfill_run", "state", "State", "RUNNING"], ["backfill_run", "DagRun", "find", "dag_id", "dag", "dag_id", "run_type", "DagRunType", "BACKFILL_JOB", "session", "session"], ["backfill_run", "state", "State", "RUNNING"]], "dm": [["dm", "DagModel", "get_dagmodel", "dag", "dag_id"], ["dm", "is_paused", "True"], ["session", "merge", "dm"]], "executor": [["scheduler_job", "executor", "MockExecutor"]], "is_paused": [["dm", "is_paused", "True"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_update_dag_run_state_for_paused_dags"]], "last_scheduling_decision": [["backfill_run", "last_scheduling_decision", "datetime", "datetime", "now", "timezone", "utc", "timedelta", "minutes"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["scheduler_job", "executor", "MockExecutor"]], "ti": [["ti", "backfill_run", "get_task_instances"], ["ti", "set_state", "TaskInstanceState", "SUCCESS"], ["session", "merge", "ti"]]}, "name": "test_update_dagrun_state_for_paused_dag_not_for_backfill", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag"], ["backfill_run", "dag_maker", "create_dagrun", "run_type", "DagRunType", "BACKFILL_JOB"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_update_dag_run_state_for_paused_dags"]], "session": [["session", "merge", "dm"], ["session", "merge", "ti"], ["session", "flush"], ["session", "flush"], ["backfill_run", "DagRun", "find", "dag_id", "dag", "dag_id", "run_type", "DagRunType", "BACKFILL_JOB", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["int", 0.2109422538081019], ["Optional[Dict[str, Any]]", 0.09397254271682871], ["str", 0.09397254271682871]], "kwargs": [], "self": [], "session": [["sqlalchemy.orm.Session", 0.33197338462925674], ["models.UserAuth", 0.12007507638249106], ["tnadmin.models.GvOrganisation", 0.09565588487913677], ["zerver.models.UserProfile", 0.09220493189336418], ["Iterator[Tuple[hermes.types.UserType, hermes.types.EmailAddressType]]", 0.09203237502179726], ["dict", 0.0866554482243569]]}, "q_name": "TestSchedulerJob.test_update_dagrun_state_for_paused_dag_not_for_backfill", "ret_exprs": [], "ret_type": "", "variables": {"backfill_run": "", "dm": "", "executor": "", "is_paused": "", "job_runner": "", "last_scheduling_decision": "", "scheduler_job": "", "ti": ""}, "variables_p": {"backfill_run": [["unittesmock.MagicMock", 0.18997845629089394], ["set", 0.11038846211292397], ["utils.tree.Node[utils.test_tree.MyDataType]", 0.10246580123937862], ["List[List[Any]]", 0.10193446644273789], ["int", 0.09144716487397445], ["cnaas_nms.db.device.Device", 0.08965187581910151]], "dm": [["str", 0.39621986761658096], ["Dict[str, Callable]", 0.12626402346025367], ["dict", 0.09545984181044521], ["Dict[str, str]", 0.08937834707014092], ["decksite.data.models.person.Person", 0.08348022262063076]], "executor": [["unittesmock.MagicMock", 0.49999999995400857], ["list", 2.1664709224561442e-11], ["List[str]", 8.116995576045707e-12], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 8.007660674688464e-12]], "is_paused": [["bool", 1.0000000000000002]], "job_runner": [["Dict[str, Dict[str, str]]", 0.1216791991270129], ["Dict[str, Union[None, Any, str]]", 0.10188678506502317], ["dict", 0.09974578103636508], ["Dict[str, Any]", 0.09707933965071423], ["str", 0.09445726780147333]], "last_scheduling_decision": [["datetime.datetime", 0.43199160303946527], ["datetime.datetime.datetime", 0.3076972786495227], ["datetime.datetime.timedelta", 0.26031111831101217]], "scheduler_job": [["Dict[str, List[str]]", 0.2866423692826576], ["cincoconfig.config.Schema", 0.08246538960069358], ["raiden.utils.Any", 0.07557206833854697]], "ti": [["hub2labhook.github.models.evenGithubEvent", 0.28486803267389815], ["Dict[str, Callable]", 0.10419829609286468], ["golem.rpc.session.WebSocketAddress", 0.09204431655124563]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[5015, 4], [5053, 50]], "fn_var_ln": {"dataset1": [[5016, 8], [5016, 16]], "dataset2": [[5017, 8], [5017, 16]], "dataset3": [[5018, 8], [5018, 16]], "dataset4": [[5019, 8], [5019, 16]], "job_runner": [[5034, 8], [5034, 23]], "non_orphaned_dataset_count": [[5024, 8], [5024, 34]], "non_orphaned_datasets": [[5040, 8], [5040, 29]], "orphaned_dataset_count": [[5026, 8], [5026, 30]], "orphaned_datasets": [[5047, 8], [5047, 25]], "scheduler_job": [[5033, 8], [5033, 21]]}, "fn_var_occur": {"dataset1": [["dataset1", "Dataset", "uri"], ["dag_maker", "dag_id", "schedule", "dataset1", "dataset2", "session", "session"], ["dag_maker", "dag_id", "schedule", "dataset1", "session", "session"]], "dataset2": [["dataset2", "Dataset", "uri"], ["dag_maker", "dag_id", "schedule", "dataset1", "dataset2", "session", "session"]], "dataset3": [["dataset3", "Dataset", "uri"], ["BashOperator", "task_id", "bash_command", "outlets", "dataset3", "dataset4"], ["BashOperator", "task_id", "bash_command", "outlets", "dataset3"]], "dataset4": [["dataset4", "Dataset", "uri"], ["BashOperator", "task_id", "bash_command", "outlets", "dataset3", "dataset4"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_orphan_unreferenced_datasets", "session", "session"]], "non_orphaned_dataset_count": [["non_orphaned_dataset_count", "session", "query", "DatasetModel", "filter", "DatasetModel", "is_orphaned", "count"]], "non_orphaned_datasets": [["non_orphaned_datasets", "dataset", "uri", "dataset", "session", "query", "DatasetModel", "uri", "filter", "DatasetModel", "is_orphaned", "order_by", "DatasetModel", "uri"]], "orphaned_dataset_count": [["orphaned_dataset_count", "session", "query", "DatasetModel", "filter", "DatasetModel", "is_orphaned", "count"]], "orphaned_datasets": [["orphaned_datasets", "dataset", "uri", "dataset", "session", "query", "DatasetModel", "uri", "filter", "DatasetModel", "is_orphaned", "order_by", "DatasetModel", "uri"]], "scheduler_job": [["scheduler_job", "Job"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]]}, "name": "test_dataset_orphaning", "params": {"dag_maker": "", "self": "", "session": ""}, "params_descr": {"dag_maker": "", "self": "", "session": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "schedule", "dataset1", "dataset2", "session", "session"], ["dag_maker", "dag_id", "schedule", "dataset1", "session", "session"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["self", "job_runner", "_orphan_unreferenced_datasets", "session", "session"]], "session": [["dag_maker", "dag_id", "schedule", "dataset1", "dataset2", "session", "session"], ["non_orphaned_dataset_count", "session", "query", "DatasetModel", "filter", "DatasetModel", "is_orphaned", "count"], ["orphaned_dataset_count", "session", "query", "DatasetModel", "filter", "DatasetModel", "is_orphaned", "count"], ["dag_maker", "dag_id", "schedule", "dataset1", "session", "session"], ["self", "job_runner", "_orphan_unreferenced_datasets", "session", "session"], ["session", "flush"], ["non_orphaned_datasets", "dataset", "uri", "dataset", "session", "query", "DatasetModel", "uri", "filter", "DatasetModel", "is_orphaned", "order_by", "DatasetModel", "uri"], ["orphaned_datasets", "dataset", "uri", "dataset", "session", "query", "DatasetModel", "uri", "filter", "DatasetModel", "is_orphaned", "order_by", "DatasetModel", "uri"]]}, "params_p": {"args": [], "dag_maker": [["sqlalchemy.orm.Session", 0.20154307136385158], ["sqlalchemy.orm.session.Session", 0.18103853995502367], ["abilian.core.sqlalchemy.SQLAlchemy", 0.09240489716730005], ["datasets.me_db.me_db.Database", 0.08581487306109616]], "kwargs": [], "self": [], "session": [["zerver.models.UserProfile", 0.19141125305662937], ["django.contrib.auth.models.User", 0.1847331079217304], ["str", 0.11442965372362365], ["grouper.models.user.User", 0.11442965372362365], ["Optional[str]", 0.10106268933427227], ["tracim.models.User", 0.0918082635715761]]}, "q_name": "TestSchedulerJob.test_dataset_orphaning", "ret_exprs": [], "ret_type": "", "variables": {"dataset1": "", "dataset2": "", "dataset3": "", "dataset4": "", "job_runner": "", "non_orphaned_dataset_count": "", "non_orphaned_datasets": "", "orphaned_dataset_count": "", "orphaned_datasets": "", "scheduler_job": ""}, "variables_p": {"dataset1": [["grpy.core.models.Grouping", 0.2078235681190634], ["lms.lmsdb.models.Solution", 0.11266274133487283], ["zerver.models.Realm", 0.09622131197440308], ["golem.rpc.session.Publisher", 0.09427213952517378]], "dataset2": [["str", 0.167415775639053], ["Dict[str, str]", 0.10174262956506941], ["dict", 0.09939848728867594]], "dataset3": [["List[int]", 0.12912947659715], ["List[Dict[str, str]]", 0.09720027907692225], ["int", 0.09534184284582758], ["Tuple[int, int, int, int]", 0.09252583026302925]], "dataset4": [["List[int]", 0.21996342676546798], ["str", 0.16361530259355075], ["datetime.datetime.datetime", 0.08213637856302124]], "job_runner": [["dict", 0.5027446253314631], ["Dict[str, Sequence[Any]]", 0.12292515300613222], ["Dict[str, str]", 0.10068097278695386]], "non_orphaned_dataset_count": [["alerta.models.user.User", 0.19749385654054918], ["Optional[grpy.core.models.User]", 0.18282819275381454], ["str", 0.13719560497662983], ["set", 0.10231306424848383], ["Dict[int, str]", 0.09956428897417587], ["List[Dict[str, Any]]", 0.08440911450126481]], "non_orphaned_datasets": [["legistar.models.RollCall", 0.4170025104507237], ["List[raiden.transfer.state.RouteState]", 0.08530820194079022], ["str", 0.0840808642879705], ["List[Optional[str]]", 0.07671396714425038]], "orphaned_dataset_count": [["Optional[str]", 0.3278151913309683], ["Dict[str, Any]", 0.11991302630614797], ["raiden.utils.List[raiden.utils.Address]", 0.1034182110152954], ["list", 0.09480567632483236], ["Dict[int, str]", 0.08596652015330933], ["Dict[str, Union[Any, Any]]", 0.07628538014121727]], "orphaned_datasets": [["Dict[None, None]", 0.12860836145619028], ["str", 0.08254047546541891], ["Dict[str, Any]", 0.08059316533985851]], "scheduler_job": [["list", 0.19570499955325546], ["dict", 0.17252785516624142], ["cincoconfig.config.Schema", 0.11383114927313187], ["List[str]", 0.11317931249425185], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.10617094697387076]]}}], "name": "TestSchedulerJob", "q_name": "TestSchedulerJob", "variables": {}, "variables_p": {}}, {"cls_lc": [[5095, 0], [5268, 61]], "cls_var_ln": {"scheduler_job": [[5102, 4], [5102, 17]]}, "cls_var_occur": {"scheduler_job": []}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[5105, 4], [5112, 34]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "clean_db", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJobQueriesCount.clean_db", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[5115, 4], [5122, 23]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "per_test", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "clean_db"], ["self", "job_runner", "processor_agent"], ["self", "job_runner", "processor_agent", "end"], ["self", "clean_db"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSchedulerJobQueriesCount.per_test", "ret_exprs": [], "ret_type": "typing.Generator", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[5132, 4], [5186, 57]], "fn_var_ln": {"dag": [[5161, 16], [5161, 19]], "dag_ids": [[5158, 12], [5158, 19]], "dagbag": [[5159, 12], [5159, 18]], "dagruns": [[5154, 12], [5154, 19]], "dr": [[5162, 16], [5162, 18]], "heartbeat": [[5176, 12], [5176, 35]], "job_runner": [[5177, 12], [5177, 27]], "mock_agent": [[5171, 12], [5171, 22]], "query": [[5182, 20], [5182, 25]], "return_value": [[5184, 20], [5184, 45]], "scheduler_job": [[5173, 12], [5173, 25]]}, "fn_var_occur": {"dag": [["dag", "dagbag", "get_dag", "dag_id"], ["dr", "dag", "create_dagrun", "state", "State", "RUNNING", "run_id", "DagRunType", "MANUAL", "value", "i", "dag_hash", "dagbag", "dags_hash", "dag", "dag_id"]], "dag_ids": [["dag_ids", "dagbag", "dag_ids"], ["enumerate", "dag_ids"]], "dagbag": [["dagbag", "DagBag", "dag_folder", "ELASTIC_DAG_FILE", "include_examples", "False", "read_dags_from_db", "False"], ["dagbag", "sync_to_db"], ["dag_ids", "dagbag", "dag_ids"], ["dagbag", "DagBag", "read_dags_from_db", "True"], ["dag", "dagbag", "get_dag", "dag_id"], ["dr", "dag", "create_dagrun", "state", "State", "RUNNING", "run_id", "DagRunType", "MANUAL", "value", "i", "dag_hash", "dagbag", "dags_hash", "dag", "dag_id"]], "dagruns": [["dagruns", "append", "dr"], ["query", "all", "return_value", "dagruns"]], "dr": [["dr", "dag", "create_dagrun", "state", "State", "RUNNING", "run_id", "DagRunType", "MANUAL", "value", "i", "dag_hash", "dagbag", "dags_hash", "dag", "dag_id"], ["dagruns", "append", "dr"], ["dr", "get_task_instances"]], "heartbeat": [["scheduler_job", "heartbeat", "mock", "MagicMock"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "PERF_DAGS_FOLDER", "num_runs"], ["self", "job_runner", "processor_agent", "mock_agent"], ["self", "job_runner", "_run_scheduler_loop"]], "mock_agent": [["mock_agent", "mock", "MagicMock"], ["self", "job_runner", "processor_agent", "mock_agent"]], "query": [["query", "MagicMock"], ["query", "all", "return_value", "dagruns"], ["mock_dagruns", "return_value", "query"]], "return_value": [["query", "all", "return_value", "dagruns"], ["mock_dagruns", "return_value", "query"]], "scheduler_job": [["scheduler_job", "Job", "executor", "MockExecutor", "do_update", "False"], ["scheduler_job", "heartbeat", "mock", "MagicMock"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "PERF_DAGS_FOLDER", "num_runs"]]}, "name": "test_execute_queries_count_with_harvested_dags", "params": {"dag_count": "", "expected_query_count": "", "self": "", "task_count": ""}, "params_descr": {"dag_count": "", "expected_query_count": "", "self": "", "task_count": ""}, "params_occur": {"dag_count": [["mock", "patch", "dict", "str", "dag_count", "str", "task_count"]], "expected_query_count": [["assert_queries_count", "expected_query_count", "margin"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "PERF_DAGS_FOLDER", "num_runs"], ["self", "job_runner", "processor_agent", "mock_agent"], ["self", "job_runner", "_run_scheduler_loop"]], "task_count": [["mock", "patch", "dict", "str", "dag_count", "str", "task_count"]]}, "params_p": {"args": [], "dag_count": [["core.models.Grouping", 0.20708243806891147]], "expected_query_count": [["int", 0.3492310200160281], ["List[Dict[str, Any]]", 0.09073187316606762]], "kwargs": [], "self": [], "task_count": [["core.models.Grouping", 0.20708243806891147]]}, "q_name": "TestSchedulerJobQueriesCount.test_execute_queries_count_with_harvested_dags", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_ids": "", "dagbag": "", "dagruns": "", "dr": "", "heartbeat": "", "job_runner": "", "mock_agent": "", "query": "", "return_value": "", "scheduler_job": ""}, "variables_p": {"dag": [["int", 0.34594563971290254], ["str", 0.09090959818145529]], "dag_ids": [["Dict[str, str]", 0.8897672984618723], ["Iterator[Any]", 0.11023270153812785]], "dagbag": [["str", 0.09940582809007083], ["grouper.fe.settings.FrontendSettings", 0.08677970855852774]], "dagruns": [["list", 0.800425278062856], ["List[str]", 0.10279418744396543]], "dr": [["str", 0.6486430559924364], ["int", 0.26100542431979556], ["Dict[str, List[Any]]", 0.09035151968776806]], "heartbeat": [["int", 0.20652509343497108], ["Dict[str, str]", 0.11022876331250356], ["mode.utils.mocks.Mock", 0.10326604198082145], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.09159704290057437], ["mock.Mock", 0.08787334267419773]], "job_runner": [["Dict[starfish.core.types._constants.Axes, int]", 0.29712976267755054], ["int", 0.11409326192563075], ["bytes", 0.0930961914326343], ["Tuple[int, int]", 0.0918636157581222], ["str", 0.08990804510277146], ["dict", 0.08977961022668998]], "mock_agent": [["mock.Mock", 0.32127665247723136]], "query": [["unittesmock.MagicMock", 0.46002909120081614], ["Type[unittesmock.MagicMock]", 0.10428036198282835]], "return_value": [["int", 0.44684049951123217], ["str", 0.36344309853520584], ["Tuple[int, int]", 0.09487989761361926], ["Tuple[str, str, str, str, str, str, str, str, str, str, str, str, str, str, str, str, str, str, str, str, str, str, str, str]", 0.09483650433994241]], "scheduler_job": [["pxl.config.Config", 0.15911567797738455]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[5223, 4], [5268, 61]], "fn_var_ln": {"dagbag": [[5246, 12], [5246, 18]], "failures": [[5256, 12], [5256, 20]], "heartbeat": [[5252, 12], [5252, 35]], "job_runner": [[5253, 12], [5253, 27]], "joined": [[5267, 16], [5267, 22]], "message": [[5257, 12], [5257, 19]], "mock_agent": [[5249, 12], [5249, 22]], "prefix": [[5266, 16], [5266, 22]], "scheduler_job": [[5251, 12], [5251, 25]]}, "fn_var_occur": {"dagbag": [["dagbag", "DagBag", "dag_folder", "ELASTIC_DAG_FILE", "include_examples", "False"], ["dagbag", "sync_to_db"]], "failures": [["failures", "append", "str", "e"], ["joined", "join", "failures"]], "heartbeat": [["scheduler_job", "heartbeat", "mock", "MagicMock"]], "job_runner": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "PERF_DAGS_FOLDER", "num_runs"], ["self", "job_runner", "processor_agent", "mock_agent"], ["self", "job_runner", "_do_scheduling", "session"]], "joined": [["joined", "join", "failures"], ["AssertionError", "prefix", "joined"]], "message": [["assert_queries_count", "expected_query_count", "message_fmt", "message", "margin"]], "mock_agent": [["mock_agent", "mock", "MagicMock"], ["self", "job_runner", "processor_agent", "mock_agent"]], "prefix": [["AssertionError", "prefix", "joined"]], "scheduler_job": [["scheduler_job", "Job", "job_type", "SchedulerJobRunner", "job_type", "executor", "MockExecutor", "do_update", "False"], ["scheduler_job", "heartbeat", "mock", "MagicMock"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "PERF_DAGS_FOLDER", "num_runs"]]}, "name": "test_process_dags_queries_count", "params": {"dag_count": "", "expected_query_counts": "", "schedule_interval": "", "self": "", "shape": "", "start_ago": "", "task_count": ""}, "params_descr": {"dag_count": "", "expected_query_counts": "", "schedule_interval": "", "self": "", "shape": "", "start_ago": "", "task_count": ""}, "params_occur": {"dag_count": [["mock", "patch", "dict", "str", "dag_count", "str", "task_count", "start_ago", "schedule_interval", "shape"]], "expected_query_counts": [], "schedule_interval": [["mock", "patch", "dict", "str", "dag_count", "str", "task_count", "start_ago", "schedule_interval", "shape"]], "self": [["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "PERF_DAGS_FOLDER", "num_runs"], ["self", "job_runner", "processor_agent", "mock_agent"], ["self", "job_runner", "_do_scheduling", "session"]], "shape": [["mock", "patch", "dict", "str", "dag_count", "str", "task_count", "start_ago", "schedule_interval", "shape"]], "start_ago": [["mock", "patch", "dict", "str", "dag_count", "str", "task_count", "start_ago", "schedule_interval", "shape"]], "task_count": [["mock", "patch", "dict", "str", "dag_count", "str", "task_count", "start_ago", "schedule_interval", "shape"]]}, "params_p": {"args": [], "dag_count": [["str", 0.29938455409679654], ["Dict[str, str]", 0.11877817277187643], ["bool", 0.1159772856169685], ["purplship.providers.ups.utils.Settings", 0.0949422079146179], ["Optional[Exception]", 0.09439370084252498]], "expected_query_counts": [["List[str]", 0.2184678552658116], ["raiden.utils.List[raiden.raiden_service.RaidenService]", 0.21481627677826565]], "kwargs": [], "schedule_interval": [["str", 0.29938455409679654], ["Dict[str, str]", 0.11877817277187643], ["bool", 0.1159772856169685], ["purplship.providers.ups.utils.Settings", 0.0949422079146179], ["Optional[Exception]", 0.09439370084252498]], "self": [], "shape": [["str", 0.29938455409679654], ["Dict[str, str]", 0.11877817277187643], ["bool", 0.1159772856169685], ["purplship.providers.ups.utils.Settings", 0.0949422079146179], ["Optional[Exception]", 0.09439370084252498]], "start_ago": [["str", 0.29938455409679654], ["Dict[str, str]", 0.11877817277187643], ["bool", 0.1159772856169685], ["purplship.providers.ups.utils.Settings", 0.0949422079146179], ["Optional[Exception]", 0.09439370084252498]], "task_count": [["str", 0.29938455409679654], ["Dict[str, str]", 0.11877817277187643], ["bool", 0.1159772856169685], ["purplship.providers.ups.utils.Settings", 0.0949422079146179], ["Optional[Exception]", 0.09439370084252498]]}, "q_name": "TestSchedulerJobQueriesCount.test_process_dags_queries_count", "ret_exprs": [], "ret_type": "", "variables": {"dagbag": "", "failures": "", "heartbeat": "", "job_runner": "", "joined": "", "message": "", "mock_agent": "", "prefix": "", "scheduler_job": ""}, "variables_p": {"dagbag": [["grouper.fe.settings.FrontendSettings", 0.1607749245345166], ["str", 0.114493226495661], ["dict", 0.08610106132733773], ["Dict[str, Union[Any, Any]]", 0.08610106132733773]], "failures": [["list", 0.719419506372549], ["str", 0.09178061019652231], ["List[str]", 0.0850493810878783]], "heartbeat": [["int", 0.20652509343497108], ["Dict[str, str]", 0.11022876331250356], ["mode.utils.mocks.Mock", 0.10326604198082145], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.09159704290057437], ["mock.Mock", 0.08787334267419773]], "job_runner": [["Dict[starfish.core.types._constants.Axes, int]", 0.29712976267755054], ["int", 0.11409326192563075], ["bytes", 0.0930961914326343], ["Tuple[int, int]", 0.0918636157581222], ["str", 0.08990804510277146], ["dict", 0.08977961022668998]], "joined": [["str", 0.8723147418766102], ["Dict[str, Dict[str, Any]]", 0.12768525812339]], "message": [["int", 0.7753837428516426], ["Optional[str]", 0.11546471783536169], ["float", 0.10915153931299582]], "mock_agent": [["mock.Mock", 0.32127665247723136]], "prefix": [["str", 0.6234393669475262], ["float", 0.09369497493479208], ["List[str]", 0.08952616793944668]], "scheduler_job": [["yacron.job.RunningJob", 0.18542219725201192], ["dict", 0.10239309080423385]]}}], "name": "TestSchedulerJobQueriesCount", "q_name": "TestSchedulerJobQueriesCount", "variables": {"scheduler_job": "Job | None"}, "variables_p": {"scheduler_job": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]]}}], "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[96, 0], [99, 17]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "disable_load_example", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "disable_load_example", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[103, 0], [109, 41]], "fn_var_ln": {"non_serialized_dagbag": [[107, 4], [107, 25]]}, "fn_var_occur": {"non_serialized_dagbag": [["non_serialized_dagbag", "DagBag", "read_dags_from_db", "False", "include_examples", "False"], ["non_serialized_dagbag", "sync_to_db"]]}, "name": "dagbag", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "dagbag", "ret_exprs": ["return DagBag(read_dags_from_db=True)"], "ret_type": "", "ret_type_p": [["IO[str]", 0.13927392907332312], ["raiden.utils.TokenAmount", 0.10227027691965349], ["cmk.utils.type_defs.HostName", 0.10046049291636155], ["cmk.utils.type_defs.ServiceName", 0.10046049291636155], ["str", 0.09848603510444305], ["int", 0.09379279132650341]], "variables": {"non_serialized_dagbag": ""}, "variables_p": {"non_serialized_dagbag": [["str", 0.27407875641207435], ["List[Tuple[str, str, str, str, Any]]", 0.19016622881879802], ["List[str]", 0.1145435612007457], ["bool", 0.09396870691496804]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[113, 0], [115, 13]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "load_examples", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "load_examples", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Test if _schedule_dag_run puts a task instance into SKIPPED state if any of its", "long_descr": "upstream tasks are skipped according to TriggerRuleDep.", "ret": null}, "fn_lc": [[5057, 0], [5092, 53]], "fn_var_ln": {"dr": [[5072, 4], [5072, 6]], "dummy1": [[5067, 8], [5067, 14]], "dummy2": [[5068, 8], [5068, 14]], "dummy3": [[5069, 8], [5069, 14]], "job_runner": [[5085, 4], [5085, 14]], "scheduler_job": [[5084, 4], [5084, 17]], "tis": [[5088, 4], [5088, 7]]}, "fn_var_occur": {"dr": [["dr", "dag_maker", "create_dagrun", "state", "State", "RUNNING"], ["dr", "None"], ["tis", "ti", "task_id", "ti", "ti", "dr", "get_task_instances", "session", "session"], ["job_runner", "_schedule_dag_run", "dr", "session"], ["tis", "ti", "task_id", "ti", "ti", "dr", "get_task_instances", "session", "session"]], "dummy1": [["dummy1", "EmptyOperator", "task_id"], ["dummy1", "dummy2", "dummy3"], ["tis", "dummy1", "task_id", "state", "State", "SKIPPED"], ["tis", "dummy1", "task_id", "state", "State", "SKIPPED"]], "dummy2": [["dummy2", "EmptyOperator", "task_id"], ["dummy1", "dummy2", "dummy3"], ["tis", "dummy2", "task_id", "state", "State", "SUCCESS"], ["tis", "dummy2", "task_id", "state", "State", "SUCCESS"]], "dummy3": [["dummy3", "EmptyOperator", "task_id"], ["dummy1", "dummy2", "dummy3"], ["tis", "dummy3", "task_id", "state", "State", "NONE"], ["tis", "dummy3", "task_id", "state", "State", "SKIPPED"]], "job_runner": [["job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"], ["job_runner", "_schedule_dag_run", "dr", "session"]], "scheduler_job": [["scheduler_job", "Job"], ["job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "devnull"]], "tis": [["tis", "ti", "task_id", "ti", "ti", "dr", "get_task_instances", "session", "session"], ["tis", "dummy1", "task_id", "state", "State", "SKIPPED"], ["tis", "dummy2", "task_id", "state", "State", "SUCCESS"], ["tis", "dummy3", "task_id", "state", "State", "NONE"], ["tis", "ti", "task_id", "ti", "ti", "dr", "get_task_instances", "session", "session"], ["tis", "dummy1", "task_id", "state", "State", "SKIPPED"], ["tis", "dummy2", "task_id", "state", "State", "SUCCESS"], ["tis", "dummy3", "task_id", "state", "State", "SKIPPED"]]}, "name": "test_schedule_dag_run_with_upstream_skip", "params": {"dag_maker": "", "session": ""}, "params_descr": {"dag_maker": "", "session": ""}, "params_occur": {"dag_maker": [["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "session", "session"], ["dr", "dag_maker", "create_dagrun", "state", "State", "RUNNING"]], "session": [["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "session", "session"], ["tis", "ti", "task_id", "ti", "ti", "dr", "get_task_instances", "session", "session"], ["session", "flush"], ["job_runner", "_schedule_dag_run", "dr", "session"], ["session", "flush"], ["tis", "ti", "task_id", "ti", "ti", "dr", "get_task_instances", "session", "session"]]}, "params_p": {"args": [], "dag_maker": [["str", 0.23019404441688437], ["app.models.User", 0.1973038921202931], ["app.models.user.User", 0.1973038921202931], ["Optional[core.models.User]", 0.09820164973372451]], "kwargs": [], "session": [["zerver.models.UserProfile", 0.20082111400105557], ["django.contrib.auth.models.User", 0.18885480531660884], ["zam_repondeur.models.Dossier", 0.11291046721778888], ["sqlalchemy.orm.session.Session", 0.11018721137788787], ["raiden.utils.Dict[str, raiden.utils.Any]", 0.09814859233654219], ["sqlalchemy.orm.Session", 0.09326989357692927]]}, "q_name": "test_schedule_dag_run_with_upstream_skip", "ret_exprs": [], "ret_type": "", "variables": {"dr": "", "dummy1": "", "dummy2": "", "dummy3": "", "job_runner": "", "scheduler_job": "", "tis": ""}, "variables_p": {"dr": [["Dict[str, str]", 0.12914803560185417], ["str", 0.095788867463755], ["Dict[str, Dict[str, int]]", 0.09559576917745828], ["Dict[str, Any]", 0.0892030918104662], ["float", 0.08551529609126537], ["datetime.datetime.datetime", 0.08482328756771457]], "dummy1": [["str", 0.1356408050114778], ["int", 0.09961857440210847], ["Dict[str, Any]", 0.09660794285547131], ["list", 0.09346272184585391], ["Type[List[Any]]", 0.08173886058522234]], "dummy2": [["str", 0.1356408050114778], ["int", 0.09961857440210847], ["Dict[str, Any]", 0.09660794285547131], ["list", 0.09346272184585391], ["Type[List[Any]]", 0.08173886058522234]], "dummy3": [["int", 0.08922965027223355], ["zerver.models.Realm", 0.08273361657130868], ["Dict[str, str]", 0.08247800690151727], ["owlmixin.TList[jumeaux.models.Request]", 0.08205648776594789]], "job_runner": [["quantumflow.states.State", 0.09642339189128107]], "scheduler_job": [["cincoconfig.config.Schema", 0.2721445678641783], ["list", 0.1094705612376343], ["neuromation.cli.formatters.jobs.TabularJobsFormatter", 0.1003208345363045], ["raiden.transfer.mediated_transfer.state.LockedTransferUnsignedState", 0.09871785888033564], ["Dict[str, None]", 0.09378662119396461]], "tis": [["Dict[str, str]", 0.09269167225371959], ["pydynasync.models.Changes", 0.08822894941442339], ["list", 0.0702779535565824]]}}], "imports": ["__future__", "annotations", "collections", "datetime", "logging", "os", "shutil", "datetime", "timedelta", "tempfile", "mkdtemp", "typing", "Generator", "unittest", "mock", "unittest", "mock", "MagicMock", "patch", "psutil", "pytest", "time_machine", "sqlalchemy", "func", "airflow.example_dags", "airflow", "settings", "airflow", "callbacks", "callback_requests", "DagCallbackRequest", "SlaCallbackRequest", "TaskCallbackRequest", "airflow", "callbacks", "database_callback_sink", "DatabaseCallbackSink", "airflow", "callbacks", "pipe_callback_sink", "PipeCallbackSink", "airflow", "dag_processing", "manager", "DagFileProcessorAgent", "airflow", "datasets", "Dataset", "airflow", "exceptions", "AirflowException", "airflow", "executors", "base_executor", "BaseExecutor", "airflow", "executors", "executor_constants", "MOCK_EXECUTOR", "airflow", "executors", "executor_loader", "ExecutorLoader", "airflow", "jobs", "backfill_job_runner", "BackfillJobRunner", "airflow", "jobs", "job", "Job", "run_job", "airflow", "jobs", "local_task_job_runner", "LocalTaskJobRunner", "airflow", "jobs", "scheduler_job_runner", "SchedulerJobRunner", "airflow", "models", "DAG", "DagBag", "DagModel", "DbCallbackRequest", "Pool", "TaskInstance", "airflow", "models", "dagrun", "DagRun", "airflow", "models", "dataset", "DatasetDagRunQueue", "DatasetEvent", "DatasetModel", "airflow", "models", "serialized_dag", "SerializedDagModel", "airflow", "models", "taskinstance", "SimpleTaskInstance", "TaskInstanceKey", "airflow", "operators", "bash", "BashOperator", "airflow", "operators", "empty", "EmptyOperator", "airflow", "serialization", "serialized_objects", "SerializedDAG", "airflow", "utils", "timezone", "airflow", "utils", "file", "list_py_file_paths", "airflow", "utils", "session", "create_session", "provide_session", "airflow", "utils", "state", "DagRunState", "State", "TaskInstanceState", "airflow", "utils", "types", "DagRunType", "tests", "listeners", "dag_listener", "tests", "listeners", "test_listeners", "get_listener_manager", "tests", "models", "TEST_DAGS_FOLDER", "tests", "test_utils", "asserts", "assert_queries_count", "tests", "test_utils", "config", "conf_vars", "env_vars", "tests", "test_utils", "db", "clear_db_dags", "clear_db_datasets", "clear_db_import_errors", "clear_db_jobs", "clear_db_pools", "clear_db_runs", "clear_db_serialized_dags", "clear_db_sla_miss", "set_default_pool_slots", "tests", "test_utils", "mock_executor", "MockExecutor", "tests", "test_utils", "mock_operators", "CustomOperator", "tests", "utils", "test_timezone", "UTC", "airflow", "models", "dagbag", "DagBag", "airflow", "executors", "local_executor", "LocalExecutor", "airflow", "executors", "sequential_executor", "SequentialExecutor"], "mod_var_ln": {"DEFAULT_DATE": [[91, 0], [91, 12]], "ELASTIC_DAG_FILE": [[88, 0], [88, 16]], "PERF_DAGS_FOLDER": [[87, 0], [87, 16]], "ROOT_FOLDER": [[84, 0], [84, 11]], "TEST_DAG_FOLDER": [[90, 0], [90, 15]], "TRY_NUMBER": [[92, 0], [92, 10]]}, "mod_var_occur": {"DEFAULT_DATE": [["ti1", "dag_maker", "create_dagrun", "run_id", "run_id", "execution_date", "DEFAULT_DATE", "timedelta", "hours", "get_task_instance", "task1", "task_id"], ["dr1", "dag_maker", "create_dagrun", "execution_date", "DEFAULT_DATE", "timedelta", "hours"], ["dr2", "dag_maker", "create_dagrun", "execution_date", "DEFAULT_DATE", "timedelta", "hours"], ["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "session", "session"], ["dag_maker", "dag_id", "dag_id", "start_date", "DEFAULT_DATE", "session", "session"], ["dr2", "dag", "create_dagrun", "run_type", "DagRunType", "BACKFILL_JOB", "state", "State", "RUNNING", "execution_date", "DEFAULT_DATE", "datetime", "timedelta", "start_date", "DEFAULT_DATE", "session", "session"], ["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "max_active_runs", "processor_subdir", "TEST_DAG_FOLDER", "dagrun_timeout", "datetime", "timedelta", "seconds", "dag"], ["dr", "dag_maker", "create_dagrun", "start_date", "DEFAULT_DATE"], ["dag_maker", "dag_id", "schedule", "schedule_interval", "start_date", "DEFAULT_DATE", "schedule_interval"], ["dr", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "state", "None"], ["first_run", "DagRun", "find", "dag_id", "dag_id", "execution_date", "DEFAULT_DATE"], ["job_runner", "BackfillJobRunner", "job", "backfill_job", "dag", "dag", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["TaskInstanceKey", "dag", "dag_id", "DEFAULT_DATE", "isoformat", "State", "SUCCESS", "None", "bf_exec", "sorted_tasks"], ["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "session", "session"], ["dag_maker", "dag_id", "start_date", "DEFAULT_DATE"], ["dag_maker", "dag_id", "start_date", "DEFAULT_DATE"], ["dr1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "start_date", "timezone", "utcnow"], ["dag_maker", "create_dagrun", "run_id", "index", "execution_date", "DEFAULT_DATE", "timedelta", "days", "index", "start_date", "timezone", "utcnow", "state", "State", "RUNNING", "session", "session"], ["dr", "dag_maker", "create_dagrun", "run_id", "execution_date", "DEFAULT_DATE", "timedelta", "days", "data_interval", "DEFAULT_DATE", "timedelta", "days", "DEFAULT_DATE", "timedelta", "days"], ["dr", "dag_maker", "create_dagrun", "run_id", "execution_date", "DEFAULT_DATE", "timedelta", "days", "data_interval", "DEFAULT_DATE", "timedelta", "days", "DEFAULT_DATE", "timedelta", "days"], ["created_run", "data_interval_start", "DEFAULT_DATE", "timedelta", "days"], ["created_run", "data_interval_end", "DEFAULT_DATE", "timedelta", "days"], ["dag_model", "next_dagrun", "DEFAULT_DATE"], ["dag_model", "next_dagrun_data_interval_start", "DEFAULT_DATE"], ["dag_model", "next_dagrun_data_interval_end", "DEFAULT_DATE", "timedelta", "minutes"], ["dr1", "dag", "get_dagrun", "DEFAULT_DATE", "session", "session"], ["dr1", "execution_date", "DEFAULT_DATE"], ["dr1", "data_interval_start", "DEFAULT_DATE"], ["dr1", "data_interval_end", "DEFAULT_DATE", "timedelta", "minutes"], ["dag_model", "next_dagrun", "DEFAULT_DATE", "timedelta", "minutes"], ["dag_model", "next_dagrun_data_interval_start", "DEFAULT_DATE", "timedelta", "minutes"], ["dag_model", "next_dagrun_data_interval_end", "DEFAULT_DATE", "timedelta", "minutes"], ["dag_model", "next_dagrun", "DEFAULT_DATE", "timedelta", "minutes"], ["dag_model", "next_dagrun_data_interval_start", "DEFAULT_DATE", "timedelta", "minutes"], ["dag_model", "next_dagrun_data_interval_end", "DEFAULT_DATE", "timedelta", "minutes"], ["dag_model", "next_dagrun", "DEFAULT_DATE"], ["dag_model", "next_dagrun_data_interval_start", "DEFAULT_DATE", "timedelta", "days"], ["dag_model", "next_dagrun_data_interval_end", "DEFAULT_DATE", "timedelta", "days"], ["dag_model", "next_dagrun", "DEFAULT_DATE", "timedelta", "days"], ["run1", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "state", "State", "RUNNING", "start_date", "timezone", "utcnow", "timedelta", "seconds", "session", "session"], ["run2", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "timedelta", "seconds", "state", "State", "QUEUED", "session", "session"], ["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "schedule", "max_active_runs", "session", "session"], ["run1", "dag_maker", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "execution_date", "DEFAULT_DATE", "timedelta", "hours", "state", "State", "RUNNING"], ["dag_maker", "dag_model", "next_dagrun", "DEFAULT_DATE"], ["dag_maker", "dag_model", "next_dagrun", "DEFAULT_DATE", "timedelta", "days"], ["dag_maker", "create_dagrun", "run_type", "DagRunType", "MANUAL", "execution_date", "DEFAULT_DATE", "timedelta", "hours", "state", "State", "QUEUED", "session", "session"], ["dag_maker", "start_date", "DEFAULT_DATE", "schedule", "timedelta", "hours", "max_active_runs"], ["date", "dag", "following_schedule", "DEFAULT_DATE"], ["ti", "TaskInstance", "task", "task1", "execution_date", "DEFAULT_DATE"], ["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "max_active_runs", "dag"], ["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "schedule", "max_active_runs", "session", "session"], ["dr2", "dag_maker", "create_dagrun", "run_id", "execution_date", "DEFAULT_DATE", "datetime", "timedelta", "seconds"], ["dag_run", "dag", "create_dagrun", "state", "DagRunState", "RUNNING", "execution_date", "DEFAULT_DATE", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["dag_run", "dag", "create_dagrun", "state", "DagRunState", "RUNNING", "execution_date", "DEFAULT_DATE", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["dag_run", "dag", "create_dagrun", "state", "DagRunState", "RUNNING", "execution_date", "DEFAULT_DATE", "run_type", "DagRunType", "SCHEDULED", "session", "session"], ["dag_maker", "dag_id", "schedule", "timedelta", "days", "start_date", "DEFAULT_DATE", "catchup", "True", "max_active_runs", "session", "session", "dag"], ["dr", "DagRun", "find", "execution_date", "DEFAULT_DATE", "session", "session"], ["session", "query", "DagRun", "execution_date", "filter", "DagRun", "execution_date", "DEFAULT_DATE", "scalar", "timezone", "utcnow", "timedelta", "days"], ["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "session", "session"]], "ELASTIC_DAG_FILE": [["dagbag", "DagBag", "dag_folder", "ELASTIC_DAG_FILE", "include_examples", "False", "read_dags_from_db", "False"], ["dagbag", "DagBag", "dag_folder", "ELASTIC_DAG_FILE", "include_examples", "False"]], "PERF_DAGS_FOLDER": [["ELASTIC_DAG_FILE", "os", "path", "join", "PERF_DAGS_FOLDER"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "PERF_DAGS_FOLDER", "num_runs"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "PERF_DAGS_FOLDER", "num_runs"]], "ROOT_FOLDER": [["PERF_DAGS_FOLDER", "os", "path", "join", "ROOT_FOLDER"]], "TEST_DAG_FOLDER": [["dag_maker", "dag_id", "start_date", "DEFAULT_DATE", "max_active_runs", "processor_subdir", "TEST_DAG_FOLDER", "dagrun_timeout", "datetime", "timedelta", "seconds", "dag"], ["expected_callback", "DagCallbackRequest", "full_filepath", "dr", "dag", "fileloc", "dag_id", "dr", "dag_id", "is_failure_callback", "True", "run_id", "dr", "run_id", "processor_subdir", "TEST_DAG_FOLDER", "msg"], ["dag_maker", "dag_id", "dagrun_timeout", "datetime", "timedelta", "seconds", "processor_subdir", "TEST_DAG_FOLDER", "session", "session"], ["expected_callback", "DagCallbackRequest", "full_filepath", "dr", "dag", "fileloc", "dag_id", "dr", "dag_id", "is_failure_callback", "True", "run_id", "dr", "run_id", "processor_subdir", "TEST_DAG_FOLDER", "msg"], ["dag_maker", "dag_id", "on_success_callback", "x", "print", "on_failure_callback", "x", "print", "processor_subdir", "TEST_DAG_FOLDER", "dag"], ["expected_callback", "DagCallbackRequest", "full_filepath", "dag", "fileloc", "dag_id", "dr", "dag_id", "is_failure_callback", "bool", "state", "State", "FAILED", "run_id", "dr", "run_id", "processor_subdir", "TEST_DAG_FOLDER", "msg", "expected_callback_msg"], ["dag_maker", "dag_id", "on_success_callback", "x", "print", "on_failure_callback", "x", "print", "processor_subdir", "TEST_DAG_FOLDER"], ["dag_maker", "dag_id", "on_failure_callback", "x", "print", "dagrun_timeout", "timedelta", "hours", "processor_subdir", "TEST_DAG_FOLDER", "dag"], ["expected_callback", "DagCallbackRequest", "full_filepath", "dag", "fileloc", "dag_id", "dr", "dag_id", "is_failure_callback", "True", "run_id", "dr", "run_id", "processor_subdir", "TEST_DAG_FOLDER", "msg"], ["dag_maker", "dag_id", "on_success_callback", "x", "print", "on_failure_callback", "x", "print", "processor_subdir", "TEST_DAG_FOLDER"], ["self", "job_runner", "SchedulerJobRunner", "job", "scheduler_job", "subdir", "os", "path", "join", "TEST_DAG_FOLDER", "num_runs"], ["os", "walk", "TEST_DAG_FOLDER"], ["list_py_file_paths", "TEST_DAG_FOLDER", "include_examples", "False"], ["list_py_file_paths", "TEST_DAG_FOLDER", "include_examples", "True"], ["dag_maker", "dag_id", "dag_id", "schedule", "schedule", "processor_subdir", "TEST_DAG_FOLDER", "dag"], ["expected_callback", "SlaCallbackRequest", "full_filepath", "dag", "fileloc", "dag_id", "dag", "dag_id", "processor_subdir", "TEST_DAG_FOLDER"], ["dagbag", "DagBag", "TEST_DAG_FOLDER", "read_dags_from_db", "False"], ["dagbag", "DagBag", "TEST_DAG_FOLDER", "read_dags_from_db", "False"], ["dag", "sync_to_db", "processor_subdir", "TEST_DAG_FOLDER"], ["expected_failure_callback_requests", "TaskCallbackRequest", "full_filepath", "dag", "fileloc", "simple_task_instance", "SimpleTaskInstance", "from_ti", "ti", "processor_subdir", "TEST_DAG_FOLDER", "msg", "str", "self", "job_runner", "_generate_zombie_message_details", "ti"], ["dagbag", "DagBag", "TEST_DAG_FOLDER", "read_dags_from_db", "False"]], "TRY_NUMBER": []}, "no_types_annot": {"D": 10, "I": 0, "U": 1410}, "session_id": "XFLS55kgNGN8GDR9zPYejlnHAVKKvCtgHm6LlNBhoio", "set": null, "tc": [false, null], "type_annot_cove": 0.01, "typed_seq": "", "untyped_seq": "", "variables": {"DEFAULT_DATE": "", "ELASTIC_DAG_FILE": "", "PERF_DAGS_FOLDER": "", "ROOT_FOLDER": "", "TEST_DAG_FOLDER": "", "TRY_NUMBER": ""}, "variables_p": {"DEFAULT_DATE": [["str", 0.32892504198220884], ["int", 0.1904627802632022], ["datetime.datetime.datetime", 0.18612061809968666], ["datetime.datetime", 0.10109971933560831], ["Type[Dict[str, int]]", 0.09816045018769295], ["dict", 0.0952313901316011]], "ELASTIC_DAG_FILE": [["src.pip_shims.models.ShimmedPathCollection", 0.2187990945141742], ["Counter[str]", 0.09346258085246288]], "PERF_DAGS_FOLDER": [["str", 0.9134012277606292]], "ROOT_FOLDER": [["str", 1.0]], "TEST_DAG_FOLDER": [["datetime.time", 0.4595802135858403], ["Dict[str, bool]", 0.2984833663843004]], "TRY_NUMBER": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]]}}}