{"error": null, "response": {"classes": [{"cls_lc": [[53, 0], [487, 63]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[54, 4], [69, 27]], "fn_var_ln": {"_tmpfile": [[58, 12], [58, 25]], "dag": [[66, 8], [66, 16]], "dagbag": [[67, 8], [67, 14]]}, "fn_var_occur": {"_tmpfile": [["self", "_tmpfile", "f", "name"], ["session", "add", "DagModel", "dag_id", "TRIGGERED_DAG_ID", "fileloc", "self", "_tmpfile"]], "dag": [["self", "dag", "DAG", "TEST_DAG_ID", "default_args", "DEFAULT_DATE"], ["dagbag", "bag_dag", "self", "dag", "root_dag", "self", "dag"]], "dagbag": [["dagbag", "DagBag", "f", "name", "read_dags_from_db", "False", "include_examples", "False"], ["dagbag", "bag_dag", "self", "dag", "root_dag", "self", "dag"], ["dagbag", "sync_to_db"]]}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "_tmpfile", "f", "name"], ["session", "add", "DagModel", "dag_id", "TRIGGERED_DAG_ID", "fileloc", "self", "_tmpfile"], ["self", "dag", "DAG", "TEST_DAG_ID", "default_args", "DEFAULT_DATE"], ["dagbag", "bag_dag", "self", "dag", "root_dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"_tmpfile": "", "dag": "", "dagbag": ""}, "variables_p": {"_tmpfile": [["int", 0.7698957665200074], ["Counter[int]", 0.1305280708388063], ["list", 0.09957616264118624]], "dag": [["str", 0.29971775547868174], ["int", 0.10328487344695551], ["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.08926244593189803]], "dagbag": []}}, {"docstring": {"func": "Cleanup state after testing in DB.", "long_descr": null, "ret": null}, "fn_lc": [[71, 4], [80, 44]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "teardown_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["pathlib", "Path", "self", "_tmpfile", "unlink"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.teardown_method", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Asserts whether the correct extra links url will be created.", "long_descr": "Specifically it tests whether the correct dag id and date are passed to\nthe method which constructs the final url.\nNote: We can't run that method to generate the url itself because the Flask app context\nisn't available within the test logic, so it is mocked here.", "ret": null}, "fn_lc": [[82, 4], [107, 36]], "fn_var_ln": {"_": [[102, 14], [102, 15]], "args": [[102, 8], [102, 12]], "expected_args": [[103, 8], [103, 21]], "triggering_ti": [[91, 8], [91, 21]]}, "fn_var_occur": {"_": [["args", "_", "mock_build_url", "call_args"]], "args": [["args", "_", "mock_build_url", "call_args"], ["expected_args", "args"]], "expected_args": [["expected_args", "triggered_dag_run", "dag_id", "triggered_dag_run", "execution_date", "isoformat"], ["expected_args", "args"]], "triggering_ti": [["triggering_ti", "session", "query", "TaskInstance", "filter_by", "task_id", "triggering_task", "task_id", "dag_id", "triggering_task", "dag_id", "one"], ["triggering_task", "get_extra_links", "triggering_ti"]]}, "name": "assert_extra_link", "params": {"self": "", "session": "", "triggered_dag_run": "", "triggering_task": ""}, "params_descr": {"self": "", "session": "", "triggered_dag_run": "", "triggering_task": ""}, "params_occur": {"self": [], "session": [["triggering_ti", "session", "query", "TaskInstance", "filter_by", "task_id", "triggering_task", "task_id", "dag_id", "triggering_task", "dag_id", "one"]], "triggered_dag_run": [["expected_args", "triggered_dag_run", "dag_id", "triggered_dag_run", "execution_date", "isoformat"]], "triggering_task": [["triggering_ti", "session", "query", "TaskInstance", "filter_by", "task_id", "triggering_task", "task_id", "dag_id", "triggering_task", "dag_id", "one"], ["triggering_task", "get_extra_links", "triggering_ti"]]}, "params_p": {"args": [], "kwargs": [], "self": [], "session": [["dict", 0.12885062375005682], ["prefecengine.state.State", 0.08963281335206712], ["Dict[str, taskiapplication.models.task.Task]", 0.08386659760692755]], "triggered_dag_run": [["str", 0.19282932260343844], ["Dict[str, Any]", 0.10003492634810433]], "triggering_task": [["dict", 0.12885062375005682], ["prefecengine.state.State", 0.08963281335206712], ["Dict[str, taskiapplication.models.task.Task]", 0.08386659760692755]]}, "q_name": "TestDagRunOperator.assert_extra_link", "ret_exprs": [], "ret_type": "", "variables": {"_": "", "args": "", "expected_args": "", "triggering_ti": ""}, "variables_p": {"_": [["str", 0.6220171603558868], ["dict", 0.17855792552766897], ["Tuple[Type[str], Type[bytes]]", 0.11535729083005646]], "args": [["str", 0.18099455997419214], ["List[str]", 0.16347925444700584], ["Dict[str, Union[Any, bool]]", 0.10123944605957476], ["List[Union[Any, Any]]", 0.09873406409911877], ["Generator[str, None, None]", 0.09118570792496504], ["Dict[str, Any]", 0.09072498931843356], ["Dict[Any, List[Any]]", 0.09007271139018266]], "expected_args": [["Dict[str, Tuple[Any, Any]]", 0.08510601985326526]], "triggering_ti": [["int", 0.24900375039013373], ["list", 0.09328700922032467]]}}, {"docstring": {"func": "Test TriggerDagRunOperator.", "long_descr": null, "ret": null}, "fn_lc": [[109, 4], [118, 57]], "fn_var_ln": {"dagrun": [[115, 12], [115, 18]], "task": [[111, 8], [111, 12]]}, "fn_var_occur": {"dagrun": [["dagrun", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "one"], ["dagrun", "external_trigger"], ["dagrun", "run_id", "DagRun", "generate_run_id", "DagRunType", "MANUAL", "dagrun", "execution_date"], ["self", "assert_extra_link", "dagrun", "task", "session"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "dag", "self", "dag"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"], ["self", "assert_extra_link", "dagrun", "task", "session"]]}, "name": "test_trigger_dagrun", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "dag", "self", "dag"], ["self", "assert_extra_link", "dagrun", "task", "session"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun", "ret_exprs": [], "ret_type": "", "variables": {"dagrun": "", "task": ""}, "variables_p": {"dagrun": [["int", 0.4339914358089945], ["list", 0.1061216474874019], ["lists.models.Todo", 0.10194594303976776], ["str", 0.09269995751686426], ["Union[Literal[False], Literal[True]]", 0.08909414670530297]], "task": [["taskiapplication.models.task.Task", 0.27303579686755114], ["kippo.tasks.models.KippoTask", 0.1894532967974271]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[120, 4], [132, 55]], "fn_var_ln": {"dagruns": [[130, 12], [130, 19]], "task": [[121, 8], [121, 12]]}, "fn_var_occur": {"dagruns": [["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["len", "dagruns"], ["dagruns", "run_id"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "trigger_run_id", "dag", "self", "dag"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"]]}, "name": "test_trigger_dagrun_custom_run_id", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "trigger_run_id", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_custom_run_id", "ret_exprs": [], "ret_type": "", "variables": {"dagruns": "", "task": ""}, "variables_p": {"dagruns": [["int", 0.5610903243822541], ["Union[Literal, int]", 0.12023930076700251], ["Type[insta.models.Image]", 0.09336125299369906], ["list", 0.07551300069787184], ["set", 0.06835028264881605]], "task": [["str", 0.1106299152418692], ["taskiapplication.models.task.Task", 0.0898758223956091]]}}, {"docstring": {"func": "Test TriggerDagRunOperator with custom execution_date.", "long_descr": null, "ret": null}, "fn_lc": [[134, 4], [150, 57]], "fn_var_ln": {"custom_execution_date": [[136, 8], [136, 29]], "dagrun": [[146, 12], [146, 18]], "task": [[137, 8], [137, 12]]}, "fn_var_occur": {"custom_execution_date": [["custom_execution_date", "timezone", "datetime"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "custom_execution_date", "dag", "self", "dag"], ["dagrun", "execution_date", "custom_execution_date"], ["dagrun", "run_id", "DagRun", "generate_run_id", "DagRunType", "MANUAL", "custom_execution_date"]], "dagrun": [["dagrun", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "one"], ["dagrun", "external_trigger"], ["dagrun", "execution_date", "custom_execution_date"], ["dagrun", "run_id", "DagRun", "generate_run_id", "DagRunType", "MANUAL", "custom_execution_date"], ["self", "assert_extra_link", "dagrun", "task", "session"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "custom_execution_date", "dag", "self", "dag"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"], ["self", "assert_extra_link", "dagrun", "task", "session"]]}, "name": "test_trigger_dagrun_with_execution_date", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "custom_execution_date", "dag", "self", "dag"], ["self", "assert_extra_link", "dagrun", "task", "session"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_with_execution_date", "ret_exprs": [], "ret_type": "", "variables": {"custom_execution_date": "", "dagrun": "", "task": ""}, "variables_p": {"custom_execution_date": [["datetime.datetime", 0.39806275203581826], ["datetime.date", 0.17485542811856578], ["Type[prm.journals.models.moods.Mood]", 0.15165944635740258], ["str", 0.09428734804586689], ["Optional[int]", 0.0937073113830636], ["Dict[datetime.date, Dict[str, Any]]", 0.08742771405928289]], "dagrun": [["int", 0.5333943606507727], ["lists.models.Todo", 0.11541858746262583], ["list", 0.0918204210730794], ["set", 0.08416355244656339]], "task": [["khetha.models.Task", 0.1951530996239424]]}}, {"docstring": {"func": "Test TriggerDagRunOperator with custom execution_date.", "long_descr": null, "ret": null}, "fn_lc": [[152, 4], [182, 68]], "fn_var_ln": {"dag_run": [[166, 12], [166, 19]], "dagruns": [[177, 12], [177, 19]], "run_id": [[164, 8], [164, 14]], "task": [[155, 8], [155, 12]], "triggered_dag_run": [[179, 12], [179, 29]], "utc_now": [[154, 8], [154, 15]]}, "fn_var_occur": {"dag_run": [["dag_run", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "state", "State", "SUCCESS", "run_type", "run_id", "run_id"], ["session", "add", "dag_run"]], "dagruns": [["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["len", "dagruns"], ["triggered_dag_run", "dagruns"]], "run_id": [["run_id", "utc_now", "isoformat"], ["dag_run", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "state", "State", "SUCCESS", "run_type", "run_id", "run_id"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "dag", "self", "dag", "poke_interval", "reset_dag_run", "True", "wait_for_completion", "True"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"], ["self", "assert_extra_link", "triggered_dag_run", "task", "session"]], "triggered_dag_run": [["triggered_dag_run", "dagruns"], ["triggered_dag_run", "external_trigger"], ["triggered_dag_run", "execution_date", "utc_now"], ["self", "assert_extra_link", "triggered_dag_run", "task", "session"]], "utc_now": [["utc_now", "timezone", "utcnow"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "dag", "self", "dag", "poke_interval", "reset_dag_run", "True", "wait_for_completion", "True"], ["run_id", "utc_now", "isoformat"], ["dag_run", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "state", "State", "SUCCESS", "run_type", "run_id", "run_id"], ["triggered_dag_run", "execution_date", "utc_now"]]}, "name": "test_trigger_dagrun_twice", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "dag", "self", "dag", "poke_interval", "reset_dag_run", "True", "wait_for_completion", "True"], ["self", "assert_extra_link", "triggered_dag_run", "task", "session"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_twice", "ret_exprs": [], "ret_type": "", "variables": {"dag_run": "", "dagruns": "", "run_id": "", "task": "", "triggered_dag_run": "", "utc_now": ""}, "variables_p": {"dag_run": [["int", 0.19991400905780599], ["dict", 0.18993630819026336], ["raiden.transfer.state.BalanceProofSignedState", 0.12403130453073852], ["Type[tuple]", 0.10672068006591276], ["Dict[str, int]", 0.09974114745531248]], "dagruns": [["int", 0.6325430029780073], ["Union[Literal, int]", 0.12752396078691752], ["Type[insta.models.Image]", 0.08403113818396357], ["list", 0.06827709827139009]], "run_id": [["Optional[int]", 0.06534028681735941], ["Callable(id)[[object], int]", 0.039357868124095294]], "task": [["bytes", 0.09363575355198461]], "triggered_dag_run": [["int", 0.09983803205995095]], "utc_now": [["tagstore.models.entity.EntityId", 0.39427508065212735], ["Optional[magic.models.deck.Deck]", 0.20217066617710353], ["str", 0.10706491513535475]]}}, {"docstring": {"func": "Test TriggerDagRunOperator with custom execution_date and scheduled dag_run.", "long_descr": null, "ret": null}, "fn_lc": [[184, 4], [214, 68]], "fn_var_ln": {"dag_run": [[198, 12], [198, 19]], "dagruns": [[209, 12], [209, 19]], "run_id": [[196, 8], [196, 14]], "task": [[187, 8], [187, 12]], "triggered_dag_run": [[211, 12], [211, 29]], "utc_now": [[186, 8], [186, 15]]}, "fn_var_occur": {"dag_run": [["dag_run", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "state", "State", "SUCCESS", "run_type", "run_id", "run_id"], ["session", "add", "dag_run"]], "dagruns": [["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["len", "dagruns"], ["triggered_dag_run", "dagruns"]], "run_id": [["run_id", "utc_now", "isoformat"], ["dag_run", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "state", "State", "SUCCESS", "run_type", "run_id", "run_id"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "dag", "self", "dag", "poke_interval", "reset_dag_run", "True", "wait_for_completion", "True"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"], ["self", "assert_extra_link", "triggered_dag_run", "task", "session"]], "triggered_dag_run": [["triggered_dag_run", "dagruns"], ["triggered_dag_run", "external_trigger"], ["triggered_dag_run", "execution_date", "utc_now"], ["self", "assert_extra_link", "triggered_dag_run", "task", "session"]], "utc_now": [["utc_now", "timezone", "utcnow"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "dag", "self", "dag", "poke_interval", "reset_dag_run", "True", "wait_for_completion", "True"], ["run_id", "utc_now", "isoformat"], ["dag_run", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "state", "State", "SUCCESS", "run_type", "run_id", "run_id"], ["triggered_dag_run", "execution_date", "utc_now"]]}, "name": "test_trigger_dagrun_with_scheduled_dag_run", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "dag", "self", "dag", "poke_interval", "reset_dag_run", "True", "wait_for_completion", "True"], ["self", "assert_extra_link", "triggered_dag_run", "task", "session"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_with_scheduled_dag_run", "ret_exprs": [], "ret_type": "", "variables": {"dag_run": "", "dagruns": "", "run_id": "", "task": "", "triggered_dag_run": "", "utc_now": ""}, "variables_p": {"dag_run": [["int", 0.19991400905780599], ["dict", 0.18993630819026336], ["raiden.transfer.state.BalanceProofSignedState", 0.12403130453073852], ["Type[tuple]", 0.10672068006591276], ["Dict[str, int]", 0.09974114745531248]], "dagruns": [["int", 0.6325430029780073], ["Union[Literal, int]", 0.12752396078691752], ["Type[insta.models.Image]", 0.08403113818396357], ["list", 0.06827709827139009]], "run_id": [["Optional[int]", 0.06534028681735941], ["Callable(id)[[object], int]", 0.039357868124095294]], "task": [["bytes", 0.09363575355198461]], "triggered_dag_run": [["int", 0.09983803205995095]], "utc_now": [["tagstore.models.entity.EntityId", 0.39427508065212735], ["Optional[magic.models.deck.Deck]", 0.20217066617710353], ["str", 0.10706491513535475]]}}, {"docstring": {"func": "Test TriggerDagRunOperator with templated execution_date.", "long_descr": null, "ret": null}, "fn_lc": [[216, 4], [232, 68]], "fn_var_ln": {"dagruns": [[227, 12], [227, 19]], "task": [[218, 8], [218, 12]], "triggered_dag_run": [[229, 12], [229, 29]]}, "fn_var_occur": {"dagruns": [["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["len", "dagruns"], ["triggered_dag_run", "dagruns"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "dag", "self", "dag"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"], ["self", "assert_extra_link", "triggered_dag_run", "task", "session"]], "triggered_dag_run": [["triggered_dag_run", "dagruns"], ["triggered_dag_run", "external_trigger"], ["triggered_dag_run", "execution_date", "DEFAULT_DATE"], ["self", "assert_extra_link", "triggered_dag_run", "task", "session"]]}, "name": "test_trigger_dagrun_with_templated_execution_date", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "dag", "self", "dag"], ["self", "assert_extra_link", "triggered_dag_run", "task", "session"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_with_templated_execution_date", "ret_exprs": [], "ret_type": "", "variables": {"dagruns": "", "task": "", "triggered_dag_run": ""}, "variables_p": {"dagruns": [["int", 0.6325430029780073], ["Union[Literal, int]", 0.12752396078691752], ["Type[insta.models.Image]", 0.08403113818396357], ["list", 0.06827709827139009]], "task": [["taskiapplication.models.task.Task", 0.19797241879616284]], "triggered_dag_run": []}}, {"docstring": {"func": "Test passing conf to the triggered DagRun.", "long_descr": null, "ret": null}, "fn_lc": [[234, 4], [247, 52]], "fn_var_ln": {"dagruns": [[245, 12], [245, 19]], "task": [[236, 8], [236, 12]]}, "fn_var_occur": {"dagruns": [["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["len", "dagruns"], ["dagruns", "conf"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "conf", "dag", "self", "dag"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"]]}, "name": "test_trigger_dagrun_operator_conf", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "conf", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_operator_conf", "ret_exprs": [], "ret_type": "", "variables": {"dagruns": "", "task": ""}, "variables_p": {"dagruns": [["int", 0.6325430029780073], ["Union[Literal, int]", 0.12752396078691752], ["Type[insta.models.Image]", 0.08403113818396357], ["list", 0.06827709827139009]], "task": [["src.models.generic_task.GenericTask", 0.09198862685820801], ["str", 0.0878149673323855], ["Dict[str, Any]", 0.08313262196853548]]}}, {"docstring": {"func": "Test passing a conf that is not JSON Serializable raise error.", "long_descr": null, "ret": null}, "fn_lc": [[249, 4], [258, 68]], "fn_var_ln": {"task": [[251, 8], [251, 12]]}, "fn_var_occur": {"task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "conf", "timezone", "utcnow", "dag", "self", "dag"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"]]}, "name": "test_trigger_dagrun_operator_templated_invalid_conf", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "conf", "timezone", "utcnow", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_operator_templated_invalid_conf", "ret_exprs": [], "ret_type": "", "variables": {"task": ""}, "variables_p": {"task": [["str", 0.1134799099751517], ["Tuple[int]", 0.1001222247372896], ["buza.models.Answer", 0.09799206495291155], ["bytes", 0.09604121591435029]]}}, {"docstring": {"func": "Test passing a templated conf to the triggered DagRun.", "long_descr": null, "ret": null}, "fn_lc": [[260, 4], [273, 58]], "fn_var_ln": {"dagruns": [[271, 12], [271, 19]], "task": [[262, 8], [262, 12]]}, "fn_var_occur": {"dagruns": [["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["len", "dagruns"], ["dagruns", "conf", "TEST_DAG_ID"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "conf", "dag", "self", "dag"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"]]}, "name": "test_trigger_dagrun_operator_templated_conf", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "conf", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_operator_templated_conf", "ret_exprs": [], "ret_type": "", "variables": {"dagruns": "", "task": ""}, "variables_p": {"dagruns": [["int", 0.6491713042391168], ["Type[insta.models.Image]", 0.09501129181506433], ["Union[Literal, int]", 0.0922517176139589], ["defaultdict", 0.07271547209641137]], "task": [["src.models.generic_task.GenericTask", 0.09198862685820801], ["str", 0.0878149673323855], ["Dict[str, Any]", 0.08313262196853548]]}}, {"docstring": {"func": "Test TriggerDagRunOperator with reset_dag_run.", "long_descr": null, "ret": null}, "fn_lc": [[275, 4], [288, 94]], "fn_var_ln": {"execution_date": [[277, 8], [277, 22]], "task": [[278, 8], [278, 12]]}, "fn_var_occur": {"execution_date": [["execution_date", "DEFAULT_DATE"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "reset_dag_run", "False", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date", "ignore_ti_state", "True"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date", "ignore_ti_state", "True"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "reset_dag_run", "False", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date", "ignore_ti_state", "True"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date", "ignore_ti_state", "True"]]}, "name": "test_trigger_dagrun_with_reset_dag_run_false", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "reset_dag_run", "False", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_with_reset_dag_run_false", "ret_exprs": [], "ret_type": "", "variables": {"execution_date": "", "task": ""}, "variables_p": {"execution_date": [["int", 0.48182992963022], ["cmk.utils.type_defs.UserId", 0.11751003551168364], ["Iterator[Any]", 0.10549463121397995], ["Optional[int]", 0.10323038730742681], ["datetime.datetime.datetime", 0.10281343603167843], ["str", 0.08912158030501129]], "task": [["khetha.models.Task", 0.19618803450450806]]}}, {"docstring": {"func": "Test TriggerDagRunOperator with reset_dag_run.", "long_descr": null, "ret": null}, "fn_lc": [[290, 4], [306, 46]], "fn_var_ln": {"dagruns": [[304, 12], [304, 19]], "execution_date": [[292, 8], [292, 22]], "task": [[293, 8], [293, 12]]}, "fn_var_occur": {"dagruns": [["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["len", "dagruns"], ["dagruns", "external_trigger"]], "execution_date": [["execution_date", "DEFAULT_DATE"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "reset_dag_run", "True", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date", "ignore_ti_state", "True"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date", "ignore_ti_state", "True"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "reset_dag_run", "True", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date", "ignore_ti_state", "True"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date", "ignore_ti_state", "True"]]}, "name": "test_trigger_dagrun_with_reset_dag_run_true", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "reset_dag_run", "True", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_with_reset_dag_run_true", "ret_exprs": [], "ret_type": "", "variables": {"dagruns": "", "execution_date": "", "task": ""}, "variables_p": {"dagruns": [["int", 0.6325430029780073], ["Union[Literal, int]", 0.12752396078691752], ["Type[insta.models.Image]", 0.08403113818396357], ["list", 0.06827709827139009]], "execution_date": [["int", 0.48182992963022], ["cmk.utils.type_defs.UserId", 0.11751003551168364], ["Iterator[Any]", 0.10549463121397995], ["Optional[int]", 0.10323038730742681], ["datetime.datetime.datetime", 0.10281343603167843], ["str", 0.08912158030501129]], "task": [["buza.models.Answer", 0.08822923461485567]]}}, {"docstring": {"func": "Test TriggerDagRunOperator with wait_for_completion.", "long_descr": null, "ret": null}, "fn_lc": [[308, 4], [324, 36]], "fn_var_ln": {"dagruns": [[323, 12], [323, 19]], "execution_date": [[310, 8], [310, 22]], "task": [[311, 8], [311, 12]]}, "fn_var_occur": {"dagruns": [["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["len", "dagruns"]], "execution_date": [["execution_date", "DEFAULT_DATE"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "QUEUED", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "QUEUED", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"]]}, "name": "test_trigger_dagrun_with_wait_for_completion_true", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "QUEUED", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_with_wait_for_completion_true", "ret_exprs": [], "ret_type": "", "variables": {"dagruns": "", "execution_date": "", "task": ""}, "variables_p": {"dagruns": [["int", 0.6325430029780073], ["Union[Literal, int]", 0.12752396078691752], ["Type[insta.models.Image]", 0.08403113818396357], ["list", 0.06827709827139009]], "execution_date": [["int", 0.48182992963022], ["cmk.utils.type_defs.UserId", 0.11751003551168364], ["Iterator[Any]", 0.10549463121397995], ["Optional[int]", 0.10323038730742681], ["datetime.datetime.datetime", 0.10281343603167843], ["str", 0.08912158030501129]], "task": [["khetha.models.Task", 0.20298569786300144]]}}, {"docstring": {"func": "Test TriggerDagRunOperator with wait_for_completion but triggered dag fails.", "long_descr": null, "ret": null}, "fn_lc": [[326, 4], [339, 72]], "fn_var_ln": {"execution_date": [[328, 8], [328, 22]], "task": [[329, 8], [329, 12]]}, "fn_var_occur": {"execution_date": [["execution_date", "DEFAULT_DATE"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "failed_states", "State", "QUEUED", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "failed_states", "State", "QUEUED", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"]]}, "name": "test_trigger_dagrun_with_wait_for_completion_true_fail", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "failed_states", "State", "QUEUED", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_with_wait_for_completion_true_fail", "ret_exprs": [], "ret_type": "", "variables": {"execution_date": "", "task": ""}, "variables_p": {"execution_date": [["int", 0.48182992963022], ["cmk.utils.type_defs.UserId", 0.11751003551168364], ["Iterator[Any]", 0.10549463121397995], ["Optional[int]", 0.10323038730742681], ["datetime.datetime.datetime", 0.10281343603167843], ["str", 0.08912158030501129]], "task": [["khetha.models.Task", 0.20298569786300144]]}}, {"docstring": {"func": "Test TriggerDagRunOperator that triggers itself", "long_descr": null, "ret": null}, "fn_lc": [[341, 4], [361, 68]], "fn_var_ln": {"dagruns": [[352, 12], [352, 19]], "execution_date": [[343, 8], [343, 22]], "task": [[344, 8], [344, 12]], "triggered_dag_run": [[359, 12], [359, 29]]}, "fn_var_occur": {"dagruns": [["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "self", "dag", "dag_id", "order_by", "DagRun", "execution_date", "all"], ["len", "dagruns"], ["triggered_dag_run", "dagruns"]], "execution_date": [["execution_date", "DEFAULT_DATE"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"], ["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "self", "dag", "dag_id", "order_by", "DagRun", "execution_date", "all"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "self", "dag", "dag_id", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"], ["self", "assert_extra_link", "triggered_dag_run", "task", "session"]], "triggered_dag_run": [["triggered_dag_run", "dagruns"], ["triggered_dag_run", "state", "State", "QUEUED"], ["self", "assert_extra_link", "triggered_dag_run", "task", "session"]]}, "name": "test_trigger_dagrun_triggering_itself", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "self", "dag", "dag_id", "dag", "self", "dag"], ["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "self", "dag", "dag_id", "order_by", "DagRun", "execution_date", "all"], ["self", "assert_extra_link", "triggered_dag_run", "task", "session"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_triggering_itself", "ret_exprs": [], "ret_type": "", "variables": {"dagruns": "", "execution_date": "", "task": "", "triggered_dag_run": ""}, "variables_p": {"dagruns": [["Dict[str, Any]", 0.20995704727242007], ["int", 0.18228884358730857], ["alerta.models.alerAlert", 0.11032850189754517], ["dict", 0.10396110520709294], ["Type[ddionrails.workspace.models.baskeBasket]", 0.08542407310985094], ["Type[bootcamp.qa.models.Question]", 0.08419534230549552]], "execution_date": [["int", 0.14663506335752888], ["datetime.datetime", 0.09959765749899212], ["datetime.date", 0.09513747004948554], ["Type[prm.journals.models.moods.Mood]", 0.09442079580433803], ["datetime.datetime.datetime", 0.09378106073195065], ["datetime.timedelta", 0.09206941496310714], ["Optional[str]", 0.08955717794466778]], "task": [["kippo.tasks.models.KippoTask", 0.1718137995690515]], "triggered_dag_run": [["int", 0.20603170653780767]]}}, {"docstring": {"func": "Test TriggerDagRunOperator that triggers itself with execution date,", "long_descr": "fails with DagRunAlreadyExists", "ret": null}, "fn_lc": [[363, 4], [374, 72]], "fn_var_ln": {"execution_date": [[366, 8], [366, 22]], "task": [[367, 8], [367, 12]]}, "fn_var_occur": {"execution_date": [["execution_date", "DEFAULT_DATE"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "self", "dag", "dag_id", "execution_date", "execution_date", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "self", "dag", "dag_id", "execution_date", "execution_date", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"]]}, "name": "test_trigger_dagrun_triggering_itself_with_execution_date", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "self", "dag", "dag_id", "execution_date", "execution_date", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_triggering_itself_with_execution_date", "ret_exprs": [], "ret_type": "", "variables": {"execution_date": "", "task": ""}, "variables_p": {"execution_date": [["int", 0.420932567325739], ["str", 0.1896048912230423], ["datetime.datetime.datetime", 0.10210336149860334], ["Tuple[int, int, int]", 0.09655607858245334], ["datetime.date.time", 0.09560977413510262], ["raiden.transfer.state.BalanceProofSignedState", 0.09519332723505954]], "task": [["kippo.tasks.models.KippoTask", 0.18000404103615247], ["src.models.generic_task.GenericTask", 0.09256632809383933], ["taskiapplication.models.task.Task", 0.07549314330698406]]}}, {"docstring": {"func": "Test TriggerDagRunOperator with wait_for_completion.", "long_descr": null, "ret": null}, "fn_lc": [[376, 4], [393, 36]], "fn_var_ln": {"dagruns": [[392, 12], [392, 19]], "execution_date": [[378, 8], [378, 22]], "task": [[379, 8], [379, 12]]}, "fn_var_occur": {"dagruns": [["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["len", "dagruns"]], "execution_date": [["execution_date", "DEFAULT_DATE"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "QUEUED", "deferrable", "False", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "QUEUED", "deferrable", "False", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"]]}, "name": "test_trigger_dagrun_with_wait_for_completion_true_defer_false", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "QUEUED", "deferrable", "False", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_with_wait_for_completion_true_defer_false", "ret_exprs": [], "ret_type": "", "variables": {"dagruns": "", "execution_date": "", "task": ""}, "variables_p": {"dagruns": [["int", 0.6325430029780073], ["Union[Literal, int]", 0.12752396078691752], ["Type[insta.models.Image]", 0.08403113818396357], ["list", 0.06827709827139009]], "execution_date": [["int", 0.48182992963022], ["cmk.utils.type_defs.UserId", 0.11751003551168364], ["Iterator[Any]", 0.10549463121397995], ["Optional[int]", 0.10323038730742681], ["datetime.datetime.datetime", 0.10281343603167843], ["str", 0.08912158030501129]], "task": [["khetha.models.Task", 0.20298569786300144]]}}, {"docstring": {"func": "Test TriggerDagRunOperator with wait_for_completion.", "long_descr": null, "ret": null}, "fn_lc": [[395, 4], [421, 68]], "fn_var_ln": {"dagruns": [[412, 12], [412, 19]], "execution_date": [[397, 8], [397, 22]], "task": [[398, 8], [398, 12]], "trigger": [[414, 8], [414, 15]]}, "fn_var_occur": {"dagruns": [["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["len", "dagruns"]], "execution_date": [["execution_date", "DEFAULT_DATE"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "QUEUED", "deferrable", "True", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "QUEUED", "deferrable", "True", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"], ["task", "execute_complete", "context", "event", "trigger", "serialize"]], "trigger": [["trigger", "DagStateTrigger", "dag_id", "execution_dates", "DEFAULT_DATE", "poll_interval", "states"], ["task", "execute_complete", "context", "event", "trigger", "serialize"]]}, "name": "test_trigger_dagrun_with_wait_for_completion_true_defer_true", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "QUEUED", "deferrable", "True", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_with_wait_for_completion_true_defer_true", "ret_exprs": [], "ret_type": "", "variables": {"dagruns": "", "execution_date": "", "task": "", "trigger": ""}, "variables_p": {"dagruns": [["int", 0.6325430029780073], ["Union[Literal, int]", 0.12752396078691752], ["Type[insta.models.Image]", 0.08403113818396357], ["list", 0.06827709827139009]], "execution_date": [["int", 0.48182992963022], ["cmk.utils.type_defs.UserId", 0.11751003551168364], ["Iterator[Any]", 0.10549463121397995], ["Optional[int]", 0.10323038730742681], ["datetime.datetime.datetime", 0.10281343603167843], ["str", 0.08912158030501129]], "task": [["khetha.models.Task", 0.20298569786300144]], "trigger": [["List[int]", 0.11646012045217695], ["str", 0.0984065326922349], ["list", 0.09225584918505875]]}}, {"docstring": {"func": "Test TriggerDagRunOperator wait_for_completion dag run in non defined state.", "long_descr": null, "ret": null}, "fn_lc": [[423, 4], [454, 54]], "fn_var_ln": {"dagruns": [[440, 12], [440, 19]], "execution_date": [[425, 8], [425, 22]], "task": [[426, 8], [426, 12]], "trigger": [[443, 8], [443, 15]]}, "fn_var_occur": {"dagruns": [["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["len", "dagruns"]], "execution_date": [["execution_date", "DEFAULT_DATE"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "SUCCESS", "deferrable", "True", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "SUCCESS", "deferrable", "True", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"], ["task", "execute_complete", "context", "event", "trigger", "serialize"]], "trigger": [["trigger", "DagStateTrigger", "dag_id", "execution_dates", "DEFAULT_DATE", "poll_interval", "states"], ["task", "execute_complete", "context", "event", "trigger", "serialize"]]}, "name": "test_trigger_dagrun_with_wait_for_completion_true_defer_true_failure", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "SUCCESS", "deferrable", "True", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_with_wait_for_completion_true_defer_true_failure", "ret_exprs": [], "ret_type": "", "variables": {"dagruns": "", "execution_date": "", "task": "", "trigger": ""}, "variables_p": {"dagruns": [["int", 0.6325430029780073], ["Union[Literal, int]", 0.12752396078691752], ["Type[insta.models.Image]", 0.08403113818396357], ["list", 0.06827709827139009]], "execution_date": [["int", 0.48182992963022], ["cmk.utils.type_defs.UserId", 0.11751003551168364], ["Iterator[Any]", 0.10549463121397995], ["Optional[int]", 0.10323038730742681], ["datetime.datetime.datetime", 0.10281343603167843], ["str", 0.08912158030501129]], "task": [["khetha.models.Task", 0.20298569786300144]], "trigger": [["List[int]", 0.11646012045217695], ["str", 0.0984065326922349], ["list", 0.09225584918505875]]}}, {"docstring": {"func": "Test TriggerDagRunOperator  wait_for_completion dag run in failed state.", "long_descr": null, "ret": null}, "fn_lc": [[456, 4], [487, 63]], "fn_var_ln": {"dagruns": [[474, 12], [474, 19]], "execution_date": [[458, 8], [458, 22]], "task": [[459, 8], [459, 12]], "trigger": [[477, 8], [477, 15]]}, "fn_var_occur": {"dagruns": [["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["len", "dagruns"]], "execution_date": [["execution_date", "DEFAULT_DATE"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "SUCCESS", "failed_states", "State", "QUEUED", "deferrable", "True", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"]], "task": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "SUCCESS", "failed_states", "State", "QUEUED", "deferrable", "True", "dag", "self", "dag"], ["task", "run", "start_date", "execution_date", "end_date", "execution_date"], ["task", "execute_complete", "context", "event", "trigger", "serialize"]], "trigger": [["trigger", "DagStateTrigger", "dag_id", "execution_dates", "DEFAULT_DATE", "poll_interval", "states"], ["task", "execute_complete", "context", "event", "trigger", "serialize"]]}, "name": "test_trigger_dagrun_with_wait_for_completion_true_defer_true_failure_2", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "SUCCESS", "failed_states", "State", "QUEUED", "deferrable", "True", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDagRunOperator.test_trigger_dagrun_with_wait_for_completion_true_defer_true_failure_2", "ret_exprs": [], "ret_type": "", "variables": {"dagruns": "", "execution_date": "", "task": "", "trigger": ""}, "variables_p": {"dagruns": [["int", 0.6325430029780073], ["Union[Literal, int]", 0.12752396078691752], ["Type[insta.models.Image]", 0.08403113818396357], ["list", 0.06827709827139009]], "execution_date": [["int", 0.48182992963022], ["cmk.utils.type_defs.UserId", 0.11751003551168364], ["Iterator[Any]", 0.10549463121397995], ["Optional[int]", 0.10323038730742681], ["datetime.datetime.datetime", 0.10281343603167843], ["str", 0.08912158030501129]], "task": [["khetha.models.Task", 0.20298569786300144]], "trigger": [["List[int]", 0.11646012045217695], ["str", 0.0984065326922349], ["list", 0.09225584918505875]]}}], "name": "TestDagRunOperator", "q_name": "TestDagRunOperator", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["__future__", "annotations", "pathlib", "tempfile", "datetime", "datetime", "unittest", "mock", "pytest", "airflow", "exceptions", "AirflowException", "DagRunAlreadyExists", "airflow", "models", "DAG", "DagBag", "DagModel", "DagRun", "Log", "TaskInstance", "airflow", "models", "serialized_dag", "SerializedDagModel", "airflow", "operators", "trigger_dagrun", "TriggerDagRunOperator", "airflow", "triggers", "external_task", "DagStateTrigger", "airflow", "utils", "timezone", "airflow", "utils", "session", "create_session", "airflow", "utils", "state", "State", "airflow", "utils", "types", "DagRunType"], "mod_var_ln": {"DAG_SCRIPT": [[40, 0], [40, 10]], "DEFAULT_DATE": [[37, 0], [37, 12]], "TEST_DAG_ID": [[38, 0], [38, 11]], "TRIGGERED_DAG_ID": [[39, 0], [39, 16]]}, "mod_var_occur": {"DAG_SCRIPT": [["f", "write", "DAG_SCRIPT"]], "DEFAULT_DATE": [["self", "dag", "DAG", "TEST_DAG_ID", "default_args", "DEFAULT_DATE"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"], ["triggered_dag_run", "execution_date", "DEFAULT_DATE"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"], ["execution_date", "DEFAULT_DATE"], ["execution_date", "DEFAULT_DATE"], ["execution_date", "DEFAULT_DATE"], ["execution_date", "DEFAULT_DATE"], ["execution_date", "DEFAULT_DATE"], ["execution_date", "DEFAULT_DATE"], ["execution_date", "DEFAULT_DATE"], ["execution_date", "DEFAULT_DATE"], ["trigger", "DagStateTrigger", "dag_id", "execution_dates", "DEFAULT_DATE", "poll_interval", "states"], ["execution_date", "DEFAULT_DATE"], ["trigger", "DagStateTrigger", "dag_id", "execution_dates", "DEFAULT_DATE", "poll_interval", "states"], ["execution_date", "DEFAULT_DATE"], ["trigger", "DagStateTrigger", "dag_id", "execution_dates", "DEFAULT_DATE", "poll_interval", "states"]], "TEST_DAG_ID": [["self", "dag", "DAG", "TEST_DAG_ID", "default_args", "DEFAULT_DATE"], ["session", "query", "Log", "filter", "Log", "dag_id", "TEST_DAG_ID", "delete", "synchronize_session", "False"], ["session", "query", "dbmodel", "filter", "dbmodel", "dag_id", "in_", "TRIGGERED_DAG_ID", "TEST_DAG_ID", "delete", "synchronize_session", "False"], ["dagruns", "conf", "TEST_DAG_ID"]], "TRIGGERED_DAG_ID": [["DAG_SCRIPT", "format", "dag_id", "TRIGGERED_DAG_ID"], ["session", "add", "DagModel", "dag_id", "TRIGGERED_DAG_ID", "fileloc", "self", "_tmpfile"], ["session", "query", "dbmodel", "filter", "dbmodel", "dag_id", "in_", "TRIGGERED_DAG_ID", "TEST_DAG_ID", "delete", "synchronize_session", "False"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "dag", "self", "dag"], ["dagrun", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "one"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "trigger_run_id", "dag", "self", "dag"], ["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "custom_execution_date", "dag", "self", "dag"], ["dagrun", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "one"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "dag", "self", "dag", "poke_interval", "reset_dag_run", "True", "wait_for_completion", "True"], ["dag_run", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "state", "State", "SUCCESS", "run_type", "run_id", "run_id"], ["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "dag", "self", "dag", "poke_interval", "reset_dag_run", "True", "wait_for_completion", "True"], ["dag_run", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "execution_date", "utc_now", "state", "State", "SUCCESS", "run_type", "run_id", "run_id"], ["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "dag", "self", "dag"], ["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "conf", "dag", "self", "dag"], ["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "conf", "timezone", "utcnow", "dag", "self", "dag"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "conf", "dag", "self", "dag"], ["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "reset_dag_run", "False", "dag", "self", "dag"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "reset_dag_run", "True", "dag", "self", "dag"], ["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "QUEUED", "dag", "self", "dag"], ["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "failed_states", "State", "QUEUED", "dag", "self", "dag"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "QUEUED", "deferrable", "False", "dag", "self", "dag"], ["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "QUEUED", "deferrable", "True", "dag", "self", "dag"], ["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "SUCCESS", "deferrable", "True", "dag", "self", "dag"], ["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"], ["task", "TriggerDagRunOperator", "task_id", "trigger_dag_id", "TRIGGERED_DAG_ID", "execution_date", "execution_date", "wait_for_completion", "True", "poke_interval", "allowed_states", "State", "SUCCESS", "failed_states", "State", "QUEUED", "deferrable", "True", "dag", "self", "dag"], ["dagruns", "session", "query", "DagRun", "filter", "DagRun", "dag_id", "TRIGGERED_DAG_ID", "all"]]}, "no_types_annot": {"D": 0, "I": 0, "U": 94}, "session_id": "n0lbHfZICV0OFhyLe_IraKTcOjvS6AmfFjHk_sP4-cc", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"DAG_SCRIPT": "", "DEFAULT_DATE": "", "TEST_DAG_ID": "", "TRIGGERED_DAG_ID": ""}, "variables_p": {"DAG_SCRIPT": [["str", 0.9999999999999999]], "DEFAULT_DATE": [["str", 0.5132252483649141], ["datetime.datetime.datetime", 0.10725717093093566], ["Optional[str]", 0.0979825228614306], ["dict", 0.09136570473965373]], "TEST_DAG_ID": [["str", 0.9027725708405443], ["float", 0.09722742915945573]], "TRIGGERED_DAG_ID": [["set", 0.6457214918934673], ["list", 0.24808601616156506], ["Set[int]", 0.10619249194496773]]}}}