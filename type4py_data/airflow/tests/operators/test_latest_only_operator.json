{"error": null, "response": {"classes": [{"cls_lc": [[52, 0], [206, 42]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[54, 4], [56, 23]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "clean_db", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestLatestOnlyOperator.clean_db", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[58, 4], [59, 23]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "setup_class", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "clean_db"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestLatestOnlyOperator.setup_class", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[61, 4], [68, 28]], "fn_var_ln": {"dag": [[62, 8], [62, 16]], "freezer": [[67, 8], [67, 20]]}, "fn_var_occur": {"dag": [["self", "dag", "DAG", "default_args", "DEFAULT_DATE", "schedule", "INTERVAL"]], "freezer": [["self", "freezer", "time_machine", "travel", "FROZEN_NOW", "tick", "False"], ["self", "freezer", "start"]]}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "dag", "DAG", "default_args", "DEFAULT_DATE", "schedule", "INTERVAL"], ["self", "freezer", "time_machine", "travel", "FROZEN_NOW", "tick", "False"], ["self", "freezer", "start"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestLatestOnlyOperator.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "freezer": ""}, "variables_p": {"dag": [["bool", 0.1112778246631051], ["Optional[int]", 0.10425459590324088], ["Optional[datetime.datetime]", 0.10422043349494478], ["recidiviz.calculator.pipeline.utils.incarceration_period_index.IncarcerationPeriodIndex", 0.09926085855519212], ["str", 0.09600074522287037], ["datetime.datetime", 0.09462196868171527]], "freezer": [["Dict[str, str]", 0.19721193378515595], ["int", 0.17920439307703287], ["str", 0.12146431729024786], ["bool", 0.11029364446658889], ["Optional[str]", 0.11029364446658889]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[70, 4], [72, 23]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "teardown_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "freezer", "stop"], ["self", "clean_db"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestLatestOnlyOperator.teardown_method", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[74, 4], [76, 64]], "fn_var_ln": {"task": [[75, 8], [75, 12]]}, "fn_var_occur": {"task": [["task", "LatestOnlyOperator", "task_id", "dag", "self", "dag"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"]]}, "name": "test_run", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "LatestOnlyOperator", "task_id", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestLatestOnlyOperator.test_run", "ret_exprs": [], "ret_type": "", "variables": {"task": ""}, "variables_p": {"task": [["dict", 0.15606475506323514], ["khetha.models.Task", 0.0845058270730219], ["Dict[str, Any]", 0.07701057257127565], ["Dict[datetime.date, Dict[str, float]]", 0.0737533307369491]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[78, 4], [146, 42]], "fn_var_ln": {"downstream_instances": [[140, 8], [140, 28]], "downstream_task": [[80, 8], [80, 23]], "downstream_task2": [[81, 8], [81, 24]], "downstream_task3": [[82, 8], [82, 24]], "exec_date_to_downstream_state": [[141, 8], [141, 37]], "exec_date_to_latest_state": [[117, 8], [117, 33]], "latest_instances": [[116, 8], [116, 24]], "latest_task": [[79, 8], [79, 19]]}, "fn_var_occur": {"downstream_instances": [["downstream_instances", "get_task_instances"], ["exec_date_to_downstream_state", "ti", "execution_date", "ti", "state", "ti", "downstream_instances"], ["downstream_instances", "get_task_instances"], ["exec_date_to_downstream_state", "ti", "execution_date", "ti", "state", "ti", "downstream_instances"], ["downstream_instances", "get_task_instances"], ["exec_date_to_downstream_state", "ti", "execution_date", "ti", "state", "ti", "downstream_instances"]], "downstream_task": [["downstream_task", "EmptyOperator", "task_id", "dag", "self", "dag"], ["downstream_task", "set_upstream", "latest_task"], ["downstream_task2", "set_upstream", "downstream_task"], ["downstream_task3", "set_upstream", "downstream_task"], ["downstream_task", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"]], "downstream_task2": [["downstream_task2", "EmptyOperator", "task_id", "dag", "self", "dag"], ["downstream_task2", "set_upstream", "downstream_task"], ["downstream_task2", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"]], "downstream_task3": [["downstream_task3", "EmptyOperator", "task_id", "trigger_rule", "TriggerRule", "NONE_FAILED", "dag", "self", "dag"], ["downstream_task3", "set_upstream", "downstream_task"], ["downstream_task3", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"]], "exec_date_to_downstream_state": [["exec_date_to_downstream_state", "ti", "execution_date", "ti", "state", "ti", "downstream_instances"], ["timezone", "datetime", "timezone", "datetime", "timezone", "datetime", "exec_date_to_downstream_state"], ["exec_date_to_downstream_state", "ti", "execution_date", "ti", "state", "ti", "downstream_instances"], ["timezone", "datetime", "None", "timezone", "datetime", "None", "timezone", "datetime", "exec_date_to_downstream_state"], ["exec_date_to_downstream_state", "ti", "execution_date", "ti", "state", "ti", "downstream_instances"], ["timezone", "datetime", "timezone", "datetime", "timezone", "datetime", "exec_date_to_downstream_state"]], "exec_date_to_latest_state": [["exec_date_to_latest_state", "ti", "execution_date", "ti", "state", "ti", "latest_instances"], ["timezone", "datetime", "timezone", "datetime", "timezone", "datetime", "exec_date_to_latest_state"]], "latest_instances": [["latest_instances", "get_task_instances"], ["exec_date_to_latest_state", "ti", "execution_date", "ti", "state", "ti", "latest_instances"]], "latest_task": [["latest_task", "LatestOnlyOperator", "task_id", "dag", "self", "dag"], ["downstream_task", "set_upstream", "latest_task"], ["latest_task", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"]]}, "name": "test_skipping_non_latest", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["latest_task", "LatestOnlyOperator", "task_id", "dag", "self", "dag"], ["downstream_task", "EmptyOperator", "task_id", "dag", "self", "dag"], ["downstream_task2", "EmptyOperator", "task_id", "dag", "self", "dag"], ["downstream_task3", "EmptyOperator", "task_id", "trigger_rule", "TriggerRule", "NONE_FAILED", "dag", "self", "dag"], ["self", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "start_date", "timezone", "utcnow", "execution_date", "DEFAULT_DATE", "state", "State", "RUNNING"], ["self", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "start_date", "timezone", "utcnow", "execution_date", "timezone", "datetime", "state", "State", "RUNNING"], ["self", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "start_date", "timezone", "utcnow", "execution_date", "END_DATE", "state", "State", "RUNNING"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestLatestOnlyOperator.test_skipping_non_latest", "ret_exprs": [], "ret_type": "", "variables": {"downstream_instances": "", "downstream_task": "", "downstream_task2": "", "downstream_task3": "", "exec_date_to_downstream_state": "", "exec_date_to_latest_state": "", "latest_instances": "", "latest_task": ""}, "variables_p": {"downstream_instances": [["Dict[str, Callable]", 0.09864504895533728], ["list", 0.09293163958279801], ["Dict[Any, str]", 0.09244044249834445], ["grpy.core.models.Grouping", 0.09143962594718516]], "downstream_task": [["Dict[str, Dict[str, int]]", 0.10047815945447396]], "downstream_task2": [], "downstream_task3": [["Dict[str, Union[Any, bool, str]]", 0.18429830860860266], ["bytes", 0.13656176641616075], ["List[str]", 0.10765877515639322], ["list", 0.09320131597942033], ["RuntimeError", 0.08804997332319649]], "exec_date_to_downstream_state": [["str", 0.20414476749244376], ["list", 0.12495132307284802], ["datetime.datetime.datetime", 0.1079343959921735], ["Iterator[Any]", 0.10102216891887504], ["Type[str]", 0.09752264342534461], ["int", 0.09374532975610655], ["Dict[Any, List[Any]]", 0.08841484012140333]], "exec_date_to_latest_state": [["str", 0.20414476749244376], ["list", 0.12495132307284802], ["datetime.datetime.datetime", 0.1079343959921735], ["Iterator[Any]", 0.10102216891887504], ["Type[str]", 0.09752264342534461], ["int", 0.09374532975610655], ["Dict[Any, List[Any]]", 0.08841484012140333]], "latest_instances": [["ofxtools.models.invessecurities.SECID", 0.17673139755873568], ["list", 0.10025353973758469], ["Dict[str, Callable]", 0.09193993594095269]], "latest_task": []}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[148, 4], [206, 42]], "fn_var_ln": {"downstream_instances": [[200, 8], [200, 28]], "downstream_task": [[150, 8], [150, 23]], "downstream_task2": [[151, 8], [151, 24]], "exec_date_to_downstream_state": [[201, 8], [201, 37]], "exec_date_to_latest_state": [[185, 8], [185, 33]], "latest_instances": [[184, 8], [184, 24]], "latest_task": [[149, 8], [149, 19]]}, "fn_var_occur": {"downstream_instances": [["downstream_instances", "get_task_instances"], ["exec_date_to_downstream_state", "ti", "execution_date", "ti", "state", "ti", "downstream_instances"], ["downstream_instances", "get_task_instances"], ["exec_date_to_downstream_state", "ti", "execution_date", "ti", "state", "ti", "downstream_instances"]], "downstream_task": [["downstream_task", "EmptyOperator", "task_id", "dag", "self", "dag"], ["downstream_task", "set_upstream", "latest_task"], ["downstream_task2", "set_upstream", "downstream_task"], ["downstream_task", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"]], "downstream_task2": [["downstream_task2", "EmptyOperator", "task_id", "dag", "self", "dag"], ["downstream_task2", "set_upstream", "downstream_task"], ["downstream_task2", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"]], "exec_date_to_downstream_state": [["exec_date_to_downstream_state", "ti", "execution_date", "ti", "state", "ti", "downstream_instances"], ["timezone", "datetime", "timezone", "datetime", "timezone", "datetime", "exec_date_to_downstream_state"], ["exec_date_to_downstream_state", "ti", "execution_date", "ti", "state", "ti", "downstream_instances"], ["timezone", "datetime", "timezone", "datetime", "timezone", "datetime", "exec_date_to_downstream_state"]], "exec_date_to_latest_state": [["exec_date_to_latest_state", "ti", "execution_date", "ti", "state", "ti", "latest_instances"], ["timezone", "datetime", "timezone", "datetime", "timezone", "datetime", "exec_date_to_latest_state"]], "latest_instances": [["latest_instances", "get_task_instances"], ["exec_date_to_latest_state", "ti", "execution_date", "ti", "state", "ti", "latest_instances"]], "latest_task": [["latest_task", "LatestOnlyOperator", "task_id", "dag", "self", "dag"], ["downstream_task", "set_upstream", "latest_task"], ["latest_task", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"]]}, "name": "test_not_skipping_external", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["latest_task", "LatestOnlyOperator", "task_id", "dag", "self", "dag"], ["downstream_task", "EmptyOperator", "task_id", "dag", "self", "dag"], ["downstream_task2", "EmptyOperator", "task_id", "dag", "self", "dag"], ["self", "dag", "create_dagrun", "run_type", "DagRunType", "MANUAL", "start_date", "timezone", "utcnow", "execution_date", "DEFAULT_DATE", "state", "State", "RUNNING", "external_trigger", "True"], ["self", "dag", "create_dagrun", "run_type", "DagRunType", "MANUAL", "start_date", "timezone", "utcnow", "execution_date", "timezone", "datetime", "state", "State", "RUNNING", "external_trigger", "True"], ["self", "dag", "create_dagrun", "run_type", "DagRunType", "MANUAL", "start_date", "timezone", "utcnow", "execution_date", "END_DATE", "state", "State", "RUNNING", "external_trigger", "True"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestLatestOnlyOperator.test_not_skipping_external", "ret_exprs": [], "ret_type": "", "variables": {"downstream_instances": "", "downstream_task": "", "downstream_task2": "", "exec_date_to_downstream_state": "", "exec_date_to_latest_state": "", "latest_instances": "", "latest_task": ""}, "variables_p": {"downstream_instances": [["Dict[str, Callable]", 0.09864504895533728], ["list", 0.09293163958279801], ["Dict[Any, str]", 0.09244044249834445], ["grpy.core.models.Grouping", 0.09143962594718516]], "downstream_task": [["Dict[str, Dict[str, int]]", 0.10047815945447396]], "downstream_task2": [], "exec_date_to_downstream_state": [["str", 0.20414476749244376], ["list", 0.12495132307284802], ["datetime.datetime.datetime", 0.1079343959921735], ["Iterator[Any]", 0.10102216891887504], ["Type[str]", 0.09752264342534461], ["int", 0.09374532975610655], ["Dict[Any, List[Any]]", 0.08841484012140333]], "exec_date_to_latest_state": [["str", 0.20414476749244376], ["list", 0.12495132307284802], ["datetime.datetime.datetime", 0.1079343959921735], ["Iterator[Any]", 0.10102216891887504], ["Type[str]", 0.09752264342534461], ["int", 0.09374532975610655], ["Dict[Any, List[Any]]", 0.08841484012140333]], "latest_instances": [["ofxtools.models.invessecurities.SECID", 0.17673139755873568], ["list", 0.10025353973758469], ["Dict[str, Callable]", 0.09193993594095269]], "latest_task": []}}], "name": "TestLatestOnlyOperator", "q_name": "TestLatestOnlyOperator", "variables": {}, "variables_p": {}}], "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[41, 0], [49, 5]], "fn_var_ln": {"session": [[42, 4], [42, 11]]}, "fn_var_occur": {"session": [["session", "settings", "Session"], ["session", "query", "TaskInstance", "join", "TaskInstance", "dag_run", "filter", "TaskInstance", "task_id", "task_id", "order_by", "DagRun", "execution_date", "all"]]}, "name": "get_task_instances", "params": {"task_id": ""}, "params_descr": {"task_id": ""}, "params_occur": {"task_id": [["session", "query", "TaskInstance", "join", "TaskInstance", "dag_run", "filter", "TaskInstance", "task_id", "task_id", "order_by", "DagRun", "execution_date", "all"]]}, "params_p": {"args": [], "kwargs": [], "task_id": [["str", 0.7144543961063035], ["int", 0.1882065029665814], ["MutableMapping", 0.09733910092711513]]}, "q_name": "get_task_instances", "ret_exprs": ["return ( session.query(TaskInstance) .join(TaskInstance.dag_run) .filter(TaskInstance.task_id == task_id) .order_by(DagRun.execution_date) .all())"], "ret_type": "", "ret_type_p": [["bool", 0.19050460104654626], ["List[str]", 0.13153341225886345], ["cmk.utils.type_defs.UserId", 0.12924773075718266], ["str", 0.0933294129613866], ["Union[float, str]", 0.09156095137183433], ["float", 0.09156095137183433]], "variables": {"session": ""}, "variables_p": {"session": []}}], "imports": ["__future__", "annotations", "datetime", "time_machine", "airflow", "settings", "airflow", "models", "DagRun", "TaskInstance", "airflow", "models", "dag", "DAG", "airflow", "operators", "empty", "EmptyOperator", "airflow", "operators", "latest_only", "LatestOnlyOperator", "airflow", "utils", "timezone", "airflow", "utils", "state", "State", "airflow", "utils", "trigger_rule", "TriggerRule", "airflow", "utils", "types", "DagRunType", "tests", "test_utils", "db", "clear_db_runs", "clear_db_xcom"], "mod_var_ln": {"DEFAULT_DATE": [[35, 0], [35, 12]], "END_DATE": [[36, 0], [36, 8]], "FROZEN_NOW": [[38, 0], [38, 10]], "INTERVAL": [[37, 0], [37, 8]]}, "mod_var_occur": {"DEFAULT_DATE": [["self", "dag", "DAG", "default_args", "DEFAULT_DATE", "schedule", "INTERVAL"], ["task", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["self", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "start_date", "timezone", "utcnow", "execution_date", "DEFAULT_DATE", "state", "State", "RUNNING"], ["latest_task", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"], ["downstream_task", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"], ["downstream_task2", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"], ["downstream_task3", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"], ["self", "dag", "create_dagrun", "run_type", "DagRunType", "MANUAL", "start_date", "timezone", "utcnow", "execution_date", "DEFAULT_DATE", "state", "State", "RUNNING", "external_trigger", "True"], ["latest_task", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"], ["downstream_task", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"], ["downstream_task2", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"]], "END_DATE": [["self", "dag", "create_dagrun", "run_type", "DagRunType", "SCHEDULED", "start_date", "timezone", "utcnow", "execution_date", "END_DATE", "state", "State", "RUNNING"], ["latest_task", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"], ["downstream_task", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"], ["downstream_task2", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"], ["downstream_task3", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"], ["self", "dag", "create_dagrun", "run_type", "DagRunType", "MANUAL", "start_date", "timezone", "utcnow", "execution_date", "END_DATE", "state", "State", "RUNNING", "external_trigger", "True"], ["latest_task", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"], ["downstream_task", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"], ["downstream_task2", "run", "start_date", "DEFAULT_DATE", "end_date", "END_DATE"]], "FROZEN_NOW": [["self", "freezer", "time_machine", "travel", "FROZEN_NOW", "tick", "False"]], "INTERVAL": [["self", "dag", "DAG", "default_args", "DEFAULT_DATE", "schedule", "INTERVAL"]]}, "no_types_annot": {"D": 0, "I": 0, "U": 32}, "session_id": "DHDmn3PabwpAEU4iReqqyg-o3PXB6lNTX2kB6TSXrqk", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"DEFAULT_DATE": "", "END_DATE": "", "FROZEN_NOW": "", "INTERVAL": ""}, "variables_p": {"DEFAULT_DATE": [["str", 0.9078744354355344], ["datetime.datetime", 0.09212556456446565]], "END_DATE": [["str", 0.7935565951904731], ["datetime.datetime", 0.10703063389248514], ["datetime.date", 0.09941277091704168]], "FROZEN_NOW": [["str", 0.47511356242083747], ["models.Route", 0.10969734440913627]], "INTERVAL": [["bool", 0.1112778246631051], ["Optional[int]", 0.10425459590324088], ["Optional[datetime.datetime]", 0.10422043349494478], ["recidiviz.calculator.pipeline.utils.incarceration_period_index.IncarcerationPeriodIndex", 0.09926085855519212], ["str", 0.09600074522287037], ["datetime.datetime", 0.09462196868171527]]}}}