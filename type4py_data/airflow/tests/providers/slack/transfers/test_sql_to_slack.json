{"error": null, "response": {"classes": [{"cls_lc": [[58, 8], [62, 20]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[61, 12], [62, 20]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "get_pandas_df", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBaseSqlToSlackOperator.test_get_hook.<locals>.SomeDummyHook.get_pandas_df", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}], "name": "SomeDummyHook", "q_name": "TestBaseSqlToSlackOperator.test_get_hook.<locals>.SomeDummyHook", "variables": {}, "variables_p": {}}, {"cls_lc": [[79, 8], [80, 69]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [], "name": "SomeDummyHook", "q_name": "TestBaseSqlToSlackOperator.test_get_not_supported_hook.<locals>.SomeDummyHook", "variables": {}, "variables_p": {}}, {"cls_lc": [[38, 0], [106, 28]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[39, 4], [45, 9]], "fn_var_ln": {"default_op_kwargs": [[40, 8], [40, 30]]}, "fn_var_occur": {"default_op_kwargs": [["self", "default_op_kwargs", "None", "None"]]}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "default_op_kwargs", "None", "None"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBaseSqlToSlackOperator.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"default_op_kwargs": ""}, "variables_p": {"default_op_kwargs": [["int", 0.4497540423145471], ["Pattern[str]", 0.1728790227788811], ["str", 0.15670306850045562], ["Optional[int]", 0.07477910482417863]]}}, {"docstring": {"func": "Test that no base implementation for ``BaseSqlToSlackOperator.execute()``.", "long_descr": null, "ret": null}, "fn_lc": [[47, 4], [51, 40]], "fn_var_ln": {"op": [[49, 8], [49, 10]]}, "fn_var_occur": {"op": [["op", "BaseSqlToSlackOperator", "task_id", "self", "default_op_kwargs"], ["op", "execute", "mock", "MagicMock"]]}, "name": "test_execute_not_implemented", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["op", "BaseSqlToSlackOperator", "task_id", "self", "default_op_kwargs"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestBaseSqlToSlackOperator.test_execute_not_implemented", "ret_exprs": [], "ret_type": "", "variables": {"op": ""}, "variables_p": {"op": [["Dict[str, Union[Any, bool, str]]", 0.2204449871476218], ["List[str]", 0.15697953254563038], ["bytes", 0.087743107006746], ["List[float]", 0.083167543713545]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[57, 4], [74, 36]], "fn_var_ln": {"expected_hook": [[64, 8], [64, 21]], "hook": [[72, 8], [72, 12]], "op": [[71, 8], [71, 10]], "op_kwargs": [[67, 8], [67, 17]], "return_value": [[66, 8], [66, 34]]}, "fn_var_occur": {"expected_hook": [["expected_hook", "SomeDummyHook"], ["mock_get_hook", "return_value", "expected_hook"], ["hook", "expected_hook"]], "hook": [["hook", "op", "_get_hook"], ["hook", "expected_hook"]], "op": [["op", "BaseSqlToSlackOperator", "task_id", "op_kwargs"], ["hook", "op", "_get_hook"]], "op_kwargs": [["op_kwargs", "self", "default_op_kwargs", "sql_hook_params"], ["op", "BaseSqlToSlackOperator", "task_id", "op_kwargs"]], "return_value": [["mock_get_conn", "return_value", "Connection", "conn_id", "conn_type", "conn_type", "conn_type"], ["mock_get_hook", "return_value", "expected_hook"]]}, "name": "test_get_hook", "params": {"conn_type": "", "mock_get_conn": "", "mock_get_hook": "", "self": "", "sql_hook_params": ""}, "params_descr": {"conn_type": "", "mock_get_conn": "", "mock_get_hook": "", "self": "", "sql_hook_params": ""}, "params_occur": {"conn_type": [["mock_get_conn", "return_value", "Connection", "conn_id", "conn_type", "conn_type", "conn_type"]], "mock_get_conn": [["mock_get_conn", "return_value", "Connection", "conn_id", "conn_type", "conn_type", "conn_type"]], "mock_get_hook": [["mock_get_hook", "return_value", "expected_hook"], ["mock_get_hook", "assert_called_once_with", "hook_params", "sql_hook_params"]], "self": [["op_kwargs", "self", "default_op_kwargs", "sql_hook_params"]], "sql_hook_params": [["op_kwargs", "self", "default_op_kwargs", "sql_hook_params"], ["mock_get_hook", "assert_called_once_with", "hook_params", "sql_hook_params"]]}, "params_p": {"args": [], "conn_type": [], "kwargs": [], "mock_get_conn": [], "mock_get_hook": [], "self": [], "sql_hook_params": [["dict", 0.17160978811729893]]}, "q_name": "TestBaseSqlToSlackOperator.test_get_hook", "ret_exprs": [], "ret_type": "", "variables": {"expected_hook": "", "hook": "", "op": "", "op_kwargs": "", "return_value": ""}, "variables_p": {"expected_hook": [["dict", 0.19396345169938609], ["Type[Dict[Any, Any]]", 0.11009413000422973], ["Tuple[int, int]", 0.10443573300637823], ["str", 0.09388264787528126], ["Dict[str, int]", 0.08869839183338414], ["Dict[str, Dict[str, Any]]", 0.08511122801501257]], "hook": [["int", 0.6114578303258547], ["List[Tuple[str, Any]]", 0.11470391562321179], ["list", 0.09102900583160345]], "op": [["str", 0.16373919395190228], ["List[List[int]]", 0.1585961777670465], ["Pattern[Any]", 0.09780204714511397], ["Dict[str, str]", 0.08460466838917793]], "op_kwargs": [["str", 0.09067177530875457]], "return_value": [["str", 0.20620440035823182], ["Dict[Any, Union[int, str]]", 0.1264960378512645], ["Type[bootcamp.news.models.News]", 0.10216947650600061], ["List[Dict[str, str]]", 0.09971829293387019], ["Dict[str, str]", 0.09633042423065177], ["Dict[str, Union[int, str]]", 0.0930951109723996], ["Dict[str, Any]", 0.0926165962664884]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[78, 4], [87, 26]], "fn_var_ln": {"error_message": [[85, 8], [85, 21]], "op": [[84, 8], [84, 10]], "return_value": [[83, 8], [83, 34]]}, "fn_var_occur": {"error_message": [["pytest", "raises", "AirflowException", "match", "error_message"]], "op": [["op", "BaseSqlToSlackOperator", "task_id", "self", "default_op_kwargs"], ["op", "_get_hook"]], "return_value": [["mock_get_conn", "return_value", "Connection", "conn_id", "conn_type"], ["mock_get_hook", "return_value", "SomeDummyHook"]]}, "name": "test_get_not_supported_hook", "params": {"mock_get_conn": "", "mock_get_hook": "", "self": ""}, "params_descr": {"mock_get_conn": "", "mock_get_hook": "", "self": ""}, "params_occur": {"mock_get_conn": [["mock_get_conn", "return_value", "Connection", "conn_id", "conn_type"]], "mock_get_hook": [["mock_get_hook", "return_value", "SomeDummyHook"]], "self": [["op", "BaseSqlToSlackOperator", "task_id", "self", "default_op_kwargs"]]}, "params_p": {"args": [], "kwargs": [], "mock_get_conn": [], "mock_get_hook": [], "self": []}, "q_name": "TestBaseSqlToSlackOperator.test_get_not_supported_hook", "ret_exprs": [], "ret_type": "", "variables": {"error_message": "", "op": "", "return_value": ""}, "variables_p": {"error_message": [["Pattern[str]", 1.0]], "op": [["List[str]", 0.11723774718348531], ["bytes", 0.09182436378495838], ["models.MedstationData", 0.08892446275544598]], "return_value": [["str", 0.8073521849088142], ["List[Dict[str, str]]", 0.09736767270005796], ["int", 0.09528014239112785]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[92, 4], [106, 28]], "fn_var_ln": {"df": [[104, 8], [104, 10]], "get_pandas_df": [[96, 8], [96, 31]], "mock_get_pandas_df": [[94, 8], [94, 26]], "mock_hook": [[95, 8], [95, 17]], "op": [[103, 8], [103, 10]], "op_kwargs": [[98, 8], [98, 17]], "return_value": [[97, 8], [97, 37]], "test_df": [[93, 8], [93, 15]]}, "fn_var_occur": {"df": [["df", "op", "_get_query_results"], ["df", "test_df"]], "get_pandas_df": [["mock_hook", "get_pandas_df", "mock_get_pandas_df"]], "mock_get_pandas_df": [["mock_get_pandas_df", "mock", "MagicMock", "return_value", "test_df"], ["mock_hook", "get_pandas_df", "mock_get_pandas_df"], ["mock_get_pandas_df", "assert_called_once_with", "sql", "parameters", "parameters"]], "mock_hook": [["mock_hook", "mock", "MagicMock"], ["mock_hook", "get_pandas_df", "mock_get_pandas_df"], ["mock_op_get_hook", "return_value", "mock_hook"]], "op": [["op", "BaseSqlToSlackOperator", "task_id", "op_kwargs"], ["df", "op", "_get_query_results"]], "op_kwargs": [["op_kwargs", "self", "default_op_kwargs", "sql", "parameters"], ["op", "BaseSqlToSlackOperator", "task_id", "op_kwargs"]], "return_value": [["mock_get_pandas_df", "mock", "MagicMock", "return_value", "test_df"], ["mock_op_get_hook", "return_value", "mock_hook"]], "test_df": [["test_df", "pd", "DataFrame", "index"], ["mock_get_pandas_df", "mock", "MagicMock", "return_value", "test_df"], ["df", "test_df"]]}, "name": "test_get_query_results", "params": {"mock_op_get_hook": "", "parameters": "", "self": "", "sql": ""}, "params_descr": {"mock_op_get_hook": "", "parameters": "", "self": "", "sql": ""}, "params_occur": {"mock_op_get_hook": [["mock_op_get_hook", "return_value", "mock_hook"]], "parameters": [["op_kwargs", "self", "default_op_kwargs", "sql", "parameters"], ["mock_get_pandas_df", "assert_called_once_with", "sql", "parameters", "parameters"]], "self": [["op_kwargs", "self", "default_op_kwargs", "sql", "parameters"]], "sql": [["op_kwargs", "self", "default_op_kwargs", "sql", "parameters"], ["mock_get_pandas_df", "assert_called_once_with", "sql", "parameters", "parameters"]]}, "params_p": {"args": [], "kwargs": [], "mock_op_get_hook": [["mock.MagicMock", 0.3024800521612537]], "parameters": [["str", 0.15677264777451635], ["excars.models.user.User", 0.09293148527488067]], "self": [], "sql": [["str", 0.15677264777451635], ["excars.models.user.User", 0.09293148527488067]]}, "q_name": "TestBaseSqlToSlackOperator.test_get_query_results", "ret_exprs": [], "ret_type": "", "variables": {"df": "", "get_pandas_df": "", "mock_get_pandas_df": "", "mock_hook": "", "op": "", "op_kwargs": "", "return_value": "", "test_df": ""}, "variables_p": {"df": [["str", 0.10136520749015712]], "get_pandas_df": [["str", 0.47395349927090513], ["Dict[str, str]", 0.23065001083503983], ["Dict[str, Union[int, str]]", 0.10607619614367637], ["Set[str]", 0.09504266812555437], ["Pattern[str]", 0.09427762562482422]], "mock_get_pandas_df": [], "mock_hook": [], "op": [["List[List[int]]", 0.24279087828206053], ["Dict[str, str]", 0.09403347865439053], ["int", 0.08371854376680704], ["Dict[str, Dict[str, Any]]", 0.07929927068511022], ["str", 0.07712508052730173]], "op_kwargs": [["dict", 0.194742293496356], ["list", 0.08008257880523006]], "return_value": [], "test_df": [["mock.MagicMock", 0.09412411574879088], ["mock.Mock", 0.09280127761175468]]}}], "name": "TestBaseSqlToSlackOperator", "q_name": "TestBaseSqlToSlackOperator", "variables": {}, "variables_p": {}}, {"cls_lc": [[109, 0], [292, 38]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[110, 4], [111, 68]], "fn_var_ln": {"example_dag": [[111, 8], [111, 24]]}, "fn_var_occur": {"example_dag": [["self", "example_dag", "DAG", "TEST_DAG_ID", "start_date", "DEFAULT_DATE"]]}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "example_dag", "DAG", "TEST_DAG_ID", "start_date", "DEFAULT_DATE"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSqlToSlackOperator.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"example_dag": ""}, "variables_p": {"example_dag": [["int", 0.5299394373002807], ["str", 0.19882960069168484], ["Dict[str, Optional[str]]", 0.09354750060780663], ["Tuple[Literal, Literal, int]", 0.0901074619764267]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[114, 4], [116, 23]], "fn_var_ln": {"operator": [[115, 8], [115, 16]]}, "fn_var_occur": {"operator": [["operator", "SqlToSlackOperator", "task_id", "TEST_TASK_ID", "kwargs"]]}, "name": "_construct_operator", "params": {"kwargs": ""}, "params_descr": {"kwargs": ""}, "params_occur": {"kwargs": [["operator", "SqlToSlackOperator", "task_id", "TEST_TASK_ID", "kwargs"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSqlToSlackOperator._construct_operator", "ret_exprs": ["return operator"], "ret_type": "", "ret_type_p": [["int", 0.30000000000000004], ["Callable", 0.2], ["models.Question", 0.1], ["str", 0.1]], "variables": {"operator": ""}, "variables_p": {"operator": [["int", 0.261047175715076], ["Dict[str, List[str]]", 0.1648561698222272], ["dict", 0.09747460057261705]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[119, 4], [150, 9]], "fn_var_ln": {"_get_hook": [[137, 8], [137, 39]], "get_pandas_df_mock": [[123, 8], [123, 26]], "mock_dbapi_hook": [[120, 8], [120, 23]], "operator_args": [[126, 8], [126, 21]], "return_value": [[124, 8], [124, 39]], "slack_webhook_hook": [[136, 8], [136, 26]], "sql_to_slack_operator": [[134, 8], [134, 29]], "test_df": [[122, 8], [122, 15]]}, "fn_var_occur": {"_get_hook": [["sql_to_slack_operator", "_get_hook", "mock_dbapi_hook"]], "get_pandas_df_mock": [["get_pandas_df_mock", "mock_dbapi_hook", "return_value", "get_pandas_df"], ["get_pandas_df_mock", "return_value", "test_df"]], "mock_dbapi_hook": [["mock_dbapi_hook", "mock", "Mock"], ["get_pandas_df_mock", "mock_dbapi_hook", "return_value", "get_pandas_df"], ["sql_to_slack_operator", "_get_hook", "mock_dbapi_hook"]], "operator_args": [["operator_args", "self", "example_dag"], ["sql_to_slack_operator", "self", "_construct_operator", "operator_args"]], "return_value": [["get_pandas_df_mock", "mock_dbapi_hook", "return_value", "get_pandas_df"], ["get_pandas_df_mock", "return_value", "test_df"], ["slack_webhook_hook", "mock_slack_hook_class", "return_value"]], "slack_webhook_hook": [["slack_webhook_hook", "mock_slack_hook_class", "return_value"], ["slack_webhook_hook", "send", "assert_called_once_with", "text", "test_df", "channel"]], "sql_to_slack_operator": [["sql_to_slack_operator", "self", "_construct_operator", "operator_args"], ["sql_to_slack_operator", "_get_hook", "mock_dbapi_hook"], ["sql_to_slack_operator", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"]], "test_df": [["test_df", "pd", "DataFrame", "index"], ["get_pandas_df_mock", "return_value", "test_df"], ["slack_webhook_hook", "send", "assert_called_once_with", "text", "test_df", "channel"]]}, "name": "test_rendering_and_message_execution", "params": {"mock_slack_hook_class": "", "self": ""}, "params_descr": {"mock_slack_hook_class": "", "self": ""}, "params_occur": {"mock_slack_hook_class": [["slack_webhook_hook", "mock_slack_hook_class", "return_value"], ["mock_slack_hook_class", "assert_called_once_with", "slack_webhook_conn_id", "webhook_token", "None"]], "self": [["operator_args", "self", "example_dag"], ["sql_to_slack_operator", "self", "_construct_operator", "operator_args"]]}, "params_p": {"args": [], "kwargs": [], "mock_slack_hook_class": [["mock.Mock", 0.11526105706279835]], "self": []}, "q_name": "TestSqlToSlackOperator.test_rendering_and_message_execution", "ret_exprs": [], "ret_type": "", "variables": {"_get_hook": "", "get_pandas_df_mock": "", "mock_dbapi_hook": "", "operator_args": "", "return_value": "", "slack_webhook_hook": "", "sql_to_slack_operator": "", "test_df": ""}, "variables_p": {"_get_hook": [["list", 0.19392261407347033], ["circle_core.models.cc_info.CcInfo", 0.11910619143338243], ["Dict[str, Union[int, str]]", 0.11904615568034055], ["List[Tuple[str, str]]", 0.08686635200714954], ["int", 0.08463402608317074]], "get_pandas_df_mock": [["int", 0.12171832538829812], ["str", 0.11612899574296331], ["Dict[str, str]", 0.10224191399385317], ["Dict[str, List[Any]]", 0.09965110987627705], ["Dict[Any, Union[Any, Any]]", 0.09912801251212325], ["rotkehlchen.tests.utils.mock.MockResponse", 0.0972005986745669], ["bool", 0.09243751906598249]], "mock_dbapi_hook": [["Union[mock.AsyncMock, mock.MagicMock]", 0.5631438167169515]], "operator_args": [["Dict[str, Dict[str, Any]]", 0.1785790077490776], ["str", 0.14215788552865322], ["List[str]", 0.124185052778483], ["Dict[str, Union[Any, Any]]", 0.09792400224061194], ["list", 0.09576418282413088], ["Pattern[str]", 0.09256580735416949], ["Dict[str, str]", 0.08664388920740924], ["Dict[str, dict]", 0.08641598949333369]], "return_value": [["Dict[str, Any]", 0.2946539484620181], ["str", 0.1803629877667659], ["int", 0.12248256107383244], ["Dict[str, List[Any]]", 0.11919836857515209], ["dict", 0.08920574348853479]], "slack_webhook_hook": [["str", 0.33770903030048427], ["Dict[str, Dict[str, Any]]", 0.27158931627132105], ["list", 0.20176857743075166], ["property", 0.10811388463569001]], "sql_to_slack_operator": [["Dict[str, List[Any]]", 0.18023305229177167]], "test_df": [["int", 0.1981383246523032], ["float", 0.11875025670364889], ["str", 0.09641515525657754]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[153, 4], [185, 9]], "fn_var_ln": {"_get_hook": [[172, 8], [172, 39]], "get_pandas_df_mock": [[157, 8], [157, 26]], "mock_dbapi_hook": [[154, 8], [154, 23]], "operator_args": [[160, 8], [160, 21]], "return_value": [[158, 8], [158, 39]], "slack_webhook_hook": [[171, 8], [171, 26]], "sql_to_slack_operator": [[169, 8], [169, 29]], "test_df": [[156, 8], [156, 15]]}, "fn_var_occur": {"_get_hook": [["sql_to_slack_operator", "_get_hook", "mock_dbapi_hook"]], "get_pandas_df_mock": [["get_pandas_df_mock", "mock_dbapi_hook", "return_value", "get_pandas_df"], ["get_pandas_df_mock", "return_value", "test_df"]], "mock_dbapi_hook": [["mock_dbapi_hook", "mock", "Mock"], ["get_pandas_df_mock", "mock_dbapi_hook", "return_value", "get_pandas_df"], ["sql_to_slack_operator", "_get_hook", "mock_dbapi_hook"]], "operator_args": [["operator_args", "self", "example_dag"], ["sql_to_slack_operator", "self", "_construct_operator", "operator_args"]], "return_value": [["get_pandas_df_mock", "mock_dbapi_hook", "return_value", "get_pandas_df"], ["get_pandas_df_mock", "return_value", "test_df"], ["slack_webhook_hook", "mock_slack_hook_class", "return_value"]], "slack_webhook_hook": [["slack_webhook_hook", "mock_slack_hook_class", "return_value"], ["slack_webhook_hook", "send", "assert_called_once_with", "text", "test_df", "channel"]], "sql_to_slack_operator": [["sql_to_slack_operator", "self", "_construct_operator", "operator_args"], ["sql_to_slack_operator", "_get_hook", "mock_dbapi_hook"], ["sql_to_slack_operator", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"]], "test_df": [["test_df", "pd", "DataFrame", "index"], ["get_pandas_df_mock", "return_value", "test_df"], ["slack_webhook_hook", "send", "assert_called_once_with", "text", "test_df", "channel"]]}, "name": "test_rendering_and_message_execution_with_slack_hook", "params": {"mock_slack_hook_class": "", "self": ""}, "params_descr": {"mock_slack_hook_class": "", "self": ""}, "params_occur": {"mock_slack_hook_class": [["slack_webhook_hook", "mock_slack_hook_class", "return_value"], ["mock_slack_hook_class", "assert_called_once_with", "slack_webhook_conn_id", "webhook_token"]], "self": [["operator_args", "self", "example_dag"], ["sql_to_slack_operator", "self", "_construct_operator", "operator_args"]]}, "params_p": {"args": [], "kwargs": [], "mock_slack_hook_class": [["mock.Mock", 0.11526105706279835]], "self": []}, "q_name": "TestSqlToSlackOperator.test_rendering_and_message_execution_with_slack_hook", "ret_exprs": [], "ret_type": "", "variables": {"_get_hook": "", "get_pandas_df_mock": "", "mock_dbapi_hook": "", "operator_args": "", "return_value": "", "slack_webhook_hook": "", "sql_to_slack_operator": "", "test_df": ""}, "variables_p": {"_get_hook": [["list", 0.19392261407347033], ["circle_core.models.cc_info.CcInfo", 0.11910619143338243], ["Dict[str, Union[int, str]]", 0.11904615568034055], ["List[Tuple[str, str]]", 0.08686635200714954], ["int", 0.08463402608317074]], "get_pandas_df_mock": [["int", 0.12171832538829812], ["str", 0.11612899574296331], ["Dict[str, str]", 0.10224191399385317], ["Dict[str, List[Any]]", 0.09965110987627705], ["Dict[Any, Union[Any, Any]]", 0.09912801251212325], ["rotkehlchen.tests.utils.mock.MockResponse", 0.0972005986745669], ["bool", 0.09243751906598249]], "mock_dbapi_hook": [["Union[mock.AsyncMock, mock.MagicMock]", 0.5631438167169515]], "operator_args": [["Dict[str, Dict[str, Any]]", 0.1785790077490776], ["str", 0.14215788552865322], ["List[str]", 0.124185052778483], ["Dict[str, Union[Any, Any]]", 0.09792400224061194], ["list", 0.09576418282413088], ["Pattern[str]", 0.09256580735416949], ["Dict[str, str]", 0.08664388920740924], ["Dict[str, dict]", 0.08641598949333369]], "return_value": [["Dict[str, Any]", 0.2946539484620181], ["str", 0.1803629877667659], ["int", 0.12248256107383244], ["Dict[str, List[Any]]", 0.11919836857515209], ["dict", 0.08920574348853479]], "slack_webhook_hook": [["str", 0.33770903030048427], ["Dict[str, Dict[str, Any]]", 0.27158931627132105], ["list", 0.20176857743075166], ["property", 0.10811388463569001]], "sql_to_slack_operator": [["Dict[str, List[Any]]", 0.18023305229177167]], "test_df": [["int", 0.1981383246523032], ["float", 0.11875025670364889], ["str", 0.09641515525657754]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[187, 4], [194, 53]], "fn_var_ln": {"operator_args": [[188, 8], [188, 21]]}, "fn_var_occur": {"operator_args": [["self", "_construct_operator", "operator_args"]]}, "name": "test_non_existing_slack_parameters_provided_exception_thrown", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "_construct_operator", "operator_args"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSqlToSlackOperator.test_non_existing_slack_parameters_provided_exception_thrown", "ret_exprs": [], "ret_type": "", "variables": {"operator_args": ""}, "variables_p": {"operator_args": [["int", 0.6420238502005469], ["str", 0.09596322927248119], ["float", 0.08713112642291018], ["DefaultDict[Any, List[Any]]", 0.08294566340473013]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[197, 4], [229, 9]], "fn_var_ln": {"_get_hook": [[216, 8], [216, 39]], "get_pandas_df_mock": [[201, 8], [201, 26]], "mock_dbapi_hook": [[198, 8], [198, 23]], "operator_args": [[204, 8], [204, 21]], "return_value": [[202, 8], [202, 39]], "slack_webhook_hook": [[215, 8], [215, 26]], "sql_to_slack_operator": [[213, 8], [213, 29]], "test_df": [[200, 8], [200, 15]]}, "fn_var_occur": {"_get_hook": [["sql_to_slack_operator", "_get_hook", "mock_dbapi_hook"]], "get_pandas_df_mock": [["get_pandas_df_mock", "mock_dbapi_hook", "return_value", "get_pandas_df"], ["get_pandas_df_mock", "return_value", "test_df"]], "mock_dbapi_hook": [["mock_dbapi_hook", "mock", "Mock"], ["get_pandas_df_mock", "mock_dbapi_hook", "return_value", "get_pandas_df"], ["sql_to_slack_operator", "_get_hook", "mock_dbapi_hook"]], "operator_args": [["operator_args", "self", "example_dag"], ["sql_to_slack_operator", "self", "_construct_operator", "operator_args"]], "return_value": [["get_pandas_df_mock", "mock_dbapi_hook", "return_value", "get_pandas_df"], ["get_pandas_df_mock", "return_value", "test_df"], ["slack_webhook_hook", "mock_slack_hook_class", "return_value"]], "slack_webhook_hook": [["slack_webhook_hook", "mock_slack_hook_class", "return_value"], ["slack_webhook_hook", "send", "assert_called_once_with", "text", "test_df", "channel"]], "sql_to_slack_operator": [["sql_to_slack_operator", "self", "_construct_operator", "operator_args"], ["sql_to_slack_operator", "_get_hook", "mock_dbapi_hook"], ["sql_to_slack_operator", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"]], "test_df": [["test_df", "pd", "DataFrame", "index"], ["get_pandas_df_mock", "return_value", "test_df"], ["slack_webhook_hook", "send", "assert_called_once_with", "text", "test_df", "channel"]]}, "name": "test_rendering_custom_df_name_message_execution", "params": {"mock_slack_hook_class": "", "self": ""}, "params_descr": {"mock_slack_hook_class": "", "self": ""}, "params_occur": {"mock_slack_hook_class": [["slack_webhook_hook", "mock_slack_hook_class", "return_value"], ["mock_slack_hook_class", "assert_called_once_with", "slack_webhook_conn_id", "webhook_token", "None"]], "self": [["operator_args", "self", "example_dag"], ["sql_to_slack_operator", "self", "_construct_operator", "operator_args"]]}, "params_p": {"args": [], "kwargs": [], "mock_slack_hook_class": [["mock.Mock", 0.10316041098087762]], "self": []}, "q_name": "TestSqlToSlackOperator.test_rendering_custom_df_name_message_execution", "ret_exprs": [], "ret_type": "", "variables": {"_get_hook": "", "get_pandas_df_mock": "", "mock_dbapi_hook": "", "operator_args": "", "return_value": "", "slack_webhook_hook": "", "sql_to_slack_operator": "", "test_df": ""}, "variables_p": {"_get_hook": [["list", 0.19392261407347033], ["circle_core.models.cc_info.CcInfo", 0.11910619143338243], ["Dict[str, Union[int, str]]", 0.11904615568034055], ["List[Tuple[str, str]]", 0.08686635200714954], ["int", 0.08463402608317074]], "get_pandas_df_mock": [["int", 0.12171832538829812], ["str", 0.11612899574296331], ["Dict[str, str]", 0.10224191399385317], ["Dict[str, List[Any]]", 0.09965110987627705], ["Dict[Any, Union[Any, Any]]", 0.09912801251212325], ["rotkehlchen.tests.utils.mock.MockResponse", 0.0972005986745669], ["bool", 0.09243751906598249]], "mock_dbapi_hook": [["Union[mock.AsyncMock, mock.MagicMock]", 0.5631438167169515]], "operator_args": [["Dict[str, Dict[str, Any]]", 0.1785790077490776], ["str", 0.14215788552865322], ["List[str]", 0.124185052778483], ["Dict[str, Union[Any, Any]]", 0.09792400224061194], ["list", 0.09576418282413088], ["Pattern[str]", 0.09256580735416949], ["Dict[str, str]", 0.08664388920740924], ["Dict[str, dict]", 0.08641598949333369]], "return_value": [["Dict[str, Any]", 0.2946539484620181], ["str", 0.1803629877667659], ["int", 0.12248256107383244], ["Dict[str, List[Any]]", 0.11919836857515209], ["dict", 0.08920574348853479]], "slack_webhook_hook": [["str", 0.33770903030048427], ["Dict[str, Dict[str, Any]]", 0.27158931627132105], ["list", 0.20176857743075166], ["property", 0.10811388463569001]], "sql_to_slack_operator": [["Dict[str, List[Any]]", 0.18023305229177167]], "test_df": [["int", 0.1981383246523032], ["float", 0.11875025670364889], ["str", 0.09641515525657754]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[232, 4], [252, 67]], "fn_var_ln": {"hook_params": [[234, 8], [234, 19]], "operator_args": [[240, 8], [240, 21]], "return_value": [[233, 8], [233, 34]], "sql_to_slack_operator": [[250, 8], [250, 29]]}, "fn_var_occur": {"hook_params": [["operator_args", "hook_params", "self", "example_dag"], ["sql_to_slack_operator", "sql_hook_params", "hook_params"]], "operator_args": [["operator_args", "hook_params", "self", "example_dag"], ["sql_to_slack_operator", "SqlToSlackOperator", "task_id", "TEST_TASK_ID", "operator_args"]], "return_value": [["mock_get_conn", "return_value", "Connection", "conn_id", "conn_type"]], "sql_to_slack_operator": [["sql_to_slack_operator", "SqlToSlackOperator", "task_id", "TEST_TASK_ID", "operator_args"], ["sql_to_slack_operator", "sql_hook_params", "hook_params"]]}, "name": "test_hook_params_building", "params": {"mock_get_conn": "", "self": ""}, "params_descr": {"mock_get_conn": "", "self": ""}, "params_occur": {"mock_get_conn": [["mock_get_conn", "return_value", "Connection", "conn_id", "conn_type"]], "self": [["operator_args", "hook_params", "self", "example_dag"]]}, "params_p": {"args": [], "kwargs": [], "mock_get_conn": [], "self": []}, "q_name": "TestSqlToSlackOperator.test_hook_params_building", "ret_exprs": [], "ret_type": "", "variables": {"hook_params": "", "operator_args": "", "return_value": "", "sql_to_slack_operator": ""}, "variables_p": {"hook_params": [["str", 0.5079599688583741], ["List[str]", 0.19746127180213136], ["Type[str]", 0.19586502874146933], ["Dict[str, Union[Any, Any]]", 0.09871373059802516]], "operator_args": [["Dict[str, List[str]]", 0.1071745412168406], ["Dict[str, Any]", 0.10668316855791052], ["frozenset[str]", 0.10206772191524706], ["Dict[str, set]", 0.09616316848390119], ["Dict[str, List[int]]", 0.09470381724694615], ["Tuple[Dict[str, Any], int]", 0.09432544812504114]], "return_value": [["str", 0.5938998503393051], ["int", 0.10649524534965821], ["list", 0.0944260190818065], ["List[Dict[str, str]]", 0.08680370491694113]], "sql_to_slack_operator": [["str", 0.29446934438082456], ["Dict[str, Dict[str, Any]]", 0.21233116682143888], ["int", 0.11151602345542766], ["RuntimeError", 0.10282608304711231], ["Dict[int, str]", 0.09419082342264035], ["dict", 0.08466463604093061]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[255, 4], [268, 60]], "fn_var_ln": {"hook": [[267, 8], [267, 12]], "op": [[257, 8], [257, 10]], "return_value": [[256, 8], [256, 34]]}, "fn_var_occur": {"hook": [["hook", "op", "_get_hook"], ["hook", "log_sql", "op", "sql_hook_params"]], "op": [["op", "SqlToSlackOperator", "task_id", "sql_conn_id", "slack_webhook_token", "sql", "slack_message", "sql_hook_params", "False"], ["hook", "op", "_get_hook"], ["hook", "log_sql", "op", "sql_hook_params"]], "return_value": [["mock_get_conn", "return_value", "Connection", "conn_id", "conn_type"]]}, "name": "test_hook_params", "params": {"mock_get_conn": "", "self": ""}, "params_descr": {"mock_get_conn": "", "self": ""}, "params_occur": {"mock_get_conn": [["mock_get_conn", "return_value", "Connection", "conn_id", "conn_type"]], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_get_conn": [], "self": []}, "q_name": "TestSqlToSlackOperator.test_hook_params", "ret_exprs": [], "ret_type": "", "variables": {"hook": "", "op": "", "return_value": ""}, "variables_p": {"hook": [["str", 0.5072790493267554], ["Optional[str]", 0.37646357378557116]], "op": [["str", 0.19644581959230767], ["List[str]", 0.11486528223060832], ["Dict[str, str]", 0.11347396308403672], ["int", 0.09694310636605129], ["List[Tuple[Any, str]]", 0.09350621697342919], ["Dict[str, Optional[str]]", 0.08888903465743546]], "return_value": [["str", 0.5938998503393051], ["int", 0.10649524534965821], ["list", 0.0944260190818065], ["List[Dict[str, str]]", 0.08680370491694113]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[271, 4], [292, 38]], "fn_var_ln": {"hook": [[287, 8], [287, 12]], "op": [[273, 8], [273, 10]], "return_value": [[272, 8], [272, 34]]}, "fn_var_occur": {"hook": [["hook", "op", "_get_hook"], ["hook", "warehouse"], ["hook", "database"], ["hook", "role"], ["hook", "schema"]], "op": [["op", "SqlToSlackOperator", "task_id", "sql_conn_id", "slack_conn_id", "results_df_name", "sql", "slack_message", "sql_hook_params"], ["hook", "op", "_get_hook"]], "return_value": [["mock_get_conn", "return_value", "Connection", "conn_id", "conn_type"]]}, "name": "test_hook_params_snowflake", "params": {"mock_get_conn": "", "self": ""}, "params_descr": {"mock_get_conn": "", "self": ""}, "params_occur": {"mock_get_conn": [["mock_get_conn", "return_value", "Connection", "conn_id", "conn_type"]], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_get_conn": [], "self": []}, "q_name": "TestSqlToSlackOperator.test_hook_params_snowflake", "ret_exprs": [], "ret_type": "", "variables": {"hook": "", "op": "", "return_value": ""}, "variables_p": {"hook": [["int", 0.23771766884861834], ["tuple", 0.10281749163938272], ["str", 0.09869997081788148], ["List[str]", 0.09628830828466334]], "op": [["int", 0.278955231090435], ["Dict[str, Optional[str]]", 0.08121158881824123], ["Dict[str, Union[Any, Any]]", 0.07815995329930205], ["str", 0.07715101542641824]], "return_value": [["str", 0.5938998503393051], ["int", 0.10649524534965821], ["list", 0.0944260190818065], ["List[Dict[str, str]]", 0.08680370491694113]]}}], "name": "TestSqlToSlackOperator", "q_name": "TestSqlToSlackOperator", "variables": {}, "variables_p": {}}, {"cls_lc": [[295, 0], [379, 40]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[296, 4], [303, 9]], "fn_var_ln": {"default_op_kwargs": [[297, 8], [297, 30]]}, "fn_var_occur": {"default_op_kwargs": [["self", "default_op_kwargs", "None", "None"]]}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "default_op_kwargs", "None", "None"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSqlToSlackApiFileOperator.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"default_op_kwargs": ""}, "variables_p": {"default_op_kwargs": [["int", 0.4497540423145471], ["Pattern[str]", 0.1728790227788811], ["str", 0.15670306850045562], ["Optional[int]", 0.07477910482417863]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[321, 4], [363, 9]], "fn_var_ln": {"mock_df": [[337, 8], [337, 15]], "mock_df_output_method": [[338, 8], [338, 29]], "mock_send_file": [[333, 8], [333, 22]], "op": [[351, 8], [351, 10]], "op_kwargs": [[342, 8], [342, 17]], "return_value": [[340, 8], [340, 43]]}, "fn_var_occur": {"mock_df": [["mock_df", "mock", "MagicMock"], ["setattr", "mock_df", "df_method", "mock_df_output_method"], ["mock_get_query_results", "return_value", "mock_df"]], "mock_df_output_method": [["mock_df_output_method", "mock", "MagicMock"], ["setattr", "mock_df", "df_method", "mock_df_output_method"], ["mock_df_output_method", "assert_called_once_with", "mock", "ANY", "df_kwargs"]], "mock_send_file": [["mock_send_file", "mock", "MagicMock"], ["mock_slack_hook_cls", "return_value", "send_file", "mock_send_file"], ["mock_send_file", "assert_called_once_with", "channels", "channels", "filename", "filename", "initial_comment", "initial_comment", "title", "title", "file", "mock", "ANY"]], "op": [["op", "SqlToSlackApiFileOperator", "task_id", "op_kwargs"], ["op", "execute", "mock", "MagicMock"]], "op_kwargs": [["op_kwargs", "self", "default_op_kwargs", "filename", "channels", "initial_comment", "title", "df_kwargs"], ["op", "SqlToSlackApiFileOperator", "task_id", "op_kwargs"]], "return_value": [["mock_slack_hook_cls", "return_value", "send_file", "mock_send_file"], ["mock_get_query_results", "return_value", "mock_df"]]}, "name": "test_send_file", "params": {"channels": "", "df_kwargs": "", "df_method": "", "filename": "", "initial_comment": "", "mock_get_query_results": "", "mock_slack_hook_cls": "", "self": "", "title": ""}, "params_descr": {"channels": "", "df_kwargs": "", "df_method": "", "filename": "", "initial_comment": "", "mock_get_query_results": "", "mock_slack_hook_cls": "", "self": "", "title": ""}, "params_occur": {"channels": [["op_kwargs", "self", "default_op_kwargs", "filename", "channels", "initial_comment", "title", "df_kwargs"], ["mock_send_file", "assert_called_once_with", "channels", "channels", "filename", "filename", "initial_comment", "initial_comment", "title", "title", "file", "mock", "ANY"]], "df_kwargs": [["op_kwargs", "self", "default_op_kwargs", "filename", "channels", "initial_comment", "title", "df_kwargs"], ["mock_df_output_method", "assert_called_once_with", "mock", "ANY", "df_kwargs"]], "df_method": [["setattr", "mock_df", "df_method", "mock_df_output_method"]], "filename": [["op_kwargs", "self", "default_op_kwargs", "filename", "channels", "initial_comment", "title", "df_kwargs"], ["mock_send_file", "assert_called_once_with", "channels", "channels", "filename", "filename", "initial_comment", "initial_comment", "title", "title", "file", "mock", "ANY"]], "initial_comment": [["op_kwargs", "self", "default_op_kwargs", "filename", "channels", "initial_comment", "title", "df_kwargs"], ["mock_send_file", "assert_called_once_with", "channels", "channels", "filename", "filename", "initial_comment", "initial_comment", "title", "title", "file", "mock", "ANY"]], "mock_get_query_results": [["mock_get_query_results", "return_value", "mock_df"], ["mock_get_query_results", "assert_called_once_with"]], "mock_slack_hook_cls": [["mock_slack_hook_cls", "return_value", "send_file", "mock_send_file"], ["mock_slack_hook_cls", "assert_called_once_with", "slack_conn_id"]], "self": [["op_kwargs", "self", "default_op_kwargs", "filename", "channels", "initial_comment", "title", "df_kwargs"]], "title": [["op_kwargs", "self", "default_op_kwargs", "filename", "channels", "initial_comment", "title", "df_kwargs"], ["mock_send_file", "assert_called_once_with", "channels", "channels", "filename", "filename", "initial_comment", "initial_comment", "title", "title", "file", "mock", "ANY"]]}, "params_p": {"args": [], "channels": [["core.models.Grouping", 0.10663705779554107], ["IO[str]", 0.0954163483818364], ["docker.models.networks.Network", 0.09108764126102091]], "df_kwargs": [["tuple", 0.09619189541671297], ["Dict[str, Any]", 0.09619189541671297]], "df_method": [], "filename": [["core.models.Grouping", 0.10663705779554107], ["IO[str]", 0.0954163483818364], ["docker.models.networks.Network", 0.09108764126102091]], "initial_comment": [["core.models.Grouping", 0.10663705779554107], ["IO[str]", 0.0954163483818364], ["docker.models.networks.Network", 0.09108764126102091]], "kwargs": [], "mock_get_query_results": [["mock.MagicMock", 0.7942272114611211]], "mock_slack_hook_cls": [], "self": [], "title": [["core.models.Grouping", 0.10663705779554107], ["IO[str]", 0.0954163483818364], ["docker.models.networks.Network", 0.09108764126102091]]}, "q_name": "TestSqlToSlackApiFileOperator.test_send_file", "ret_exprs": [], "ret_type": "", "variables": {"mock_df": "", "mock_df_output_method": "", "mock_send_file": "", "op": "", "op_kwargs": "", "return_value": ""}, "variables_p": {"mock_df": [], "mock_df_output_method": [["str", 0.0958334618037966], ["mock.mock.MagicMock", 0.09130895686695714]], "mock_send_file": [["str", 0.4749905488591737], ["List[str]", 0.12720857396266536], ["Optional[str]", 0.08137046607736854]], "op": [["dict", 0.14237894324154235], ["List[str]", 0.09071197413184635]], "op_kwargs": [["tuple", 0.09245507992231057], ["list", 0.08992201570468229]], "return_value": [["str", 0.6636707394007535], ["Dict[str, Union[int, str]]", 0.15164326905162748], ["List[Dict[str, str]]", 0.0966437842991439], ["int", 0.08804220724847517]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[374, 4], [379, 40]], "fn_var_ln": {"op": [[375, 8], [375, 10]]}, "fn_var_occur": {"op": [["op", "SqlToSlackApiFileOperator", "task_id", "slack_filename", "filename", "self", "default_op_kwargs"], ["op", "execute", "mock", "MagicMock"]]}, "name": "test_unsupported_format", "params": {"filename": "", "self": ""}, "params_descr": {"filename": "", "self": ""}, "params_occur": {"filename": [["op", "SqlToSlackApiFileOperator", "task_id", "slack_filename", "filename", "self", "default_op_kwargs"]], "self": [["op", "SqlToSlackApiFileOperator", "task_id", "slack_filename", "filename", "self", "default_op_kwargs"]]}, "params_p": {"args": [], "filename": [["app.models.Game", 0.10118352804148475]], "kwargs": [], "self": []}, "q_name": "TestSqlToSlackApiFileOperator.test_unsupported_format", "ret_exprs": [], "ret_type": "", "variables": {"op": ""}, "variables_p": {"op": [["RuntimeError", 0.1096293813846444]]}}], "name": "TestSqlToSlackApiFileOperator", "q_name": "TestSqlToSlackApiFileOperator", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["__future__", "annotations", "unittest", "mock", "pandas", "pd", "pytest", "airflow", "exceptions", "AirflowException", "airflow", "models", "DAG", "Connection", "airflow", "providers", "slack", "transfers", "sql_to_slack", "BaseSqlToSlackOperator", "SqlToSlackApiFileOperator", "SqlToSlackOperator", "airflow", "utils", "timezone"], "mod_var_ln": {"DEFAULT_DATE": [[35, 0], [35, 12]], "TEST_DAG_ID": [[33, 0], [33, 11]], "TEST_TASK_ID": [[34, 0], [34, 12]]}, "mod_var_occur": {"DEFAULT_DATE": [["self", "example_dag", "DAG", "TEST_DAG_ID", "start_date", "DEFAULT_DATE"], ["sql_to_slack_operator", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"], ["sql_to_slack_operator", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"], ["sql_to_slack_operator", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"]], "TEST_DAG_ID": [["self", "example_dag", "DAG", "TEST_DAG_ID", "start_date", "DEFAULT_DATE"]], "TEST_TASK_ID": [["operator", "SqlToSlackOperator", "task_id", "TEST_TASK_ID", "kwargs"], ["sql_to_slack_operator", "SqlToSlackOperator", "task_id", "TEST_TASK_ID", "operator_args"]]}, "no_types_annot": {"D": 0, "I": 0, "U": 109}, "session_id": "yATu5WVWs-mmOOp8ogwUAM_hroOwEL6qyqNE-EBvYms", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"DEFAULT_DATE": "", "TEST_DAG_ID": "", "TEST_TASK_ID": ""}, "variables_p": {"DEFAULT_DATE": [["str", 1.0]], "TEST_DAG_ID": [["str", 0.3683686969987609], ["int", 0.34156297106259464], ["Tuple[Tuple[str, str], Tuple[str, str]]", 0.09633726438252664]], "TEST_TASK_ID": [["str", 0.7808534319895137], ["cmk.utils.type_defs.UserId", 0.13468951292512846]]}}}