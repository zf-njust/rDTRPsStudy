{"error": null, "response": {"classes": [{"cls_lc": [[34, 0], [372, 97]], "cls_var_ln": {"_config": [[35, 4], [35, 11]], "_config_export": [[43, 4], [43, 18]], "_config_import": [[62, 4], [62, 18]], "_config_json": [[76, 4], [76, 16]]}, "cls_var_occur": {"_config": [], "_config_export": [], "_config_import": [], "_config_json": []}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[83, 4], [103, 9]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["db", "merge_conn", "Connection", "conn_id", "conn_type", "schema", "host", "port", "extra", "json", "dumps", "self", "_config_json"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSqoopHook.setup_method", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[106, 4], [174, 9]], "fn_var_ln": {"hook": [[119, 8], [119, 12]], "mock_proc": [[108, 8], [108, 17]], "returncode": [[109, 8], [109, 28]], "stderr": [[111, 8], [111, 24]], "stdout": [[110, 8], [110, 24]]}, "fn_var_occur": {"hook": [["hook", "SqoopHook", "conn_id", "libjars"], ["hook", "export_table", "self", "_config_export"]], "mock_proc": [["mock_proc", "mock", "MagicMock"], ["mock_proc", "returncode"], ["mock_proc", "stdout", "StringIO"], ["mock_proc", "stderr", "StringIO"], ["mock_proc", "communicate", "return_value", "StringIO", "StringIO"], ["mock_popen", "return_value", "__enter__", "return_value", "mock_proc"]], "returncode": [["mock_proc", "returncode"]], "stderr": [["mock_proc", "stderr", "StringIO"], ["mock_popen", "mock_calls", "call", "self", "_config_json", "self", "_config_json", "self", "_config_json", "self", "_config_json", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "str", "self", "_config_export", "get", "self", "_config_export", "self", "_config_export", "stderr", "stdout"]], "stdout": [["mock_proc", "stdout", "StringIO"], ["mock_popen", "mock_calls", "call", "self", "_config_json", "self", "_config_json", "self", "_config_json", "self", "_config_json", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "str", "self", "_config_export", "get", "self", "_config_export", "self", "_config_export", "stderr", "stdout"]]}, "name": "test_popen", "params": {"mock_popen": "", "self": ""}, "params_descr": {"mock_popen": "", "self": ""}, "params_occur": {"mock_popen": [["mock_popen", "return_value", "__enter__", "return_value", "mock_proc"], ["mock_popen", "mock_calls", "call", "self", "_config_json", "self", "_config_json", "self", "_config_json", "self", "_config_json", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "str", "self", "_config_export", "get", "self", "_config_export", "self", "_config_export", "stderr", "stdout"]], "self": [["hook", "export_table", "self", "_config_export"], ["mock_popen", "mock_calls", "call", "self", "_config_json", "self", "_config_json", "self", "_config_json", "self", "_config_json", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "self", "_config_export", "str", "self", "_config_export", "get", "self", "_config_export", "self", "_config_export", "stderr", "stdout"]]}, "params_p": {"args": [], "kwargs": [], "mock_popen": [], "self": []}, "q_name": "TestSqoopHook.test_popen", "ret_exprs": [], "ret_type": "", "variables": {"hook": "", "mock_proc": "", "returncode": "", "stderr": "", "stdout": ""}, "variables_p": {"hook": [["str", 0.27103978660222006], ["Dict[str, Any]", 0.10194085714211008], ["dict", 0.09381386529236475]], "mock_proc": [["mock.Mock", 0.14175339768806153]], "returncode": [["str", 0.46146968833119484], ["List[Dict[str, float]]", 0.10543346334745063], ["Dict[str, Dict[str, str]]", 0.0831681400737581]], "stderr": [["Dict[str, Any]", 0.2623510846819525], ["str", 0.2430148480590475], ["mock.Mock", 0.1007607634105924], ["Dict[str, Union[Any, Any]]", 0.0868334922133407], ["list", 0.07586726257221209]], "stdout": [["Dict[str, Any]", 0.26543244043512565], ["str", 0.23413994481305656], ["mock.Mock", 0.11441142115369328], ["Dict[str, Union[Any, Any]]", 0.0903510642428747], ["list", 0.07307385977542019]]}}, {"docstring": {"func": "Test to check that if value of num_mappers is None, then it shouldn't be in the cmd built.", "long_descr": null, "ret": null}, "fn_lc": [[176, 4], [185, 41]], "fn_var_ln": {"_config_without_mappers": [[180, 8], [180, 31]], "cmd": [[184, 8], [184, 11]], "hook": [[183, 8], [183, 12]]}, "fn_var_occur": {"_config_without_mappers": [["_config_without_mappers", "self", "_config", "copy"], ["_config_without_mappers", "None"], ["hook", "SqoopHook", "_config_without_mappers"]], "cmd": [["cmd", "join", "hook", "_prepare_command"]], "hook": [["hook", "SqoopHook", "_config_without_mappers"], ["cmd", "join", "hook", "_prepare_command"]]}, "name": "test_submit_none_mappers", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["_config_without_mappers", "self", "_config", "copy"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSqoopHook.test_submit_none_mappers", "ret_exprs": [], "ret_type": "", "variables": {"_config_without_mappers": "", "cmd": "", "hook": ""}, "variables_p": {"_config_without_mappers": [["Optional[List[str]]", 0.09745080336647144], ["str", 0.08958533415916978]], "cmd": [["List[str]", 0.9999999999999999]], "hook": [["Dict[str, Any]", 0.16557311936062516], ["List[str]", 0.08700506413399042], ["IO[bytes]", 0.0832911299772668], ["str", 0.0828807737351211]]}}, {"docstring": {"func": "Tests to verify that from connection extra option the options are added to the Sqoop command.", "long_descr": null, "ret": null}, "fn_lc": [[187, 4], [230, 96]], "fn_var_ln": {"cmd": [[193, 8], [193, 11]], "hook": [[191, 8], [191, 12]]}, "fn_var_occur": {"cmd": [["cmd", "join", "hook", "_prepare_command"], ["self", "_config_json", "cmd"], ["self", "_config_json", "cmd"], ["self", "_config_json", "cmd"], ["self", "_config_json", "cmd"], ["self", "_config", "cmd"], ["self", "_config", "cmd"], ["self", "_config", "cmd"], ["key", "value", "cmd"]], "hook": [["hook", "SqoopHook", "self", "_config"], ["cmd", "join", "hook", "_prepare_command"], ["hook", "export_table", "self", "_config_export"], ["hook", "import_table", "table", "target_dir", "schema"], ["hook", "import_query", "query", "target_dir"]]}, "name": "test_submit", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["hook", "SqoopHook", "self", "_config"], ["self", "_config_json"], ["self", "_config_json", "cmd"], ["self", "_config_json"], ["self", "_config_json", "cmd"], ["self", "_config_json"], ["self", "_config_json", "cmd"], ["self", "_config_json"], ["self", "_config_json", "cmd"], ["self", "_config", "cmd"], ["self", "_config", "cmd"], ["self", "_config"], ["self", "_config"], ["self", "_config", "cmd"], ["self", "_config", "items"], ["hook", "export_table", "self", "_config_export"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSqoopHook.test_submit", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "hook": ""}, "variables_p": {"cmd": [["str", 0.3835340715484017], ["int", 0.10558387230365993], ["List[str]", 0.10164200873255698], ["TextIO", 0.0985892316147748], ["frozenset[str]", 0.08775273801733681]], "hook": [["str", 0.4549582527536762], ["float", 0.18219118735317488], ["dict", 0.08306938886063185]]}}, {"docstring": {"func": "Tests to verify the hook export command is building correct Sqoop export command.", "long_descr": null, "ret": null}, "fn_lc": [[232, 4], [286, 39]], "fn_var_ln": {"cmd": [[239, 8], [239, 11]], "hook": [[236, 8], [236, 12]]}, "fn_var_occur": {"cmd": [["cmd", "join", "hook", "_export_cmd", "self", "_config_export", "self", "_config_export", "input_null_string", "self", "_config_export", "input_null_non_string", "self", "_config_export", "staging_table", "self", "_config_export", "clear_staging_table", "self", "_config_export", "enclosed_by", "self", "_config_export", "escaped_by", "self", "_config_export", "input_fields_terminated_by", "self", "_config_export", "input_lines_terminated_by", "self", "_config_export", "input_optionally_enclosed_by", "self", "_config_export", "batch", "self", "_config_export", "relaxed_isolation", "self", "_config_export", "extra_export_options", "self", "_config_export", "schema", "self", "_config_export"], ["self", "_config_export", "cmd"], ["self", "_config_export", "cmd"], ["self", "_config_export", "cmd"], ["self", "_config_export", "cmd"], ["self", "_config_export", "cmd"], ["self", "_config_export", "cmd"], ["self", "_config_export", "cmd"], ["self", "_config_export", "cmd"]], "hook": [["hook", "SqoopHook"], ["cmd", "join", "hook", "_export_cmd", "self", "_config_export", "self", "_config_export", "input_null_string", "self", "_config_export", "input_null_non_string", "self", "_config_export", "staging_table", "self", "_config_export", "clear_staging_table", "self", "_config_export", "enclosed_by", "self", "_config_export", "escaped_by", "self", "_config_export", "input_fields_terminated_by", "self", "_config_export", "input_lines_terminated_by", "self", "_config_export", "input_optionally_enclosed_by", "self", "_config_export", "batch", "self", "_config_export", "relaxed_isolation", "self", "_config_export", "extra_export_options", "self", "_config_export", "schema", "self", "_config_export"]]}, "name": "test_export_cmd", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cmd", "join", "hook", "_export_cmd", "self", "_config_export", "self", "_config_export", "input_null_string", "self", "_config_export", "input_null_non_string", "self", "_config_export", "staging_table", "self", "_config_export", "clear_staging_table", "self", "_config_export", "enclosed_by", "self", "_config_export", "escaped_by", "self", "_config_export", "input_fields_terminated_by", "self", "_config_export", "input_lines_terminated_by", "self", "_config_export", "input_optionally_enclosed_by", "self", "_config_export", "batch", "self", "_config_export", "relaxed_isolation", "self", "_config_export", "extra_export_options", "self", "_config_export", "schema", "self", "_config_export"], ["self", "_config_export", "cmd"], ["self", "_config_export", "cmd"], ["self", "_config_export", "cmd"], ["self", "_config_export", "cmd"], ["self", "_config_export", "cmd"], ["self", "_config_export", "cmd"], ["self", "_config_export", "cmd"], ["self", "_config_export", "cmd"], ["self", "_config_export"], ["self", "_config_export"], ["self", "_config_export"], ["self", "_config_export"], ["self", "_config_export"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSqoopHook.test_export_cmd", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "hook": ""}, "variables_p": {"cmd": [["Type[Pattern[str]]", 0.24845569448180005], ["Type[str]", 0.21528758680130816], ["int", 0.17192110635066862], ["List[Dict[str, Any]]", 0.10385458390430027], ["List[str]", 0.09361984029245776], ["Tuple[str, str, str, str]", 0.09193423726506143], ["Type[Callable[..., Any]]", 0.0749269509044037]], "hook": [["dict", 0.31121551800453096], ["str", 0.22206505260586745], ["list", 0.09402743431275977], ["Dict[str, List[str]]", 0.08867743538801147], ["Dict[str, Any]", 0.08848653329152084]]}}, {"docstring": {"func": "Tests to verify the hook import command is building correct Sqoop import command.", "long_descr": null, "ret": null}, "fn_lc": [[288, 4], [337, 36]], "fn_var_ln": {"cmd": [[321, 8], [321, 11]], "hook": [[292, 8], [292, 12]]}, "fn_var_occur": {"cmd": [["cmd", "join", "hook", "_import_cmd", "self", "_config_import", "append", "self", "_config_import", "file_type", "self", "_config_import", "split_by", "self", "_config_import", "direct", "self", "_config_import", "driver", "self", "_config_import", "extra_import_options", "None"], ["self", "_config_import", "cmd"], ["self", "_config_import", "cmd"], ["self", "_config_import", "cmd"], ["cmd", "join", "hook", "_import_cmd", "target_dir", "None", "append", "self", "_config_import", "file_type", "self", "_config_import", "split_by", "self", "_config_import", "direct", "self", "_config_import", "driver", "self", "_config_import", "extra_import_options", "self", "_config_import"]], "hook": [["hook", "SqoopHook"], ["cmd", "join", "hook", "_import_cmd", "self", "_config_import", "append", "self", "_config_import", "file_type", "self", "_config_import", "split_by", "self", "_config_import", "direct", "self", "_config_import", "driver", "self", "_config_import", "extra_import_options", "None"], ["cmd", "join", "hook", "_import_cmd", "target_dir", "None", "append", "self", "_config_import", "file_type", "self", "_config_import", "split_by", "self", "_config_import", "direct", "self", "_config_import", "driver", "self", "_config_import", "extra_import_options", "self", "_config_import"]]}, "name": "test_import_cmd", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cmd", "join", "hook", "_import_cmd", "self", "_config_import", "append", "self", "_config_import", "file_type", "self", "_config_import", "split_by", "self", "_config_import", "direct", "self", "_config_import", "driver", "self", "_config_import", "extra_import_options", "None"], ["self", "_config_import"], ["self", "_config_import"], ["self", "_config_import", "cmd"], ["self", "_config_import", "cmd"], ["self", "_config_import", "cmd"], ["cmd", "join", "hook", "_import_cmd", "target_dir", "None", "append", "self", "_config_import", "file_type", "self", "_config_import", "split_by", "self", "_config_import", "direct", "self", "_config_import", "driver", "self", "_config_import", "extra_import_options", "self", "_config_import"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSqoopHook.test_import_cmd", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "hook": ""}, "variables_p": {"cmd": [["str", 0.708834050866774], ["List[str]", 0.09229741466151903]], "hook": [["str", 0.3247356086738329], ["dict", 0.2898295116184159], ["List[str]", 0.19789235174889186], ["Set[str]", 0.07988386172589233]]}}, {"docstring": {"func": "Tests to verify the hook get format function is building", "long_descr": "correct Sqoop command with correct format type.", "ret": null}, "fn_lc": [[339, 4], [350, 55]], "fn_var_ln": {"hook": [[344, 8], [344, 12]]}, "fn_var_occur": {"hook": [["hook", "SqoopHook"], ["hook", "_get_export_format_argument"], ["hook", "_get_export_format_argument"], ["hook", "_get_export_format_argument"], ["hook", "_get_export_format_argument"], ["hook", "_get_export_format_argument"]]}, "name": "test_get_export_format_argument", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSqoopHook.test_get_export_format_argument", "ret_exprs": [], "ret_type": "", "variables": {"hook": ""}, "variables_p": {"hook": [["fastapi.dependencies.models.Dependant", 0.09446247140401008]]}}, {"docstring": {"func": "Tests to verify the hook masking function will correctly mask a user password in Sqoop command.", "long_descr": null, "ret": null}, "fn_lc": [[352, 4], [360, 49]], "fn_var_ln": {"cmd": [[359, 8], [359, 11]], "hook": [[356, 8], [356, 12]]}, "fn_var_occur": {"cmd": [["hook", "cmd_mask_password", "cmd", "cmd"]], "hook": [["hook", "SqoopHook"], ["hook", "cmd_mask_password"], ["hook", "cmd_mask_password", "cmd", "cmd"]]}, "name": "test_cmd_mask_password", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSqoopHook.test_cmd_mask_password", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "hook": ""}, "variables_p": {"cmd": [["int", 0.7809915160495132], ["str", 0.07892363967928284]], "hook": []}}, {"docstring": {"func": "Tests to verify the hook creates the connection string correctly for mssql and not DB connections.", "long_descr": null, "ret": null}, "fn_lc": [[362, 4], [372, 97]], "fn_var_ln": {"hook": [[371, 8], [371, 12]]}, "fn_var_occur": {"hook": [["hook", "SqoopHook", "conn_id"], ["hook", "conn", "host", "hook", "conn", "port", "hook", "conn", "schema", "hook", "_prepare_command"], ["hook", "SqoopHook", "conn_id"], ["hook", "conn", "host", "hook", "conn", "port", "hook", "conn", "schema", "hook", "_prepare_command"]]}, "name": "test_connection_string_preparation", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSqoopHook.test_connection_string_preparation", "ret_exprs": [], "ret_type": "", "variables": {"hook": ""}, "variables_p": {"hook": [["int", 0.6997716963415141], ["bytes", 0.09245015424536575]]}}], "name": "TestSqoopHook", "q_name": "TestSqoopHook", "variables": {"_config": "", "_config_export": "", "_config_import": "", "_config_json": ""}, "variables_p": {"_config": [["str", 0.4], ["Tuple[str]", 0.2], ["Optional[Dict[str, Any]]", 0.1], ["Tuple[str, str]", 0.1], ["dict", 0.1]], "_config_export": [["str", 0.4], ["Tuple[str]", 0.2], ["Optional[Dict[str, Any]]", 0.1], ["Tuple[str, str]", 0.1], ["dict", 0.1]], "_config_import": [["str", 0.4], ["Tuple[str]", 0.2], ["Optional[Dict[str, Any]]", 0.1], ["Tuple[str, str]", 0.1], ["dict", 0.1]], "_config_json": [["str", 0.4], ["Tuple[str]", 0.2], ["Optional[Dict[str, Any]]", 0.1], ["Tuple[str, str]", 0.1], ["dict", 0.1]]}}], "funcs": [], "imports": ["__future__", "annotations", "collections", "json", "io", "StringIO", "unittest", "mock", "unittest", "mock", "call", "patch", "pytest", "airflow", "exceptions", "AirflowException", "airflow", "models", "Connection", "airflow", "providers", "apache", "sqoop", "hooks", "sqoop", "SqoopHook", "airflow", "utils", "db"], "mod_var_ln": {}, "mod_var_occur": {}, "no_types_annot": {"D": 0, "I": 0, "U": 32}, "session_id": "1AVnKwzzQXAI9qNwW5XF4Er1SPQbaoKCoeqAwN67tMg", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {}, "variables_p": {}}}