{"error": null, "response": {"classes": [{"cls_lc": [[38, 0], [398, 61]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[39, 4], [47, 48]], "fn_var_ln": {"args": [[40, 8], [40, 12]], "dag": [[41, 8], [41, 16]], "mock_context": [[47, 8], [47, 25]]}, "fn_var_occur": {"args": [["args", "DEFAULT_DATE"], ["self", "dag", "DAG", "default_args", "args"]], "dag": [["self", "dag", "DAG", "default_args", "args"]], "mock_context": [["self", "mock_context", "dict", "ti", "MagicMock"]]}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "dag", "DAG", "default_args", "args"], ["self", "mock_context", "dict", "ti", "MagicMock"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestLivyOperator.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"args": "", "dag": "", "mock_context": ""}, "variables_p": {"args": [["dict", 0.23158237319952885], ["Tuple[Any, Any]", 0.09138477310665434]], "dag": [["bool", 0.2048703308790552], ["dict", 0.19090330750955672], ["id3c.db.types.GenomeRecord", 0.13106309879648786], ["str", 0.08800142005137496], ["Exception", 0.08517259256046432]], "mock_context": [["str", 0.28787204782732057], ["Dict[str, Union[None, Any, int]]", 0.13698409202975823], ["list", 0.11172036488980237], ["Dict[str, List[Any]]", 0.09928977040162425], ["Type[Callable[[], float]]", 0.09748914365104702], ["List[Dict[str, str]]", 0.08934515601957176], ["Dict[str, Optional[str]]", 0.08925057815736039], ["Dict[str, str]", 0.08804884702351552]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[57, 8], [61, 34]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "side_effect", "params": {"_": "", "retry_args": ""}, "params_descr": {"_": "", "retry_args": ""}, "params_occur": {"_": [], "retry_args": []}, "params_p": {"_": [["Tuple[str]", 0.1], ["List[str]", 0.1]], "args": [], "kwargs": [], "retry_args": [["Tuple[str]", 0.1], ["List[str]", 0.1]], "self": []}, "q_name": "TestLivyOperator.test_poll_for_termination.<locals>.side_effect", "ret_exprs": ["return state_list.pop(0)"], "ret_type": "", "ret_type_p": [["bool", 0.3038521145263621], ["List[str]", 0.10773662290327146], ["str", 0.08802157113901043]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[54, 4], [71, 40]], "fn_var_ln": {"_livy_hook": [[66, 8], [66, 23]], "side_effect": [[63, 8], [63, 29]], "state_list": [[55, 8], [55, 18]], "task": [[65, 8], [65, 12]]}, "fn_var_occur": {"_livy_hook": [["task", "_livy_hook", "task", "get_hook"]], "side_effect": [["mock_livy", "side_effect", "side_effect"]], "state_list": [], "task": [["task", "LivyOperator", "file", "polling_interval", "dag", "self", "dag", "task_id"], ["task", "_livy_hook", "task", "get_hook"], ["task", "poll_for_termination", "BATCH_ID"]]}, "name": "test_poll_for_termination", "params": {"mock_dump_logs": "", "mock_livy": "", "self": ""}, "params_descr": {"mock_dump_logs": "", "mock_livy": "", "self": ""}, "params_occur": {"mock_dump_logs": [["mock_dump_logs", "assert_called_with", "BATCH_ID"]], "mock_livy": [["mock_livy", "side_effect", "side_effect"], ["mock_livy", "assert_called_with", "BATCH_ID", "retry_args", "None"], ["mock_livy", "call_count"]], "self": [["task", "LivyOperator", "file", "polling_interval", "dag", "self", "dag", "task_id"]]}, "params_p": {"args": [], "kwargs": [], "mock_dump_logs": [["unittesmock.MagicMock", 0.6445876194168804], ["mock.MagicMock", 0.09073942524107084]], "mock_livy": [["unittesmock.MagicMock", 0.822913410063117], ["mock.Mock", 0.09032033116778326]], "self": []}, "q_name": "TestLivyOperator.test_poll_for_termination", "ret_exprs": [], "ret_type": "", "variables": {"_livy_hook": "", "side_effect": "", "state_list": "", "task": ""}, "variables_p": {"_livy_hook": [["Dict[str, Dict[str, Any]]", 0.10055826643540179], ["decksite.data.models.person.Person", 0.09400017423453898]], "side_effect": [["str", 0.46146968833119484], ["List[Dict[str, float]]", 0.10543346334745063], ["Dict[str, Dict[str, str]]", 0.0831681400737581]], "state_list": [["bool", 0.260766112283629], ["int", 0.2367839062424071], ["bytes", 0.13037127870317966], ["Type[TodaySalary.salary.models.SalaryData]", 0.11677092856368286], ["Optional[bool]", 0.09038721178551533], ["property", 0.08013016184996181]], "task": [["dict", 0.10397900955899209], ["defaultdict", 0.08938510663390173], ["str", 0.08906431682328622], ["models.store.StoreModel", 0.08702819448258392]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[81, 8], [85, 34]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "side_effect", "params": {"_": "", "retry_args": ""}, "params_descr": {"_": "", "retry_args": ""}, "params_occur": {"_": [], "retry_args": []}, "params_p": {"_": [["Tuple[str]", 0.1], ["List[str]", 0.1]], "args": [], "kwargs": [], "retry_args": [["Tuple[str]", 0.1], ["List[str]", 0.1]], "self": []}, "q_name": "TestLivyOperator.test_poll_for_termination_fail.<locals>.side_effect", "ret_exprs": ["return state_list.pop(0)"], "ret_type": "", "ret_type_p": [["bool", 0.3038521145263621], ["List[str]", 0.10773662290327146], ["str", 0.08802157113901043]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[78, 4], [97, 40]], "fn_var_ln": {"_livy_hook": [[90, 8], [90, 23]], "side_effect": [[87, 8], [87, 29]], "state_list": [[79, 8], [79, 18]], "task": [[89, 8], [89, 12]]}, "fn_var_occur": {"_livy_hook": [["task", "_livy_hook", "task", "get_hook"]], "side_effect": [["mock_livy", "side_effect", "side_effect"]], "state_list": [], "task": [["task", "LivyOperator", "file", "polling_interval", "dag", "self", "dag", "task_id"], ["task", "_livy_hook", "task", "get_hook"], ["task", "poll_for_termination", "BATCH_ID"]]}, "name": "test_poll_for_termination_fail", "params": {"mock_dump_logs": "", "mock_livy": "", "self": ""}, "params_descr": {"mock_dump_logs": "", "mock_livy": "", "self": ""}, "params_occur": {"mock_dump_logs": [["mock_dump_logs", "assert_called_with", "BATCH_ID"]], "mock_livy": [["mock_livy", "side_effect", "side_effect"], ["mock_livy", "assert_called_with", "BATCH_ID", "retry_args", "None"], ["mock_livy", "call_count"]], "self": [["task", "LivyOperator", "file", "polling_interval", "dag", "self", "dag", "task_id"]]}, "params_p": {"args": [], "kwargs": [], "mock_dump_logs": [["unittesmock.MagicMock", 0.6445876194168804], ["mock.MagicMock", 0.09073942524107084]], "mock_livy": [["unittesmock.MagicMock", 0.822913410063117], ["mock.Mock", 0.09032033116778326]], "self": []}, "q_name": "TestLivyOperator.test_poll_for_termination_fail", "ret_exprs": [], "ret_type": "", "variables": {"_livy_hook": "", "side_effect": "", "state_list": "", "task": ""}, "variables_p": {"_livy_hook": [["Dict[str, Dict[str, Any]]", 0.10055826643540179], ["decksite.data.models.person.Person", 0.09400017423453898]], "side_effect": [["str", 0.46146968833119484], ["List[Dict[str, float]]", 0.10543346334745063], ["Dict[str, Dict[str, str]]", 0.0831681400737581]], "state_list": [["bool", 0.260766112283629], ["int", 0.2367839062424071], ["bytes", 0.13037127870317966], ["Type[TodaySalary.salary.models.SalaryData]", 0.11677092856368286], ["Optional[bool]", 0.09038721178551533], ["property", 0.08013016184996181]], "task": [["dict", 0.10397900955899209], ["defaultdict", 0.08938510663390173], ["str", 0.08906431682328622], ["models.store.StoreModel", 0.08702819448258392]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[109, 4], [124, 93]], "fn_var_ln": {"call_args": [[119, 8], [119, 17]], "task": [[110, 8], [110, 12]]}, "fn_var_occur": {"call_args": [["call_args", "k", "v", "k", "v", "mock_post", "call_args", "kwargs", "items", "v"]], "task": [["task", "LivyOperator", "livy_conn_id", "file", "polling_interval", "dag", "self", "dag", "task_id"], ["task", "execute", "context", "self", "mock_context"]]}, "name": "test_execution", "params": {"mock_dump_logs": "", "mock_get": "", "mock_get_batch": "", "mock_post": "", "self": ""}, "params_descr": {"mock_dump_logs": "", "mock_get": "", "mock_get_batch": "", "mock_post": "", "self": ""}, "params_occur": {"mock_dump_logs": [["mock_dump_logs", "assert_called_once_with", "BATCH_ID"]], "mock_get": [["mock_get", "assert_called_once_with", "BATCH_ID", "retry_args", "None"]], "mock_get_batch": [["mock_get_batch", "assert_called_once_with", "BATCH_ID"]], "mock_post": [["call_args", "k", "v", "k", "v", "mock_post", "call_args", "kwargs", "items", "v"]], "self": [["task", "LivyOperator", "livy_conn_id", "file", "polling_interval", "dag", "self", "dag", "task_id"], ["task", "execute", "context", "self", "mock_context"], ["self", "mock_context", "xcom_push", "assert_called_once_with", "key", "value", "APP_ID"]]}, "params_p": {"args": [], "kwargs": [], "mock_dump_logs": [["unittesmock.MagicMock", 0.2805306791282882]], "mock_get": [["unittesmock.MagicMock", 0.6415448946444482], ["str", 0.08763986271780597]], "mock_get_batch": [["unittesmock.MagicMock", 0.6154813126774498]], "mock_post": [["core_lib.core.models.Venue", 0.10365536195165968], ["str", 0.09998347619632911]], "self": []}, "q_name": "TestLivyOperator.test_execution", "ret_exprs": [], "ret_type": "", "variables": {"call_args": "", "task": ""}, "variables_p": {"call_args": [["dict", 0.23770925264660947], ["Dict[str, Any]", 0.19597856751246984], ["Dict[str, Union[Any, int]]", 0.10470315268897976], ["KeysView[str]", 0.10321733960473224], ["Dict[str, Union[Any, Any, Any, Any, Any]]", 0.09055255100734759], ["set", 0.08971407907193907], ["Dict[Any, List[Any]]", 0.0877707034075354]], "task": [["defaultdict", 0.10064660417667058], ["rotkehlchen.db.settings.DBSettings", 0.09470094650040904]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[128, 4], [136, 61]], "fn_var_ln": {"extra_options": [[129, 8], [129, 21]], "task": [[130, 8], [130, 12]]}, "fn_var_occur": {"extra_options": [["extra_options", "True"], ["task", "LivyOperator", "file", "dag", "self", "dag", "task_id", "extra_options", "extra_options"], ["task", "get_hook", "extra_options", "extra_options"]], "task": [["task", "LivyOperator", "file", "dag", "self", "dag", "task_id", "extra_options", "extra_options"], ["task", "execute", "context", "self", "mock_context"], ["task", "get_hook", "extra_options", "extra_options"]]}, "name": "test_execution_with_extra_options", "params": {"mock_get_batch": "", "mock_post": "", "self": ""}, "params_descr": {"mock_get_batch": "", "mock_post": "", "self": ""}, "params_occur": {"mock_get_batch": [], "mock_post": [], "self": [["task", "LivyOperator", "file", "dag", "self", "dag", "task_id", "extra_options", "extra_options"], ["task", "execute", "context", "self", "mock_context"]]}, "params_p": {"args": [], "kwargs": [], "mock_get_batch": [["unittesmock.MagicMock", 0.34156196457230426], ["mock.MagicMock", 0.14049466585792264], ["str", 0.07344661613788371], ["mock.Mock", 0.06974942393590991]], "mock_post": [["unittesmock.MagicMock", 0.34156196457230426], ["mock.MagicMock", 0.14049466585792264], ["str", 0.07344661613788371], ["mock.Mock", 0.06974942393590991]], "self": []}, "q_name": "TestLivyOperator.test_execution_with_extra_options", "ret_exprs": [], "ret_type": "", "variables": {"extra_options": "", "task": ""}, "variables_p": {"extra_options": [["str", 0.10034610812963114], ["Dict[int, int]", 0.1001853841654229], ["Dict[str, Any]", 0.09745323254520843], ["Dict[Any, int]", 0.09246762438939679], ["Dict[str, str]", 0.09097899437316116]], "task": [["Counter[str]", 0.09897002185361985], ["zaimcsvconverter.models.Store", 0.08230315501332777], ["Generator[Any, None, None]", 0.08133900250733306]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[141, 4], [148, 53]], "fn_var_ln": {"task": [[142, 8], [142, 12]]}, "fn_var_occur": {"task": [["task", "LivyOperator", "livy_conn_id", "file", "dag", "self", "dag", "task_id"], ["task", "execute", "context", "self", "mock_context"], ["task", "kill"]]}, "name": "test_deletion", "params": {"mock_delete": "", "mock_get_batch": "", "mock_post": "", "self": ""}, "params_descr": {"mock_delete": "", "mock_get_batch": "", "mock_post": "", "self": ""}, "params_occur": {"mock_delete": [["mock_delete", "assert_called_once_with", "BATCH_ID"]], "mock_get_batch": [], "mock_post": [], "self": [["task", "LivyOperator", "livy_conn_id", "file", "dag", "self", "dag", "task_id"], ["task", "execute", "context", "self", "mock_context"]]}, "params_p": {"args": [], "kwargs": [], "mock_delete": [["unittesmock.MagicMock", 0.21908870106962863], ["mock.MagicMock", 0.09458567865040685]], "mock_get_batch": [["mock.Mock", 0.5091561680846166], ["unittesmock.MagicMock", 0.1944759309442738]], "mock_post": [["mock.Mock", 0.5091561680846166], ["unittesmock.MagicMock", 0.1944759309442738]], "self": []}, "q_name": "TestLivyOperator.test_deletion", "ret_exprs": [], "ret_type": "", "variables": {"task": ""}, "variables_p": {"task": [["str", 0.1097476086437938], ["Dict[str, dict]", 0.10671900294613787], ["tracim.models.data.Content", 0.10046595765561335], ["zaimcsvconverter.models.Store", 0.09402612355030632], ["dict", 0.09196428541911254], ["defaultdict", 0.08489727975349964]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[150, 4], [156, 42]], "fn_var_ln": {"_livy_hook": [[154, 8], [154, 23]], "def_hook": [[151, 8], [151, 16]], "task": [[153, 8], [153, 12]]}, "fn_var_occur": {"_livy_hook": [["task", "_livy_hook", "def_hook"]], "def_hook": [["def_hook", "LivyHook", "livy_conn_id"], ["task", "_livy_hook", "def_hook"], ["task", "get_hook", "def_hook"]], "task": [["task", "LivyOperator", "file", "dag", "self", "dag", "task_id"], ["task", "_livy_hook", "def_hook"], ["task", "get_hook", "def_hook"]]}, "name": "test_injected_hook", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "LivyOperator", "file", "dag", "self", "dag", "task_id"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestLivyOperator.test_injected_hook", "ret_exprs": [], "ret_type": "", "variables": {"_livy_hook": "", "def_hook": "", "task": ""}, "variables_p": {"_livy_hook": [["str", 0.9999999998589113], ["float", 5.0293977863003915e-11], ["List[Tuple[Any, Any]]", 3.280465135645566e-11], ["int", 1.6741493678777148e-11], ["Callable", 1.3150431712564683e-11], ["Dict[str, Any]", 1.2484896413883547e-11]], "def_hook": [["Optional[excars.models.profiles.Profile]", 0.12484104838553883], ["List[str]", 0.11206197439193843]], "task": [["zaimcsvconverter.models.Store", 0.13840251911061013], ["defaultdict", 0.10257031404067753], ["Dict[str, dict]", 0.08620954793069119], ["Dict[str, str]", 0.08265518707668347]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[165, 4], [182, 63]], "fn_var_ln": {"task": [[166, 8], [166, 12]]}, "fn_var_occur": {"task": [["task", "LivyOperator", "livy_conn_id", "file", "dag", "self", "dag", "task_id", "polling_interval"], ["caplog", "at_level", "level", "logging", "INFO", "logger", "task", "get_hook", "log", "name"], ["task", "execute", "context", "self", "mock_context"]]}, "name": "test_log_dump", "params": {"caplog": "", "mock_get": "", "mock_get_batch": "", "mock_get_logs": "", "mock_post": "", "self": ""}, "params_descr": {"caplog": "", "mock_get": "", "mock_get_batch": "", "mock_get_logs": "", "mock_post": "", "self": ""}, "params_occur": {"caplog": [["caplog", "clear"], ["caplog", "at_level", "level", "logging", "INFO", "logger", "task", "get_hook", "log", "name"], ["caplog", "messages"], ["caplog", "messages"], ["caplog", "messages"]], "mock_get": [["mock_get", "assert_called_once_with", "BATCH_ID", "retry_args", "None"]], "mock_get_batch": [], "mock_get_logs": [["mock_get_logs", "assert_called_once_with", "BATCH_ID"]], "mock_post": [], "self": [["task", "LivyOperator", "livy_conn_id", "file", "dag", "self", "dag", "task_id", "polling_interval"], ["task", "execute", "context", "self", "mock_context"]]}, "params_p": {"args": [], "caplog": [], "kwargs": [], "mock_get": [["unittesmock.MagicMock", 0.31907792757195697], ["mock.Mock", 0.26994007321954544]], "mock_get_batch": [["mock.Mock", 0.5738627211048329], ["unittesmock.MagicMock", 0.19570473128618485]], "mock_get_logs": [["unittesmock.MagicMock", 0.3315518988465856], ["mock.MagicMock", 0.09193331215731687]], "mock_post": [["mock.Mock", 0.5738627211048329], ["unittesmock.MagicMock", 0.19570473128618485]], "self": []}, "q_name": "TestLivyOperator.test_log_dump", "ret_exprs": [], "ret_type": "", "variables": {"task": ""}, "variables_p": {"task": [["Dict[str, dict]", 0.11135156221442144], ["tracim.models.data.Content", 0.10661664367331626], ["defaultdict", 0.1039378925397765], ["Dict[str, Union[Any, str]]", 0.08827773456779053]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[192, 8], [196, 34]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "side_effect", "params": {"_": "", "retry_args": ""}, "params_descr": {"_": "", "retry_args": ""}, "params_occur": {"_": [], "retry_args": []}, "params_p": {"_": [["Tuple[str]", 0.1], ["List[str]", 0.1]], "args": [], "kwargs": [], "retry_args": [["Tuple[str]", 0.1], ["List[str]", 0.1]], "self": []}, "q_name": "TestLivyOperator.test_poll_for_termination_deferrable.<locals>.side_effect", "ret_exprs": ["return state_list.pop(0)"], "ret_type": "", "ret_type_p": [["bool", 0.3038521145263621], ["List[str]", 0.10773662290327146], ["str", 0.08802157113901043]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[189, 4], [208, 40]], "fn_var_ln": {"_livy_hook": [[203, 8], [203, 23]], "side_effect": [[198, 8], [198, 29]], "state_list": [[190, 8], [190, 18]], "task": [[200, 8], [200, 12]]}, "fn_var_occur": {"_livy_hook": [["task", "_livy_hook", "task", "get_hook"]], "side_effect": [["mock_livy", "side_effect", "side_effect"]], "state_list": [], "task": [["task", "LivyOperator", "file", "polling_interval", "dag", "self", "dag", "task_id", "deferrable", "True"], ["task", "_livy_hook", "task", "get_hook"], ["task", "poll_for_termination", "BATCH_ID"]]}, "name": "test_poll_for_termination_deferrable", "params": {"mock_dump_logs": "", "mock_livy": "", "self": ""}, "params_descr": {"mock_dump_logs": "", "mock_livy": "", "self": ""}, "params_occur": {"mock_dump_logs": [["mock_dump_logs", "assert_called_with", "BATCH_ID"]], "mock_livy": [["mock_livy", "side_effect", "side_effect"], ["mock_livy", "assert_called_with", "BATCH_ID", "retry_args", "None"], ["mock_livy", "call_count"]], "self": [["task", "LivyOperator", "file", "polling_interval", "dag", "self", "dag", "task_id", "deferrable", "True"]]}, "params_p": {"args": [], "kwargs": [], "mock_dump_logs": [["unittesmock.MagicMock", 0.6445876194168804], ["mock.MagicMock", 0.09073942524107084]], "mock_livy": [["unittesmock.MagicMock", 0.822913410063117], ["mock.Mock", 0.09032033116778326]], "self": []}, "q_name": "TestLivyOperator.test_poll_for_termination_deferrable", "ret_exprs": [], "ret_type": "", "variables": {"_livy_hook": "", "side_effect": "", "state_list": "", "task": ""}, "variables_p": {"_livy_hook": [["Dict[str, Dict[str, Any]]", 0.10055826643540179], ["decksite.data.models.person.Person", 0.09400017423453898]], "side_effect": [["str", 0.46146968833119484], ["List[Dict[str, float]]", 0.10543346334745063], ["Dict[str, Dict[str, str]]", 0.0831681400737581]], "state_list": [["bool", 0.260766112283629], ["int", 0.2367839062424071], ["bytes", 0.13037127870317966], ["Type[TodaySalary.salary.models.SalaryData]", 0.11677092856368286], ["Optional[bool]", 0.09038721178551533], ["property", 0.08013016184996181]], "task": [["dict", 0.09202474695588839], ["defaultdict", 0.08687741473568003], ["models.store.StoreModel", 0.08130621972620809]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[218, 8], [222, 34]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "side_effect", "params": {"_": "", "retry_args": ""}, "params_descr": {"_": "", "retry_args": ""}, "params_occur": {"_": [], "retry_args": []}, "params_p": {"_": [["Tuple[str]", 0.1], ["List[str]", 0.1]], "args": [], "kwargs": [], "retry_args": [["Tuple[str]", 0.1], ["List[str]", 0.1]], "self": []}, "q_name": "TestLivyOperator.test_poll_for_termination_fail_deferrable.<locals>.side_effect", "ret_exprs": ["return state_list.pop(0)"], "ret_type": "", "ret_type_p": [["bool", 0.3038521145263621], ["List[str]", 0.10773662290327146], ["str", 0.08802157113901043]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[215, 4], [236, 40]], "fn_var_ln": {"_livy_hook": [[229, 8], [229, 23]], "side_effect": [[224, 8], [224, 29]], "state_list": [[216, 8], [216, 18]], "task": [[226, 8], [226, 12]]}, "fn_var_occur": {"_livy_hook": [["task", "_livy_hook", "task", "get_hook"]], "side_effect": [["mock_livy", "side_effect", "side_effect"]], "state_list": [], "task": [["task", "LivyOperator", "file", "polling_interval", "dag", "self", "dag", "task_id", "deferrable", "True"], ["task", "_livy_hook", "task", "get_hook"], ["task", "poll_for_termination", "BATCH_ID"]]}, "name": "test_poll_for_termination_fail_deferrable", "params": {"mock_dump_logs": "", "mock_livy": "", "self": ""}, "params_descr": {"mock_dump_logs": "", "mock_livy": "", "self": ""}, "params_occur": {"mock_dump_logs": [["mock_dump_logs", "assert_called_with", "BATCH_ID"]], "mock_livy": [["mock_livy", "side_effect", "side_effect"], ["mock_livy", "assert_called_with", "BATCH_ID", "retry_args", "None"], ["mock_livy", "call_count"]], "self": [["task", "LivyOperator", "file", "polling_interval", "dag", "self", "dag", "task_id", "deferrable", "True"]]}, "params_p": {"args": [], "kwargs": [], "mock_dump_logs": [["unittesmock.MagicMock", 0.6445876194168804], ["mock.MagicMock", 0.09073942524107084]], "mock_livy": [["unittesmock.MagicMock", 0.822913410063117], ["mock.Mock", 0.09032033116778326]], "self": []}, "q_name": "TestLivyOperator.test_poll_for_termination_fail_deferrable", "ret_exprs": [], "ret_type": "", "variables": {"_livy_hook": "", "side_effect": "", "state_list": "", "task": ""}, "variables_p": {"_livy_hook": [["Dict[str, Dict[str, Any]]", 0.10055826643540179], ["decksite.data.models.person.Person", 0.09400017423453898]], "side_effect": [["str", 0.46146968833119484], ["List[Dict[str, float]]", 0.10543346334745063], ["Dict[str, Dict[str, str]]", 0.0831681400737581]], "state_list": [["bool", 0.260766112283629], ["int", 0.2367839062424071], ["bytes", 0.13037127870317966], ["Type[TodaySalary.salary.models.SalaryData]", 0.11677092856368286], ["Optional[bool]", 0.09038721178551533], ["property", 0.08013016184996181]], "task": [["dict", 0.09202474695588839], ["defaultdict", 0.08687741473568003], ["models.store.StoreModel", 0.08130621972620809]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[249, 4], [265, 93]], "fn_var_ln": {"call_args": [[260, 8], [260, 17]], "task": [[250, 8], [250, 12]]}, "fn_var_occur": {"call_args": [["call_args", "k", "v", "k", "v", "mock_post", "call_args", "items", "v"]], "task": [["task", "LivyOperator", "livy_conn_id", "file", "polling_interval", "dag", "self", "dag", "task_id", "deferrable", "True"], ["task", "execute", "context", "self", "mock_context"]]}, "name": "test_execution_deferrable", "params": {"mock_defer": "", "mock_dump_logs": "", "mock_get": "", "mock_get_batch": "", "mock_post": "", "self": ""}, "params_descr": {"mock_defer": "", "mock_dump_logs": "", "mock_get": "", "mock_get_batch": "", "mock_post": "", "self": ""}, "params_occur": {"mock_defer": [["mock_defer", "called"]], "mock_dump_logs": [["mock_dump_logs", "assert_called_once_with", "BATCH_ID"]], "mock_get": [["mock_get", "assert_called_once_with", "BATCH_ID", "retry_args", "None"]], "mock_get_batch": [["mock_get_batch", "assert_called_once_with", "BATCH_ID"]], "mock_post": [["call_args", "k", "v", "k", "v", "mock_post", "call_args", "items", "v"]], "self": [["task", "LivyOperator", "livy_conn_id", "file", "polling_interval", "dag", "self", "dag", "task_id", "deferrable", "True"], ["task", "execute", "context", "self", "mock_context"], ["self", "mock_context", "xcom_push", "assert_called_once_with", "key", "value", "APP_ID"]]}, "params_p": {"args": [], "kwargs": [], "mock_defer": [["unittesmock.MagicMock", 0.6930452253606443], ["mock.Mock", 0.11492355334189049], ["mock.MagicMock", 0.10189636567134909]], "mock_dump_logs": [["unittesmock.MagicMock", 0.2805306791282882]], "mock_get": [["unittesmock.MagicMock", 0.6415448946444482], ["str", 0.08763986271780597]], "mock_get_batch": [["unittesmock.MagicMock", 0.6154813126774498]], "mock_post": [["unittesmock.MagicMock", 0.11665683359989797], ["str", 0.09704424800402216]], "self": []}, "q_name": "TestLivyOperator.test_execution_deferrable", "ret_exprs": [], "ret_type": "", "variables": {"call_args": "", "task": ""}, "variables_p": {"call_args": [["Dict[str, Any]", 0.2095504549306419], ["Mapping[str, Mapping[str, Any]]", 0.11767503827031427], ["Dict[str, str]", 0.10191352836437588], ["List[str]", 0.09842583341663506], ["Tuple[Literal]", 0.09208194371592064], ["dict", 0.0871492010808791]], "task": [["dict", 0.21962107688089014], ["str", 0.19893219134917436], ["defaultdict", 0.10185717611400182], ["tracim.models.data.Content", 0.097459629017975]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[277, 4], [290, 61]], "fn_var_ln": {"extra_options": [[280, 8], [280, 21]], "task": [[281, 8], [281, 12]]}, "fn_var_occur": {"extra_options": [["extra_options", "True"], ["task", "LivyOperator", "file", "dag", "self", "dag", "task_id", "extra_options", "extra_options", "deferrable", "True"], ["task", "get_hook", "extra_options", "extra_options"]], "task": [["task", "LivyOperator", "file", "dag", "self", "dag", "task_id", "extra_options", "extra_options", "deferrable", "True"], ["task", "execute", "context", "self", "mock_context"], ["task", "get_hook", "extra_options", "extra_options"]]}, "name": "test_execution_with_extra_options_deferrable", "params": {"mock_dump_logs": "", "mock_get_batch": "", "mock_get_batch_state": "", "mock_post": "", "self": ""}, "params_descr": {"mock_dump_logs": "", "mock_get_batch": "", "mock_get_batch_state": "", "mock_post": "", "self": ""}, "params_occur": {"mock_dump_logs": [], "mock_get_batch": [], "mock_get_batch_state": [], "mock_post": [], "self": [["task", "LivyOperator", "file", "dag", "self", "dag", "task_id", "extra_options", "extra_options", "deferrable", "True"], ["task", "execute", "context", "self", "mock_context"]]}, "params_p": {"args": [], "kwargs": [], "mock_dump_logs": [["mock.Mock", 0.6859744420938609], ["unittesmock.MagicMock", 0.23914904493762063]], "mock_get_batch": [["mock.Mock", 0.6859744420938609], ["unittesmock.MagicMock", 0.23914904493762063]], "mock_get_batch_state": [["mock.Mock", 0.6859744420938609], ["unittesmock.MagicMock", 0.23914904493762063]], "mock_post": [["mock.Mock", 0.6859744420938609], ["unittesmock.MagicMock", 0.23914904493762063]], "self": []}, "q_name": "TestLivyOperator.test_execution_with_extra_options_deferrable", "ret_exprs": [], "ret_type": "", "variables": {"extra_options": "", "task": ""}, "variables_p": {"extra_options": [["List[str]", 0.1133718429665919], ["Dict[str, Dict[str, Any]]", 0.10527319818943313], ["mock.MagicMock", 0.09257920058376233], ["Dict[str, Any]", 0.09095646470537688], ["dict", 0.08685216516854942]], "task": [["defaultdict", 0.09318587895276423], ["dict", 0.09071138866975617], ["models.store.StoreModel", 0.08787098122879361]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[303, 4], [316, 53]], "fn_var_ln": {"task": [[306, 8], [306, 12]]}, "fn_var_occur": {"task": [["task", "LivyOperator", "livy_conn_id", "file", "dag", "self", "dag", "task_id", "deferrable", "True"], ["task", "execute", "context", "self", "mock_context"], ["task", "kill"]]}, "name": "test_deletion_deferrable", "params": {"mock_delete": "", "mock_dump_logs": "", "mock_get_batch": "", "mock_get_batch_state": "", "mock_post": "", "self": ""}, "params_descr": {"mock_delete": "", "mock_dump_logs": "", "mock_get_batch": "", "mock_get_batch_state": "", "mock_post": "", "self": ""}, "params_occur": {"mock_delete": [["mock_delete", "assert_called_once_with", "BATCH_ID"]], "mock_dump_logs": [], "mock_get_batch": [], "mock_get_batch_state": [], "mock_post": [], "self": [["task", "LivyOperator", "livy_conn_id", "file", "dag", "self", "dag", "task_id", "deferrable", "True"], ["task", "execute", "context", "self", "mock_context"]]}, "params_p": {"args": [], "kwargs": [], "mock_delete": [["unittesmock.MagicMock", 0.16286738945820067], ["mock.Mock", 0.12731959149399782]], "mock_dump_logs": [["mock.Mock", 0.7492194715394879], ["unittesmock.MagicMock", 0.1761208989403219]], "mock_get_batch": [["mock.Mock", 0.7492194715394879], ["unittesmock.MagicMock", 0.1761208989403219]], "mock_get_batch_state": [["mock.Mock", 0.7492194715394879], ["unittesmock.MagicMock", 0.1761208989403219]], "mock_post": [["mock.Mock", 0.7492194715394879], ["unittesmock.MagicMock", 0.1761208989403219]], "self": []}, "q_name": "TestLivyOperator.test_deletion_deferrable", "ret_exprs": [], "ret_type": "", "variables": {"task": ""}, "variables_p": {"task": [["tracim.models.data.Content", 0.13015176457872313], ["Dict[str, dict]", 0.11159082326735435], ["str", 0.09362986905630068], ["defaultdict", 0.08725071227630189]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[318, 4], [324, 42]], "fn_var_ln": {"_livy_hook": [[322, 8], [322, 23]], "def_hook": [[319, 8], [319, 16]], "task": [[321, 8], [321, 12]]}, "fn_var_occur": {"_livy_hook": [["task", "_livy_hook", "def_hook"]], "def_hook": [["def_hook", "LivyHook", "livy_conn_id"], ["task", "_livy_hook", "def_hook"], ["task", "get_hook", "def_hook"]], "task": [["task", "LivyOperator", "file", "dag", "self", "dag", "task_id", "deferrable", "True"], ["task", "_livy_hook", "def_hook"], ["task", "get_hook", "def_hook"]]}, "name": "test_injected_hook_deferrable", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["task", "LivyOperator", "file", "dag", "self", "dag", "task_id", "deferrable", "True"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestLivyOperator.test_injected_hook_deferrable", "ret_exprs": [], "ret_type": "", "variables": {"_livy_hook": "", "def_hook": "", "task": ""}, "variables_p": {"_livy_hook": [["str", 0.9999999998589113], ["float", 5.0293977863003915e-11], ["List[Tuple[Any, Any]]", 3.280465135645566e-11], ["int", 1.6741493678777148e-11], ["Callable", 1.3150431712564683e-11], ["Dict[str, Any]", 1.2484896413883547e-11]], "def_hook": [["Optional[excars.models.profiles.Profile]", 0.12484104838553883], ["List[str]", 0.11206197439193843]], "task": [["dict", 0.09093895118262132], ["defaultdict", 0.0879122845170801], ["models.store.StoreModel", 0.08781208108248857]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[333, 4], [352, 63]], "fn_var_ln": {"task": [[334, 8], [334, 12]]}, "fn_var_occur": {"task": [["task", "LivyOperator", "livy_conn_id", "file", "dag", "self", "dag", "task_id", "polling_interval", "deferrable", "True"], ["caplog", "at_level", "level", "logging", "INFO", "logger", "task", "get_hook", "log", "name"], ["task", "execute", "context", "self", "mock_context"]]}, "name": "test_log_dump_deferrable", "params": {"caplog": "", "mock_get": "", "mock_get_batch": "", "mock_get_logs": "", "mock_post": "", "self": ""}, "params_descr": {"caplog": "", "mock_get": "", "mock_get_batch": "", "mock_get_logs": "", "mock_post": "", "self": ""}, "params_occur": {"caplog": [["caplog", "clear"], ["caplog", "at_level", "level", "logging", "INFO", "logger", "task", "get_hook", "log", "name"], ["caplog", "messages"], ["caplog", "messages"], ["caplog", "messages"]], "mock_get": [["mock_get", "assert_called_once_with", "BATCH_ID", "retry_args", "None"]], "mock_get_batch": [], "mock_get_logs": [["mock_get_logs", "assert_called_once_with", "BATCH_ID"]], "mock_post": [], "self": [["task", "LivyOperator", "livy_conn_id", "file", "dag", "self", "dag", "task_id", "polling_interval", "deferrable", "True"], ["task", "execute", "context", "self", "mock_context"]]}, "params_p": {"args": [], "caplog": [], "kwargs": [], "mock_get": [["unittesmock.MagicMock", 0.31907792757195697], ["mock.Mock", 0.26994007321954544]], "mock_get_batch": [["mock.Mock", 0.5738627211048329], ["unittesmock.MagicMock", 0.19570473128618485]], "mock_get_logs": [["unittesmock.MagicMock", 0.3315518988465856], ["mock.MagicMock", 0.09193331215731687]], "mock_post": [["mock.Mock", 0.5738627211048329], ["unittesmock.MagicMock", 0.19570473128618485]], "self": []}, "q_name": "TestLivyOperator.test_log_dump_deferrable", "ret_exprs": [], "ret_type": "", "variables": {"task": ""}, "variables_p": {"task": [["tracim.models.data.Content", 0.317460628629334], ["Dict[str, dict]", 0.09959535932819101], ["defaultdict", 0.09849378413016954]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[356, 4], [376, 93]], "fn_var_ln": {"result": [[365, 8], [365, 14]], "task": [[357, 8], [357, 12]]}, "fn_var_occur": {"result": [["result", "task", "execute_complete", "context", "self", "mock_context", "event", "None", "BATCH_ID"], ["result", "BATCH_ID"]], "task": [["task", "LivyOperator", "livy_conn_id", "file", "dag", "self", "dag", "task_id", "polling_interval", "deferrable", "True"], ["result", "task", "execute_complete", "context", "self", "mock_context", "event", "None", "BATCH_ID"]]}, "name": "test_execute_complete_success", "params": {"mock_get": "", "mock_post": "", "self": ""}, "params_descr": {"mock_get": "", "mock_post": "", "self": ""}, "params_occur": {"mock_get": [], "mock_post": [], "self": [["task", "LivyOperator", "livy_conn_id", "file", "dag", "self", "dag", "task_id", "polling_interval", "deferrable", "True"], ["result", "task", "execute_complete", "context", "self", "mock_context", "event", "None", "BATCH_ID"], ["self", "mock_context", "xcom_push", "assert_called_once_with", "key", "value", "APP_ID"]]}, "params_p": {"args": [], "kwargs": [], "mock_get": [["mock.Mock", 0.26674719549060233], ["unittesmock.MagicMock", 0.2237007449146432]], "mock_post": [["mock.Mock", 0.26674719549060233], ["unittesmock.MagicMock", 0.2237007449146432]], "self": []}, "q_name": "TestLivyOperator.test_execute_complete_success", "ret_exprs": [], "ret_type": "", "variables": {"result": "", "task": ""}, "variables_p": {"result": [["Dict[str, str]", 0.18556274206070547], ["list", 0.10205501645637279]], "task": [["Dict[str, dict]", 0.11481464705859228], ["tracim.models.data.Content", 0.11366864421366416], ["zaimcsvconverter.models.Store", 0.0911952713582634], ["str", 0.09014477540164344], ["defaultdict", 0.08363921117165994]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[379, 4], [398, 61]], "fn_var_ln": {"task": [[380, 8], [380, 12]]}, "fn_var_occur": {"task": [["task", "LivyOperator", "livy_conn_id", "file", "dag", "self", "dag", "task_id", "polling_interval", "deferrable", "True"], ["task", "execute_complete", "context", "self", "mock_context", "event", "BATCH_ID"]]}, "name": "test_execute_complete_error", "params": {"mock_post": "", "self": ""}, "params_descr": {"mock_post": "", "self": ""}, "params_occur": {"mock_post": [], "self": [["task", "LivyOperator", "livy_conn_id", "file", "dag", "self", "dag", "task_id", "polling_interval", "deferrable", "True"], ["task", "execute_complete", "context", "self", "mock_context", "event", "BATCH_ID"], ["self", "mock_context", "xcom_push", "assert_not_called"]]}, "params_p": {"args": [], "kwargs": [], "mock_post": [["unittesmock.MagicMock", 0.3086745121226416], ["mock.Mock", 0.30024604082601847], ["mock.MagicMock", 0.09088455497061498]], "self": []}, "q_name": "TestLivyOperator.test_execute_complete_error", "ret_exprs": [], "ret_type": "", "variables": {"task": ""}, "variables_p": {"task": [["tracim.models.data.Content", 0.2297340533162704], ["Dict[str, dict]", 0.10058267838158762], ["defaultdict", 0.08874589173931108]]}}], "name": "TestLivyOperator", "q_name": "TestLivyOperator", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["__future__", "annotations", "logging", "unittest", "mock", "MagicMock", "patch", "pytest", "airflow", "exceptions", "AirflowException", "airflow", "models", "Connection", "airflow", "models", "dag", "DAG", "airflow", "providers", "apache", "livy", "hooks", "livy", "BatchState", "LivyHook", "airflow", "providers", "apache", "livy", "operators", "livy", "LivyOperator", "airflow", "utils", "db", "timezone"], "mod_var_ln": {"APP_ID": [[33, 0], [33, 6]], "BATCH_ID": [[32, 0], [32, 8]], "DEFAULT_DATE": [[31, 0], [31, 12]], "GET_BATCH": [[34, 0], [34, 9]], "LOG_RESPONSE": [[35, 0], [35, 12]]}, "mod_var_occur": {"APP_ID": [["GET_BATCH", "APP_ID"], ["self", "mock_context", "xcom_push", "assert_called_once_with", "key", "value", "APP_ID"], ["self", "mock_context", "xcom_push", "assert_called_once_with", "key", "value", "APP_ID"], ["self", "mock_context", "xcom_push", "assert_called_once_with", "key", "value", "APP_ID"]], "BATCH_ID": [["task", "poll_for_termination", "BATCH_ID"], ["mock_livy", "assert_called_with", "BATCH_ID", "retry_args", "None"], ["mock_dump_logs", "assert_called_with", "BATCH_ID"], ["task", "poll_for_termination", "BATCH_ID"], ["mock_livy", "assert_called_with", "BATCH_ID", "retry_args", "None"], ["mock_dump_logs", "assert_called_with", "BATCH_ID"], ["mock_get", "assert_called_once_with", "BATCH_ID", "retry_args", "None"], ["mock_dump_logs", "assert_called_once_with", "BATCH_ID"], ["mock_get_batch", "assert_called_once_with", "BATCH_ID"], ["mock_delete", "assert_called_once_with", "BATCH_ID"], ["mock_get", "assert_called_once_with", "BATCH_ID", "retry_args", "None"], ["mock_get_logs", "assert_called_once_with", "BATCH_ID"], ["task", "poll_for_termination", "BATCH_ID"], ["mock_livy", "assert_called_with", "BATCH_ID", "retry_args", "None"], ["mock_dump_logs", "assert_called_with", "BATCH_ID"], ["task", "poll_for_termination", "BATCH_ID"], ["mock_livy", "assert_called_with", "BATCH_ID", "retry_args", "None"], ["mock_dump_logs", "assert_called_with", "BATCH_ID"], ["mock_get", "assert_called_once_with", "BATCH_ID", "retry_args", "None"], ["mock_dump_logs", "assert_called_once_with", "BATCH_ID"], ["mock_get_batch", "assert_called_once_with", "BATCH_ID"], ["mock_delete", "assert_called_once_with", "BATCH_ID"], ["mock_get", "assert_called_once_with", "BATCH_ID", "retry_args", "None"], ["mock_get_logs", "assert_called_once_with", "BATCH_ID"], ["result", "task", "execute_complete", "context", "self", "mock_context", "event", "None", "BATCH_ID"], ["result", "BATCH_ID"], ["task", "execute_complete", "context", "self", "mock_context", "event", "BATCH_ID"]], "DEFAULT_DATE": [["args", "DEFAULT_DATE"]], "GET_BATCH": [], "LOG_RESPONSE": []}, "no_types_annot": {"D": 0, "I": 0, "U": 109}, "session_id": "ND5cWTDJHWwDjfsnyN4EU8uDnhWAfOM8_XjqjVX-BFc", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"APP_ID": "", "BATCH_ID": "", "DEFAULT_DATE": "", "GET_BATCH": "", "LOG_RESPONSE": ""}, "variables_p": {"APP_ID": [["str", 0.7970667545903748], ["int", 0.10862580085309828], ["List[str]", 0.09430744455652691]], "BATCH_ID": [["str", 0.2680262127519445], ["List[str]", 0.09700996255821642], ["cmk.utils.type_defs.UserId", 0.08842662608148263]], "DEFAULT_DATE": [["str", 0.40571561154314545], ["Dict[str, Any]", 0.12993690078695638], ["int", 0.09257737549276539], ["myia.utils.misc.Named", 0.09091309555855764]], "GET_BATCH": [["str", 0.6], ["bool", 0.1], ["Type[bot_app.models.ConnectedApi]", 0.1]], "LOG_RESPONSE": [["Dict[str, Tuple[int, int]]", 0.33374575267092643], ["str", 0.25419450942107946], ["Dict[str, Union[Any, Any]]", 0.11124858422364214], ["Type[loan.models.Loan]", 0.10336806957904514], ["Optional[float]", 0.10169928601200749], ["list", 0.09574379809329953]]}}}