{"error": null, "response": {"classes": [{"cls_lc": [[40, 0], [215, 9]], "cls_var_ln": {"_config": [[41, 4], [41, 11]]}, "cls_var_occur": {"_config": []}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[54, 4], [56, 104]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "setup_class", "params": {"cls": ""}, "params_descr": {"cls": ""}, "params_occur": {"cls": []}, "params_p": {"args": [], "cls": [["Tuple[str]", 0.49999999978930826], ["Type", 0.49999999978930826], ["bool", 1.2432275369423927e-10], ["int", 6.761356990136683e-11], ["Optional[str]", 6.761356990136683e-11], ["Type[Any]", 4.801814051136299e-11], ["Optional[List]", 4.157460403209174e-11]], "kwargs": [], "self": []}, "q_name": "TestSparkSqlHook.setup_class", "ret_exprs": [], "ret_type": "None", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[59, 4], [60, 63]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "teardown_class", "params": {"cls": ""}, "params_descr": {"cls": ""}, "params_occur": {"cls": []}, "params_p": {"args": [], "cls": [["Tuple[str]", 0.49999999978930826], ["Type", 0.49999999978930826], ["bool", 1.2432275369423927e-10], ["int", 6.761356990136683e-11], ["Optional[str]", 6.761356990136683e-11], ["Type[Any]", 4.801814051136299e-11], ["Optional[List]", 4.157460403209174e-11]], "kwargs": [], "self": []}, "q_name": "TestSparkSqlHook.teardown_class", "ret_exprs": [], "ret_type": "None", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[62, 4], [83, 37]], "fn_var_ln": {"cmd": [[66, 8], [66, 11]], "hook": [[63, 8], [63, 12]], "k": [[79, 12], [79, 13]], "sql_path": [[74, 8], [74, 16]], "v": [[79, 15], [79, 16]]}, "fn_var_occur": {"cmd": [["cmd", "join", "hook", "_prepare_command"], ["self", "_config", "cmd"], ["self", "_config", "cmd"], ["self", "_config", "cmd"], ["self", "_config", "cmd"], ["self", "_config", "cmd"], ["k", "v", "cmd"]], "hook": [["hook", "SparkSqlHook", "self", "_config"], ["cmd", "join", "hook", "_prepare_command"], ["sql_path", "get_after", "hook", "_prepare_command"]], "k": [["k", "v", "key_value", "split"], ["k", "v", "cmd"]], "sql_path": [["sql_path", "get_after", "hook", "_prepare_command"], ["self", "_config", "strip", "sql_path"]], "v": [["k", "v", "key_value", "split"], ["k", "v", "cmd"]]}, "name": "test_build_command", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["hook", "SparkSqlHook", "self", "_config"], ["self", "_config", "cmd"], ["self", "_config", "cmd"], ["self", "_config", "cmd"], ["self", "_config", "cmd"], ["self", "_config", "cmd"], ["self", "_config", "strip", "sql_path"], ["self", "_config", "split"], ["self", "_config"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSqlHook.test_build_command", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "hook": "", "k": "", "sql_path": "", "v": ""}, "variables_p": {"cmd": [["Tuple[Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal]", 0.3586983389266866], ["str", 0.1890676911866834], ["int", 0.1232583871727966], ["bytes", 0.12066592476116006], ["list", 0.1173796478435603], ["Dict[str, str]", 0.09093001010911324]], "hook": [["str", 0.084856464334736], ["tbump.hooks.Hook", 0.08364390774876253]], "k": [["Pattern[str]", 0.5200787899481923], ["str", 0.2767146678991036], ["int", 0.20320654215270406]], "sql_path": [["str", 0.773613838697902], ["dict", 0.093012293498317]], "v": [["Pattern[str]", 0.45632411473407775], ["tuple", 0.18925605082636535], ["Pattern", 0.15989047053750471], ["List[str]", 0.08790653949708141]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[86, 4], [131, 9]], "fn_var_ln": {"hook": [[93, 8], [93, 12]]}, "fn_var_occur": {"hook": [["hook", "SparkSqlHook", "conn_id", "sql"], ["patch", "object", "hook", "log", "mock_debug"], ["patch", "object", "hook", "log", "mock_info"], ["hook", "run_query"]]}, "name": "test_spark_process_runcmd", "params": {"mock_popen": "", "self": ""}, "params_descr": {"mock_popen": "", "self": ""}, "params_occur": {"mock_popen": [["mock_popen", "return_value", "stdout", "io", "StringIO"], ["mock_popen", "return_value", "stderr", "io", "StringIO"], ["mock_popen", "return_value", "wait", "return_value"], ["mock_popen", "mock_calls", "call", "stderr", "stdout", "universal_newlines", "True"]], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_popen": [], "self": []}, "q_name": "TestSparkSqlHook.test_spark_process_runcmd", "ret_exprs": [], "ret_type": "", "variables": {"hook": ""}, "variables_p": {"hook": [["str", 0.22568204107313083]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[134, 4], [161, 9]], "fn_var_ln": {"hook": [[139, 8], [139, 12]]}, "fn_var_occur": {"hook": [["hook", "SparkSqlHook", "conn_id", "sql"], ["hook", "run_query"]]}, "name": "test_spark_process_runcmd_with_str", "params": {"mock_popen": "", "self": ""}, "params_descr": {"mock_popen": "", "self": ""}, "params_occur": {"mock_popen": [["mock_popen", "return_value", "wait", "return_value"], ["mock_popen", "mock_calls", "call", "stderr", "stdout", "universal_newlines", "True"]], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_popen": [["mock.Mock", 0.08585431836666195]], "self": []}, "q_name": "TestSparkSqlHook.test_spark_process_runcmd_with_str", "ret_exprs": [], "ret_type": "", "variables": {"hook": ""}, "variables_p": {"hook": [["str", 0.19910861981821115], ["Dict[Any, str]", 0.1171927819370811], ["Tuple[int, int, int, int]", 0.09902164764978426], ["raiden.utils.PaymentID", 0.09668725219029435]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[164, 4], [191, 9]], "fn_var_ln": {"hook": [[169, 8], [169, 12]]}, "fn_var_occur": {"hook": [["hook", "SparkSqlHook", "conn_id", "sql"], ["hook", "run_query"]]}, "name": "test_spark_process_runcmd_with_list", "params": {"mock_popen": "", "self": ""}, "params_descr": {"mock_popen": "", "self": ""}, "params_occur": {"mock_popen": [["mock_popen", "return_value", "wait", "return_value"], ["mock_popen", "mock_calls", "call", "stderr", "stdout", "universal_newlines", "True"]], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_popen": [], "self": []}, "q_name": "TestSparkSqlHook.test_spark_process_runcmd_with_list", "ret_exprs": [], "ret_type": "", "variables": {"hook": ""}, "variables_p": {"hook": [["str", 0.19910861981821115], ["Dict[Any, str]", 0.1171927819370811], ["Tuple[int, int, int, int]", 0.09902164764978426], ["raiden.utils.PaymentID", 0.09668725219029435]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[194, 4], [215, 9]], "fn_var_ln": {"hook": [[204, 12], [204, 16]], "master": [[197, 8], [197, 14]], "params": [[198, 8], [198, 14]], "sql": [[196, 8], [196, 11]], "status": [[199, 8], [199, 14]]}, "fn_var_occur": {"hook": [["hook", "SparkSqlHook", "conn_id", "sql", "sql", "master", "master"], ["hook", "run_query", "params"]], "master": [["hook", "SparkSqlHook", "conn_id", "sql", "sql", "master", "master"], ["str", "ctx", "value", "sql", "master", "params", "status"]], "params": [["hook", "run_query", "params"], ["str", "ctx", "value", "sql", "master", "params", "status"]], "sql": [["hook", "SparkSqlHook", "conn_id", "sql", "sql", "master", "master"], ["str", "ctx", "value", "sql", "master", "params", "status"]], "status": [["mock_popen", "return_value", "wait", "return_value", "status"], ["str", "ctx", "value", "sql", "master", "params", "status"]]}, "name": "test_spark_process_runcmd_and_fail", "params": {"mock_popen": "", "self": ""}, "params_descr": {"mock_popen": "", "self": ""}, "params_occur": {"mock_popen": [["mock_popen", "return_value", "wait", "return_value", "status"]], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_popen": [], "self": []}, "q_name": "TestSparkSqlHook.test_spark_process_runcmd_and_fail", "ret_exprs": [], "ret_type": "", "variables": {"hook": "", "master": "", "params": "", "sql": "", "status": ""}, "variables_p": {"hook": [["Pattern[str]", 0.29540587135382723], ["Dict[int, Union[Any, Any]]", 0.09441981536525555]], "master": [["str", 0.20013650487196072], ["int", 0.19153456512589234], ["Dict[str, Union[Any, Any, Any, Any]]", 0.11524108537103775], ["list", 0.09567001303796056]], "params": [["str", 0.23691024859722135], ["List[str]", 0.19378600809253554], ["Callable(copyright)[[], None]", 0.16805398044581807], ["Dict[str, Any]", 0.11520558493872508], ["dict", 0.09349321380134801]], "sql": [["str", 0.20013650487196072], ["int", 0.19153456512589234], ["Dict[str, Union[Any, Any, Any, Any]]", 0.11524108537103775], ["list", 0.09567001303796056]], "status": [["str", 0.5161003526949599], ["int", 0.09449720900702663], ["Dict[Any, str]", 0.08950465713641281], ["Dict[int, int]", 0.08795550684943385]]}}], "name": "TestSparkSqlHook", "q_name": "TestSparkSqlHook", "variables": {"_config": ""}, "variables_p": {"_config": [["str", 0.4], ["Tuple[str]", 0.2], ["Optional[Dict[str, Any]]", 0.1], ["Tuple[str, str]", 0.1], ["dict", 0.1]]}}], "funcs": [{"docstring": {"func": "Get the value after `sentinel` in an `iterable`", "long_descr": null, "ret": null}, "fn_lc": [[33, 0], [37, 26]], "fn_var_ln": {"truncated": [[35, 4], [35, 13]]}, "fn_var_occur": {"truncated": [["truncated", "dropwhile", "el", "el", "sentinel", "iterable"], ["next", "truncated"], ["next", "truncated"]]}, "name": "get_after", "params": {"iterable": "", "sentinel": ""}, "params_descr": {"iterable": "", "sentinel": ""}, "params_occur": {"iterable": [["truncated", "dropwhile", "el", "el", "sentinel", "iterable"]], "sentinel": [["truncated", "dropwhile", "el", "el", "sentinel", "iterable"]]}, "params_p": {"args": [], "iterable": [["str", 0.19999999999999998], ["bool", 0.09999999999999999]], "kwargs": [], "sentinel": [["str", 0.19999999999999998], ["bool", 0.09999999999999999]]}, "q_name": "get_after", "ret_exprs": ["return next(truncated)"], "ret_type": "", "ret_type_p": [["str", 0.19999999999999998], ["bool", 0.09999999999999999]], "variables": {"truncated": ""}, "variables_p": {"truncated": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1]]}}], "imports": ["__future__", "annotations", "io", "itertools", "dropwhile", "unittest", "mock", "call", "patch", "pytest", "airflow", "exceptions", "AirflowException", "airflow", "models", "Connection", "airflow", "providers", "apache", "spark", "hooks", "spark_sql", "SparkSqlHook", "airflow", "utils", "db", "tests", "test_utils", "db", "clear_db_connections"], "mod_var_ln": {}, "mod_var_occur": {}, "no_types_annot": {"D": 2, "I": 0, "U": 29}, "session_id": "FK-4So9s5JieM8EH3yTjnGxPqkChW0JnlFySz8i5Cgg", "set": null, "tc": [false, null], "type_annot_cove": 0.06, "typed_seq": "", "untyped_seq": "", "variables": {}, "variables_p": {}}}