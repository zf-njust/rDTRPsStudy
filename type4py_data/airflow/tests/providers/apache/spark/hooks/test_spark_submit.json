{"error": null, "response": {"classes": [{"cls_lc": [[32, 0], [867, 41]], "cls_var_ln": {"_config": [[35, 4], [35, 11]], "_spark_job_file": [[34, 4], [34, 19]]}, "cls_var_occur": {"_config": [], "_spark_job_file": []}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[68, 4], [74, 26]], "fn_var_ln": {"pos": [[72, 16], [72, 19]], "return_dict": [[69, 8], [69, 19]]}, "fn_var_occur": {"pos": [["pos", "list_cmd", "index", "arg"], ["return_dict", "arg", "list_cmd", "pos"]], "return_dict": [["return_dict", "arg", "list_cmd", "pos"]]}, "name": "cmd_args_to_dict", "params": {"list_cmd": ""}, "params_descr": {"list_cmd": ""}, "params_occur": {"list_cmd": [["pos", "list_cmd", "index", "arg"], ["return_dict", "arg", "list_cmd", "pos"]]}, "params_p": {"args": [], "kwargs": [], "list_cmd": [["dict", 0.327725145459774], ["str", 0.11374210444492582]], "self": []}, "q_name": "TestSparkSubmitHook.cmd_args_to_dict", "ret_exprs": ["return return_dict"], "ret_type": "", "ret_type_p": [["dict", 0.2888332108149981], ["OrderedDict", 0.1927388328858884], ["Dict[str, str]", 0.09627773693833269], ["Mapping[str, Union[int, slice]]", 0.09627773693833269]], "variables": {"pos": "", "return_dict": ""}, "variables_p": {"pos": [["str", 0.17529227064742803], ["list", 0.0973384398563355], ["List[tuple]", 0.09252528426667396], ["List[int]", 0.09073874020020531], ["List[Tuple[int, Any]]", 0.08179680451060503]], "return_dict": [["str", 0.21041654462003773], ["list", 0.18360596338140417], ["int", 0.16041344841328142], ["List[List[Any]]", 0.09268105714969001], ["Dict[str, Any]", 0.09268105714969001], ["Dict[str, str]", 0.08852318065455786], ["dict", 0.08603162351313824]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[76, 4], [144, 9]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.setup_method", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[146, 4], [204, 40]], "fn_var_ln": {"cmd": [[151, 8], [151, 11]], "expected_build_cmd": [[154, 8], [154, 26]], "hook": [[148, 8], [148, 12]]}, "fn_var_occur": {"cmd": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"], ["expected_build_cmd", "cmd"]], "expected_build_cmd": [["expected_build_cmd", "cmd"]], "hook": [["hook", "SparkSubmitHook", "self", "_config"], ["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "name": "test_build_spark_submit_command", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["hook", "SparkSubmitHook", "self", "_config"], ["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_build_spark_submit_command", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "expected_build_cmd": "", "hook": ""}, "variables_p": {"cmd": [["Counter[str]", 0.1266729040575261]], "expected_build_cmd": [["bool", 0.38562427648234254], ["Set[str]", 0.23631440623631556], ["Tuple[Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal]", 0.10024044451656314], ["List[int]", 0.10003423499778356], ["Union[Literal[False], str]", 0.09013828597996455], ["str", 0.0876483517870306]], "hook": []}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[206, 4], [240, 90]], "fn_var_ln": {"_driver_id": [[214, 8], [214, 42]], "build_track_driver_status_spark_standalone_cluster": [[217, 8], [217, 58]], "build_track_driver_status_spark_yarn_cluster": [[220, 8], [220, 52]], "expected_spark_standalone_cluster": [[225, 8], [225, 41]], "expected_spark_yarn_cluster": [[231, 8], [231, 35]], "hook_spark_standalone_cluster": [[211, 8], [211, 37]], "hook_spark_yarn_cluster": [[213, 8], [213, 31]]}, "fn_var_occur": {"_driver_id": [["hook_spark_standalone_cluster", "_driver_id"], ["hook_spark_yarn_cluster", "_driver_id"]], "build_track_driver_status_spark_standalone_cluster": [["build_track_driver_status_spark_standalone_cluster", "hook_spark_standalone_cluster", "_build_track_driver_status_command"], ["expected_spark_standalone_cluster", "build_track_driver_status_spark_standalone_cluster"]], "build_track_driver_status_spark_yarn_cluster": [["build_track_driver_status_spark_yarn_cluster", "hook_spark_yarn_cluster", "_build_track_driver_status_command"], ["expected_spark_yarn_cluster", "build_track_driver_status_spark_yarn_cluster"]], "expected_spark_standalone_cluster": [["expected_spark_standalone_cluster", "build_track_driver_status_spark_standalone_cluster"]], "expected_spark_yarn_cluster": [["expected_spark_yarn_cluster", "build_track_driver_status_spark_yarn_cluster"]], "hook_spark_standalone_cluster": [["hook_spark_standalone_cluster", "SparkSubmitHook", "conn_id"], ["hook_spark_standalone_cluster", "_driver_id"], ["build_track_driver_status_spark_standalone_cluster", "hook_spark_standalone_cluster", "_build_track_driver_status_command"]], "hook_spark_yarn_cluster": [["hook_spark_yarn_cluster", "SparkSubmitHook", "conn_id"], ["hook_spark_yarn_cluster", "_driver_id"], ["build_track_driver_status_spark_yarn_cluster", "hook_spark_yarn_cluster", "_build_track_driver_status_command"]]}, "name": "test_build_track_driver_status_command", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_build_track_driver_status_command", "ret_exprs": [], "ret_type": "", "variables": {"_driver_id": "", "build_track_driver_status_spark_standalone_cluster": "", "build_track_driver_status_spark_yarn_cluster": "", "expected_spark_standalone_cluster": "", "expected_spark_yarn_cluster": "", "hook_spark_standalone_cluster": "", "hook_spark_yarn_cluster": ""}, "variables_p": {"_driver_id": [["str", 0.6005295786074648], ["Set[int]", 0.1619799679335579], ["int", 0.1576967934215445], ["Dict[str, int]", 0.07979366003743285]], "build_track_driver_status_spark_standalone_cluster": [["str", 0.20502945456985516], ["Optional[str]", 0.11383637546293977], ["Dict[str, Any]", 0.09104396115667132], ["List[str]", 0.08110335271781383], ["dict", 0.08068271829195037]], "build_track_driver_status_spark_yarn_cluster": [["str", 0.20502945456985516], ["Optional[str]", 0.11383637546293977], ["Dict[str, Any]", 0.09104396115667132], ["List[str]", 0.08110335271781383], ["dict", 0.08068271829195037]], "expected_spark_standalone_cluster": [["List[Dict[str, str]]", 0.40980375212902764], ["list", 0.14001823271360658], ["str", 0.1104495845857899], ["int", 0.08808113374127816], ["defaultdict", 0.08396188642963434], ["Type[Dict[str, Any]]", 0.06848207372465069]], "expected_spark_yarn_cluster": [["List[Dict[str, str]]", 0.40980375212902764], ["list", 0.14001823271360658], ["str", 0.1104495845857899], ["int", 0.08808113374127816], ["defaultdict", 0.08396188642963434], ["Type[Dict[str, Any]]", 0.06848207372465069]], "hook_spark_standalone_cluster": [["Tuple[Literal]", 0.14932022323322466], ["str", 0.08688044189927963]], "hook_spark_yarn_cluster": [["Tuple[Literal]", 0.14932022323322466], ["str", 0.08688044189927963]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[243, 4], [260, 9]], "fn_var_ln": {"hook": [[250, 8], [250, 12]]}, "fn_var_occur": {"hook": [["hook", "SparkSubmitHook", "conn_id"], ["hook", "submit"]]}, "name": "test_spark_process_runcmd", "params": {"mock_popen": "", "self": ""}, "params_descr": {"mock_popen": "", "self": ""}, "params_occur": {"mock_popen": [["mock_popen", "return_value", "stdout", "io", "StringIO"], ["mock_popen", "return_value", "stderr", "io", "StringIO"], ["mock_popen", "return_value", "wait", "return_value"], ["mock_popen", "mock_calls", "call", "stderr", "stdout", "universal_newlines", "True", "bufsize"]], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_popen": [], "self": []}, "q_name": "TestSparkSubmitHook.test_spark_process_runcmd", "ret_exprs": [], "ret_type": "", "variables": {"hook": ""}, "variables_p": {"hook": [["int", 0.49999999999334244], ["Dict[str, Union[Any, Any, Any, Any]]", 0.49999999992212585], ["str", 3.930471124067573e-11], ["list", 2.4144457927609122e-11], ["List[Dict[str, Any]]", 9.941449852521256e-12]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[262, 4], [295, 74]], "fn_var_ln": {"hook_default": [[264, 8], [264, 20]], "hook_spark_binary_set": [[268, 8], [268, 29]], "hook_spark_default_mesos": [[267, 8], [267, 32]], "hook_spark_k8s_cluster": [[266, 8], [266, 30]], "hook_spark_standalone_cluster": [[269, 8], [269, 37]], "hook_spark_yarn_cluster": [[265, 8], [265, 31]], "should_track_driver_status_default": [[272, 8], [272, 42]], "should_track_driver_status_spark_binary_set": [[282, 8], [282, 51]], "should_track_driver_status_spark_default_mesos": [[279, 8], [279, 54]], "should_track_driver_status_spark_k8s_cluster": [[276, 8], [276, 52]], "should_track_driver_status_spark_standalone_cluster": [[285, 8], [285, 59]], "should_track_driver_status_spark_yarn_cluster": [[273, 8], [273, 53]]}, "fn_var_occur": {"hook_default": [["hook_default", "SparkSubmitHook", "conn_id"], ["should_track_driver_status_default", "hook_default", "_resolve_should_track_driver_status"]], "hook_spark_binary_set": [["hook_spark_binary_set", "SparkSubmitHook", "conn_id"], ["should_track_driver_status_spark_binary_set", "hook_spark_binary_set", "_resolve_should_track_driver_status"]], "hook_spark_default_mesos": [["hook_spark_default_mesos", "SparkSubmitHook", "conn_id"], ["should_track_driver_status_spark_default_mesos", "hook_spark_default_mesos", "_resolve_should_track_driver_status"]], "hook_spark_k8s_cluster": [["hook_spark_k8s_cluster", "SparkSubmitHook", "conn_id"], ["should_track_driver_status_spark_k8s_cluster", "hook_spark_k8s_cluster", "_resolve_should_track_driver_status"]], "hook_spark_standalone_cluster": [["hook_spark_standalone_cluster", "SparkSubmitHook", "conn_id"], ["should_track_driver_status_spark_standalone_cluster", "hook_spark_standalone_cluster", "_resolve_should_track_driver_status"]], "hook_spark_yarn_cluster": [["hook_spark_yarn_cluster", "SparkSubmitHook", "conn_id"], ["should_track_driver_status_spark_yarn_cluster", "hook_spark_yarn_cluster", "_resolve_should_track_driver_status"]], "should_track_driver_status_default": [["should_track_driver_status_default", "hook_default", "_resolve_should_track_driver_status"], ["should_track_driver_status_default", "False"]], "should_track_driver_status_spark_binary_set": [["should_track_driver_status_spark_binary_set", "hook_spark_binary_set", "_resolve_should_track_driver_status"], ["should_track_driver_status_spark_binary_set", "False"]], "should_track_driver_status_spark_default_mesos": [["should_track_driver_status_spark_default_mesos", "hook_spark_default_mesos", "_resolve_should_track_driver_status"], ["should_track_driver_status_spark_default_mesos", "False"]], "should_track_driver_status_spark_k8s_cluster": [["should_track_driver_status_spark_k8s_cluster", "hook_spark_k8s_cluster", "_resolve_should_track_driver_status"], ["should_track_driver_status_spark_k8s_cluster", "False"]], "should_track_driver_status_spark_standalone_cluster": [["should_track_driver_status_spark_standalone_cluster", "hook_spark_standalone_cluster", "_resolve_should_track_driver_status"], ["should_track_driver_status_spark_standalone_cluster", "True"]], "should_track_driver_status_spark_yarn_cluster": [["should_track_driver_status_spark_yarn_cluster", "hook_spark_yarn_cluster", "_resolve_should_track_driver_status"], ["should_track_driver_status_spark_yarn_cluster", "False"]]}, "name": "test_resolve_should_track_driver_status", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_should_track_driver_status", "ret_exprs": [], "ret_type": "", "variables": {"hook_default": "", "hook_spark_binary_set": "", "hook_spark_default_mesos": "", "hook_spark_k8s_cluster": "", "hook_spark_standalone_cluster": "", "hook_spark_yarn_cluster": "", "should_track_driver_status_default": "", "should_track_driver_status_spark_binary_set": "", "should_track_driver_status_spark_default_mesos": "", "should_track_driver_status_spark_k8s_cluster": "", "should_track_driver_status_spark_standalone_cluster": "", "should_track_driver_status_spark_yarn_cluster": ""}, "variables_p": {"hook_default": [["str", 0.7494693962863919], ["bool", 0.2505306037136083]], "hook_spark_binary_set": [["int", 0.18950495880854484], ["str", 0.18712004054165576], ["Pattern[Any]", 0.11198754402265028], ["Optional[str]", 0.10599280906906242], ["Set[int]", 0.08974134610846637]], "hook_spark_default_mesos": [["int", 0.6213822212264847], ["str", 0.1170532493332236], ["Dict[str, Dict[str, Any]]", 0.0916387873583706], ["Dict[str, float]", 0.08725144860555055], ["Set[int]", 0.08267429347637079]], "hook_spark_k8s_cluster": [["str", 0.23688598254980495], ["int", 0.16956322636946086], ["list", 0.16178330916476338], ["Dict[str, Dict[str, Any]]", 0.09473186260977232], ["sicp_bodb.models.Cowboy", 0.08818785658914219], ["Tuple[str, str, str, str, str]", 0.08000865449678389]], "hook_spark_standalone_cluster": [["int", 0.1158499353493296], ["Tuple[Literal]", 0.08899088146497756]], "hook_spark_yarn_cluster": [["int", 0.1158499353493296], ["Tuple[Literal]", 0.08899088146497756]], "should_track_driver_status_default": [["dict", 0.16967254662278444], ["Dict[Any, str]", 0.16967254662278444], ["str", 0.14866521452960288], ["Dict[Any, Dict[str, Any]]", 0.13066393550260683], ["List[str]", 0.11091714347561915], ["Dict[str, Union[Any, Any, Any]]", 0.10073606662381776], ["Dict[str, str]", 0.08483627331139222], ["Dict[str, Any]", 0.08483627331139222]], "should_track_driver_status_spark_binary_set": [["str", 0.2206037592988646], ["legistar.models.MatterRelation", 0.1079893923152949], ["legistar.models.MatterSponsor", 0.1079893923152949], ["legistar.models.MatterHistory", 0.1079893923152949], ["int", 0.09657434354438449]], "should_track_driver_status_spark_default_mesos": [["int", 0.3295222346665798], ["str", 0.3116639209096688], ["app.models.ScrapeTarget", 0.08533902742311959]], "should_track_driver_status_spark_k8s_cluster": [["str", 0.3207320571774145], ["Dict[str, str]", 0.20488292784593148], ["int", 0.11213248184358474], ["Dict[str, Union[bool, str]]", 0.09758173313249609], ["Tuple[Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal]", 0.08867318650155435], ["Tuple[Literal, Literal, Literal]", 0.08867318650155435]], "should_track_driver_status_spark_standalone_cluster": [["int", 0.4086008726843193], ["str", 0.31543055106385587], ["Dict[str, Union[Any, Any]]", 0.09464178472342392], ["Dict[str, Dict[str, str]]", 0.09464178472342392]], "should_track_driver_status_spark_yarn_cluster": [["int", 0.4153259894421876], ["str", 0.3043079393678071], ["Dict[str, Union[Any, Any]]", 0.1022902817077205], ["Dict[str, Dict[str, str]]", 0.1022902817077205]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[297, 4], [315, 45]], "fn_var_ln": {"cmd": [[303, 8], [303, 11]], "connection": [[302, 8], [302, 18]], "dict_cmd": [[306, 8], [306, 16]], "expected_spark_connection": [[307, 8], [307, 33]], "hook": [[299, 8], [299, 12]]}, "fn_var_occur": {"cmd": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"], ["dict_cmd", "self", "cmd_args_to_dict", "cmd"]], "connection": [["connection", "hook", "_resolve_connection"], ["connection", "expected_spark_connection"]], "dict_cmd": [["dict_cmd", "self", "cmd_args_to_dict", "cmd"]], "expected_spark_connection": [["expected_spark_connection", "None", "None", "None"], ["connection", "expected_spark_connection"]], "hook": [["hook", "SparkSubmitHook", "conn_id"], ["connection", "hook", "_resolve_connection"], ["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "name": "test_resolve_connection_yarn_default", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"], ["dict_cmd", "self", "cmd_args_to_dict", "cmd"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_connection_yarn_default", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "connection": "", "dict_cmd": "", "expected_spark_connection": "", "hook": ""}, "variables_p": {"cmd": [["Pattern[str]", 0.08856115717897389]], "connection": [["str", 0.4047441676743676], ["io.StringIO", 0.09671540403401291], ["Pattern[str]", 0.09368661734106204]], "dict_cmd": [["Dict[str, str]", 0.4183122247128817], ["dict", 0.18996983619239477], ["str", 0.09458922578681213], ["Dict[str, Union[Any, str]]", 0.09458922578681213], ["Dict[str, Any]", 0.0926242780853449]], "expected_spark_connection": [["set", 0.17305553925850303], ["Dict[str, str]", 0.12377050323932486], ["List[None]", 0.11594403030860398], ["requests.models.Response", 0.10419496320349263], ["bool", 0.09717796157703885], ["List[str]", 0.08054705941389172]], "hook": [["str", 0.19787494204859568], ["src.pip_shims.models.ShimmedPathCollection", 0.1124092917988035], ["utils.mssql_counters.Section", 0.0861084574952074]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[317, 4], [336, 52]], "fn_var_ln": {"cmd": [[323, 8], [323, 11]], "connection": [[322, 8], [322, 18]], "dict_cmd": [[326, 8], [326, 16]], "expected_spark_connection": [[327, 8], [327, 33]], "hook": [[319, 8], [319, 12]]}, "fn_var_occur": {"cmd": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"], ["dict_cmd", "self", "cmd_args_to_dict", "cmd"]], "connection": [["connection", "hook", "_resolve_connection"], ["connection", "expected_spark_connection"]], "dict_cmd": [["dict_cmd", "self", "cmd_args_to_dict", "cmd"]], "expected_spark_connection": [["expected_spark_connection", "None", "None"], ["connection", "expected_spark_connection"]], "hook": [["hook", "SparkSubmitHook", "conn_id"], ["connection", "hook", "_resolve_connection"], ["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "name": "test_resolve_connection_yarn_default_connection", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"], ["dict_cmd", "self", "cmd_args_to_dict", "cmd"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_connection_yarn_default_connection", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "connection": "", "dict_cmd": "", "expected_spark_connection": "", "hook": ""}, "variables_p": {"cmd": [["Pattern[str]", 0.08856115717897389]], "connection": [["str", 0.4047441676743676], ["io.StringIO", 0.09671540403401291], ["Pattern[str]", 0.09368661734106204]], "dict_cmd": [["Dict[str, str]", 0.4183122247128817], ["dict", 0.18996983619239477], ["str", 0.09458922578681213], ["Dict[str, Union[Any, str]]", 0.09458922578681213], ["Dict[str, Any]", 0.0926242780853449]], "expected_spark_connection": [["set", 0.16231874088020998], ["requests.models.Response", 0.1323723874918529], ["Dict[str, str]", 0.12000064019370717], ["List[None]", 0.10978920506491817], ["bool", 0.0911528877244466], ["list", 0.08949199855842918], ["List[str]", 0.08107203247374972]], "hook": [["str", 0.19787494204859568], ["src.pip_shims.models.ShimmedPathCollection", 0.1124092917988035], ["utils.mssql_counters.Section", 0.0861084574952074]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[338, 4], [356, 58]], "fn_var_ln": {"cmd": [[344, 8], [344, 11]], "connection": [[343, 8], [343, 18]], "dict_cmd": [[347, 8], [347, 16]], "expected_spark_connection": [[348, 8], [348, 33]], "hook": [[340, 8], [340, 12]]}, "fn_var_occur": {"cmd": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"], ["dict_cmd", "self", "cmd_args_to_dict", "cmd"]], "connection": [["connection", "hook", "_resolve_connection"], ["connection", "expected_spark_connection"]], "dict_cmd": [["dict_cmd", "self", "cmd_args_to_dict", "cmd"]], "expected_spark_connection": [["expected_spark_connection", "None", "None", "None"], ["connection", "expected_spark_connection"]], "hook": [["hook", "SparkSubmitHook", "conn_id"], ["connection", "hook", "_resolve_connection"], ["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "name": "test_resolve_connection_mesos_default_connection", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"], ["dict_cmd", "self", "cmd_args_to_dict", "cmd"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_connection_mesos_default_connection", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "connection": "", "dict_cmd": "", "expected_spark_connection": "", "hook": ""}, "variables_p": {"cmd": [["Pattern[str]", 0.08856115717897389]], "connection": [["str", 0.4047441676743676], ["io.StringIO", 0.09671540403401291], ["Pattern[str]", 0.09368661734106204]], "dict_cmd": [["Dict[str, str]", 0.4183122247128817], ["dict", 0.18996983619239477], ["str", 0.09458922578681213], ["Dict[str, Union[Any, str]]", 0.09458922578681213], ["Dict[str, Any]", 0.0926242780853449]], "expected_spark_connection": [["set", 0.17305553925850303], ["Dict[str, str]", 0.12377050323932486], ["List[None]", 0.11594403030860398], ["requests.models.Response", 0.10419496320349263], ["bool", 0.09717796157703885], ["List[str]", 0.08054705941389172]], "hook": [["str", 0.19787494204859568], ["src.pip_shims.models.ShimmedPathCollection", 0.1124092917988035], ["utils.mssql_counters.Section", 0.0861084574952074]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[358, 4], [378, 53]], "fn_var_ln": {"cmd": [[364, 8], [364, 11]], "connection": [[363, 8], [363, 18]], "dict_cmd": [[367, 8], [367, 16]], "expected_spark_connection": [[368, 8], [368, 33]], "hook": [[360, 8], [360, 12]]}, "fn_var_occur": {"cmd": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"], ["dict_cmd", "self", "cmd_args_to_dict", "cmd"]], "connection": [["connection", "hook", "_resolve_connection"], ["connection", "expected_spark_connection"]], "dict_cmd": [["dict_cmd", "self", "cmd_args_to_dict", "cmd"]], "expected_spark_connection": [["expected_spark_connection", "None"], ["connection", "expected_spark_connection"]], "hook": [["hook", "SparkSubmitHook", "conn_id"], ["connection", "hook", "_resolve_connection"], ["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "name": "test_resolve_connection_spark_yarn_cluster_connection", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"], ["dict_cmd", "self", "cmd_args_to_dict", "cmd"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_connection_spark_yarn_cluster_connection", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "connection": "", "dict_cmd": "", "expected_spark_connection": "", "hook": ""}, "variables_p": {"cmd": [["Pattern[str]", 0.08856115717897389]], "connection": [["str", 0.4047441676743676], ["io.StringIO", 0.09671540403401291], ["Pattern[str]", 0.09368661734106204]], "dict_cmd": [["Dict[str, str]", 0.4183122247128817], ["dict", 0.18996983619239477], ["str", 0.09458922578681213], ["Dict[str, Union[Any, str]]", 0.09458922578681213], ["Dict[str, Any]", 0.0926242780853449]], "expected_spark_connection": [["set", 0.2121635494365253], ["List[None]", 0.13485328735623256], ["requests.models.Response", 0.10088144553547397], ["List[str]", 0.0946399498819812], ["bool", 0.09332957672029324], ["Dict[str, str]", 0.09247646319385514], ["list", 0.07354373588884344]], "hook": [["str", 0.19787494204859568], ["src.pip_shims.models.ShimmedPathCollection", 0.1124092917988035], ["utils.mssql_counters.Section", 0.0861084574952074]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[380, 4], [399, 53]], "fn_var_ln": {"cmd": [[386, 8], [386, 11]], "connection": [[385, 8], [385, 18]], "dict_cmd": [[389, 8], [389, 16]], "expected_spark_connection": [[390, 8], [390, 33]], "hook": [[382, 8], [382, 12]]}, "fn_var_occur": {"cmd": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"], ["dict_cmd", "self", "cmd_args_to_dict", "cmd"]], "connection": [["connection", "hook", "_resolve_connection"], ["connection", "expected_spark_connection"]], "dict_cmd": [["dict_cmd", "self", "cmd_args_to_dict", "cmd"]], "expected_spark_connection": [["expected_spark_connection", "None"], ["connection", "expected_spark_connection"]], "hook": [["hook", "SparkSubmitHook", "conn_id"], ["connection", "hook", "_resolve_connection"], ["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "name": "test_resolve_connection_spark_k8s_cluster_connection", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"], ["dict_cmd", "self", "cmd_args_to_dict", "cmd"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_connection_spark_k8s_cluster_connection", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "connection": "", "dict_cmd": "", "expected_spark_connection": "", "hook": ""}, "variables_p": {"cmd": [["Pattern[str]", 0.08856115717897389]], "connection": [["str", 0.4047441676743676], ["io.StringIO", 0.09671540403401291], ["Pattern[str]", 0.09368661734106204]], "dict_cmd": [["Dict[str, str]", 0.4183122247128817], ["dict", 0.18996983619239477], ["str", 0.09458922578681213], ["Dict[str, Union[Any, str]]", 0.09458922578681213], ["Dict[str, Any]", 0.0926242780853449]], "expected_spark_connection": [["set", 0.2121635494365253], ["List[None]", 0.13485328735623256], ["requests.models.Response", 0.10088144553547397], ["List[str]", 0.0946399498819812], ["bool", 0.09332957672029324], ["Dict[str, str]", 0.09247646319385514], ["list", 0.07354373588884344]], "hook": [["str", 0.19787494204859568], ["src.pip_shims.models.ShimmedPathCollection", 0.1124092917988035], ["utils.mssql_counters.Section", 0.0861084574952074]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[401, 4], [424, 73]], "fn_var_ln": {"cmd": [[410, 8], [410, 11]], "conf": [[403, 8], [403, 12]], "connection": [[409, 8], [409, 18]], "dict_cmd": [[413, 8], [413, 16]], "expected_spark_connection": [[414, 8], [414, 33]], "hook": [[406, 8], [406, 12]]}, "fn_var_occur": {"cmd": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"], ["dict_cmd", "self", "cmd_args_to_dict", "cmd"]], "conf": [["hook", "SparkSubmitHook", "conn_id", "conf", "conf"]], "connection": [["connection", "hook", "_resolve_connection"], ["connection", "expected_spark_connection"]], "dict_cmd": [["dict_cmd", "self", "cmd_args_to_dict", "cmd"]], "expected_spark_connection": [["expected_spark_connection", "None"], ["connection", "expected_spark_connection"]], "hook": [["hook", "SparkSubmitHook", "conn_id", "conf", "conf"], ["connection", "hook", "_resolve_connection"], ["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "name": "test_resolve_connection_spark_k8s_cluster_ns_conf", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"], ["dict_cmd", "self", "cmd_args_to_dict", "cmd"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_connection_spark_k8s_cluster_ns_conf", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "conf": "", "connection": "", "dict_cmd": "", "expected_spark_connection": "", "hook": ""}, "variables_p": {"cmd": [["Pattern[str]", 0.08856115717897389]], "conf": [["int", 0.49999999999334244], ["Dict[str, Union[Any, Any, Any, Any]]", 0.49999999992212585], ["str", 3.930471124067573e-11], ["list", 2.4144457927609122e-11], ["List[Dict[str, Any]]", 9.941449852521256e-12]], "connection": [["str", 0.4047441676743676], ["io.StringIO", 0.09671540403401291], ["Pattern[str]", 0.09368661734106204]], "dict_cmd": [["Dict[str, str]", 0.4183122247128817], ["dict", 0.18996983619239477], ["str", 0.09458922578681213], ["Dict[str, Union[Any, str]]", 0.09458922578681213], ["Dict[str, Any]", 0.0926242780853449]], "expected_spark_connection": [["set", 0.2121635494365253], ["List[None]", 0.13485328735623256], ["requests.models.Response", 0.10088144553547397], ["List[str]", 0.0946399498819812], ["bool", 0.09332957672029324], ["Dict[str, str]", 0.09247646319385514], ["list", 0.07354373588884344]], "hook": [["dict", 0.1781553806196919], ["str", 0.10915141343733464], ["Dict[str, Any]", 0.09237827117607357]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[426, 4], [443, 40]], "fn_var_ln": {"cmd": [[432, 8], [432, 11]], "connection": [[431, 8], [431, 18]], "expected_spark_connection": [[435, 8], [435, 33]], "hook": [[428, 8], [428, 12]]}, "fn_var_occur": {"cmd": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]], "connection": [["connection", "hook", "_resolve_connection"], ["connection", "expected_spark_connection"]], "expected_spark_connection": [["expected_spark_connection", "None", "None", "None"], ["connection", "expected_spark_connection"]], "hook": [["hook", "SparkSubmitHook", "conn_id"], ["connection", "hook", "_resolve_connection"], ["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "name": "test_resolve_connection_spark_binary_set_connection", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_connection_spark_binary_set_connection", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "connection": "", "expected_spark_connection": "", "hook": ""}, "variables_p": {"cmd": [["str", 0.6996742140698761], ["Set[str]", 0.12950768125441636], ["dict", 0.08477040241459527]], "connection": [["str", 0.4047441676743676], ["io.StringIO", 0.09671540403401291], ["Pattern[str]", 0.09368661734106204]], "expected_spark_connection": [["set", 0.17305553925850303], ["Dict[str, str]", 0.12377050323932486], ["List[None]", 0.11594403030860398], ["requests.models.Response", 0.10419496320349263], ["bool", 0.09717796157703885], ["List[str]", 0.08054705941389172]], "hook": [["str", 0.19787494204859568], ["src.pip_shims.models.ShimmedPathCollection", 0.1124092917988035], ["utils.mssql_counters.Section", 0.0861084574952074]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[445, 4], [462, 40]], "fn_var_ln": {"cmd": [[451, 8], [451, 11]], "connection": [[450, 8], [450, 18]], "expected_spark_connection": [[454, 8], [454, 33]], "hook": [[447, 8], [447, 12]]}, "fn_var_occur": {"cmd": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]], "connection": [["connection", "hook", "_resolve_connection"], ["connection", "expected_spark_connection"]], "expected_spark_connection": [["expected_spark_connection", "None", "None", "None"], ["connection", "expected_spark_connection"]], "hook": [["hook", "SparkSubmitHook", "conn_id"], ["connection", "hook", "_resolve_connection"], ["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "name": "test_resolve_connection_spark_binary_spark3_submit_set_connection", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_connection_spark_binary_spark3_submit_set_connection", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "connection": "", "expected_spark_connection": "", "hook": ""}, "variables_p": {"cmd": [["str", 0.6996742140698761], ["Set[str]", 0.12950768125441636], ["dict", 0.08477040241459527]], "connection": [["str", 0.4047441676743676], ["io.StringIO", 0.09671540403401291], ["Pattern[str]", 0.09368661734106204]], "expected_spark_connection": [["set", 0.17305553925850303], ["Dict[str, str]", 0.12377050323932486], ["List[None]", 0.11594403030860398], ["requests.models.Response", 0.10419496320349263], ["bool", 0.09717796157703885], ["List[str]", 0.08054705941389172]], "hook": [["str", 0.19787494204859568], ["src.pip_shims.models.ShimmedPathCollection", 0.1124092917988035], ["utils.mssql_counters.Section", 0.0861084574952074]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[464, 4], [465, 95]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_resolve_connection_custom_spark_binary_allowed_in_hook", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_connection_custom_spark_binary_allowed_in_hook", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[467, 4], [469, 62]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_resolve_connection_spark_binary_extra_not_allowed_runtime_error", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_connection_spark_binary_extra_not_allowed_runtime_error", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[471, 4], [473, 53]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_resolve_connection_spark_home_not_allowed_runtime_error", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_connection_spark_home_not_allowed_runtime_error", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[475, 4], [492, 40]], "fn_var_ln": {"cmd": [[481, 8], [481, 11]], "connection": [[480, 8], [480, 18]], "expected_spark_connection": [[484, 8], [484, 33]], "hook": [[477, 8], [477, 12]]}, "fn_var_occur": {"cmd": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]], "connection": [["connection", "hook", "_resolve_connection"], ["connection", "expected_spark_connection"]], "expected_spark_connection": [["expected_spark_connection", "None", "None", "None"], ["connection", "expected_spark_connection"]], "hook": [["hook", "SparkSubmitHook", "conn_id", "spark_binary"], ["connection", "hook", "_resolve_connection"], ["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "name": "test_resolve_connection_spark_binary_default_value_override", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_connection_spark_binary_default_value_override", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "connection": "", "expected_spark_connection": "", "hook": ""}, "variables_p": {"cmd": [["str", 0.6996742140698761], ["Set[str]", 0.12950768125441636], ["dict", 0.08477040241459527]], "connection": [["str", 0.4047441676743676], ["io.StringIO", 0.09671540403401291], ["Pattern[str]", 0.09368661734106204]], "expected_spark_connection": [["set", 0.17305553925850303], ["Dict[str, str]", 0.12377050323932486], ["List[None]", 0.11594403030860398], ["requests.models.Response", 0.10419496320349263], ["bool", 0.09717796157703885], ["List[str]", 0.08054705941389172]], "hook": [["dict", 0.1781553806196919], ["str", 0.10915141343733464], ["Dict[str, Any]", 0.09237827117607357]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[494, 4], [511, 39]], "fn_var_ln": {"cmd": [[500, 8], [500, 11]], "connection": [[499, 8], [499, 18]], "expected_spark_connection": [[503, 8], [503, 33]], "hook": [[496, 8], [496, 12]]}, "fn_var_occur": {"cmd": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]], "connection": [["connection", "hook", "_resolve_connection"], ["connection", "expected_spark_connection"]], "expected_spark_connection": [["expected_spark_connection", "None", "None"], ["connection", "expected_spark_connection"]], "hook": [["hook", "SparkSubmitHook", "conn_id"], ["connection", "hook", "_resolve_connection"], ["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "name": "test_resolve_connection_spark_binary_default_value", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_connection_spark_binary_default_value", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "connection": "", "expected_spark_connection": "", "hook": ""}, "variables_p": {"cmd": [["str", 0.6996742140698761], ["Set[str]", 0.12950768125441636], ["dict", 0.08477040241459527]], "connection": [["str", 0.4047441676743676], ["io.StringIO", 0.09671540403401291], ["Pattern[str]", 0.09368661734106204]], "expected_spark_connection": [["set", 0.16231874088020998], ["requests.models.Response", 0.1323723874918529], ["Dict[str, str]", 0.12000064019370717], ["List[None]", 0.10978920506491817], ["bool", 0.0911528877244466], ["list", 0.08949199855842918], ["List[str]", 0.08107203247374972]], "hook": [["str", 0.19787494204859568], ["src.pip_shims.models.ShimmedPathCollection", 0.1124092917988035], ["utils.mssql_counters.Section", 0.0861084574952074]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[513, 4], [530, 39]], "fn_var_ln": {"cmd": [[519, 8], [519, 11]], "connection": [[518, 8], [518, 18]], "expected_spark_connection": [[522, 8], [522, 33]], "hook": [[515, 8], [515, 12]]}, "fn_var_occur": {"cmd": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]], "connection": [["connection", "hook", "_resolve_connection"], ["connection", "expected_spark_connection"]], "expected_spark_connection": [["expected_spark_connection", "None", "None"], ["connection", "expected_spark_connection"]], "hook": [["hook", "SparkSubmitHook", "conn_id"], ["connection", "hook", "_resolve_connection"], ["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "name": "test_resolve_connection_spark_standalone_cluster_connection", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_connection_spark_standalone_cluster_connection", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "connection": "", "expected_spark_connection": "", "hook": ""}, "variables_p": {"cmd": [["str", 0.6996742140698761], ["Set[str]", 0.12950768125441636], ["dict", 0.08477040241459527]], "connection": [["str", 0.4047441676743676], ["io.StringIO", 0.09671540403401291], ["Pattern[str]", 0.09368661734106204]], "expected_spark_connection": [["set", 0.16231874088020998], ["requests.models.Response", 0.1323723874918529], ["Dict[str, str]", 0.12000064019370717], ["List[None]", 0.10978920506491817], ["bool", 0.0911528877244466], ["list", 0.08949199855842918], ["List[str]", 0.08107203247374972]], "hook": [["str", 0.19787494204859568], ["src.pip_shims.models.ShimmedPathCollection", 0.1124092917988035], ["utils.mssql_counters.Section", 0.0861084574952074]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[532, 4], [540, 42]], "fn_var_ln": {"hook": [[534, 8], [534, 12]]}, "fn_var_occur": {"hook": [["hook", "SparkSubmitHook", "conn_id", "env_vars"], ["hook", "_build_spark_submit_command", "self", "_spark_job_file"], ["hook", "_env"]]}, "name": "test_resolve_spark_submit_env_vars_standalone_client_mode", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_spark_submit_env_vars_standalone_client_mode", "ret_exprs": [], "ret_type": "", "variables": {"hook": ""}, "variables_p": {"hook": [["str", 0.41877400515190283], ["Dict[str, Dict[str, str]]", 0.09937507308195938], ["Tuple[str, str, str, str, str]", 0.0920199872019198], ["list", 0.08983501369686893]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[543, 8], [548, 66]], "fn_var_ln": {"hook": [[545, 12], [545, 16]]}, "fn_var_occur": {"hook": [["hook", "SparkSubmitHook", "conn_id", "env_vars"], ["hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "name": "env_vars_exception_in_standalone_cluster_mode", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_spark_submit_env_vars_standalone_cluster_mode.<locals>.env_vars_exception_in_standalone_cluster_mode", "ret_exprs": [], "ret_type": "", "variables": {"hook": ""}, "variables_p": {"hook": [["str", 0.1844309447141972], ["float", 0.11716409401601374], ["bool", 0.10481174882615608], ["rotkehlchen.db.settings.DBSettings", 0.08698560010490382]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[542, 4], [552, 59]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_resolve_spark_submit_env_vars_standalone_cluster_mode", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_spark_submit_env_vars_standalone_cluster_mode", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[554, 4], [563, 42]], "fn_var_ln": {"cmd": [[559, 8], [559, 11]], "hook": [[556, 8], [556, 12]]}, "fn_var_occur": {"cmd": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]], "hook": [["hook", "SparkSubmitHook", "conn_id", "env_vars"], ["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"], ["hook", "_env"]]}, "name": "test_resolve_spark_submit_env_vars_yarn", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_spark_submit_env_vars_yarn", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "hook": ""}, "variables_p": {"cmd": [["str", 0.6996742140698761], ["Set[str]", 0.12950768125441636], ["dict", 0.08477040241459527]], "hook": [["str", 0.4170510438441941], ["Dict[str, Dict[str, str]]", 0.10136722814325001], ["list", 0.09423365492066937], ["utils.mssql_counters.Section", 0.08932227481390669]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[565, 4], [573, 61]], "fn_var_ln": {"cmd": [[570, 8], [570, 11]], "hook": [[567, 8], [567, 12]]}, "fn_var_occur": {"cmd": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]], "hook": [["hook", "SparkSubmitHook", "conn_id", "env_vars"], ["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "name": "test_resolve_spark_submit_env_vars_k8s", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cmd", "hook", "_build_spark_submit_command", "self", "_spark_job_file"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_resolve_spark_submit_env_vars_k8s", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "hook": ""}, "variables_p": {"cmd": [["str", 0.6996742140698761], ["Set[str]", 0.12950768125441636], ["dict", 0.08477040241459527]], "hook": [["str", 0.3318736321115609], ["utils.mssql_counters.Section", 0.09452462515806276], ["float", 0.09099064005346047]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[575, 4], [592, 76]], "fn_var_ln": {"hook": [[577, 8], [577, 12]], "log_lines": [[578, 8], [578, 17]]}, "fn_var_occur": {"hook": [["hook", "SparkSubmitHook", "conn_id"], ["hook", "_process_spark_submit_log", "log_lines"], ["hook", "_yarn_application_id"]], "log_lines": [["hook", "_process_spark_submit_log", "log_lines"]]}, "name": "test_process_spark_submit_log_yarn", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_process_spark_submit_log_yarn", "ret_exprs": [], "ret_type": "", "variables": {"hook": "", "log_lines": ""}, "variables_p": {"hook": [["str", 0.44889440177785606], ["list", 0.0986473840252724], ["List[str]", 0.07943122560087312]], "log_lines": [["str", 0.3876414641647077], ["list", 0.19189330504105295], ["tuple", 0.12689285065364306], ["int", 0.10337788200732678], ["MutableMapping[str, Any]", 0.09522900212609449], ["property", 0.09496549600717498]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[594, 4], [625, 43]], "fn_var_ln": {"hook": [[596, 8], [596, 12]], "log_lines": [[597, 8], [597, 17]]}, "fn_var_occur": {"hook": [["hook", "SparkSubmitHook", "conn_id"], ["hook", "_process_spark_submit_log", "log_lines"], ["hook", "_kubernetes_driver_pod"], ["hook", "_spark_exit_code"]], "log_lines": [["hook", "_process_spark_submit_log", "log_lines"]]}, "name": "test_process_spark_submit_log_k8s", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_process_spark_submit_log_k8s", "ret_exprs": [], "ret_type": "", "variables": {"hook": "", "log_lines": ""}, "variables_p": {"hook": [["str", 0.4091969470152559], ["list", 0.09967788231768875], ["List[str]", 0.0786773293901953]], "log_lines": [["str", 0.3876414641647077], ["list", 0.19189330504105295], ["tuple", 0.12689285065364306], ["int", 0.10337788200732678], ["MutableMapping[str, Any]", 0.09522900212609449], ["property", 0.09496549600717498]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[627, 4], [636, 43]], "fn_var_ln": {"hook": [[629, 8], [629, 12]], "log_lines": [[630, 8], [630, 17]]}, "fn_var_occur": {"hook": [["hook", "SparkSubmitHook", "conn_id"], ["hook", "_process_spark_submit_log", "log_lines"], ["hook", "_spark_exit_code"]], "log_lines": [["hook", "_process_spark_submit_log", "log_lines"]]}, "name": "test_process_spark_submit_log_k8s_spark_3", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_process_spark_submit_log_k8s_spark_3", "ret_exprs": [], "ret_type": "", "variables": {"hook": "", "log_lines": ""}, "variables_p": {"hook": [["str", 1.0000000000000002]], "log_lines": [["str", 0.3876414641647077], ["list", 0.19189330504105295], ["tuple", 0.12689285065364306], ["int", 0.10337788200732678], ["MutableMapping[str, Any]", 0.09522900212609449], ["property", 0.09496549600717498]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[638, 4], [653, 62]], "fn_var_ln": {"hook": [[640, 8], [640, 12]], "log_lines": [[641, 8], [641, 17]]}, "fn_var_occur": {"hook": [["hook", "SparkSubmitHook", "conn_id"], ["hook", "_process_spark_submit_log", "log_lines"], ["hook", "_driver_id"]], "log_lines": [["hook", "_process_spark_submit_log", "log_lines"]]}, "name": "test_process_spark_submit_log_standalone_cluster", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_process_spark_submit_log_standalone_cluster", "ret_exprs": [], "ret_type": "", "variables": {"hook": "", "log_lines": ""}, "variables_p": {"hook": [["str", 0.43699423339404], ["list", 0.0999281687089898], ["int", 0.08026755691814429]], "log_lines": [["str", 0.3876414641647077], ["list", 0.19189330504105295], ["tuple", 0.12689285065364306], ["int", 0.10337788200732678], ["MutableMapping[str, Any]", 0.09522900212609449], ["property", 0.09496549600717498]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[655, 4], [677, 47]], "fn_var_ln": {"hook": [[657, 8], [657, 12]], "log_lines": [[658, 8], [658, 17]]}, "fn_var_occur": {"hook": [["hook", "SparkSubmitHook", "conn_id"], ["hook", "_process_spark_status_log", "log_lines"], ["hook", "_driver_status"]], "log_lines": [["hook", "_process_spark_status_log", "log_lines"]]}, "name": "test_process_spark_driver_status_log", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_process_spark_driver_status_log", "ret_exprs": [], "ret_type": "", "variables": {"hook": "", "log_lines": ""}, "variables_p": {"hook": [["str", 0.27041925718648013], ["float", 0.25731666709959466], ["Dict[str, List[Any]]", 0.11056147033783495], ["int", 0.09238410077351458], ["Tuple[bool, bool]", 0.08370870835678845]], "log_lines": [["str", 0.7878226533358961], ["Dict[str, str]", 0.11034170976865441], ["list", 0.10183563689544946]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[679, 4], [692, 42]], "fn_var_ln": {"hook": [[681, 8], [681, 12]], "log_lines": [[682, 8], [682, 17]]}, "fn_var_occur": {"hook": [["hook", "SparkSubmitHook", "conn_id"], ["hook", "_process_spark_status_log", "log_lines"], ["hook", "_driver_status", "None"]], "log_lines": [["hook", "_process_spark_status_log", "log_lines"]]}, "name": "test_process_spark_driver_status_log_bad_response", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_process_spark_driver_status_log_bad_response", "ret_exprs": [], "ret_type": "", "variables": {"hook": "", "log_lines": ""}, "variables_p": {"hook": [["str", 0.3837129611059791], ["list", 0.11679556038065605]], "log_lines": [["str", 0.7878226533358961], ["Dict[str, str]", 0.11034170976865441], ["list", 0.10183563689544946]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[696, 4], [752, 9]], "fn_var_ln": {"env": [[712, 8], [712, 11]], "expected_env": [[742, 8], [742, 20]], "hook": [[733, 8], [733, 12]], "log_lines": [[702, 8], [702, 17]]}, "fn_var_occur": {"env": [["hook", "SparkSubmitHook", "conn_id", "env_vars", "env"], ["call", "env", "os", "environ", "env", "stderr", "stdout", "mock_popen", "mock_calls"], ["call", "env", "expected_env", "stderr", "stdout", "mock_popen", "mock_calls"]], "expected_env": [["expected_env", "os", "environ", "copy"], ["call", "env", "expected_env", "stderr", "stdout", "mock_popen", "mock_calls"]], "hook": [["hook", "SparkSubmitHook", "conn_id", "env_vars", "env"], ["hook", "_process_spark_submit_log", "log_lines"], ["hook", "submit"], ["hook", "on_kill"], ["hook", "SparkSubmitHook", "conn_id", "keytab", "principal"], ["hook", "_process_spark_submit_log", "log_lines"], ["hook", "submit"], ["hook", "on_kill"]], "log_lines": [["hook", "_process_spark_submit_log", "log_lines"], ["hook", "_process_spark_submit_log", "log_lines"]]}, "name": "test_yarn_process_on_kill", "params": {"mock_popen": "", "mock_renew_from_kt": "", "self": ""}, "params_descr": {"mock_popen": "", "mock_renew_from_kt": "", "self": ""}, "params_occur": {"mock_popen": [["mock_popen", "return_value", "stdout", "io", "StringIO"], ["mock_popen", "return_value", "stderr", "io", "StringIO"], ["mock_popen", "return_value", "poll", "return_value", "None"], ["mock_popen", "return_value", "wait", "return_value"], ["call", "env", "os", "environ", "env", "stderr", "stdout", "mock_popen", "mock_calls"], ["mock_popen", "reset_mock"], ["call", "env", "expected_env", "stderr", "stdout", "mock_popen", "mock_calls"]], "mock_renew_from_kt": [], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_popen": [], "mock_renew_from_kt": [["mock.MagicMock", 0.3505700870715619]], "self": []}, "q_name": "TestSparkSubmitHook.test_yarn_process_on_kill", "ret_exprs": [], "ret_type": "", "variables": {"env": "", "expected_env": "", "hook": "", "log_lines": ""}, "variables_p": {"env": [["Dict[Any, Dict[str, Any]]", 0.10292132735171207], ["str", 0.0951643473324585]], "expected_env": [["str", 0.2786570132316745], ["dict", 0.2229723713260441], ["Dict[str, Union[Any, Any]]", 0.08899247360701018], ["Dict[str, bool]", 0.08760870750702628]], "hook": [["str", 0.8896521634348298], ["Dict[str, int]", 0.1103478365651702]], "log_lines": [["List[int]", 0.20362274992529383], ["int", 0.1862563571873445], ["list", 0.11118152707342473], ["Pattern[str]", 0.10244166760711694], ["dict", 0.0975979266718118], ["Dict[int, bool]", 0.0918811995577255]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[754, 4], [774, 58]], "fn_var_ln": {"hook": [[763, 8], [763, 12]], "kill_cmd": [[767, 8], [767, 16]], "log_lines": [[756, 8], [756, 17]]}, "fn_var_occur": {"hook": [["hook", "SparkSubmitHook", "conn_id"], ["hook", "_process_spark_submit_log", "log_lines"], ["kill_cmd", "hook", "_build_spark_driver_kill_command"]], "kill_cmd": [["kill_cmd", "hook", "_build_spark_driver_kill_command"]], "log_lines": [["hook", "_process_spark_submit_log", "log_lines"]]}, "name": "test_standalone_cluster_process_on_kill", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_standalone_cluster_process_on_kill", "ret_exprs": [], "ret_type": "", "variables": {"hook": "", "kill_cmd": "", "log_lines": ""}, "variables_p": {"hook": [["str", 0.5361971249754275], ["Dict[str, Union[Any, Any, Any]]", 0.11812044503857956], ["list", 0.1072432097411213]], "kill_cmd": [["str", 0.7999999999999999], ["int", 0.2]], "log_lines": [["str", 0.3876414641647077], ["list", 0.19189330504105295], ["tuple", 0.12689285065364306], ["int", 0.10337788200732678], ["MutableMapping[str, Any]", 0.09522900212609449], ["property", 0.09496549600717498]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[778, 4], [820, 9]], "fn_var_ln": {"client": [[784, 8], [784, 14]], "hook": [[785, 8], [785, 12]], "kwargs": [[817, 8], [817, 14]], "log_lines": [[786, 8], [786, 17]]}, "fn_var_occur": {"client": [["client", "mock_client_method", "return_value"], ["kwargs", "True", "kubernetes", "client", "V1DeleteOptions"], ["client", "delete_namespaced_pod", "assert_called_once_with", "kwargs"]], "hook": [["hook", "SparkSubmitHook", "conn_id"], ["hook", "_process_spark_submit_log", "log_lines"], ["hook", "submit"], ["hook", "on_kill"]], "kwargs": [["kwargs", "True", "kubernetes", "client", "V1DeleteOptions"], ["client", "delete_namespaced_pod", "assert_called_once_with", "kwargs"]], "log_lines": [["hook", "_process_spark_submit_log", "log_lines"]]}, "name": "test_k8s_process_on_kill", "params": {"mock_client_method": "", "mock_popen": "", "self": ""}, "params_descr": {"mock_client_method": "", "mock_popen": "", "self": ""}, "params_occur": {"mock_client_method": [["client", "mock_client_method", "return_value"]], "mock_popen": [["mock_popen", "return_value", "stdout", "io", "StringIO"], ["mock_popen", "return_value", "stderr", "io", "StringIO"], ["mock_popen", "return_value", "poll", "return_value", "None"], ["mock_popen", "return_value", "wait", "return_value"]], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_client_method": [["mock.MagicMock", 0.10521312952448492]], "mock_popen": [], "self": []}, "q_name": "TestSparkSubmitHook.test_k8s_process_on_kill", "ret_exprs": [], "ret_type": "", "variables": {"client": "", "hook": "", "kwargs": "", "log_lines": ""}, "variables_p": {"client": [["Dict[str, Union[int, str]]", 0.15300461923934422], ["dict", 0.11905835329405755], ["str", 0.1049739458201086], ["Dict[str, Any]", 0.08711872191049785], ["list", 0.08471870462610277]], "hook": [["str", 0.9079766610360396]], "kwargs": [["src.pip_shims.models.ShimmedPathCollection", 0.10271706973933453], ["str", 0.08532719700474704], ["ariadne.exceptions.HttpBadRequestError", 0.08445077477316502]], "log_lines": [["str", 0.3876414641647077], ["list", 0.19189330504105295], ["tuple", 0.12689285065364306], ["int", 0.10337788200732678], ["MutableMapping[str, Any]", 0.09522900212609449], ["property", 0.09496549600717498]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[859, 4], [867, 41]], "fn_var_ln": {"command_masked": [[864, 8], [864, 22]], "hook": [[861, 8], [861, 12]]}, "fn_var_occur": {"command_masked": [["command_masked", "hook", "_mask_cmd", "command"], ["command_masked", "expected"]], "hook": [["hook", "SparkSubmitHook"], ["command_masked", "hook", "_mask_cmd", "command"]]}, "name": "test_masks_passwords", "params": {"command": "builtins.str", "expected": "builtins.str", "self": ""}, "params_descr": {"command": "", "expected": "", "self": ""}, "params_occur": {"command": [["command_masked", "hook", "_mask_cmd", "command"]], "expected": [["command_masked", "expected"]], "self": []}, "params_p": {"args": [], "command": [["str", 0.9605476033840805], ["Dict[str, Any]", 0.039452396615919746]], "expected": [["str", 0.9605476033840805], ["Dict[str, Any]", 0.039452396615919746]], "kwargs": [], "self": []}, "q_name": "TestSparkSubmitHook.test_masks_passwords", "ret_exprs": [], "ret_type": "None", "variables": {"command_masked": "", "hook": ""}, "variables_p": {"command_masked": [["str", 0.8437669164889006]], "hook": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1]]}}], "name": "TestSparkSubmitHook", "q_name": "TestSparkSubmitHook", "variables": {"_config": "", "_spark_job_file": ""}, "variables_p": {"_config": [["str", 0.4], ["Tuple[str]", 0.2], ["Optional[Dict[str, Any]]", 0.1], ["Tuple[str, str]", 0.1], ["dict", 0.1]], "_spark_job_file": [["str", 0.39999999999999997], ["bool", 0.3], ["List[str]", 0.09999999999999999], ["int", 0.09999999999999999]]}}], "funcs": [], "imports": ["__future__", "annotations", "io", "os", "unittest", "mock", "call", "patch", "pytest", "airflow", "exceptions", "AirflowException", "airflow", "models", "Connection", "airflow", "providers", "apache", "spark", "hooks", "spark_submit", "SparkSubmitHook", "airflow", "utils", "db", "kubernetes"], "mod_var_ln": {}, "mod_var_occur": {}, "no_types_annot": {"D": 3, "I": 0, "U": 149}, "session_id": "1a5DHXmNp7iTUbcRmbMgUW-I8FodJnlrv7LaQHwqJKs", "set": null, "tc": [false, null], "type_annot_cove": 0.02, "typed_seq": "", "untyped_seq": "", "variables": {}, "variables_p": {}}}