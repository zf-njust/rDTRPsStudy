{"error": null, "response": {"classes": [{"cls_lc": [[40, 0], [280, 17]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[42, 4], [114, 23]], "fn_var_ln": {"check_headers": [[53, 8], [53, 26]], "create": [[49, 8], [49, 19]], "delimiter": [[48, 8], [48, 22]], "field_dict": [[46, 8], [46, 23]], "file_names": [[43, 8], [43, 23]], "fn_bz2": [[102, 8], [102, 14]], "fn_gz": [[94, 8], [94, 13]], "fn_gz_upper": [[98, 8], [98, 19]], "header": [[70, 8], [70, 14]], "headers": [[52, 8], [52, 20]], "hive_table": [[47, 8], [47, 23]], "input_compressed": [[55, 8], [55, 29]], "kwargs": [[56, 8], [56, 19]], "line1": [[71, 8], [71, 13]], "line2": [[72, 8], [72, 13]], "partition": [[51, 8], [51, 22]], "recreate": [[50, 8], [50, 21]], "s3_key": [[45, 8], [45, 19]], "task_id": [[44, 8], [44, 20]], "tmp_dir": [[73, 8], [73, 20]], "wildcard_match": [[54, 8], [54, 27]]}, "fn_var_occur": {"check_headers": [["self", "check_headers", "True"], ["self", "kwargs", "self", "task_id", "self", "s3_key", "self", "field_dict", "self", "hive_table", "self", "delimiter", "self", "create", "self", "recreate", "self", "partition", "self", "headers", "self", "check_headers", "self", "wildcard_match", "self", "input_compressed"]], "create": [["self", "create", "True"], ["self", "kwargs", "self", "task_id", "self", "s3_key", "self", "field_dict", "self", "hive_table", "self", "delimiter", "self", "create", "self", "recreate", "self", "partition", "self", "headers", "self", "check_headers", "self", "wildcard_match", "self", "input_compressed"]], "delimiter": [["self", "delimiter"], ["self", "kwargs", "self", "task_id", "self", "s3_key", "self", "field_dict", "self", "hive_table", "self", "delimiter", "self", "create", "self", "recreate", "self", "partition", "self", "headers", "self", "check_headers", "self", "wildcard_match", "self", "input_compressed"]], "field_dict": [["self", "field_dict", "OrderedDict"], ["self", "kwargs", "self", "task_id", "self", "s3_key", "self", "field_dict", "self", "hive_table", "self", "delimiter", "self", "create", "self", "recreate", "self", "partition", "self", "headers", "self", "check_headers", "self", "wildcard_match", "self", "input_compressed"]], "file_names": [["self", "file_names"]], "fn_bz2": [["fn_bz2", "self", "_get_fn", "True"], ["bz2", "BZ2File", "filename", "fn_bz2", "mode", "f_bz2_h"], ["self", "_set_fn", "fn_bz2", "True"], ["fn_bz2", "self", "_get_fn", "False"], ["bz2", "BZ2File", "filename", "fn_bz2", "mode", "f_bz2_nh"], ["self", "_set_fn", "fn_bz2", "False"]], "fn_gz": [["fn_gz", "self", "_get_fn", "True"], ["GzipFile", "filename", "fn_gz", "mode", "f_gz_h"], ["self", "_set_fn", "fn_gz", "True"], ["fn_gz", "self", "_get_fn", "False"], ["GzipFile", "filename", "fn_gz", "mode", "f_gz_nh"], ["self", "_set_fn", "fn_gz", "False"]], "fn_gz_upper": [["fn_gz_upper", "self", "_get_fn", "True"], ["GzipFile", "filename", "fn_gz_upper", "mode", "f_gz_upper_h"], ["self", "_set_fn", "fn_gz_upper", "True"], ["fn_gz_upper", "self", "_get_fn", "False"], ["GzipFile", "filename", "fn_gz_upper", "mode", "f_gz_upper_nh"], ["self", "_set_fn", "fn_gz_upper", "False"]], "header": [["f_txt_h", "writelines", "header", "line1", "line2"], ["f_gz_h", "writelines", "header", "line1", "line2"], ["f_gz_upper_h", "writelines", "header", "line1", "line2"], ["f_bz2_h", "writelines", "header", "line1", "line2"]], "headers": [["self", "headers", "True"], ["self", "kwargs", "self", "task_id", "self", "s3_key", "self", "field_dict", "self", "hive_table", "self", "delimiter", "self", "create", "self", "recreate", "self", "partition", "self", "headers", "self", "check_headers", "self", "wildcard_match", "self", "input_compressed"]], "hive_table": [["self", "hive_table"], ["self", "kwargs", "self", "task_id", "self", "s3_key", "self", "field_dict", "self", "hive_table", "self", "delimiter", "self", "create", "self", "recreate", "self", "partition", "self", "headers", "self", "check_headers", "self", "wildcard_match", "self", "input_compressed"]], "input_compressed": [["self", "input_compressed", "False"], ["self", "kwargs", "self", "task_id", "self", "s3_key", "self", "field_dict", "self", "hive_table", "self", "delimiter", "self", "create", "self", "recreate", "self", "partition", "self", "headers", "self", "check_headers", "self", "wildcard_match", "self", "input_compressed"]], "kwargs": [["self", "kwargs", "self", "task_id", "self", "s3_key", "self", "field_dict", "self", "hive_table", "self", "delimiter", "self", "create", "self", "recreate", "self", "partition", "self", "headers", "self", "check_headers", "self", "wildcard_match", "self", "input_compressed"]], "line1": [["f_txt_h", "writelines", "header", "line1", "line2"], ["f_gz_h", "writelines", "header", "line1", "line2"], ["f_gz_upper_h", "writelines", "header", "line1", "line2"], ["f_bz2_h", "writelines", "header", "line1", "line2"], ["f_txt_nh", "writelines", "line1", "line2"], ["f_gz_nh", "writelines", "line1", "line2"], ["f_gz_upper_nh", "writelines", "line1", "line2"], ["f_bz2_nh", "writelines", "line1", "line2"]], "line2": [["f_txt_h", "writelines", "header", "line1", "line2"], ["f_gz_h", "writelines", "header", "line1", "line2"], ["f_gz_upper_h", "writelines", "header", "line1", "line2"], ["f_bz2_h", "writelines", "header", "line1", "line2"], ["f_txt_nh", "writelines", "line1", "line2"], ["f_gz_nh", "writelines", "line1", "line2"], ["f_gz_upper_nh", "writelines", "line1", "line2"], ["f_bz2_nh", "writelines", "line1", "line2"]], "partition": [["self", "partition"], ["self", "kwargs", "self", "task_id", "self", "s3_key", "self", "field_dict", "self", "hive_table", "self", "delimiter", "self", "create", "self", "recreate", "self", "partition", "self", "headers", "self", "check_headers", "self", "wildcard_match", "self", "input_compressed"]], "recreate": [["self", "recreate", "True"], ["self", "kwargs", "self", "task_id", "self", "s3_key", "self", "field_dict", "self", "hive_table", "self", "delimiter", "self", "create", "self", "recreate", "self", "partition", "self", "headers", "self", "check_headers", "self", "wildcard_match", "self", "input_compressed"]], "s3_key": [["self", "s3_key"], ["self", "kwargs", "self", "task_id", "self", "s3_key", "self", "field_dict", "self", "hive_table", "self", "delimiter", "self", "create", "self", "recreate", "self", "partition", "self", "headers", "self", "check_headers", "self", "wildcard_match", "self", "input_compressed"]], "task_id": [["self", "task_id"], ["self", "kwargs", "self", "task_id", "self", "s3_key", "self", "field_dict", "self", "hive_table", "self", "delimiter", "self", "create", "self", "recreate", "self", "partition", "self", "headers", "self", "check_headers", "self", "wildcard_match", "self", "input_compressed"]], "tmp_dir": [["self", "tmp_dir", "mkdtemp", "prefix"], ["NamedTemporaryFile", "mode", "dir", "self", "tmp_dir", "delete", "False", "f_txt_h"], ["NamedTemporaryFile", "mode", "dir", "self", "tmp_dir", "delete", "False", "f_txt_nh"], ["shutil", "rmtree", "self", "tmp_dir"]], "wildcard_match": [["self", "wildcard_match", "False"], ["self", "kwargs", "self", "task_id", "self", "s3_key", "self", "field_dict", "self", "hive_table", "self", "delimiter", "self", "create", "self", "recreate", "self", "partition", "self", "headers", "self", "check_headers", "self", "wildcard_match", "self", "input_compressed"]]}, "name": "setup_attrs", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "file_names"], ["self", "task_id"], ["self", "s3_key"], ["self", "field_dict", "OrderedDict"], ["self", "hive_table"], ["self", "delimiter"], ["self", "create", "True"], ["self", "recreate", "True"], ["self", "partition"], ["self", "headers", "True"], ["self", "check_headers", "True"], ["self", "wildcard_match", "False"], ["self", "input_compressed", "False"], ["self", "kwargs", "self", "task_id", "self", "s3_key", "self", "field_dict", "self", "hive_table", "self", "delimiter", "self", "create", "self", "recreate", "self", "partition", "self", "headers", "self", "check_headers", "self", "wildcard_match", "self", "input_compressed"], ["self", "tmp_dir", "mkdtemp", "prefix"], ["NamedTemporaryFile", "mode", "dir", "self", "tmp_dir", "delete", "False", "f_txt_h"], ["self", "_set_fn", "f_txt_h", "name", "True"], ["fn_gz", "self", "_get_fn", "True"], ["self", "_set_fn", "fn_gz", "True"], ["fn_gz_upper", "self", "_get_fn", "True"], ["self", "_set_fn", "fn_gz_upper", "True"], ["fn_bz2", "self", "_get_fn", "True"], ["self", "_set_fn", "fn_bz2", "True"], ["NamedTemporaryFile", "mode", "dir", "self", "tmp_dir", "delete", "False", "f_txt_nh"], ["self", "_set_fn", "f_txt_nh", "name", "False"], ["fn_gz", "self", "_get_fn", "False"], ["self", "_set_fn", "fn_gz", "False"], ["fn_gz_upper", "self", "_get_fn", "False"], ["self", "_set_fn", "fn_gz_upper", "False"], ["fn_bz2", "self", "_get_fn", "False"], ["self", "_set_fn", "fn_bz2", "False"], ["shutil", "rmtree", "self", "tmp_dir"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestS3ToHiveTransfer.setup_attrs", "ret_exprs": [], "ret_type": "", "variables": {"check_headers": "", "create": "", "delimiter": "", "field_dict": "", "file_names": "", "fn_bz2": "", "fn_gz": "", "fn_gz_upper": "", "header": "", "headers": "", "hive_table": "", "input_compressed": "", "kwargs": "", "line1": "", "line2": "", "partition": "", "recreate": "", "s3_key": "", "task_id": "", "tmp_dir": "", "wildcard_match": ""}, "variables_p": {"check_headers": [["str", 0.7088772132748217]], "create": [["int", 0.2143869188356637], ["str", 0.10054266333500012], ["property", 0.09834395130142455]], "delimiter": [["str", 0.8732676475659631]], "field_dict": [["Set[str]", 0.12484064067245558], ["OrderedDict", 0.11382781716065818], ["Dict[Union[int, str], Union[int, str]]", 0.11313840063545327], ["Dict[str, Union[Any, str]]", 0.10108075953446014], ["Dict[int, List[Any]]", 0.09332113906503502], ["dict", 0.08855331720389223], ["set", 0.0868043735738268], ["Generator[Any, None, None]", 0.08538248538537198]], "file_names": [["str", 0.7984977924307232], ["List[str]", 0.10716627385595587]], "fn_bz2": [], "fn_gz": [["str", 0.5919790230170352], ["float", 0.14036759056317866], ["List[str]", 0.08906687660144545]], "fn_gz_upper": [["int", 0.4674730390610545], ["Optional[dict]", 0.09213193750095496]], "header": [["str", 0.2906325903980482], ["Dict[str, str]", 0.18844812285239854], ["List[str]", 0.12621976501791196], ["Dict[int, str]", 0.09057773726148614], ["Dict[str, Union[Any, Any]]", 0.09026432264869598]], "headers": [["list", 0.37495844295520764], ["Dict[str, List[str]]", 0.16776183363483604], ["List[Tuple[str, str, str, str]]", 0.10266531107698107], ["Dict[str, Union[None, int, str]]", 0.09279761945009893], ["List[str]", 0.08385900920076915], ["str", 0.0837087963153486]], "hive_table": [["str", 0.8083063945651081]], "input_compressed": [["int", 0.3504367716011744], ["str", 0.3061174772732821], ["bool", 0.17043443786722895]], "kwargs": [["str", 0.5209354716101519], ["Dict[str, str]", 0.19476472326556563], ["dict", 0.1040717697813435], ["Tuple[Literal, Literal, Literal]", 0.09018451776483596], ["MutableSequence[str]", 0.09004351757810306]], "line1": [["str", 0.2960787856676742], ["float", 0.2038932996120192], ["Final", 0.19135245826285777], ["List[str]", 0.18398401639186748], ["dict", 0.12469144006558128]], "line2": [["str", 0.2960787856676742], ["float", 0.2038932996120192], ["Final", 0.19135245826285777], ["List[str]", 0.18398401639186748], ["dict", 0.12469144006558128]], "partition": [["str", 0.538483996952363], ["int", 0.30987549950272436]], "recreate": [["List[Tuple[str, str]]", 0.18776092006225886], ["str", 0.18573367953285463], ["Dict[str, str]", 0.14756917800064373], ["list", 0.10596136546246854], ["List[int]", 0.0954652763309738], ["float", 0.09309839420186017], ["bool", 0.09097383214317316]], "s3_key": [["str", 0.9087799867426329], ["Dict[int, str]", 0.09122001325736702]], "task_id": [["str", 0.712106385943966], ["int", 0.09830906945992432]], "tmp_dir": [["str", 0.9999999999999999]], "wildcard_match": [["List[str]", 0.3116277934844695], ["int", 0.29524843675122153], ["list", 0.21069414573265643], ["Tuple[List[Any], List[Any], List[Any]]", 0.09510131021257358], ["str", 0.08732831381907889]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[118, 4], [120, 33]], "fn_var_ln": {"key": [[119, 8], [119, 11]]}, "fn_var_occur": {"key": [["key", "self", "_get_key", "ext", "header"], ["self", "file_names", "key", "fn"]]}, "name": "_set_fn", "params": {"ext": "", "fn": "", "header": "", "self": ""}, "params_descr": {"ext": "", "fn": "", "header": "", "self": ""}, "params_occur": {"ext": [["key", "self", "_get_key", "ext", "header"]], "fn": [["self", "file_names", "key", "fn"]], "header": [["key", "self", "_get_key", "ext", "header"]], "self": [["key", "self", "_get_key", "ext", "header"], ["self", "file_names", "key", "fn"]]}, "params_p": {"args": [], "ext": [["str", 0.22570413775237105], ["dict", 0.094765031998357]], "fn": [["Dict[str, Any]", 0.2183806061148191], ["str", 0.19148640885879972], ["dict", 0.11197499263733306], ["list", 0.09706645706610358], ["tuple", 0.09706645706610358], ["Dict[str, str]", 0.09441995179269615]], "header": [["str", 0.22570413775237105], ["dict", 0.094765031998357]], "kwargs": [], "self": []}, "q_name": "TestS3ToHiveTransfer._set_fn", "ret_exprs": [], "ret_type": "", "variables": {"key": ""}, "variables_p": {"key": [["str", 0.7637307855848701], ["int", 0.14988896361260323], ["List[str]", 0.0863802508025267]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[124, 4], [126, 35]], "fn_var_ln": {"key": [[125, 8], [125, 11]]}, "fn_var_occur": {"key": [["key", "self", "_get_key", "ext", "header"], ["self", "file_names", "key"]]}, "name": "_get_fn", "params": {"ext": "", "header": "", "self": ""}, "params_descr": {"ext": "", "header": "", "self": ""}, "params_occur": {"ext": [["key", "self", "_get_key", "ext", "header"]], "header": [["key", "self", "_get_key", "ext", "header"]], "self": [["key", "self", "_get_key", "ext", "header"], ["self", "file_names", "key"]]}, "params_p": {"args": [], "ext": [["str", 0.18659071720761622], ["int", 0.10645120385241945], ["Union[str, Iterable[str]]", 0.10523607896169916]], "header": [["str", 0.18659071720761622], ["int", 0.10645120385241945], ["Union[str, Iterable[str]]", 0.10523607896169916]], "kwargs": [], "self": []}, "q_name": "TestS3ToHiveTransfer._get_fn", "ret_exprs": ["return self.file_names[key]"], "ret_type": "", "ret_type_p": [["str", 0.28854538086603154], ["bool", 0.21664017765086452], ["Optional[List[str]]", 0.10553803126832621], ["Optional['SparkSession']", 0.09787527303472986], ["dict", 0.09454776140369865]], "variables": {"key": ""}, "variables_p": {"key": [["str", 0.6854755865008484], ["int", 0.13607560638471214], ["List[str]", 0.08787483769109829]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[129, 4], [131, 18]], "fn_var_ln": {"key": [[130, 8], [130, 11]]}, "fn_var_occur": {"key": [["key", "ext", "header"]]}, "name": "_get_key", "params": {"ext": "", "header": ""}, "params_descr": {"ext": "", "header": ""}, "params_occur": {"ext": [["key", "ext", "header"]], "header": [["key", "ext", "header"]]}, "params_p": {"args": [], "ext": [["dict", 0.07946045652982323]], "header": [["dict", 0.07946045652982323]], "kwargs": [], "self": []}, "q_name": "TestS3ToHiveTransfer._get_key", "ret_exprs": ["return key"], "ret_type": "", "ret_type_p": [["str", 0.6968124875317687], ["dict", 0.10864604221639876], ["int", 0.09363133077901513]], "variables": {"key": ""}, "variables_p": {"key": [["List[str]", 0.3900689424493322], ["str", 0.2878537698918304], ["Set[str]", 0.10735909588627914], ["Tuple[str, str, str, str, str, str, str, str, str, str, str, str, str, str, str, str, str]", 0.10735909588627914], ["Tuple[str, str, str]", 0.10735909588627914]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[134, 4], [147, 57]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "_check_file_equality", "params": {"ext": "", "fn_1": "", "fn_2": ""}, "params_descr": {"ext": "", "fn_1": "", "fn_2": ""}, "params_occur": {"ext": [["ext", "lower"]], "fn_1": [["GzipFile", "fn_1", "f_1"], ["filecmp", "cmp", "fn_1", "fn_2", "shallow", "False"]], "fn_2": [["GzipFile", "fn_2", "f_2"], ["filecmp", "cmp", "fn_1", "fn_2", "shallow", "False"]]}, "params_p": {"args": [], "ext": [["str", 0.29418653108821724], ["Dict[str, str]", 0.128911484664916], ["Optional[int]", 0.09503450584794976], ["List[str]", 0.08846574405644363]], "fn_1": [["bool", 0.34508604413136823], ["str", 0.2252704608568704], ["Pattern", 0.08472620477880051], ["int", 0.08374165310938073], ["set", 0.08105802370266992], ["Tuple[str, str]", 0.0804794943403573]], "fn_2": [["bool", 0.34508604413136823], ["str", 0.2252704608568704], ["Pattern", 0.08472620477880051], ["int", 0.08374165310938073], ["set", 0.08105802370266992], ["Tuple[str, str]", 0.0804794943403573]], "kwargs": [], "self": []}, "q_name": "TestS3ToHiveTransfer._check_file_equality", "ret_exprs": ["return filecmp.cmp(f_txt_1.name, f_txt_2.name, shallow=False)", "return filecmp.cmp(fn_1, fn_2, shallow=False)"], "ret_type": "", "ret_type_p": [["str", 0.717812112354207]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[150, 4], [152, 58]], "fn_var_ln": {"check": [[151, 8], [151, 13]]}, "fn_var_occur": {"check": [["check", "TestS3ToHiveTransfer", "_check_file_equality", "args", "op_fn", "ext"], ["check", "ext"]]}, "name": "_load_file_side_effect", "params": {"args": "", "ext": "", "op_fn": ""}, "params_descr": {"args": "", "ext": "", "op_fn": ""}, "params_occur": {"args": [["check", "TestS3ToHiveTransfer", "_check_file_equality", "args", "op_fn", "ext"]], "ext": [["check", "TestS3ToHiveTransfer", "_check_file_equality", "args", "op_fn", "ext"], ["check", "ext"]], "op_fn": [["check", "TestS3ToHiveTransfer", "_check_file_equality", "args", "op_fn", "ext"]]}, "params_p": {"args": [], "ext": [["str", 0.3989021705178054], ["Type", 0.13875095392432588], ["int", 0.1015551265328145]], "kwargs": [], "op_fn": [["str", 0.39291049974603826], ["bool", 0.18760254726803238], ["Type", 0.13288538592230217]], "self": []}, "q_name": "TestS3ToHiveTransfer._load_file_side_effect", "ret_exprs": [], "ret_type": "", "variables": {"check": ""}, "variables_p": {"check": [["str", 0.5973208042035962], ["int", 0.20233342933128215], ["Tuple[bool, bool]", 0.08880137923199294]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[154, 4], [158, 43]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_bad_parameters", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "kwargs", "True"], ["self", "kwargs", "False"], ["S3ToHiveOperator", "self", "kwargs"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestS3ToHiveTransfer.test_bad_parameters", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[160, 4], [168, 103]], "fn_var_ln": {"fn_txt": [[162, 8], [162, 14]], "header_list": [[167, 8], [167, 19]]}, "fn_var_occur": {"fn_txt": [["fn_txt", "self", "_get_fn", "True"], ["header_list", "S3ToHiveOperator", "self", "kwargs", "_get_top_row_as_list", "fn_txt"], ["header_list", "S3ToHiveOperator", "self", "kwargs", "_get_top_row_as_list", "fn_txt"]], "header_list": [["header_list", "S3ToHiveOperator", "self", "kwargs", "_get_top_row_as_list", "fn_txt"], ["header_list", "S3ToHiveOperator", "self", "kwargs", "_get_top_row_as_list", "fn_txt"]]}, "name": "test__get_top_row_as_list", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "kwargs"], ["fn_txt", "self", "_get_fn", "True"], ["header_list", "S3ToHiveOperator", "self", "kwargs", "_get_top_row_as_list", "fn_txt"], ["self", "kwargs"], ["header_list", "S3ToHiveOperator", "self", "kwargs", "_get_top_row_as_list", "fn_txt"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestS3ToHiveTransfer.test__get_top_row_as_list", "ret_exprs": [], "ret_type": "", "variables": {"fn_txt": "", "header_list": ""}, "variables_p": {"fn_txt": [["List[int]", 0.16754818451532788], ["dict", 0.1348879586366852], ["Dict[str, Union[None, int, str]]", 0.0860482099353576]], "header_list": [["list", 0.264399053782159], ["List[str]", 0.09266842133077893]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[170, 4], [182, 52]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test__match_headers", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "kwargs", "OrderedDict"], ["S3ToHiveOperator", "self", "kwargs", "_match_headers"], ["S3ToHiveOperator", "self", "kwargs", "_match_headers"], ["S3ToHiveOperator", "self", "kwargs", "_match_headers"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestS3ToHiveTransfer.test__match_headers", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[184, 4], [194, 107]], "fn_var_ln": {"bz2_txt_nh": [[192, 8], [192, 18]], "fn_bz2": [[193, 8], [193, 14]], "fn_gz": [[189, 8], [189, 13]], "fn_txt": [[187, 8], [187, 14]], "gz_txt_nh": [[188, 8], [188, 17]], "s32hive": [[185, 8], [185, 15]]}, "fn_var_occur": {"bz2_txt_nh": [["bz2_txt_nh", "s32hive", "_delete_top_row_and_compress", "fn_txt", "self", "tmp_dir"], ["self", "_check_file_equality", "bz2_txt_nh", "fn_bz2"]], "fn_bz2": [["fn_bz2", "self", "_get_fn", "False"], ["self", "_check_file_equality", "bz2_txt_nh", "fn_bz2"]], "fn_gz": [["fn_gz", "self", "_get_fn", "False"], ["self", "_check_file_equality", "gz_txt_nh", "fn_gz"]], "fn_txt": [["fn_txt", "self", "_get_fn", "True"], ["gz_txt_nh", "s32hive", "_delete_top_row_and_compress", "fn_txt", "self", "tmp_dir"], ["bz2_txt_nh", "s32hive", "_delete_top_row_and_compress", "fn_txt", "self", "tmp_dir"]], "gz_txt_nh": [["gz_txt_nh", "s32hive", "_delete_top_row_and_compress", "fn_txt", "self", "tmp_dir"], ["self", "_check_file_equality", "gz_txt_nh", "fn_gz"]], "s32hive": [["s32hive", "S3ToHiveOperator", "self", "kwargs"], ["gz_txt_nh", "s32hive", "_delete_top_row_and_compress", "fn_txt", "self", "tmp_dir"], ["bz2_txt_nh", "s32hive", "_delete_top_row_and_compress", "fn_txt", "self", "tmp_dir"]]}, "name": "test__delete_top_row_and_compress", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["s32hive", "S3ToHiveOperator", "self", "kwargs"], ["fn_txt", "self", "_get_fn", "True"], ["gz_txt_nh", "s32hive", "_delete_top_row_and_compress", "fn_txt", "self", "tmp_dir"], ["fn_gz", "self", "_get_fn", "False"], ["self", "_check_file_equality", "gz_txt_nh", "fn_gz"], ["bz2_txt_nh", "s32hive", "_delete_top_row_and_compress", "fn_txt", "self", "tmp_dir"], ["fn_bz2", "self", "_get_fn", "False"], ["self", "_check_file_equality", "bz2_txt_nh", "fn_bz2"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestS3ToHiveTransfer.test__delete_top_row_and_compress", "ret_exprs": [], "ret_type": "", "variables": {"bz2_txt_nh": "", "fn_bz2": "", "fn_gz": "", "fn_txt": "", "gz_txt_nh": "", "s32hive": ""}, "variables_p": {"bz2_txt_nh": [], "fn_bz2": [["List[str]", 0.29378122507996], ["Set[str]", 0.19585415005330667], ["Dict[int, str]", 0.19585415005330667], ["list", 0.11865632476011995], ["str", 0.09792707502665333]], "fn_gz": [["List[str]", 0.29378122507996], ["Set[str]", 0.19585415005330667], ["Dict[int, str]", 0.19585415005330667], ["list", 0.11865632476011995], ["str", 0.09792707502665333]], "fn_txt": [["str", 0.11288750833027235]], "gz_txt_nh": [], "s32hive": [["str", 0.41541727459090866], ["int", 0.09620935378081437]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[198, 4], [227, 33]], "fn_var_ln": {"conn": [[199, 8], [199, 12]], "ip_fn": [[214, 12], [214, 17]], "op_fn": [[215, 12], [215, 17]], "s32hive": [[226, 12], [226, 19]]}, "fn_var_occur": {"conn": [["conn", "boto3", "client"], ["conn", "meta", "region_name"], ["conn", "create_bucket", "Bucket"], ["conn", "create_bucket", "Bucket", "CreateBucketConfiguration", "conn", "meta", "region_name"], ["conn", "upload_file", "ip_fn", "self", "s3_key", "ext"]], "ip_fn": [["ip_fn", "self", "_get_fn", "ext", "self", "kwargs"], ["conn", "upload_file", "ip_fn", "self", "s3_key", "ext"]], "op_fn": [["op_fn", "self", "_get_fn", "ext", "False"], ["mock_hiveclihook", "load_file", "side_effect", "args", "kwargs", "self", "_load_file_side_effect", "args", "op_fn", "ext"]], "s32hive": [["s32hive", "S3ToHiveOperator", "self", "kwargs"], ["s32hive", "execute", "None"]]}, "name": "test_execute", "params": {"mock_hiveclihook": "", "self": ""}, "params_descr": {"mock_hiveclihook": "", "self": ""}, "params_occur": {"mock_hiveclihook": [["mock_hiveclihook", "load_file", "side_effect", "args", "kwargs", "self", "_load_file_side_effect", "args", "op_fn", "ext"]], "self": [["self", "kwargs", "has_header"], ["self", "kwargs", "has_header"], ["self", "kwargs", "ext", "lower"], ["self", "kwargs", "self", "s3_key", "ext"], ["ip_fn", "self", "_get_fn", "ext", "self", "kwargs"], ["op_fn", "self", "_get_fn", "ext", "False"], ["conn", "upload_file", "ip_fn", "self", "s3_key", "ext"], ["mock_hiveclihook", "load_file", "side_effect", "args", "kwargs", "self", "_load_file_side_effect", "args", "op_fn", "ext"], ["s32hive", "S3ToHiveOperator", "self", "kwargs"]]}, "params_p": {"args": [], "kwargs": [], "mock_hiveclihook": [["str", 0.18209768648050007]], "self": []}, "q_name": "TestS3ToHiveTransfer.test_execute", "ret_exprs": [], "ret_type": "", "variables": {"conn": "", "ip_fn": "", "op_fn": "", "s32hive": ""}, "variables_p": {"conn": [], "ip_fn": [["Dict[str, str]", 0.27092464926549903], ["str", 0.2462509452370617], ["Dict[Any, bytes]", 0.1145635557088306], ["int", 0.08857983151442843]], "op_fn": [["list", 0.21374090561831502], ["List[str]", 0.09407410501851966], ["dict", 0.08813624731159343]], "s32hive": [["dict", 0.575938879032996], ["Tuple[str, str]", 0.07399262877657295]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[231, 4], [280, 17]], "fn_var_ln": {"bucket": [[241, 8], [241, 14]], "conn": [[232, 8], [232, 12]], "input_compressed": [[247, 12], [247, 28]], "input_serialization": [[261, 12], [261, 31]], "ip_fn": [[256, 12], [256, 17]], "key": [[248, 12], [248, 15]], "s32hive": [[272, 16], [272, 23]], "select_expression": [[240, 8], [240, 25]]}, "fn_var_occur": {"bucket": [["self", "kwargs", "bucket", "key"], ["conn", "upload_file", "ip_fn", "bucket", "key"], ["mock_select_key", "assert_called_once_with", "bucket_name", "bucket", "key", "key", "expression", "select_expression", "input_serialization", "input_serialization"]], "conn": [["conn", "boto3", "client"], ["conn", "meta", "region_name"], ["conn", "create_bucket", "Bucket"], ["conn", "create_bucket", "Bucket", "CreateBucketConfiguration", "conn", "meta", "region_name"], ["conn", "upload_file", "ip_fn", "bucket", "key"]], "input_compressed": [["input_compressed", "ext", "lower"], ["self", "kwargs", "input_compressed"]], "input_serialization": [["input_serialization", "self", "delimiter"], ["mock_select_key", "assert_called_once_with", "bucket_name", "bucket", "key", "key", "expression", "select_expression", "input_serialization", "input_serialization"]], "ip_fn": [["ip_fn", "self", "_get_fn", "ext", "has_header"], ["conn", "upload_file", "ip_fn", "bucket", "key"]], "key": [["key", "self", "s3_key", "ext"], ["self", "kwargs", "bucket", "key"], ["conn", "upload_file", "ip_fn", "bucket", "key"], ["mock_select_key", "assert_called_once_with", "bucket_name", "bucket", "key", "key", "expression", "select_expression", "input_serialization", "input_serialization"]], "s32hive": [["s32hive", "S3ToHiveOperator", "self", "kwargs"], ["s32hive", "execute", "None"]], "select_expression": [["self", "kwargs", "select_expression"], ["mock_select_key", "assert_called_once_with", "bucket_name", "bucket", "key", "key", "expression", "select_expression", "input_serialization", "input_serialization"]]}, "name": "test_execute_with_select_expression", "params": {"mock_hiveclihook": "", "self": ""}, "params_descr": {"mock_hiveclihook": "", "self": ""}, "params_occur": {"mock_hiveclihook": [], "self": [["key", "self", "s3_key", "ext"], ["self", "kwargs", "False"], ["self", "kwargs", "has_header"], ["self", "kwargs", "input_compressed"], ["self", "kwargs", "select_expression"], ["self", "kwargs", "bucket", "key"], ["ip_fn", "self", "_get_fn", "ext", "has_header"], ["input_serialization", "self", "delimiter"], ["s32hive", "S3ToHiveOperator", "self", "kwargs"]]}, "params_p": {"args": [], "kwargs": [], "mock_hiveclihook": [["mock.Mock", 0.8782884277640186], ["Generator[None, Any, None]", 0.12171157223598145]], "self": []}, "q_name": "TestS3ToHiveTransfer.test_execute_with_select_expression", "ret_exprs": [], "ret_type": "", "variables": {"bucket": "", "conn": "", "input_compressed": "", "input_serialization": "", "ip_fn": "", "key": "", "s32hive": "", "select_expression": ""}, "variables_p": {"bucket": [["str", 0.6290376840623256], ["List[str]", 0.09719202031741427]], "conn": [], "input_compressed": [["int", 0.2659789774757647], ["Dict[int, str]", 0.19683680913779952], ["List[str]", 0.16319772752527847], ["Dict[str, Dict[str, Any]]", 0.0858566741180003], ["str", 0.08075655668527287]], "input_serialization": [["Dict[str, str]", 0.29348091309151797], ["Dict[Any, Tuple[Any, Any]]", 0.19336397140007036], ["Type[str]", 0.17188668607008042], ["List[str]", 0.10020055994116064]], "ip_fn": [["int", 0.5110179522534831], ["list", 0.20709093734719863], ["str", 0.09813147550967473], ["List[str]", 0.09617838795169331]], "key": [["str", 1.0]], "s32hive": [["dict", 0.575938879032996], ["Tuple[str, str]", 0.07399262877657295]], "select_expression": [["str", 0.6145835616798145], ["Pattern[str]", 0.1969323404008741], ["Dict[str, Union[Any, Any, Any, Any]]", 0.09651851690435302], ["List[str]", 0.09196558101495841]]}}], "name": "TestS3ToHiveTransfer", "q_name": "TestS3ToHiveTransfer", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["__future__", "annotations", "bz2", "errno", "filecmp", "logging", "shutil", "collections", "OrderedDict", "gzip", "GzipFile", "itertools", "product", "tempfile", "NamedTemporaryFile", "mkdtemp", "unittest", "mock", "pytest", "airflow", "exceptions", "AirflowException", "airflow", "providers", "apache", "hive", "transfers", "s3_to_hive", "S3ToHiveOperator"], "mod_var_ln": {"boto3": [[36, 0], [36, 5]], "moto": [[37, 0], [37, 4]]}, "mod_var_occur": {"boto3": [["conn", "boto3", "client"], ["conn", "boto3", "client"]], "moto": []}, "no_types_annot": {"D": 0, "I": 0, "U": 74}, "session_id": "gxwYgVL3xCxkjrKLZeSvLe3yyDNGguHX3VErf0RseZI", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"boto3": "", "moto": ""}, "variables_p": {"boto3": [["str", 0.4999999999539007], ["Dict[str, str]", 1.3262960413222682e-11], ["int", 1.321091892392887e-11]], "moto": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]]}}}