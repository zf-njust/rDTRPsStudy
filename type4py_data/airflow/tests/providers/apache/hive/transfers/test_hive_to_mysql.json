{"error": null, "response": {"classes": [{"cls_lc": [[34, 0], [183, 109]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[35, 4], [43, 36]], "fn_var_ln": {"kwargs": [[36, 8], [36, 19]]}, "fn_var_occur": {"kwargs": [["self", "kwargs", "dict", "sql", "mysql_table", "hiveserver2_conn_id", "mysql_conn_id", "task_id"]]}, "name": "setup_method", "params": {"method": "", "self": ""}, "params_descr": {"method": "", "self": ""}, "params_occur": {"method": [["super", "setup_method", "method"]], "self": [["self", "kwargs", "dict", "sql", "mysql_table", "hiveserver2_conn_id", "mysql_conn_id", "task_id"]]}, "params_p": {"args": [], "kwargs": [], "method": [["str", 0.41007037980407424], ["bool", 0.12945457329877805], ["List[Dict[str, Any]]", 0.09566160340327673], ["List[int]", 0.08703660992410589], ["Type['DataclassT']", 0.08703660992410589]], "self": []}, "q_name": "TestHiveToMySqlTransfer.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"kwargs": ""}, "variables_p": {"kwargs": [["list", 0.14868250366534702], ["Dict[str, str]", 0.08955939703384129], ["str", 0.08859759424527239], ["Dict[str, Any]", 0.08732694686834641], ["DefaultDict[Any, List[Any]]", 0.0848453587837108]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[47, 4], [57, 9]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_execute", "params": {"mock_hive_hook": "", "mock_mysql_hook": "", "self": ""}, "params_descr": {"mock_hive_hook": "", "mock_mysql_hook": "", "self": ""}, "params_occur": {"mock_hive_hook": [["mock_hive_hook", "assert_called_once_with", "hiveserver2_conn_id", "self", "kwargs"], ["mock_hive_hook", "return_value", "get_records", "assert_called_once_with", "parameters"], ["mock_mysql_hook", "return_value", "insert_rows", "assert_called_once_with", "table", "self", "kwargs", "rows", "mock_hive_hook", "return_value", "get_records", "return_value"]], "mock_mysql_hook": [["mock_mysql_hook", "assert_called_once_with", "mysql_conn_id", "self", "kwargs", "local_infile", "False"], ["mock_mysql_hook", "return_value", "insert_rows", "assert_called_once_with", "table", "self", "kwargs", "rows", "mock_hive_hook", "return_value", "get_records", "return_value"]], "self": [["HiveToMySqlOperator", "self", "kwargs", "execute", "context"], ["mock_hive_hook", "assert_called_once_with", "hiveserver2_conn_id", "self", "kwargs"], ["mock_mysql_hook", "assert_called_once_with", "mysql_conn_id", "self", "kwargs", "local_infile", "False"], ["mock_mysql_hook", "return_value", "insert_rows", "assert_called_once_with", "table", "self", "kwargs", "rows", "mock_hive_hook", "return_value", "get_records", "return_value"]]}, "params_p": {"args": [], "kwargs": [], "mock_hive_hook": [["unittesmock.MagicMock", 0.9009571383216748]], "mock_mysql_hook": [["unittesmock.MagicMock", 0.9999999999999999]], "self": []}, "q_name": "TestHiveToMySqlTransfer.test_execute", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[61, 4], [66, 98]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_execute_mysql_preoperator", "params": {"mock_hive_hook": "", "mock_mysql_hook": "", "self": ""}, "params_descr": {"mock_hive_hook": "", "mock_mysql_hook": "", "self": ""}, "params_occur": {"mock_hive_hook": [], "mock_mysql_hook": [["mock_mysql_hook", "return_value", "run", "assert_called_once_with", "self", "kwargs"]], "self": [["self", "kwargs", "update", "dict", "mysql_preoperator"], ["HiveToMySqlOperator", "self", "kwargs", "execute", "context"], ["mock_mysql_hook", "return_value", "run", "assert_called_once_with", "self", "kwargs"]]}, "params_p": {"args": [], "kwargs": [], "mock_hive_hook": [["mock.Mock", 0.9993045354837721], ["unittesmock.MagicMock", 0.00038194401648635167], ["mock.MagicMock", 8.365166817200267e-05]], "mock_mysql_hook": [["unittesmock.MagicMock", 0.5423239722362861], ["mock.MagicMock", 0.11486339837576898]], "self": []}, "q_name": "TestHiveToMySqlTransfer.test_execute_mysql_preoperator", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[70, 4], [75, 99]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_execute_with_mysql_postoperator", "params": {"mock_hive_hook": "", "mock_mysql_hook": "", "self": ""}, "params_descr": {"mock_hive_hook": "", "mock_mysql_hook": "", "self": ""}, "params_occur": {"mock_hive_hook": [], "mock_mysql_hook": [["mock_mysql_hook", "return_value", "run", "assert_called_once_with", "self", "kwargs"]], "self": [["self", "kwargs", "update", "dict", "mysql_postoperator"], ["HiveToMySqlOperator", "self", "kwargs", "execute", "context"], ["mock_mysql_hook", "return_value", "run", "assert_called_once_with", "self", "kwargs"]]}, "params_p": {"args": [], "kwargs": [], "mock_hive_hook": [["mock.Mock", 0.9993045354837721], ["unittesmock.MagicMock", 0.00038194401648635167], ["mock.MagicMock", 8.365166817200267e-05]], "mock_mysql_hook": [["unittesmock.MagicMock", 0.5423239722362861], ["mock.MagicMock", 0.11486339837576898]], "self": []}, "q_name": "TestHiveToMySqlTransfer.test_execute_with_mysql_postoperator", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[80, 4], [102, 93]], "fn_var_ln": {"context": [[84, 8], [84, 15]], "mock_tmp_file": [[81, 8], [81, 21]], "name": [[82, 8], [82, 26]]}, "fn_var_occur": {"context": [["HiveToMySqlOperator", "self", "kwargs", "execute", "context", "context"], ["mock_hive_hook", "return_value", "to_csv", "assert_called_once_with", "self", "kwargs", "delimiter", "lineterminator", "output_header", "False", "hive_conf", "context_to_airflow_vars", "context"]], "mock_tmp_file": [["mock_tmp_file", "MagicMock"], ["mock_tmp_file", "name"], ["mock_tmp_file_context", "return_value", "__enter__", "return_value", "mock_tmp_file"]], "name": [["mock_tmp_file", "name"]]}, "name": "test_execute_bulk_load", "params": {"mock_hive_hook": "", "mock_mysql_hook": "", "mock_tmp_file_context": "", "self": ""}, "params_descr": {"mock_hive_hook": "", "mock_mysql_hook": "", "mock_tmp_file_context": "", "self": ""}, "params_occur": {"mock_hive_hook": [["mock_hive_hook", "return_value", "to_csv", "assert_called_once_with", "self", "kwargs", "delimiter", "lineterminator", "output_header", "False", "hive_conf", "context_to_airflow_vars", "context"]], "mock_mysql_hook": [["mock_mysql_hook", "assert_called_once_with", "mysql_conn_id", "self", "kwargs", "local_infile", "True"], ["mock_mysql_hook", "return_value", "bulk_load", "assert_called_once_with", "table", "self", "kwargs", "tmp_file"]], "mock_tmp_file_context": [["mock_tmp_file_context", "return_value", "__enter__", "return_value", "mock_tmp_file"], ["mock_tmp_file_context", "assert_called_once_with"], ["mock_tmp_file_context", "return_value", "__exit__", "assert_called_once_with", "None", "None", "None"]], "self": [["self", "kwargs", "update", "dict", "bulk_load", "True"], ["HiveToMySqlOperator", "self", "kwargs", "execute", "context", "context"], ["mock_mysql_hook", "assert_called_once_with", "mysql_conn_id", "self", "kwargs", "local_infile", "True"], ["mock_hive_hook", "return_value", "to_csv", "assert_called_once_with", "self", "kwargs", "delimiter", "lineterminator", "output_header", "False", "hive_conf", "context_to_airflow_vars", "context"], ["mock_mysql_hook", "return_value", "bulk_load", "assert_called_once_with", "table", "self", "kwargs", "tmp_file"]]}, "params_p": {"args": [], "kwargs": [], "mock_hive_hook": [["mock.MagicMock", 0.22431817368649598]], "mock_mysql_hook": [["unittesmock.MagicMock", 0.609991559906361]], "mock_tmp_file_context": [["unittesmock.MagicMock", 0.8282759308427577]], "self": []}, "q_name": "TestHiveToMySqlTransfer.test_execute_bulk_load", "ret_exprs": [], "ret_type": "", "variables": {"context": "", "mock_tmp_file": "", "name": ""}, "variables_p": {"context": [["list", 0.6019597809960101], ["str", 0.08622872280773385]], "mock_tmp_file": [["str", 0.32697876630992595], ["unittesmock.MagicMock", 0.2845939217209621], ["Dict[str, Union[Any, Any]]", 0.22291255064520327], ["Dict[str, str]", 0.08834339674347451]], "name": [["str", 0.8916831512885042], ["int", 0.10831684871149587]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[105, 4], [121, 100]], "fn_var_ln": {"context": [[106, 8], [106, 15]], "get_records": [[108, 8], [108, 34]], "hive_conf": [[118, 12], [118, 21]], "mock_hive_hook": [[107, 8], [107, 22]]}, "fn_var_occur": {"context": [["HiveToMySqlOperator", "self", "kwargs", "execute", "context", "context"], ["hive_conf", "context_to_airflow_vars", "context"]], "get_records": [["mock_hive_hook", "get_records", "MagicMock", "return_value"], ["mock_hive_hook", "get_records", "assert_called_once_with", "self", "kwargs", "parameters", "hive_conf"]], "hive_conf": [["self", "kwargs", "update", "dict", "hive_conf"], ["hive_conf", "context_to_airflow_vars", "context"], ["hive_conf", "update", "self", "kwargs"], ["mock_hive_hook", "get_records", "assert_called_once_with", "self", "kwargs", "parameters", "hive_conf"]], "mock_hive_hook": [["mock_hive_hook", "MockHiveServer2Hook"], ["mock_hive_hook", "get_records", "MagicMock", "return_value"], ["patch", "return_value", "mock_hive_hook"], ["mock_hive_hook", "get_records", "assert_called_once_with", "self", "kwargs", "parameters", "hive_conf"]]}, "name": "test_execute_with_hive_conf", "params": {"mock_mysql_hook": "", "self": ""}, "params_descr": {"mock_mysql_hook": "", "self": ""}, "params_occur": {"mock_mysql_hook": [], "self": [["self", "kwargs", "update", "dict", "hive_conf"], ["HiveToMySqlOperator", "self", "kwargs", "execute", "context", "context"], ["hive_conf", "update", "self", "kwargs"], ["mock_hive_hook", "get_records", "assert_called_once_with", "self", "kwargs", "parameters", "hive_conf"]]}, "params_p": {"args": [], "kwargs": [], "mock_mysql_hook": [["mock.Mock", 0.7777777782457801]], "self": []}, "q_name": "TestHiveToMySqlTransfer.test_execute_with_hive_conf", "ret_exprs": [], "ret_type": "", "variables": {"context": "", "get_records": "", "hive_conf": "", "mock_hive_hook": ""}, "variables_p": {"context": [["dict", 0.6765169996477974], ["Dict[str, Any]", 0.11653387087138581]], "get_records": [["str", 0.5676713292623473], ["list", 0.11562924023329324], ["Dict[Any, Union[int, str]]", 0.08372664522342883], ["Dict[str, Union[None, Any, int]]", 0.08248116446024527], ["Optional[bytes]", 0.07798631745882319]], "hive_conf": [["dict", 0.9119132036834836], ["Dict[str, str]", 0.08808679631651643]], "mock_hive_hook": [["unittesmock.MagicMock", 0.22500788132004945], ["Dict[str, Tuple[str, Any]]", 0.21247351131210104], ["Dict[str, Any]", 0.10676202178657238], ["Dict[str, Dict[str, str]]", 0.10060292299545849]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[126, 4], [183, 109]], "fn_var_ln": {"actual_hive_conf": [[168, 8], [168, 24]], "actual_select_name_query": [[164, 8], [164, 32]], "expected_hive_conf": [[169, 8], [169, 26]], "expected_mysql_preoperator": [[177, 8], [177, 34]], "expected_select_name_query": [[165, 8], [165, 34]], "get_records": [[130, 8], [130, 34]], "insert_rows": [[134, 8], [134, 35]], "mock_hive_hook": [[129, 8], [129, 22]], "mock_mysql_hook": [[132, 8], [132, 23]], "op": [[145, 16], [145, 18]], "raw_select_name_query": [[163, 8], [163, 29]], "run": [[133, 8], [133, 27]], "test_hive_results": [[127, 8], [127, 25]]}, "fn_var_occur": {"actual_hive_conf": [["actual_hive_conf", "mock_hive_hook", "get_records", "call_args_list"], ["expected_hive_conf", "actual_hive_conf"]], "actual_select_name_query": [["actual_select_name_query", "re", "sub", "raw_select_name_query", "strip"], ["expected_select_name_query", "actual_select_name_query"]], "expected_hive_conf": [["expected_hive_conf", "actual_hive_conf"]], "expected_mysql_preoperator": [["mock_mysql_hook", "run", "assert_called_with", "expected_mysql_preoperator"]], "expected_select_name_query": [["expected_select_name_query", "actual_select_name_query"]], "get_records": [["mock_hive_hook", "get_records", "MagicMock", "return_value", "test_hive_results"], ["raw_select_name_query", "mock_hive_hook", "get_records", "call_args_list"], ["actual_hive_conf", "mock_hive_hook", "get_records", "call_args_list"]], "insert_rows": [["mock_mysql_hook", "insert_rows", "MagicMock"], ["mock_mysql_hook", "insert_rows", "assert_called_with", "table", "rows", "test_hive_results"]], "mock_hive_hook": [["mock_hive_hook", "MockHiveServer2Hook"], ["mock_hive_hook", "get_records", "MagicMock", "return_value", "test_hive_results"], ["patch", "return_value", "mock_hive_hook"], ["raw_select_name_query", "mock_hive_hook", "get_records", "call_args_list"], ["actual_hive_conf", "mock_hive_hook", "get_records", "call_args_list"]], "mock_mysql_hook": [["mock_mysql_hook", "MockMySqlHook"], ["mock_mysql_hook", "run", "MagicMock"], ["mock_mysql_hook", "insert_rows", "MagicMock"], ["patch", "return_value", "mock_mysql_hook"], ["mock_mysql_hook", "run", "assert_called_with", "expected_mysql_preoperator"], ["mock_mysql_hook", "insert_rows", "assert_called_with", "table", "rows", "test_hive_results"]], "op": [["op", "HiveToMySqlOperator", "mysql_conn_id", "task_id", "sql", "mysql_table", "mysql_preoperator", "dag", "self", "dag"], ["op", "clear", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["op", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"]], "raw_select_name_query": [["raw_select_name_query", "mock_hive_hook", "get_records", "call_args_list"], ["actual_select_name_query", "re", "sub", "raw_select_name_query", "strip"]], "run": [["mock_mysql_hook", "run", "MagicMock"], ["op", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"], ["mock_mysql_hook", "run", "assert_called_with", "expected_mysql_preoperator"]], "test_hive_results": [["mock_hive_hook", "get_records", "MagicMock", "return_value", "test_hive_results"], ["mock_mysql_hook", "insert_rows", "assert_called_with", "table", "rows", "test_hive_results"]]}, "name": "test_hive_to_mysql", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["op", "HiveToMySqlOperator", "mysql_conn_id", "task_id", "sql", "mysql_table", "mysql_preoperator", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestHiveToMySqlTransfer.test_hive_to_mysql", "ret_exprs": [], "ret_type": "", "variables": {"actual_hive_conf": "", "actual_select_name_query": "", "expected_hive_conf": "", "expected_mysql_preoperator": "", "expected_select_name_query": "", "get_records": "", "insert_rows": "", "mock_hive_hook": "", "mock_mysql_hook": "", "op": "", "raw_select_name_query": "", "run": "", "test_hive_results": ""}, "variables_p": {"actual_hive_conf": [["List[str]", 0.18256980565756], ["list", 0.11705369644334447], ["Dict[str, Callable]", 0.1033250566092913], ["dict", 0.08617285496436773], ["Dict[str, Any]", 0.08570193567759521]], "actual_select_name_query": [["str", 0.4628803276304971], ["int", 0.12179544647034929], ["List[str]", 0.11045369341918225], ["KeysView[str]", 0.10372733388359809]], "expected_hive_conf": [["int", 0.4999999999837733], ["str", 0.49999999998374167], ["List[Tuple[Any, Any]]", 6.53354973500545e-12], ["Pattern[str]", 5.315446503203208e-12], ["List[Tuple[int, int]]", 4.692538014611957e-12], ["list", 4.5134568467587665e-12]], "expected_mysql_preoperator": [["str", 0.43499010128761356], ["unittesmock.MagicMock", 0.3276189662735284], ["tests.utils.MockCoroutine", 0.08329564121641926], ["bool", 0.08276644387633243], ["Dict[str, Union[Any, Any]]", 0.07132884734610657]], "expected_select_name_query": [["frozenset[str]", 0.5184194465577455], ["List[str]", 0.10051557388505496], ["str", 0.0965640172855896], ["Optional[str]", 0.09549991343453534], ["Type[List[Any]]", 0.09434044438815384]], "get_records": [["str", 0.38085551692817327], ["List[Dict[str, Any]]", 0.1249160602056581], ["unittesmock.MagicMock", 0.11134147212706313], ["rotkehlchen.tests.utils.mock.MockResponse", 0.10024367282134204], ["Dict[str, Union[None, Any, int]]", 0.09562784320789604], ["Dict[Any, Union[int, str]]", 0.09395429894488627], ["Dict[str, Any]", 0.09306113576498103]], "insert_rows": [["mock.Mock", 0.1836819790922173], ["unittesmock.MagicMock", 0.08956737600755652]], "mock_hive_hook": [["unittesmock.MagicMock", 0.2121405139210068], ["mock._patch[Union[mock.AsyncMock, mock.MagicMock]]", 0.19244017928314425], ["List[unittesmock.MagicMock]", 0.10943360587421361], ["Dict[str, Dict[str, str]]", 0.10027768135414301], ["tests.utils.MockCoroutine", 0.09313665838131122]], "mock_mysql_hook": [["unittesmock.MagicMock", 0.6834763985736436]], "op": [["List[str]", 0.08216804748233895]], "raw_select_name_query": [["Tuple[Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal]", 0.11714090366791402], ["set", 0.11603353599288432], ["str", 0.1043428203977107], ["Pattern[str]", 0.09415007195630733], ["Dict[str, int]", 0.09119994474873509], ["Dict[str, Union[Any, int, str]]", 0.09105159897344109]], "run": [["unittesmock.MagicMock", 0.790820179756079]], "test_hive_results": [["str", 0.20200415469212932], ["tests.utils.MockProvider", 0.15220248997858946], ["Dict[str, Any]", 0.10793490741010364], ["list", 0.1020381155617719], ["Dict[str, str]", 0.09688731551725428], ["tests.conftesConfluentAvroConsumerMock", 0.08962457934815829], ["unittesmock.MagicMock", 0.08527160156045989], ["List[int]", 0.07805005081254988]]}}], "name": "TestHiveToMySqlTransfer", "q_name": "TestHiveToMySqlTransfer", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["__future__", "annotations", "os", "re", "unittest", "mock", "MagicMock", "patch", "pytest", "airflow", "providers", "apache", "hive", "transfers", "hive_to_mysql", "HiveToMySqlOperator", "airflow", "utils", "timezone", "airflow", "utils", "operator_helpers", "context_to_airflow_vars", "tests", "providers", "apache", "hive", "MockHiveServer2Hook", "MockMySqlHook", "TestHiveEnvironment"], "mod_var_ln": {"DEFAULT_DATE": [[31, 0], [31, 12]]}, "mod_var_occur": {"DEFAULT_DATE": [["op", "clear", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE"], ["op", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"]]}, "no_types_annot": {"D": 0, "I": 0, "U": 40}, "session_id": "o_r7sZdSgRD1Oyjn1sjDpXMklR1DAUOo9ve9IsTUilE", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"DEFAULT_DATE": ""}, "variables_p": {"DEFAULT_DATE": [["str", 0.12056751489850417], ["datetime.datetime.timezone", 0.11445523316667426]]}}}