{"error": null, "response": {"classes": [{"cls_lc": [[57, 8], [68, 49]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[58, 12], [61, 27]], "fn_var_ln": {"_patch": [[59, 16], [59, 27]], "load_file": [[60, 16], [60, 30]]}, "fn_var_occur": {"_patch": [["self", "_patch", "mock", "patch", "object", "HiveCliHook", "side_effect", "self", "capture_file"], ["self", "load_file", "self", "_patch", "start"]], "load_file": [["self", "load_file", "self", "_patch", "start"]]}, "name": "__enter__", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "_patch", "mock", "patch", "object", "HiveCliHook", "side_effect", "self", "capture_file"], ["self", "load_file", "self", "_patch", "start"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestTransfer.spy_on_hive.<locals>.Capturer.__enter__", "ret_exprs": ["return self"], "ret_type": "", "ret_type_p": [["int", 0.30000000000000004], ["Callable", 0.2], ["str", 0.1]], "variables": {"_patch": "", "load_file": ""}, "variables_p": {"_patch": [["str", 0.3790377515168749], ["List[str]", 0.09422444045904187]], "load_file": [["str", 1.0]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[63, 12], [64, 34]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "__exit__", "params": {"args": "", "self": ""}, "params_descr": {"args": "", "self": ""}, "params_occur": {"args": [], "self": [["self", "_patch", "stop"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestTransfer.spy_on_hive.<locals>.Capturer.__exit__", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[66, 12], [68, 49]], "fn_var_ln": {"csv_contents": [[68, 20], [68, 37]]}, "fn_var_occur": {"csv_contents": [["self", "csv_contents", "fh", "read"]]}, "name": "capture_file", "params": {"args": "", "file": "", "kwargs": "", "self": ""}, "params_descr": {"args": "", "file": "", "kwargs": "", "self": ""}, "params_occur": {"args": [], "file": [["open", "file", "fh"]], "kwargs": [], "self": [["self", "csv_contents", "fh", "read"]]}, "params_p": {"args": [], "file": [["str", 0.9322802474391865], ["IO[str]", 0.06771975256081353]], "kwargs": [], "self": []}, "q_name": "TestTransfer.spy_on_hive.<locals>.Capturer.capture_file", "ret_exprs": [], "ret_type": "", "variables": {"csv_contents": ""}, "variables_p": {"csv_contents": [["str", 0.48776712844224834], ["bool", 0.21498753441038876], ["Dict[str, Any]", 0.10057292456624084]]}}], "name": "Capturer", "q_name": "TestTransfer.spy_on_hive.<locals>.Capturer", "variables": {}, "variables_p": {}}, {"cls_lc": [[43, 0], [298, 73]], "cls_var_ln": {"env_vars": [[44, 4], [44, 12]]}, "cls_var_occur": {"env_vars": []}, "funcs": [{"docstring": {"func": "Patch HiveCliHook.load_file and capture the contents of the CSV file", "long_descr": null, "ret": null}, "fn_lc": [[54, 4], [71, 19]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "spy_on_hive", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestTransfer.spy_on_hive", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[74, 4], [104, 71]], "fn_var_ln": {"rows": [[75, 8], [75, 12]]}, "fn_var_occur": {"rows": []}, "name": "baby_names_table", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestTransfer.baby_names_table", "ret_exprs": [], "ret_type": "", "variables": {"rows": ""}, "variables_p": {"rows": [["list", 0.30000000000000004], ["int", 0.30000000000000004], ["List[List[int]]", 0.1], ["property", 0.1], ["dict", 0.1], ["List[Dict[str, Any]]", 0.1]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[190, 4], [203, 46]], "fn_var_ln": {"op": [[192, 8], [192, 10]], "sql": [[191, 8], [191, 11]]}, "fn_var_occur": {"op": [["op", "MySqlToHiveOperator", "task_id", "hive_cli_conn_id", "sql", "sql", "hive_table", "params"], ["op", "execute"]], "sql": [["op", "MySqlToHiveOperator", "task_id", "hive_cli_conn_id", "sql", "sql", "hive_table", "params"]]}, "name": "test_mysql_to_hive", "params": {"csv": "", "expected": "", "params": "", "self": "", "spy_on_hive": ""}, "params_descr": {"csv": "", "expected": "", "params": "", "self": "", "spy_on_hive": ""}, "params_occur": {"csv": [["spy_on_hive", "csv_contents", "csv"]], "expected": [["spy_on_hive", "load_file", "assert_called_with", "mock", "ANY", "expected"]], "params": [["op", "MySqlToHiveOperator", "task_id", "hive_cli_conn_id", "sql", "sql", "hive_table", "params"]], "self": [], "spy_on_hive": [["spy_on_hive", "load_file", "assert_called_with", "mock", "ANY", "expected"], ["spy_on_hive", "csv_contents", "csv"]]}, "params_p": {"args": [], "csv": [["str", 0.7853762238947476]], "expected": [["int", 0.3091592194304622], ["antidote.providers.lazy.LazyCallProvider", 0.08939784620368223], ["List[str]", 0.08680963197876068]], "kwargs": [], "params": [["int", 0.20954296719112714]], "self": [], "spy_on_hive": [["str", 0.27945269806769546], ["int", 0.10549668945879985]]}, "q_name": "TestTransfer.test_mysql_to_hive", "ret_exprs": [], "ret_type": "", "variables": {"op": "", "sql": ""}, "variables_p": {"op": [["Dict[str, Union[Any, bool, str]]", 0.1771619897169801], ["Dict[str, Union[int, str]]", 0.08804683314557175], ["int", 0.08708669559654672], ["Dict[str, Optional[str]]", 0.08154884695989327]], "sql": [["str", 0.21642193211260508], ["bool", 0.12900250122168916], ["Dict[str, Any]", 0.09985396168752668], ["Dict[str, str]", 0.08632176598237239]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[205, 4], [247, 73]], "fn_var_ln": {"hook": [[208, 8], [208, 12]], "mysql_table": [[206, 8], [206, 19]], "op": [[227, 12], [227, 14]], "ordered_dict": [[236, 12], [236, 24]]}, "fn_var_occur": {"hook": [["hook", "MySqlHook"], ["closing", "hook", "get_conn", "conn"], ["closing", "hook", "get_conn", "conn"]], "mysql_table": [["cursor", "execute", "mysql_table"], ["cursor", "execute", "mysql_table"], ["op", "MySqlToHiveOperator", "task_id", "hive_cli_conn_id", "sql", "mysql_table", "hive_table"], ["cursor", "execute", "mysql_table"]], "op": [["op", "MySqlToHiveOperator", "task_id", "hive_cli_conn_id", "sql", "mysql_table", "hive_table"], ["op", "execute"]], "ordered_dict": [["ordered_dict", "OrderedDict"], ["spy_on_hive", "load_file", "call_args", "kwargs", "ordered_dict"]]}, "name": "test_mysql_to_hive_type_conversion", "params": {"self": "", "spy_on_hive": ""}, "params_descr": {"self": "", "spy_on_hive": ""}, "params_occur": {"self": [], "spy_on_hive": [["spy_on_hive", "load_file", "call_count"], ["spy_on_hive", "load_file", "call_args", "kwargs", "ordered_dict"]]}, "params_p": {"args": [], "kwargs": [], "self": [], "spy_on_hive": []}, "q_name": "TestTransfer.test_mysql_to_hive_type_conversion", "ret_exprs": [], "ret_type": "", "variables": {"hook": "", "mysql_table": "", "op": "", "ordered_dict": ""}, "variables_p": {"hook": [["List[str]", 0.999999999852663]], "mysql_table": [["dict", 0.19219350654940714], ["frozenset[str]", 0.19006419016920942]], "op": [["List[str]", 0.1038077491663904], ["Dict[str, Optional[str]]", 0.09013786687949676], ["int", 0.088196915463799], ["list", 0.07617642909947803]], "ordered_dict": [["Dict[str, str]", 0.6493925267814729], ["dict", 0.18190211818101437], ["Dict[str, object]", 0.08340862728154073]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[249, 4], [298, 73]], "fn_var_ln": {"db_record": [[256, 12], [256, 21]], "hive_table": [[251, 8], [251, 18]], "hook": [[253, 8], [253, 12]], "mysql_table": [[250, 8], [250, 19]], "op": [[279, 12], [279, 14]]}, "fn_var_occur": {"db_record": [["cursor", "execute", "format", "mysql_table", "db_record"]], "hive_table": [["op", "MySqlToHiveOperator", "task_id", "hive_cli_conn_id", "sql", "mysql_table", "hive_table", "hive_table", "recreate", "True", "delimiter", "quoting", "csv", "QUOTE_NONE", "quotechar", "escapechar"]], "hook": [["hook", "MySqlHook"], ["closing", "hook", "get_conn", "conn"], ["closing", "hook", "get_conn", "conn"]], "mysql_table": [["cursor", "execute", "mysql_table"], ["cursor", "execute", "mysql_table"], ["cursor", "execute", "format", "mysql_table", "db_record"], ["op", "MySqlToHiveOperator", "task_id", "hive_cli_conn_id", "sql", "mysql_table", "hive_table", "hive_table", "recreate", "True", "delimiter", "quoting", "csv", "QUOTE_NONE", "quotechar", "escapechar"], ["cursor", "execute", "mysql_table"]], "op": [["op", "MySqlToHiveOperator", "task_id", "hive_cli_conn_id", "sql", "mysql_table", "hive_table", "hive_table", "recreate", "True", "delimiter", "quoting", "csv", "QUOTE_NONE", "quotechar", "escapechar"], ["op", "execute"]]}, "name": "test_mysql_to_hive_verify_csv_special_char", "params": {"self": "", "spy_on_hive": ""}, "params_descr": {"self": "", "spy_on_hive": ""}, "params_occur": {"self": [], "spy_on_hive": [["spy_on_hive", "load_file", "assert_called"], ["spy_on_hive", "csv_contents"]]}, "params_p": {"args": [], "kwargs": [], "self": [], "spy_on_hive": []}, "q_name": "TestTransfer.test_mysql_to_hive_verify_csv_special_char", "ret_exprs": [], "ret_type": "", "variables": {"db_record": "", "hive_table": "", "hook": "", "mysql_table": "", "op": ""}, "variables_p": {"db_record": [["str", 0.5589237071875683], ["Union[Literal, str]", 0.17001239481875677], ["Optional[str]", 0.09586675503399053], ["Set[Optional[str]]", 0.07888238871461271]], "hive_table": [["str", 0.190193762041998], ["list", 0.09491629059918491], ["dict", 0.08935483157483068], ["Dict[Any, Dict[str, Any]]", 0.08932110118282355]], "hook": [["List[str]", 0.999999999852663]], "mysql_table": [["str", 0.19298094127439847], ["Type[Dict[Any, Any]]", 0.1040648505574381]], "op": [["list", 0.18985502880686844], ["List[str]", 0.12992131490089887], ["Dict[str, Union[int, str]]", 0.10599088397308994], ["dict", 0.09638689320244943], ["bytearray", 0.09540147734266095], ["int", 0.09307974378105634]]}}], "name": "TestTransfer", "q_name": "TestTransfer", "variables": {"env_vars": ""}, "variables_p": {"env_vars": [["str", 0.30000000000000004], ["Tuple[Tuple[Literal, Literal], Tuple[Literal, Literal], Tuple[Literal, None]]", 0.20000000000000004], ["Tuple[Tuple[Literal, None], Tuple[Literal, None]]", 0.20000000000000004], ["Tuple[Tuple[Literal, Literal], Tuple[Literal, None], Tuple[Literal, Literal]]", 0.20000000000000004], ["Dict[str, str]", 0.10000000000000002]]}}], "funcs": [], "imports": ["__future__", "annotations", "csv", "textwrap", "collections", "OrderedDict", "contextlib", "closing", "unittest", "mock", "pytest", "airflow", "providers", "apache", "hive", "hooks", "hive", "HiveCliHook", "airflow", "utils", "timezone", "airflow", "providers", "apache", "hive", "transfers", "mysql_to_hive", "MySqlToHiveOperator", "airflow", "providers", "mysql", "hooks", "mysql", "MySqlHook"], "mod_var_ln": {"DEFAULT_DATE": [[37, 0], [37, 12]], "DEFAULT_DATE_DS": [[39, 0], [39, 15]], "DEFAULT_DATE_ISO": [[38, 0], [38, 16]]}, "mod_var_occur": {"DEFAULT_DATE": [["DEFAULT_DATE_ISO", "DEFAULT_DATE", "isoformat"]], "DEFAULT_DATE_DS": [], "DEFAULT_DATE_ISO": [["DEFAULT_DATE_DS", "DEFAULT_DATE_ISO"]]}, "no_types_annot": {"D": 0, "I": 0, "U": 37}, "session_id": "kX4yp69HftKrBwv4lmfKpC75PUukbNV1mhQL-RI3tx8", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"DEFAULT_DATE": "", "DEFAULT_DATE_DS": "", "DEFAULT_DATE_ISO": ""}, "variables_p": {"DEFAULT_DATE": [["Pattern[str]", 0.18659038247047727], ["Optional[str]", 0.08892449449114831], ["str", 0.08892449449114831]], "DEFAULT_DATE_DS": [["str", 0.3059945994881268], ["bool", 0.130176423055987], ["Optional[bool]", 0.0863799894115707], ["int", 0.0863799894115707], ["list", 0.06941968313314296]], "DEFAULT_DATE_ISO": [["int", 0.11824233664115807], ["Dict[Any, List[str]]", 0.11486735568385283]]}}}