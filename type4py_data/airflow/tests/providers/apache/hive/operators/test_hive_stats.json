{"error": null, "response": {"classes": [{"cls_lc": [[40, 0], [43, 28]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[41, 4], [43, 28]], "fn_var_ln": {"name": [[42, 8], [42, 17]], "type": [[43, 8], [43, 17]]}, "fn_var_occur": {"name": [["self", "name", "col_name"]], "type": [["self", "type", "col_type"]]}, "name": "__init__", "params": {"col_name": "", "col_type": "", "self": ""}, "params_descr": {"col_name": "", "col_type": "", "self": ""}, "params_occur": {"col_name": [["self", "name", "col_name"]], "col_type": [["self", "type", "col_type"]], "self": [["self", "name", "col_name"], ["self", "type", "col_type"]]}, "params_p": {"args": [], "col_name": [["str", 0.7926729721599725], ["List[str]", 0.11339868411650574], ["Optional[str]", 0.09392834372352184]], "col_type": [["str", 0.49508125964571786], ["type", 0.2800840730914692], ["Optional[str]", 0.1726586736324823]], "kwargs": [], "self": []}, "q_name": "_FakeCol.__init__", "ret_exprs": [], "ret_type": "", "variables": {"name": "", "type": ""}, "variables_p": {"name": [["str", 0.7665349548015229], ["Dict[str, str]", 0.23346504519847697]], "type": [["Pattern[str]", 0.26214339106870194], ["Dict[Any, str]", 0.1933191570359592], ["dict", 0.0966595785179796], ["Optional[str]", 0.08812049818552929]]}}], "name": "_FakeCol", "q_name": "_FakeCol", "variables": {}, "variables_p": {}}, {"cls_lc": [[49, 0], [60, 24]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[50, 4], [57, 41]], "fn_var_ln": {"conn": [[51, 8], [51, 17]], "get_conn": [[54, 8], [54, 21]], "get_first": [[55, 8], [55, 22]]}, "fn_var_occur": {"conn": [["self", "conn", "MockConnectionCursor"], ["self", "conn", "execute", "MagicMock"], ["self", "get_conn", "MagicMock", "return_value", "self", "conn"]], "get_conn": [["self", "get_conn", "MagicMock", "return_value", "self", "conn"]], "get_first": [["self", "get_first", "MagicMock", "return_value"]]}, "name": "__init__", "params": {"args": "", "kwargs": "", "self": ""}, "params_descr": {"args": "", "kwargs": "", "self": ""}, "params_occur": {"args": [["super", "__init__", "args", "kwargs"]], "kwargs": [["super", "__init__", "args", "kwargs"]], "self": [["self", "conn", "MockConnectionCursor"], ["self", "conn", "execute", "MagicMock"], ["self", "get_conn", "MagicMock", "return_value", "self", "conn"], ["self", "get_first", "MagicMock", "return_value"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "MockPrestoHook.__init__", "ret_exprs": [], "ret_type": "", "variables": {"conn": "", "get_conn": "", "get_first": ""}, "variables_p": {"conn": [["str", 0.22617927504951313], ["Union[mock.AsyncMock, mock.MagicMock]", 0.18820757021602597], ["unittesmock.MagicMock", 0.18712294299030907]], "get_conn": [["unittesmock.MagicMock", 0.46381200089600993], ["Callable", 0.12376648143388326], ["list", 0.11195446204638677], ["str", 0.09168208226374965]], "get_first": [["unittesmock.MagicMock", 0.32087583989586427], ["str", 0.2895590338729474], ["Dict[str, Any]", 0.10394804844732758], ["List[Dict[str, Any]]", 0.10096672824406434], ["int", 0.09432388637576976], ["bool", 0.09032646316402666]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[59, 4], [60, 24]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "get_connection", "params": {"args": "", "self": ""}, "params_descr": {"args": "", "self": ""}, "params_occur": {"args": [], "self": [["self", "conn"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "MockPrestoHook.get_connection", "ret_exprs": ["return self.conn"], "ret_type": "", "ret_type_p": [["str", 0.19999999999999998], ["bool", 0.09999999999999999]], "variables": {}, "variables_p": {}}], "name": "MockPrestoHook", "q_name": "MockPrestoHook", "variables": {}, "variables_p": {}}, {"cls_lc": [[63, 0], [376, 9]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[64, 4], [73, 36]], "fn_var_ln": {"kwargs": [[65, 8], [65, 19]]}, "fn_var_occur": {"kwargs": [["self", "kwargs", "dict", "table", "partition", "dict", "col", "value", "metastore_conn_id", "presto_conn_id", "mysql_conn_id", "task_id"]]}, "name": "setup_method", "params": {"method": "", "self": ""}, "params_descr": {"method": "", "self": ""}, "params_occur": {"method": [["super", "setup_method", "method"]], "self": [["self", "kwargs", "dict", "table", "partition", "dict", "col", "value", "metastore_conn_id", "presto_conn_id", "mysql_conn_id", "task_id"]]}, "params_p": {"args": [], "kwargs": [], "method": [["str", 0.41007037980407424], ["bool", 0.12945457329877805], ["List[Dict[str, Any]]", 0.09566160340327673], ["List[int]", 0.08703660992410589], ["Type['DataclassT']", 0.08703660992410589]], "self": []}, "q_name": "TestHiveStatsCollectionOperator.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"kwargs": ""}, "variables_p": {"kwargs": [["Dict[str, List[Any]]", 0.3061521276371788], ["OrderedDict[Any, Dict[str, Any]]", 0.17266899306002184], ["Dict[int, List[Any]]", 0.10162772905348672], ["dict", 0.09312062707645018], ["Dict[Any, List[Any]]", 0.08718308544962225]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[75, 4], [80, 68]], "fn_var_ln": {"col": [[76, 8], [76, 11]], "default_exprs": [[78, 8], [78, 21]]}, "fn_var_occur": {"col": [["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "None"], ["default_exprs", "col", "col"]], "default_exprs": [["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "None"], ["default_exprs", "col", "col"]]}, "name": "test_get_default_exprs", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "None"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestHiveStatsCollectionOperator.test_get_default_exprs", "ret_exprs": [], "ret_type": "", "variables": {"col": "", "default_exprs": ""}, "variables_p": {"col": [], "default_exprs": [["float", 0.09315229026482472]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[82, 4], [88, 34]], "fn_var_ln": {"col": [[83, 8], [83, 11]], "default_exprs": [[86, 8], [86, 21]]}, "fn_var_occur": {"col": [["self", "kwargs", "update", "dict", "excluded_columns", "col"], ["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "None"]], "default_exprs": [["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "None"]]}, "name": "test_get_default_exprs_excluded_cols", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "kwargs", "update", "dict", "excluded_columns", "col"], ["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "None"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestHiveStatsCollectionOperator.test_get_default_exprs_excluded_cols", "ret_exprs": [], "ret_type": "", "variables": {"col": "", "default_exprs": ""}, "variables_p": {"col": [["dict", 0.9999999999999999]], "default_exprs": [["Iterator[Any]", 0.0966008404548201]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[90, 4], [101, 13]], "fn_var_ln": {"col": [[91, 8], [91, 11]], "default_exprs": [[93, 12], [93, 25]]}, "fn_var_occur": {"col": [["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "col_type"], ["default_exprs", "col", "col", "col", "col", "col", "col", "col", "col", "col", "col"]], "default_exprs": [["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "col_type"], ["default_exprs", "col", "col", "col", "col", "col", "col", "col", "col", "col", "col"]]}, "name": "test_get_default_exprs_number", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "col_type"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestHiveStatsCollectionOperator.test_get_default_exprs_number", "ret_exprs": [], "ret_type": "", "variables": {"col": "", "default_exprs": ""}, "variables_p": {"col": [["dict", 0.09106442189533473]], "default_exprs": [["float", 0.1015501318619436]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[103, 4], [113, 9]], "fn_var_ln": {"col": [[104, 8], [104, 11]], "col_type": [[105, 8], [105, 16]], "default_exprs": [[107, 8], [107, 21]]}, "fn_var_occur": {"col": [["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "col_type"], ["default_exprs", "col", "col", "col", "col", "col", "col"]], "col_type": [["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "col_type"]], "default_exprs": [["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "col_type"], ["default_exprs", "col", "col", "col", "col", "col", "col"]]}, "name": "test_get_default_exprs_boolean", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "col_type"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestHiveStatsCollectionOperator.test_get_default_exprs_boolean", "ret_exprs": [], "ret_type": "", "variables": {"col": "", "col_type": "", "default_exprs": ""}, "variables_p": {"col": [["dict", 0.09106442189533473]], "col_type": [], "default_exprs": [["float", 0.1015501318619436]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[115, 4], [125, 9]], "fn_var_ln": {"col": [[116, 8], [116, 11]], "col_type": [[117, 8], [117, 16]], "default_exprs": [[119, 8], [119, 21]]}, "fn_var_occur": {"col": [["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "col_type"], ["default_exprs", "col", "col", "col", "col", "col", "col"]], "col_type": [["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "col_type"]], "default_exprs": [["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "col_type"], ["default_exprs", "col", "col", "col", "col", "col", "col"]]}, "name": "test_get_default_exprs_string", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["default_exprs", "HiveStatsCollectionOperator", "self", "kwargs", "get_default_exprs", "col", "col_type"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestHiveStatsCollectionOperator.test_get_default_exprs_string", "ret_exprs": [], "ret_type": "", "variables": {"col": "", "col_type": "", "default_exprs": ""}, "variables_p": {"col": [["dict", 0.09106442189533473]], "col_type": [], "default_exprs": [["float", 0.1015501318619436]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[131, 4], [176, 9]], "fn_var_ln": {"exprs": [[153, 8], [153, 13]], "field_types": [[147, 8], [147, 19]], "hive_stats_collection_operator": [[135, 8], [135, 38]], "rows": [[154, 8], [154, 12]]}, "fn_var_occur": {"exprs": [["exprs", "update", "hive_stats_collection_operator", "get_default_exprs", "col", "col_type"], ["exprs", "OrderedDict", "exprs"], ["rows", "hive_stats_collection_operator", "ds", "hive_stats_collection_operator", "dttm", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "r", "r", "r", "r", "zip", "exprs", "mock_presto_hook", "return_value", "get_first", "return_value"]], "field_types": [["field_types", "col", "name", "col", "type", "col", "mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols"], ["list", "field_types", "items"]], "hive_stats_collection_operator": [["hive_stats_collection_operator", "HiveStatsCollectionOperator", "self", "kwargs"], ["hive_stats_collection_operator", "execute", "context"], ["mock_hive_metastore_hook", "assert_called_once_with", "metastore_conn_id", "hive_stats_collection_operator", "metastore_conn_id"], ["mock_hive_metastore_hook", "return_value", "get_table", "assert_called_once_with", "table_name", "hive_stats_collection_operator", "table"], ["mock_presto_hook", "assert_called_once_with", "presto_conn_id", "hive_stats_collection_operator", "presto_conn_id"], ["mock_mysql_hook", "assert_called_once_with", "hive_stats_collection_operator", "mysql_conn_id"], ["mock_json_dumps", "assert_called_once_with", "hive_stats_collection_operator", "partition", "sort_keys", "True"], ["exprs", "update", "hive_stats_collection_operator", "get_default_exprs", "col", "col_type"], ["rows", "hive_stats_collection_operator", "ds", "hive_stats_collection_operator", "dttm", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "r", "r", "r", "r", "zip", "exprs", "mock_presto_hook", "return_value", "get_first", "return_value"]], "rows": [["rows", "hive_stats_collection_operator", "ds", "hive_stats_collection_operator", "dttm", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "r", "r", "r", "r", "zip", "exprs", "mock_presto_hook", "return_value", "get_first", "return_value"], ["mock_mysql_hook", "return_value", "insert_rows", "assert_called_once_with", "table", "rows", "rows", "target_fields"]]}, "name": "test_execute", "params": {"mock_hive_metastore_hook": "", "mock_json_dumps": "", "mock_mysql_hook": "", "mock_presto_hook": "", "self": ""}, "params_descr": {"mock_hive_metastore_hook": "", "mock_json_dumps": "", "mock_mysql_hook": "", "mock_presto_hook": "", "self": ""}, "params_occur": {"mock_hive_metastore_hook": [["mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols", "fake_col"], ["mock_hive_metastore_hook", "assert_called_once_with", "metastore_conn_id", "hive_stats_collection_operator", "metastore_conn_id"], ["mock_hive_metastore_hook", "return_value", "get_table", "assert_called_once_with", "table_name", "hive_stats_collection_operator", "table"], ["field_types", "col", "name", "col", "type", "col", "mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols"]], "mock_json_dumps": [["mock_json_dumps", "assert_called_once_with", "hive_stats_collection_operator", "partition", "sort_keys", "True"], ["rows", "hive_stats_collection_operator", "ds", "hive_stats_collection_operator", "dttm", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "r", "r", "r", "r", "zip", "exprs", "mock_presto_hook", "return_value", "get_first", "return_value"]], "mock_mysql_hook": [["mock_mysql_hook", "return_value", "get_records", "return_value", "False"], ["mock_mysql_hook", "assert_called_once_with", "hive_stats_collection_operator", "mysql_conn_id"], ["mock_mysql_hook", "return_value", "insert_rows", "assert_called_once_with", "table", "rows", "rows", "target_fields"]], "mock_presto_hook": [["mock_presto_hook", "assert_called_once_with", "presto_conn_id", "hive_stats_collection_operator", "presto_conn_id"], ["rows", "hive_stats_collection_operator", "ds", "hive_stats_collection_operator", "dttm", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "r", "r", "r", "r", "zip", "exprs", "mock_presto_hook", "return_value", "get_first", "return_value"]], "self": [["hive_stats_collection_operator", "HiveStatsCollectionOperator", "self", "kwargs"]]}, "params_p": {"args": [], "kwargs": [], "mock_hive_metastore_hook": [["unittesmock.MagicMock", 0.434788445555911]], "mock_json_dumps": [["mock.Mock", 0.0993108300118724], ["unittesmock.MagicMock", 0.09061258775068091]], "mock_mysql_hook": [["mock.MagicMock", 0.09429099416997921], ["unittesmock.MagicMock", 0.09216120671426388]], "mock_presto_hook": [["mock.Mock", 0.31463766552794925], ["unittesmock.MagicMock", 0.29365351364925685]], "self": []}, "q_name": "TestHiveStatsCollectionOperator.test_execute", "ret_exprs": [], "ret_type": "", "variables": {"exprs": "", "field_types": "", "hive_stats_collection_operator": "", "rows": ""}, "variables_p": {"exprs": [["Dict[str, Any]", 0.17117067657616214], ["dict", 0.12403259439339875], ["Dict[str, Dict[str, Any]]", 0.11457230914118743], ["Dict[str, List[str]]", 0.0780391230541583], ["str", 0.07276684082755785], ["int", 0.0701457106687589]], "field_types": [["List[Dict[str, Any]]", 0.10572639532760196], ["Dict[str, List[str]]", 0.09777346971948961], ["int", 0.09576498407210475], ["List[str]", 0.0953544175105931]], "hive_stats_collection_operator": [["wemake_python_styleguide.visitors.ascomplexity.annotations.AnnotationComplexityVisitor", 0.19999999999999998]], "rows": [["int", 0.3570897811921162], ["float", 0.17682915850486874], ["List[List[int]]", 0.10042726572867403], ["list", 0.10026673319122117], ["Tuple[Any, Any, Any]", 0.09997589693748354], ["List[Union[Any, Any]]", 0.0884229157552577]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[185, 8], [186, 50]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "assignment_func", "params": {"_": "", "col": ""}, "params_descr": {"_": "", "col": ""}, "params_occur": {"_": [], "col": [["col", "col"]]}, "params_p": {"_": [["int", 0.5438964174599618], ["str", 0.2022664410704968], ["dict", 0.06557941054657078]], "args": [], "col": [["str", 0.533895488739855], ["dict", 0.08059188799224494], ["int", 0.07777076462254125]], "kwargs": [], "self": []}, "q_name": "TestHiveStatsCollectionOperator.test_execute_with_assignment_func.<locals>.assignment_func", "ret_exprs": ["return {(col, \"test\"): f\"TEST({col})\"}"], "ret_type": "", "ret_type_p": [["bool", 0.8793989653642075]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[182, 4], [224, 9]], "fn_var_ln": {"exprs": [[201, 8], [201, 13]], "field_types": [[195, 8], [195, 19]], "hive_stats_collection_operator": [[192, 8], [192, 38]], "rows": [[202, 8], [202, 12]]}, "fn_var_occur": {"exprs": [["exprs", "update", "hive_stats_collection_operator", "assignment_func", "col", "col_type"], ["exprs", "OrderedDict", "exprs"], ["rows", "hive_stats_collection_operator", "ds", "hive_stats_collection_operator", "dttm", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "r", "r", "r", "r", "zip", "exprs", "mock_presto_hook", "return_value", "get_first", "return_value"]], "field_types": [["field_types", "col", "name", "col", "type", "col", "mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols"], ["list", "field_types", "items"]], "hive_stats_collection_operator": [["hive_stats_collection_operator", "HiveStatsCollectionOperator", "self", "kwargs"], ["hive_stats_collection_operator", "execute", "context"], ["exprs", "update", "hive_stats_collection_operator", "assignment_func", "col", "col_type"], ["rows", "hive_stats_collection_operator", "ds", "hive_stats_collection_operator", "dttm", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "r", "r", "r", "r", "zip", "exprs", "mock_presto_hook", "return_value", "get_first", "return_value"]], "rows": [["rows", "hive_stats_collection_operator", "ds", "hive_stats_collection_operator", "dttm", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "r", "r", "r", "r", "zip", "exprs", "mock_presto_hook", "return_value", "get_first", "return_value"], ["mock_mysql_hook", "return_value", "insert_rows", "assert_called_once_with", "table", "rows", "rows", "target_fields"]]}, "name": "test_execute_with_assignment_func", "params": {"mock_hive_metastore_hook": "", "mock_json_dumps": "", "mock_mysql_hook": "", "mock_presto_hook": "", "self": ""}, "params_descr": {"mock_hive_metastore_hook": "", "mock_json_dumps": "", "mock_mysql_hook": "", "mock_presto_hook": "", "self": ""}, "params_occur": {"mock_hive_metastore_hook": [["mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols", "fake_col"], ["field_types", "col", "name", "col", "type", "col", "mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols"]], "mock_json_dumps": [["rows", "hive_stats_collection_operator", "ds", "hive_stats_collection_operator", "dttm", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "r", "r", "r", "r", "zip", "exprs", "mock_presto_hook", "return_value", "get_first", "return_value"]], "mock_mysql_hook": [["mock_mysql_hook", "return_value", "get_records", "return_value", "False"], ["mock_mysql_hook", "return_value", "insert_rows", "assert_called_once_with", "table", "rows", "rows", "target_fields"]], "mock_presto_hook": [["rows", "hive_stats_collection_operator", "ds", "hive_stats_collection_operator", "dttm", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "r", "r", "r", "r", "zip", "exprs", "mock_presto_hook", "return_value", "get_first", "return_value"]], "self": [["self", "kwargs", "update", "dict", "assignment_func", "assignment_func"], ["hive_stats_collection_operator", "HiveStatsCollectionOperator", "self", "kwargs"]]}, "params_p": {"args": [], "kwargs": [], "mock_hive_metastore_hook": [["unittesmock.MagicMock", 0.47574917919008747]], "mock_json_dumps": [], "mock_mysql_hook": [["mock.MagicMock", 0.11704790958001535], ["unittesmock.MagicMock", 0.1121402120199216]], "mock_presto_hook": [], "self": []}, "q_name": "TestHiveStatsCollectionOperator.test_execute_with_assignment_func", "ret_exprs": [], "ret_type": "", "variables": {"exprs": "", "field_types": "", "hive_stats_collection_operator": "", "rows": ""}, "variables_p": {"exprs": [["Dict[str, Any]", 0.18185117368580223], ["dict", 0.12977749865868193], ["Dict[str, List[str]]", 0.1090589014927327], ["Dict[str, Union[Any, Any]]", 0.10417896424514526], ["Dict[str, Dict[str, Any]]", 0.09178995719561153], ["bool", 0.08950394954494363]], "field_types": [["List[Dict[str, Any]]", 0.10572639532760196], ["Dict[str, List[str]]", 0.09777346971948961], ["int", 0.09576498407210475], ["List[str]", 0.0953544175105931]], "hive_stats_collection_operator": [["Dict[str, Dict[str, str]]", 0.15448006150297314]], "rows": [["int", 0.3570897811921162], ["float", 0.17682915850486874], ["List[List[int]]", 0.10042726572867403], ["list", 0.10026673319122117], ["Tuple[Any, Any, Any]", 0.09997589693748354], ["List[Union[Any, Any]]", 0.0884229157552577]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[233, 8], [234, 16]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "assignment_func", "params": {"_": "", "__": ""}, "params_descr": {"_": "", "__": ""}, "params_occur": {"_": [], "__": []}, "params_p": {"_": [["List[Dict[str, Any]]", 0.4285714281879751], ["str", 0.2857142854586501], ["int", 0.14285714272932504]], "__": [["List[Dict[str, Any]]", 0.4285714281879751], ["str", 0.2857142854586501], ["int", 0.14285714272932504]], "args": [], "kwargs": [], "self": []}, "q_name": "TestHiveStatsCollectionOperator.test_execute_with_assignment_func_no_return_value.<locals>.assignment_func", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[230, 4], [272, 9]], "fn_var_ln": {"exprs": [[249, 8], [249, 13]], "field_types": [[243, 8], [243, 19]], "hive_stats_collection_operator": [[240, 8], [240, 38]], "rows": [[250, 8], [250, 12]]}, "fn_var_occur": {"exprs": [["exprs", "update", "hive_stats_collection_operator", "get_default_exprs", "col", "col_type"], ["exprs", "OrderedDict", "exprs"], ["rows", "hive_stats_collection_operator", "ds", "hive_stats_collection_operator", "dttm", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "r", "r", "r", "r", "zip", "exprs", "mock_presto_hook", "return_value", "get_first", "return_value"]], "field_types": [["field_types", "col", "name", "col", "type", "col", "mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols"], ["list", "field_types", "items"]], "hive_stats_collection_operator": [["hive_stats_collection_operator", "HiveStatsCollectionOperator", "self", "kwargs"], ["hive_stats_collection_operator", "execute", "context"], ["exprs", "update", "hive_stats_collection_operator", "get_default_exprs", "col", "col_type"], ["rows", "hive_stats_collection_operator", "ds", "hive_stats_collection_operator", "dttm", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "r", "r", "r", "r", "zip", "exprs", "mock_presto_hook", "return_value", "get_first", "return_value"]], "rows": [["rows", "hive_stats_collection_operator", "ds", "hive_stats_collection_operator", "dttm", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "r", "r", "r", "r", "zip", "exprs", "mock_presto_hook", "return_value", "get_first", "return_value"], ["mock_mysql_hook", "return_value", "insert_rows", "assert_called_once_with", "table", "rows", "rows", "target_fields"]]}, "name": "test_execute_with_assignment_func_no_return_value", "params": {"mock_hive_metastore_hook": "", "mock_json_dumps": "", "mock_mysql_hook": "", "mock_presto_hook": "", "self": ""}, "params_descr": {"mock_hive_metastore_hook": "", "mock_json_dumps": "", "mock_mysql_hook": "", "mock_presto_hook": "", "self": ""}, "params_occur": {"mock_hive_metastore_hook": [["mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols", "fake_col"], ["field_types", "col", "name", "col", "type", "col", "mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols"]], "mock_json_dumps": [["rows", "hive_stats_collection_operator", "ds", "hive_stats_collection_operator", "dttm", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "r", "r", "r", "r", "zip", "exprs", "mock_presto_hook", "return_value", "get_first", "return_value"]], "mock_mysql_hook": [["mock_mysql_hook", "return_value", "get_records", "return_value", "False"], ["mock_mysql_hook", "return_value", "insert_rows", "assert_called_once_with", "table", "rows", "rows", "target_fields"]], "mock_presto_hook": [["rows", "hive_stats_collection_operator", "ds", "hive_stats_collection_operator", "dttm", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "r", "r", "r", "r", "zip", "exprs", "mock_presto_hook", "return_value", "get_first", "return_value"]], "self": [["self", "kwargs", "update", "dict", "assignment_func", "assignment_func"], ["hive_stats_collection_operator", "HiveStatsCollectionOperator", "self", "kwargs"]]}, "params_p": {"args": [], "kwargs": [], "mock_hive_metastore_hook": [["unittesmock.MagicMock", 0.4103536557195868], ["mock.Mock", 0.0907670459836505]], "mock_json_dumps": [], "mock_mysql_hook": [["unittesmock.MagicMock", 0.2997318870225938], ["mock.MagicMock", 0.11792140359724289]], "mock_presto_hook": [], "self": []}, "q_name": "TestHiveStatsCollectionOperator.test_execute_with_assignment_func_no_return_value", "ret_exprs": [], "ret_type": "", "variables": {"exprs": "", "field_types": "", "hive_stats_collection_operator": "", "rows": ""}, "variables_p": {"exprs": [["Dict[str, Any]", 0.17117067657616214], ["dict", 0.12403259439339875], ["Dict[str, Dict[str, Any]]", 0.11457230914118743], ["Dict[str, List[str]]", 0.0780391230541583], ["str", 0.07276684082755785], ["int", 0.0701457106687589]], "field_types": [["List[Dict[str, Any]]", 0.10572639532760196], ["Dict[str, List[str]]", 0.09777346971948961], ["int", 0.09576498407210475], ["List[str]", 0.0953544175105931]], "hive_stats_collection_operator": [["Dict[str, Dict[str, str]]", 0.15448006150297314]], "rows": [["int", 0.3570897811921162], ["float", 0.17682915850486874], ["List[List[int]]", 0.10042726572867403], ["list", 0.10026673319122117], ["Tuple[Any, Any, Any]", 0.09997589693748354], ["List[Union[Any, Any]]", 0.0884229157552577]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[277, 4], [283, 74]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_execute_no_query_results", "params": {"mock_hive_metastore_hook": "", "mock_mysql_hook": "", "mock_presto_hook": "", "self": ""}, "params_descr": {"mock_hive_metastore_hook": "", "mock_mysql_hook": "", "mock_presto_hook": "", "self": ""}, "params_occur": {"mock_hive_metastore_hook": [["mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols", "fake_col"]], "mock_mysql_hook": [["mock_mysql_hook", "return_value", "get_records", "return_value", "False"]], "mock_presto_hook": [["mock_presto_hook", "return_value", "get_first", "return_value", "None"]], "self": [["HiveStatsCollectionOperator", "self", "kwargs", "execute", "context"]]}, "params_p": {"args": [], "kwargs": [], "mock_hive_metastore_hook": [["unittesmock.MagicMock", 0.6355257490767336]], "mock_mysql_hook": [["unittesmock.MagicMock", 0.25217663138165347]], "mock_presto_hook": [["unittesmock.MagicMock", 0.49800619106850724]], "self": []}, "q_name": "TestHiveStatsCollectionOperator.test_execute_no_query_results", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[289, 4], [305, 69]], "fn_var_ln": {"hive_stats_collection_operator": [[295, 8], [295, 38]], "sql": [[298, 8], [298, 11]]}, "fn_var_occur": {"hive_stats_collection_operator": [["hive_stats_collection_operator", "HiveStatsCollectionOperator", "self", "kwargs"], ["hive_stats_collection_operator", "execute", "context"], ["sql", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "hive_stats_collection_operator", "dttm"]], "sql": [["sql", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "hive_stats_collection_operator", "dttm"], ["mock_mysql_hook", "return_value", "run", "assert_called_once_with", "sql"]]}, "name": "test_execute_delete_previous_runs_rows", "params": {"mock_hive_metastore_hook": "", "mock_json_dumps": "", "mock_mysql_hook": "", "mock_presto_hook": "", "self": ""}, "params_descr": {"mock_hive_metastore_hook": "", "mock_json_dumps": "", "mock_mysql_hook": "", "mock_presto_hook": "", "self": ""}, "params_occur": {"mock_hive_metastore_hook": [["mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols", "fake_col"]], "mock_json_dumps": [["sql", "hive_stats_collection_operator", "table", "mock_json_dumps", "return_value", "hive_stats_collection_operator", "dttm"]], "mock_mysql_hook": [["mock_mysql_hook", "return_value", "get_records", "return_value", "True"], ["mock_mysql_hook", "return_value", "run", "assert_called_once_with", "sql"]], "mock_presto_hook": [], "self": [["hive_stats_collection_operator", "HiveStatsCollectionOperator", "self", "kwargs"]]}, "params_p": {"args": [], "kwargs": [], "mock_hive_metastore_hook": [["unittesmock.MagicMock", 0.6272744067306608]], "mock_json_dumps": [["unittesmock.MagicMock", 0.20000006684442642]], "mock_mysql_hook": [["unittesmock.MagicMock", 0.4676832853327156], ["mock.MagicMock", 0.13025927375387092]], "mock_presto_hook": [["mock.Mock", 0.32057884511825274]], "self": []}, "q_name": "TestHiveStatsCollectionOperator.test_execute_delete_previous_runs_rows", "ret_exprs": [], "ret_type": "", "variables": {"hive_stats_collection_operator": "", "sql": ""}, "variables_p": {"hive_stats_collection_operator": [], "sql": [["str", 0.3361241196961758], ["List[Dict[str, float]]", 0.09864605734661275], ["list", 0.09112766552746457]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[314, 4], [376, 9]], "fn_var_ln": {"actual_stats_select_query": [[348, 8], [348, 33]], "expected_stats_select_query": [[338, 8], [338, 35]], "insert_rows_val": [[352, 8], [352, 23]], "mock_mysql_hook": [[315, 8], [315, 23]], "mock_presto_hook": [[316, 8], [316, 24]], "op": [[323, 16], [323, 18]], "raw_stats_select_query": [[347, 8], [347, 30]], "select_count_query": [[331, 8], [331, 26]]}, "fn_var_occur": {"actual_stats_select_query": [["actual_stats_select_query", "re", "sub", "raw_stats_select_query", "strip"], ["expected_stats_select_query", "actual_stats_select_query"]], "expected_stats_select_query": [["expected_stats_select_query", "actual_stats_select_query"]], "insert_rows_val": [["mock_mysql_hook", "insert_rows", "assert_called_with", "table", "rows", "insert_rows_val", "target_fields"]], "mock_mysql_hook": [["mock_mysql_hook", "MockMySqlHook"], ["patch", "return_value", "mock_mysql_hook"], ["raw_stats_select_query", "mock_mysql_hook", "get_records", "call_args_list"], ["mock_mysql_hook", "insert_rows", "assert_called_with", "table", "rows", "insert_rows_val", "target_fields"]], "mock_presto_hook": [["mock_presto_hook", "MockPrestoHook"], ["patch", "return_value", "mock_presto_hook"], ["mock_presto_hook", "get_first", "assert_called_with", "hql", "select_count_query"]], "op": [["op", "HiveStatsCollectionOperator", "task_id", "table", "partition", "DEFAULT_DATE_DS", "dag", "self", "dag"], ["op", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"]], "raw_stats_select_query": [["raw_stats_select_query", "mock_mysql_hook", "get_records", "call_args_list"], ["actual_stats_select_query", "re", "sub", "raw_stats_select_query", "strip"]], "select_count_query": [["mock_presto_hook", "get_first", "assert_called_with", "hql", "select_count_query"]]}, "name": "test_runs_for_hive_stats", "params": {"mock_hive_metastore_hook": "", "self": ""}, "params_descr": {"mock_hive_metastore_hook": "", "self": ""}, "params_occur": {"mock_hive_metastore_hook": [], "self": [["op", "HiveStatsCollectionOperator", "task_id", "table", "partition", "DEFAULT_DATE_DS", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "mock_hive_metastore_hook": [["mock.Mock", 0.9132912262317311]], "self": []}, "q_name": "TestHiveStatsCollectionOperator.test_runs_for_hive_stats", "ret_exprs": [], "ret_type": "", "variables": {"actual_stats_select_query": "", "expected_stats_select_query": "", "insert_rows_val": "", "mock_mysql_hook": "", "mock_presto_hook": "", "op": "", "raw_stats_select_query": "", "select_count_query": ""}, "variables_p": {"actual_stats_select_query": [["int", 0.21360136769727034], ["dict", 0.10258682577163751], ["Optional[dict]", 0.09806834157754869]], "expected_stats_select_query": [["str", 0.09964212980760763]], "insert_rows_val": [["List[Union[Any, Any]]", 0.18062176334876753], ["unittesmock.MagicMock", 0.16025118503328475], ["list", 0.13286035422830805], ["str", 0.10756794774352295], ["int", 0.08797194969578831]], "mock_mysql_hook": [["Dict[str, int]", 0.09724534968881074], ["Dict[str, Any]", 0.07768875788959348]], "mock_presto_hook": [["unittesmock.MagicMock", 0.16447811379195768], ["Dict[str, int]", 0.06928569933462161]], "op": [], "raw_stats_select_query": [["int", 0.40386687215670886], ["dict", 0.10068374093854088]], "select_count_query": [["int", 0.2835338681472561], ["str", 0.11433803778411625], ["Dict[str, Union[Any, str]]", 0.08486223490714978], ["List[str]", 0.07975742491811484], ["tuple", 0.07665131747367308], ["Tuple[str, str, str, str, str, str, str, str, str, str]", 0.07541904094509833]]}}], "name": "TestHiveStatsCollectionOperator", "q_name": "TestHiveStatsCollectionOperator", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["__future__", "annotations", "os", "re", "collections", "OrderedDict", "unittest", "mock", "MagicMock", "patch", "pytest", "airflow", "exceptions", "AirflowException", "airflow", "providers", "apache", "hive", "operators", "hive_stats", "HiveStatsCollectionOperator", "airflow", "providers", "presto", "hooks", "presto", "PrestoHook", "tests", "providers", "apache", "hive", "DEFAULT_DATE", "DEFAULT_DATE_DS", "MockConnectionCursor", "MockHiveMetastoreHook", "MockMySqlHook", "TestHiveEnvironment"], "mod_var_ln": {"fake_col": [[46, 0], [46, 8]]}, "mod_var_occur": {"fake_col": [["mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols", "fake_col"], ["mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols", "fake_col"], ["mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols", "fake_col"], ["mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols", "fake_col"], ["mock_hive_metastore_hook", "return_value", "get_table", "return_value", "sd", "cols", "fake_col"]]}, "no_types_annot": {"D": 0, "I": 0, "U": 86}, "session_id": "bzrgtwipddHINDpAh7IiHZMzihzwlZXBDvvr_o_OS88", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"fake_col": ""}, "variables_p": {"fake_col": [["Dict[str, Union[Any, Any]]", 0.2524141742269951], ["str", 0.11954527712808397], ["Dict[str, Dict[str, Any]]", 0.1126159009901557], ["List[Dict[str, Any]]", 0.08073240032214488], ["Dict[str, int]", 0.07554671359359898]]}}}