{"error": null, "response": {"classes": [{"cls_lc": [[32, 0], [57, 66]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[33, 4], [44, 74]], "fn_var_ln": {"op": [[34, 8], [34, 10]], "test_config_hive_mapred_queue": [[43, 8], [43, 37]]}, "fn_var_occur": {"op": [["op", "HiveOperator", "task_id", "hql", "self", "hql", "mapred_queue_priority", "mapred_job_name", "dag", "self", "dag"], ["op", "get_hook", "mapred_queue", "test_config_hive_mapred_queue"]], "test_config_hive_mapred_queue": [["test_config_hive_mapred_queue", "conf", "get"], ["op", "get_hook", "mapred_queue", "test_config_hive_mapred_queue"]]}, "name": "test_hive_airflow_default_config_queue", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["op", "HiveOperator", "task_id", "hql", "self", "hql", "mapred_queue_priority", "mapred_job_name", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "HiveOperatorConfigTest.test_hive_airflow_default_config_queue", "ret_exprs": [], "ret_type": "", "variables": {"op": "", "test_config_hive_mapred_queue": ""}, "variables_p": {"op": [["dict", 0.18153516860574698], ["Dict[str, int]", 0.10086648790560396], ["Dict[str, Dict[str, int]]", 0.09849064009777937], ["Dict[str, Any]", 0.09360735515956731]], "test_config_hive_mapred_queue": [["Dict[str, Union[Any, Any]]", 0.3430056304055505], ["ChainMap", 0.096807611140698], ["str", 0.09532976815896634], ["piccolo.conf.apps.AppConfig", 0.08960991947112792]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[46, 4], [57, 66]], "fn_var_ln": {"op": [[48, 8], [48, 10]], "specific_mapred_queue": [[47, 8], [47, 29]]}, "fn_var_occur": {"op": [["op", "HiveOperator", "task_id", "hql", "self", "hql", "mapred_queue", "specific_mapred_queue", "mapred_queue_priority", "mapred_job_name", "dag", "self", "dag"], ["op", "get_hook", "mapred_queue", "specific_mapred_queue"]], "specific_mapred_queue": [["op", "HiveOperator", "task_id", "hql", "self", "hql", "mapred_queue", "specific_mapred_queue", "mapred_queue_priority", "mapred_job_name", "dag", "self", "dag"], ["op", "get_hook", "mapred_queue", "specific_mapred_queue"]]}, "name": "test_hive_airflow_default_config_queue_override", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["op", "HiveOperator", "task_id", "hql", "self", "hql", "mapred_queue", "specific_mapred_queue", "mapred_queue_priority", "mapred_job_name", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "HiveOperatorConfigTest.test_hive_airflow_default_config_queue_override", "ret_exprs": [], "ret_type": "", "variables": {"op": "", "specific_mapred_queue": ""}, "variables_p": {"op": [["list", 0.20127393591811552], ["Dict[str, Union[Any, bool, str]]", 0.19949333675557365], ["List[str]", 0.10529112862096693]], "specific_mapred_queue": [["dict", 0.19105698084977202], ["Dict[str, dict]", 0.09004455165705216], ["List[tuple]", 0.0893199127052498]]}}], "name": "HiveOperatorConfigTest", "q_name": "HiveOperatorConfigTest", "variables": {}, "variables_p": {}}, {"cls_lc": [[60, 0], [96, 9]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[61, 4], [65, 65]], "fn_var_ln": {"hql": [[62, 8], [62, 11]], "op": [[63, 8], [63, 10]]}, "fn_var_occur": {"hql": [["op", "HiveOperator", "hiveconf_jinja_translate", "True", "task_id", "hql", "hql", "dag", "self", "dag"], ["op", "hql"]], "op": [["op", "HiveOperator", "hiveconf_jinja_translate", "True", "task_id", "hql", "hql", "dag", "self", "dag"], ["op", "prepare_template"], ["op", "hql"]]}, "name": "test_hiveconf_jinja_translate", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["op", "HiveOperator", "hiveconf_jinja_translate", "True", "task_id", "hql", "hql", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "HiveOperatorTest.test_hiveconf_jinja_translate", "ret_exprs": [], "ret_type": "", "variables": {"hql": "", "op": ""}, "variables_p": {"hql": [], "op": [["int", 0.10774011882312365], ["tuple", 0.10131039846660235], ["deeplearning.ml4pl.models.checkpoints.CheckpointReference", 0.09811005653975434]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[67, 4], [76, 87]], "fn_var_ln": {"hql": [[68, 8], [68, 11]], "op": [[69, 8], [69, 10]]}, "fn_var_occur": {"hql": [["op", "HiveOperator", "hiveconfs", "task_id", "hql", "hql", "dag", "self", "dag"], ["op", "hql"]], "op": [["op", "HiveOperator", "hiveconfs", "task_id", "hql", "hql", "dag", "self", "dag"], ["op", "prepare_template"], ["op", "hql"]]}, "name": "test_hiveconf", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["op", "HiveOperator", "hiveconfs", "task_id", "hql", "hql", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "HiveOperatorTest.test_hiveconf", "ret_exprs": [], "ret_type": "", "variables": {"hql": "", "op": ""}, "variables_p": {"hql": [["str", 0.4510073002727921], ["Dict[str, Any]", 0.09863933845424233], ["bool", 0.09470440043298768], ["int", 0.08572464125006965]], "op": [["str", 0.16910218845553215], ["Dict[str, str]", 0.1037760177243696], ["magic.models.deck.Deck", 0.09610971918673719], ["int", 0.07947229452818037]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[79, 4], [96, 9]], "fn_var_ln": {"dag_run": [[87, 8], [87, 23]], "fake_context": [[89, 8], [89, 20]], "fake_execution_date": [[85, 8], [85, 27]], "fake_run_id": [[84, 8], [84, 19]], "fake_ti": [[86, 8], [86, 15]], "hostname": [[88, 8], [88, 24]], "mock_hook": [[80, 8], [80, 17]], "op": [[82, 8], [82, 10]], "return_value": [[81, 8], [81, 34]]}, "fn_var_occur": {"dag_run": [["fake_ti", "dag_run", "DagRun", "run_id", "fake_run_id", "execution_date", "fake_execution_date"]], "fake_context": [["fake_context", "fake_ti"], ["op", "execute", "fake_context"]], "fake_execution_date": [["fake_execution_date", "timezone", "datetime"], ["fake_ti", "dag_run", "DagRun", "run_id", "fake_run_id", "execution_date", "fake_execution_date"], ["fake_ti", "hostname", "self", "dag", "dag_id", "op", "task_id", "fake_execution_date", "isoformat", "mock_hook", "mapred_job_name"]], "fake_run_id": [["fake_ti", "dag_run", "DagRun", "run_id", "fake_run_id", "execution_date", "fake_execution_date"]], "fake_ti": [["fake_ti", "TaskInstance", "task", "op"], ["fake_ti", "dag_run", "DagRun", "run_id", "fake_run_id", "execution_date", "fake_execution_date"], ["fake_ti", "hostname"], ["fake_context", "fake_ti"], ["fake_ti", "hostname", "self", "dag", "dag_id", "op", "task_id", "fake_execution_date", "isoformat", "mock_hook", "mapred_job_name"]], "hostname": [["fake_ti", "hostname"], ["fake_ti", "hostname", "self", "dag", "dag_id", "op", "task_id", "fake_execution_date", "isoformat", "mock_hook", "mapred_job_name"]], "mock_hook": [["mock_hook", "mock", "MagicMock"], ["mock_get_hook", "return_value", "mock_hook"], ["fake_ti", "hostname", "self", "dag", "dag_id", "op", "task_id", "fake_execution_date", "isoformat", "mock_hook", "mapred_job_name"]], "op": [["op", "HiveOperator", "task_id", "hql", "self", "hql", "dag", "self", "dag"], ["fake_ti", "TaskInstance", "task", "op"], ["op", "execute", "fake_context"], ["fake_ti", "hostname", "self", "dag", "dag_id", "op", "task_id", "fake_execution_date", "isoformat", "mock_hook", "mapred_job_name"]], "return_value": [["mock_get_hook", "return_value", "mock_hook"]]}, "name": "test_mapred_job_name", "params": {"mock_get_hook": "", "self": ""}, "params_descr": {"mock_get_hook": "", "self": ""}, "params_occur": {"mock_get_hook": [["mock_get_hook", "return_value", "mock_hook"]], "self": [["op", "HiveOperator", "task_id", "hql", "self", "hql", "dag", "self", "dag"], ["fake_ti", "hostname", "self", "dag", "dag_id", "op", "task_id", "fake_execution_date", "isoformat", "mock_hook", "mapred_job_name"]]}, "params_p": {"args": [], "kwargs": [], "mock_get_hook": [["mock.MagicMock", 0.09338817139531502]], "self": []}, "q_name": "HiveOperatorTest.test_mapred_job_name", "ret_exprs": [], "ret_type": "", "variables": {"dag_run": "", "fake_context": "", "fake_execution_date": "", "fake_run_id": "", "fake_ti": "", "hostname": "", "mock_hook": "", "op": "", "return_value": ""}, "variables_p": {"dag_run": [], "fake_context": [["List[List[str]]", 0.3148302237480269], ["Dict[int, str]", 0.07551565129181197], ["Tuple[str, str]", 0.05213972190745644], ["Tuple[str, str, str, str, str]", 0.05213972190745644]], "fake_execution_date": [], "fake_run_id": [["str", 0.2833363129174647], ["int", 0.09635527015913606]], "fake_ti": [["str", 0.2024016053540626], ["raiden.utils.PaymentID", 0.086730613869914], ["Tuple[int, int, int, int]", 0.08161512136910845]], "hostname": [], "mock_hook": [["mock.Mock", 0.0914233318863848]], "op": [["Dict[str, Dict[str, int]]", 0.11815509047745439], ["Dict[str, Any]", 0.0894522624660892]], "return_value": [["Dict[str, Dict[str, Any]]", 0.18979986842445393], ["Dict[str, Union[Any, Any]]", 0.17122133107536028], ["list", 0.09070336380699785], ["Dict[str, Union[Any, Any, Any]]", 0.07945907825733256]]}}], "name": "HiveOperatorTest", "q_name": "HiveOperatorTest", "variables": {}, "variables_p": {}}, {"cls_lc": [[102, 0], [298, 9]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[106, 4], [147, 9]], "fn_var_ln": {"hive_cmd": [[113, 8], [113, 16]], "mock_subprocess": [[107, 8], [107, 23]], "op": [[110, 8], [110, 10]], "return_value": [[109, 8], [109, 34]]}, "fn_var_occur": {"hive_cmd": [["mock_popen", "assert_called_with", "hive_cmd", "stdout", "mock_subprocess", "PIPE", "stderr", "mock_subprocess", "STDOUT", "cwd", "close_fds", "True"]], "mock_subprocess": [["mock_subprocess", "MockSubProcess"], ["mock_popen", "return_value", "mock_subprocess"], ["mock_popen", "assert_called_with", "hive_cmd", "stdout", "mock_subprocess", "PIPE", "stderr", "mock_subprocess", "STDOUT", "cwd", "close_fds", "True"]], "op": [["op", "HiveOperator", "task_id", "hql", "self", "hql", "dag", "self", "dag", "mapred_job_name"], ["op", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"]], "return_value": [["mock_popen", "return_value", "mock_subprocess"], ["mock_temp_dir", "return_value"]]}, "name": "test_hive", "params": {"mock_popen": "", "mock_temp_dir": "", "self": ""}, "params_descr": {"mock_popen": "", "mock_temp_dir": "", "self": ""}, "params_occur": {"mock_popen": [["mock_popen", "return_value", "mock_subprocess"], ["mock_popen", "assert_called_with", "hive_cmd", "stdout", "mock_subprocess", "PIPE", "stderr", "mock_subprocess", "STDOUT", "cwd", "close_fds", "True"]], "mock_temp_dir": [["mock_temp_dir", "return_value"]], "self": [["op", "HiveOperator", "task_id", "hql", "self", "hql", "dag", "self", "dag", "mapred_job_name"]]}, "params_p": {"args": [], "kwargs": [], "mock_popen": [], "mock_temp_dir": [], "self": []}, "q_name": "TestHivePresto.test_hive", "ret_exprs": [], "ret_type": "", "variables": {"hive_cmd": "", "mock_subprocess": "", "op": "", "return_value": ""}, "variables_p": {"hive_cmd": [["str", 0.5032337893350641], ["Dict[str, Union[int, str]]", 0.1883707439939754], ["Union[Literal, str]", 0.1538236420023181], ["Dict[str, Union[Any, Any]]", 0.07788951647578213]], "mock_subprocess": [["Dict[str, Tuple[str, Any]]", 0.209635858390889]], "op": [["dict", 0.1972906195748108], ["Dict[str, Any]", 0.12142056159755428], ["Dict[str, Dict[str, int]]", 0.09630125692206659]], "return_value": [["str", 0.7804479198572908], ["Dict[str, Union[int, str]]", 0.13577990220152364]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[152, 4], [202, 9]], "fn_var_ln": {"hive_cmd": [[157, 8], [157, 16]], "mock_subprocess": [[153, 8], [153, 23]], "op": [[186, 8], [186, 10]], "return_value": [[155, 8], [155, 34]]}, "fn_var_occur": {"hive_cmd": [["mock_popen", "assert_called_with", "hive_cmd", "stdout", "mock_subprocess", "PIPE", "stderr", "mock_subprocess", "STDOUT", "cwd", "close_fds", "True"]], "mock_subprocess": [["mock_subprocess", "MockSubProcess"], ["mock_popen", "return_value", "mock_subprocess"], ["mock_popen", "assert_called_with", "hive_cmd", "stdout", "mock_subprocess", "PIPE", "stderr", "mock_subprocess", "STDOUT", "cwd", "close_fds", "True"]], "op": [["op", "HiveOperator", "task_id", "hql", "self", "hql", "mapred_queue", "mapred_queue_priority", "mapred_job_name", "dag", "self", "dag"], ["op", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"]], "return_value": [["mock_popen", "return_value", "mock_subprocess"], ["mock_temp_dir", "return_value"]]}, "name": "test_hive_queues", "params": {"mock_popen": "", "mock_temp_dir": "", "self": ""}, "params_descr": {"mock_popen": "", "mock_temp_dir": "", "self": ""}, "params_occur": {"mock_popen": [["mock_popen", "return_value", "mock_subprocess"], ["mock_popen", "assert_called_with", "hive_cmd", "stdout", "mock_subprocess", "PIPE", "stderr", "mock_subprocess", "STDOUT", "cwd", "close_fds", "True"]], "mock_temp_dir": [["mock_temp_dir", "return_value"]], "self": [["op", "HiveOperator", "task_id", "hql", "self", "hql", "mapred_queue", "mapred_queue_priority", "mapred_job_name", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "mock_popen": [], "mock_temp_dir": [], "self": []}, "q_name": "TestHivePresto.test_hive_queues", "ret_exprs": [], "ret_type": "", "variables": {"hive_cmd": "", "mock_subprocess": "", "op": "", "return_value": ""}, "variables_p": {"hive_cmd": [["str", 0.5032337893350641], ["Dict[str, Union[int, str]]", 0.1883707439939754], ["Union[Literal, str]", 0.1538236420023181], ["Dict[str, Union[Any, Any]]", 0.07788951647578213]], "mock_subprocess": [["Dict[str, Tuple[str, Any]]", 0.209635858390889]], "op": [["Dict[str, Union[Any, bool, str]]", 0.20739785087215568], ["Dict[str, int]", 0.11585203705923396], ["List[str]", 0.10416001566061046], ["str", 0.08976522310094708]], "return_value": [["str", 0.7804479198572908], ["Dict[str, Union[int, str]]", 0.13577990220152364]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[207, 4], [246, 9]], "fn_var_ln": {"hive_cmd": [[215, 8], [215, 16]], "mock_subprocess": [[208, 8], [208, 23]], "op": [[212, 8], [212, 10]], "return_value": [[210, 8], [210, 34]]}, "fn_var_occur": {"hive_cmd": [["mock_popen", "assert_called_with", "hive_cmd", "stdout", "mock_subprocess", "PIPE", "stderr", "mock_subprocess", "STDOUT", "cwd", "close_fds", "True"]], "mock_subprocess": [["mock_subprocess", "MockSubProcess"], ["mock_popen", "return_value", "mock_subprocess"], ["mock_popen", "assert_called_with", "hive_cmd", "stdout", "mock_subprocess", "PIPE", "stderr", "mock_subprocess", "STDOUT", "cwd", "close_fds", "True"]], "op": [["op", "HiveOperator", "task_id", "hql", "self", "hql", "dag", "self", "dag"], ["op", "dry_run"]], "return_value": [["mock_popen", "return_value", "mock_subprocess"], ["mock_temp_dir", "return_value"]]}, "name": "test_hive_dryrun", "params": {"mock_popen": "", "mock_temp_dir": "", "self": ""}, "params_descr": {"mock_popen": "", "mock_temp_dir": "", "self": ""}, "params_occur": {"mock_popen": [["mock_popen", "return_value", "mock_subprocess"], ["mock_popen", "assert_called_with", "hive_cmd", "stdout", "mock_subprocess", "PIPE", "stderr", "mock_subprocess", "STDOUT", "cwd", "close_fds", "True"]], "mock_temp_dir": [["mock_temp_dir", "return_value"]], "self": [["op", "HiveOperator", "task_id", "hql", "self", "hql", "dag", "self", "dag"]]}, "params_p": {"args": [], "kwargs": [], "mock_popen": [], "mock_temp_dir": [], "self": []}, "q_name": "TestHivePresto.test_hive_dryrun", "ret_exprs": [], "ret_type": "", "variables": {"hive_cmd": "", "mock_subprocess": "", "op": "", "return_value": ""}, "variables_p": {"hive_cmd": [["str", 0.5032337893350641], ["Dict[str, Union[int, str]]", 0.1883707439939754], ["Union[Literal, str]", 0.1538236420023181], ["Dict[str, Union[Any, Any]]", 0.07788951647578213]], "mock_subprocess": [["Dict[str, Tuple[str, Any]]", 0.209635858390889]], "op": [["Dict[int, Any]", 0.20371421592894803], ["dict", 0.12747914787203096], ["List[str]", 0.11009223091022027], ["List[float]", 0.0995195033275281], ["list", 0.09924846469072564], ["List[Tuple[Any, Any, Any]]", 0.09243280302057734], ["DefaultDict[Any, List[Any]]", 0.09111218290047024], ["ValueError", 0.08890260823616163]], "return_value": [["str", 0.7804479198572908], ["Dict[str, Union[int, str]]", 0.13577990220152364]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[251, 4], [298, 9]], "fn_var_ln": {"hive_cmd": [[256, 8], [256, 16]], "mock_subprocess": [[252, 8], [252, 23]], "op": [[284, 8], [284, 10]], "return_value": [[254, 8], [254, 34]]}, "fn_var_occur": {"hive_cmd": [["mock_popen", "assert_called_with", "hive_cmd", "stdout", "mock_subprocess", "PIPE", "stderr", "mock_subprocess", "STDOUT", "cwd", "close_fds", "True"]], "mock_subprocess": [["mock_subprocess", "MockSubProcess"], ["mock_popen", "return_value", "mock_subprocess"], ["mock_popen", "assert_called_with", "hive_cmd", "stdout", "mock_subprocess", "PIPE", "stderr", "mock_subprocess", "STDOUT", "cwd", "close_fds", "True"]], "op": [["op", "HiveOperator", "task_id", "hive_cli_conn_id", "hql", "self", "hql", "dag", "self", "dag", "mapred_job_name"], ["op", "run", "start_date", "DEFAULT_DATE", "end_date", "DEFAULT_DATE", "ignore_ti_state", "True"]], "return_value": [["mock_popen", "return_value", "mock_subprocess"], ["mock_temp_dir", "return_value"]]}, "name": "test_beeline", "params": {"mock_popen": "", "mock_temp_dir": "", "self": ""}, "params_descr": {"mock_popen": "", "mock_temp_dir": "", "self": ""}, "params_occur": {"mock_popen": [["mock_popen", "return_value", "mock_subprocess"], ["mock_popen", "assert_called_with", "hive_cmd", "stdout", "mock_subprocess", "PIPE", "stderr", "mock_subprocess", "STDOUT", "cwd", "close_fds", "True"]], "mock_temp_dir": [["mock_temp_dir", "return_value"]], "self": [["op", "HiveOperator", "task_id", "hive_cli_conn_id", "hql", "self", "hql", "dag", "self", "dag", "mapred_job_name"]]}, "params_p": {"args": [], "kwargs": [], "mock_popen": [], "mock_temp_dir": [], "self": []}, "q_name": "TestHivePresto.test_beeline", "ret_exprs": [], "ret_type": "", "variables": {"hive_cmd": "", "mock_subprocess": "", "op": "", "return_value": ""}, "variables_p": {"hive_cmd": [["str", 0.5032337893350641], ["Dict[str, Union[int, str]]", 0.1883707439939754], ["Union[Literal, str]", 0.1538236420023181], ["Dict[str, Union[Any, Any]]", 0.07788951647578213]], "mock_subprocess": [["Dict[str, Tuple[str, Any]]", 0.209635858390889]], "op": [["int", 0.24873353886831845], ["Pattern[Any]", 0.24664645362622328], ["Dict[str, str]", 0.08961407315823754], ["str", 0.08692621068129668], ["Dict[str, Dict[str, Any]]", 0.08676746360183588], ["dict", 0.08408713264861777]], "return_value": [["str", 0.7804479198572908], ["Dict[str, Union[int, str]]", 0.13577990220152364]]}}], "name": "TestHivePresto", "q_name": "TestHivePresto", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["__future__", "annotations", "os", "unittest", "mock", "pytest", "airflow", "configuration", "conf", "airflow", "models", "DagRun", "TaskInstance", "airflow", "providers", "apache", "hive", "operators", "hive", "HiveOperator", "airflow", "utils", "timezone", "tests", "providers", "apache", "hive", "DEFAULT_DATE", "MockSubProcess", "TestHiveEnvironment"], "mod_var_ln": {}, "mod_var_occur": {}, "no_types_annot": {"D": 0, "I": 0, "U": 51}, "session_id": "8qircGVtWQ6jpYOnm2Z71x7IISbF12gg1rOCk0gDCDI", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {}, "variables_p": {}}}