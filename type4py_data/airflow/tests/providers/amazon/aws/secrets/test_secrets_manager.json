{"error": null, "response": {"classes": [{"cls_lc": [[28, 0], [391, 9]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[30, 4], [33, 34]], "fn_var_ln": {"conn": [[32, 8], [32, 12]], "return_value": [[31, 8], [31, 35]]}, "fn_var_occur": {"conn": [["conn", "SecretsManagerBackend", "get_connection"], ["conn", "host"]], "return_value": [["mock_get_value", "return_value"]]}, "name": "test_aws_secrets_manager_get_connection", "params": {"mock_get_value": "", "self": ""}, "params_descr": {"mock_get_value": "", "self": ""}, "params_occur": {"mock_get_value": [["mock_get_value", "return_value"]], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_get_value": [["mock.MagicMock", 0.2024969688537127], ["bytes", 0.09008059462380279]], "self": []}, "q_name": "TestSecretsManagerBackend.test_aws_secrets_manager_get_connection", "ret_exprs": [], "ret_type": "", "variables": {"conn": "", "return_value": ""}, "variables_p": {"conn": [["float", 0.09627023242681115]], "return_value": [["str", 0.18912662088057908], ["List[Dict[str, Any]]", 0.18829514115232585], ["List[str]", 0.1503270106332012], ["Dict[str, Dict[str, Any]]", 0.12565892175924767], ["Dict[str, int]", 0.09822915448846747], ["Dict[str, Union[Any, Any, Any]]", 0.08630167051880366], ["List[Dict[str, str]]", 0.07972386934076722]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[36, 4], [52, 79]], "fn_var_ln": {"create_param": [[38, 8], [38, 20]], "param": [[42, 8], [42, 13]], "returned_uri": [[51, 8], [51, 20]], "secret_id": [[37, 8], [37, 17]], "secrets_manager_backend": [[47, 8], [47, 31]]}, "fn_var_occur": {"create_param": [["create_param", "secret_id"], ["secrets_manager_backend", "client", "create_secret", "create_param"]], "param": [["param", "secret_id"], ["secrets_manager_backend", "client", "put_secret_value", "param"]], "returned_uri": [["returned_uri", "secrets_manager_backend", "get_conn_value", "conn_id"]], "secret_id": [["create_param", "secret_id"], ["param", "secret_id"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend"], ["secrets_manager_backend", "client", "create_secret", "create_param"], ["secrets_manager_backend", "client", "put_secret_value", "param"], ["returned_uri", "secrets_manager_backend", "get_conn_value", "conn_id"]]}, "name": "test_get_conn_value_full_url_mode", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSecretsManagerBackend.test_get_conn_value_full_url_mode", "ret_exprs": [], "ret_type": "", "variables": {"create_param": "", "param": "", "returned_uri": "", "secret_id": "", "secrets_manager_backend": ""}, "variables_p": {"create_param": [["int", 0.32937913970633736], ["str", 0.2004352144649642], ["float", 0.09242988380690961]], "param": [["dict", 0.22827234010792485], ["str", 0.18577173729776847], ["Dict[str, Any]", 0.08953221740631817]], "returned_uri": [["str", 0.4380149883902241], ["Dict[str, List[str]]", 0.17744279819385275], ["Optional[str]", 0.11867752167164963], ["List[str]", 0.09867552689566203]], "secret_id": [["int", 0.3940292417279344], ["Set[str]", 0.12362462613058908], ["str", 0.10124329846255921], ["Pattern[Any]", 0.09219115486153552], ["list", 0.0917948183694836]], "secrets_manager_backend": [["int", 0.19690293589580693], ["str", 0.09820402570513795]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[62, 4], [93, 48]], "fn_var_ln": {"conn": [[87, 8], [87, 12]], "create_param": [[64, 8], [64, 20]], "param": [[68, 8], [68, 13]], "secret_id": [[63, 8], [63, 17]], "secrets_manager_backend": [[81, 8], [81, 31]]}, "fn_var_occur": {"conn": [["conn", "secrets_manager_backend", "get_connection", "conn_id"], ["conn", "login", "login"], ["conn", "password"], ["conn", "host", "host"], ["conn", "conn_id"], ["conn", "extra_dejson"]], "create_param": [["create_param", "secret_id"], ["secrets_manager_backend", "client", "create_secret", "create_param"]], "param": [["param", "secret_id", "json", "dumps", "json", "dumps"], ["secrets_manager_backend", "client", "put_secret_value", "param"]], "secret_id": [["create_param", "secret_id"], ["param", "secret_id", "json", "dumps", "json", "dumps"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend", "are_secret_values_urlencoded", "are_secret_values_urlencoded"], ["secrets_manager_backend", "client", "create_secret", "create_param"], ["secrets_manager_backend", "client", "put_secret_value", "param"], ["conn", "secrets_manager_backend", "get_connection", "conn_id"]]}, "name": "test_get_connection_broken_field_mode_url_encoding", "params": {"are_secret_values_urlencoded": "", "host": "", "login": "", "self": ""}, "params_descr": {"are_secret_values_urlencoded": "", "host": "", "login": "", "self": ""}, "params_occur": {"are_secret_values_urlencoded": [["secrets_manager_backend", "SecretsManagerBackend", "are_secret_values_urlencoded", "are_secret_values_urlencoded"]], "host": [["conn", "host", "host"]], "login": [["conn", "login", "login"]], "self": []}, "params_p": {"are_secret_values_urlencoded": [["str", 0.41198681042996177]], "args": [], "host": [["str", 0.6850446467998145], ["Optional[Callable[..., Any]]", 0.10597943910623274], ["int", 0.10217040344459535]], "kwargs": [], "login": [["List[str]", 0.11944383628782737], ["Tuple[float, float]", 0.10852938502882387], ["str", 0.08994384771810324]], "self": []}, "q_name": "TestSecretsManagerBackend.test_get_connection_broken_field_mode_url_encoding", "ret_exprs": [], "ret_type": "", "variables": {"conn": "", "create_param": "", "param": "", "secret_id": "", "secrets_manager_backend": ""}, "variables_p": {"conn": [["int", 0.2692717840367541], ["bytearray", 0.117077854907836]], "create_param": [["int", 0.32937913970633736], ["str", 0.2004352144649642], ["float", 0.09242988380690961]], "param": [["Dict[Any, int]", 0.19643888784099897], ["bool", 0.18978090623118982], ["dict", 0.18859095928970562], ["Dict[str, str]", 0.1326197647443042], ["Dict[str, Any]", 0.09918346244079206], ["Dict[str, Tuple[int, int, int, int]]", 0.09156691377278695]], "secret_id": [["dict", 0.5951293137694597]], "secrets_manager_backend": [["str", 0.34533259964495217]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[96, 4], [120, 48]], "fn_var_ln": {"conn": [[119, 8], [119, 12]], "create_param": [[98, 8], [98, 20]], "param": [[102, 8], [102, 13]], "secret_id": [[97, 8], [97, 17]], "secrets_manager_backend": [[115, 8], [115, 31]]}, "fn_var_occur": {"conn": [["conn", "secrets_manager_backend", "get_connection", "conn_id"], ["conn", "extra_dejson"]], "create_param": [["create_param", "secret_id"], ["secrets_manager_backend", "client", "create_secret", "create_param"]], "param": [["param", "secret_id", "json", "dumps"], ["secrets_manager_backend", "client", "put_secret_value", "param"]], "secret_id": [["create_param", "secret_id"], ["param", "secret_id", "json", "dumps"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend", "full_url_mode", "False"], ["secrets_manager_backend", "client", "create_secret", "create_param"], ["secrets_manager_backend", "client", "put_secret_value", "param"], ["conn", "secrets_manager_backend", "get_connection", "conn_id"]]}, "name": "test_get_connection_broken_field_mode_extra_allows_nested_json", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSecretsManagerBackend.test_get_connection_broken_field_mode_extra_allows_nested_json", "ret_exprs": [], "ret_type": "", "variables": {"conn": "", "create_param": "", "param": "", "secret_id": "", "secrets_manager_backend": ""}, "variables_p": {"conn": [["int", 0.17723703565863957], ["str", 0.11859582915053633], ["List[str]", 0.11370735303192459], ["bytearray", 0.1034036890388066], ["dict", 0.09797841903565241], ["list", 0.09536044146697405]], "create_param": [["int", 0.32937913970633736], ["str", 0.2004352144649642], ["float", 0.09242988380690961]], "param": [["bool", 0.10098049650207137], ["Dict[str, Any]", 0.0954500048691429], ["str", 0.09228473906176682], ["Dict[str, str]", 0.09219693758518799], ["dict", 0.09072022045557586]], "secret_id": [["set", 0.33518285515229396]], "secrets_manager_backend": []}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[123, 4], [141, 77]], "fn_var_ln": {"conn": [[139, 8], [139, 12]], "create_param": [[125, 8], [125, 20]], "param": [[129, 8], [129, 13]], "returned_uri": [[140, 8], [140, 20]], "secret_id": [[124, 8], [124, 17]], "secrets_manager_backend": [[135, 8], [135, 31]]}, "fn_var_occur": {"conn": [["conn", "secrets_manager_backend", "get_connection", "conn_id"], ["returned_uri", "conn", "get_uri"]], "create_param": [["create_param", "secret_id"], ["secrets_manager_backend", "client", "create_secret", "create_param"]], "param": [["param", "secret_id"], ["secrets_manager_backend", "client", "put_secret_value", "param"]], "returned_uri": [["returned_uri", "conn", "get_uri"]], "secret_id": [["create_param", "secret_id"], ["param", "secret_id"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend", "full_url_mode", "False"], ["secrets_manager_backend", "client", "create_secret", "create_param"], ["secrets_manager_backend", "client", "put_secret_value", "param"], ["conn", "secrets_manager_backend", "get_connection", "conn_id"]]}, "name": "test_get_conn_value_broken_field_mode", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSecretsManagerBackend.test_get_conn_value_broken_field_mode", "ret_exprs": [], "ret_type": "", "variables": {"conn": "", "create_param": "", "param": "", "returned_uri": "", "secret_id": "", "secrets_manager_backend": ""}, "variables_p": {"conn": [["Dict[str, str]", 0.10300695498546404], ["list", 0.10090698587059235], ["float", 0.09358444370701666], ["dict", 0.09179551654626503], ["str", 0.09050465693852035]], "create_param": [["int", 0.32937913970633736], ["str", 0.2004352144649642], ["float", 0.09242988380690961]], "param": [["dict", 0.22827234010792485], ["str", 0.18577173729776847], ["Dict[str, Any]", 0.08953221740631817]], "returned_uri": [["Tuple[Literal, Literal]", 0.2560974334184785], ["str", 0.11098087303614983], ["int", 0.08413504603717155]], "secret_id": [["int", 0.3940292417279344], ["Set[str]", 0.12362462613058908], ["str", 0.10124329846255921], ["Pattern[Any]", 0.09219115486153552], ["list", 0.0917948183694836]], "secrets_manager_backend": []}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[144, 4], [164, 77]], "fn_var_ln": {"conn": [[162, 8], [162, 12]], "create_param": [[146, 8], [146, 20]], "param": [[150, 8], [150, 13]], "returned_uri": [[163, 8], [163, 20]], "secret_id": [[145, 8], [145, 17]], "secrets_manager_backend": [[156, 8], [156, 31]]}, "fn_var_occur": {"conn": [["conn", "secrets_manager_backend", "get_connection", "conn_id"], ["returned_uri", "conn", "get_uri"]], "create_param": [["create_param", "secret_id"], ["secrets_manager_backend", "client", "create_secret", "create_param"]], "param": [["param", "secret_id"], ["secrets_manager_backend", "client", "put_secret_value", "param"]], "returned_uri": [["returned_uri", "conn", "get_uri"]], "secret_id": [["create_param", "secret_id"], ["param", "secret_id"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend", "full_url_mode", "False", "extra_conn_words"], ["secrets_manager_backend", "client", "create_secret", "create_param"], ["secrets_manager_backend", "client", "put_secret_value", "param"], ["conn", "secrets_manager_backend", "get_connection", "conn_id"]]}, "name": "test_get_conn_value_broken_field_mode_extra_words_added", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSecretsManagerBackend.test_get_conn_value_broken_field_mode_extra_words_added", "ret_exprs": [], "ret_type": "", "variables": {"conn": "", "create_param": "", "param": "", "returned_uri": "", "secret_id": "", "secrets_manager_backend": ""}, "variables_p": {"conn": [["Dict[str, str]", 0.10300695498546404], ["list", 0.10090698587059235], ["float", 0.09358444370701666], ["dict", 0.09179551654626503], ["str", 0.09050465693852035]], "create_param": [["int", 0.32937913970633736], ["str", 0.2004352144649642], ["float", 0.09242988380690961]], "param": [["dict", 0.22827234010792485], ["str", 0.18577173729776847], ["Dict[str, Any]", 0.08953221740631817]], "returned_uri": [["Tuple[Literal, Literal]", 0.2560974334184785], ["str", 0.11098087303614983], ["int", 0.08413504603717155]], "secret_id": [["int", 0.3940292417279344], ["Set[str]", 0.12362462613058908], ["str", 0.10124329846255921], ["Pattern[Any]", 0.09219115486153552], ["list", 0.0917948183694836]], "secrets_manager_backend": [["str", 0.08927650795345934]]}}, {"docstring": {"func": "Test that if the key with connection ID is not present,", "long_descr": "SecretsManagerBackend.get_connection should return None", "ret": null}, "fn_lc": [[167, 4], [189, 78]], "fn_var_ln": {"conn_id": [[172, 8], [172, 15]], "create_param": [[175, 8], [175, 20]], "param": [[179, 8], [179, 13]], "secret_id": [[174, 8], [174, 17]], "secrets_manager_backend": [[184, 8], [184, 31]]}, "fn_var_occur": {"conn_id": [["secrets_manager_backend", "get_conn_value", "conn_id", "conn_id", "None"], ["secrets_manager_backend", "get_connection", "conn_id", "conn_id", "None"]], "create_param": [["create_param", "secret_id"], ["secrets_manager_backend", "client", "create_secret", "create_param"]], "param": [["param", "secret_id"], ["secrets_manager_backend", "client", "put_secret_value", "param"]], "secret_id": [["create_param", "secret_id"], ["param", "secret_id"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend"], ["secrets_manager_backend", "client", "create_secret", "create_param"], ["secrets_manager_backend", "client", "put_secret_value", "param"], ["secrets_manager_backend", "get_conn_value", "conn_id", "conn_id", "None"], ["secrets_manager_backend", "get_connection", "conn_id", "conn_id", "None"]]}, "name": "test_get_conn_value_non_existent_key", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSecretsManagerBackend.test_get_conn_value_non_existent_key", "ret_exprs": [], "ret_type": "", "variables": {"conn_id": "", "create_param": "", "param": "", "secret_id": "", "secrets_manager_backend": ""}, "variables_p": {"conn_id": [["int", 0.5170640236663971], ["str", 0.1798046163239489], ["Optional[int]", 0.14193867491955603]], "create_param": [["int", 0.32937913970633736], ["str", 0.2004352144649642], ["float", 0.09242988380690961]], "param": [["dict", 0.22827234010792485], ["str", 0.18577173729776847], ["Dict[str, Any]", 0.08953221740631817]], "secret_id": [["int", 0.3940292417279344], ["Set[str]", 0.12362462613058908], ["str", 0.10124329846255921], ["Pattern[Any]", 0.09219115486153552], ["list", 0.0917948183694836]], "secrets_manager_backend": [["int", 0.19690293589580693], ["str", 0.09820402570513795]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[192, 4], [206, 38]], "fn_var_ln": {"create_param": [[195, 8], [195, 20]], "param": [[199, 8], [199, 13]], "returned_uri": [[205, 8], [205, 20]], "secret_id": [[194, 8], [194, 17]], "secrets_manager_backend": [[201, 8], [201, 31]]}, "fn_var_occur": {"create_param": [["create_param", "secret_id"], ["secrets_manager_backend", "client", "create_secret", "create_param"]], "param": [["param", "secret_id"], ["secrets_manager_backend", "client", "put_secret_value", "param"]], "returned_uri": [["returned_uri", "secrets_manager_backend", "get_variable"]], "secret_id": [["create_param", "secret_id"], ["param", "secret_id"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend"], ["secrets_manager_backend", "client", "create_secret", "create_param"], ["secrets_manager_backend", "client", "put_secret_value", "param"], ["returned_uri", "secrets_manager_backend", "get_variable"]]}, "name": "test_get_variable", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSecretsManagerBackend.test_get_variable", "ret_exprs": [], "ret_type": "", "variables": {"create_param": "", "param": "", "returned_uri": "", "secret_id": "", "secrets_manager_backend": ""}, "variables_p": {"create_param": [["int", 0.32937913970633736], ["str", 0.2004352144649642], ["float", 0.09242988380690961]], "param": [["dict", 0.22827234010792485], ["str", 0.18577173729776847], ["Dict[str, Any]", 0.08953221740631817]], "returned_uri": [["str", 0.7834913060743708], ["Optional[str]", 0.12039910175530251], ["List[str]", 0.09610959217032691]], "secret_id": [["int", 0.3940292417279344], ["Set[str]", 0.12362462613058908], ["str", 0.10124329846255921], ["Pattern[Any]", 0.09219115486153552], ["list", 0.0917948183694836]], "secrets_manager_backend": [["int", 0.19690293589580693], ["str", 0.09820402570513795]]}}, {"docstring": {"func": "Test that if Variable key is not present,", "long_descr": "SystemsManagerParameterStoreBackend.get_variables should return None", "ret": null}, "fn_lc": [[209, 4], [224, 73]], "fn_var_ln": {"create_param": [[215, 8], [215, 20]], "param": [[218, 8], [218, 13]], "secret_id": [[214, 8], [214, 17]], "secrets_manager_backend": [[220, 8], [220, 31]]}, "fn_var_occur": {"create_param": [["create_param", "secret_id"], ["secrets_manager_backend", "client", "create_secret", "create_param"]], "param": [["param", "secret_id"], ["secrets_manager_backend", "client", "put_secret_value", "param"]], "secret_id": [["create_param", "secret_id"], ["param", "secret_id"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend"], ["secrets_manager_backend", "client", "create_secret", "create_param"], ["secrets_manager_backend", "client", "put_secret_value", "param"], ["secrets_manager_backend", "get_variable", "None"]]}, "name": "test_get_variable_non_existent_key", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSecretsManagerBackend.test_get_variable_non_existent_key", "ret_exprs": [], "ret_type": "", "variables": {"create_param": "", "param": "", "secret_id": "", "secrets_manager_backend": ""}, "variables_p": {"create_param": [["int", 0.32937913970633736], ["str", 0.2004352144649642], ["float", 0.09242988380690961]], "param": [["dict", 0.22827234010792485], ["str", 0.18577173729776847], ["Dict[str, Any]", 0.08953221740631817]], "secret_id": [["int", 0.3940292417279344], ["Set[str]", 0.12362462613058908], ["str", 0.10124329846255921], ["Pattern[Any]", 0.09219115486153552], ["list", 0.0917948183694836]], "secrets_manager_backend": [["int", 0.19690293589580693], ["str", 0.09820402570513795]]}}, {"docstring": {"func": "Test that if Config key is not present,", "long_descr": "SystemsManagerParameterStoreBackend.get_config should return None", "ret": null}, "fn_lc": [[227, 4], [242, 65]], "fn_var_ln": {"create_param": [[233, 8], [233, 20]], "param": [[236, 8], [236, 13]], "secret_id": [[232, 8], [232, 17]], "secrets_manager_backend": [[238, 8], [238, 31]]}, "fn_var_occur": {"create_param": [["create_param", "secret_id"], ["secrets_manager_backend", "client", "create_secret", "create_param"]], "param": [["param", "secret_id"], ["secrets_manager_backend", "client", "put_secret_value", "param"]], "secret_id": [["create_param", "secret_id"], ["param", "secret_id"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend"], ["secrets_manager_backend", "client", "create_secret", "create_param"], ["secrets_manager_backend", "client", "put_secret_value", "param"], ["secrets_manager_backend", "get_config", "None"]]}, "name": "test_get_config_non_existent_key", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSecretsManagerBackend.test_get_config_non_existent_key", "ret_exprs": [], "ret_type": "", "variables": {"create_param": "", "param": "", "secret_id": "", "secrets_manager_backend": ""}, "variables_p": {"create_param": [["int", 0.32937913970633736], ["str", 0.2004352144649642], ["float", 0.09242988380690961]], "param": [["dict", 0.22827234010792485], ["str", 0.18577173729776847], ["Dict[str, Any]", 0.08953221740631817]], "secret_id": [["int", 0.3940292417279344], ["Set[str]", 0.12362462613058908], ["str", 0.10124329846255921], ["Pattern[Any]", 0.09219115486153552], ["list", 0.0917948183694836]], "secrets_manager_backend": [["int", 0.19690293589580693], ["str", 0.09820402570513795]]}}, {"docstring": {"func": "Test that if Connection ID is not present in AWS Secrets Manager,", "long_descr": "SecretsManagerBackend.get_conn_value should return None,\nSecretsManagerBackend._get_secret should not be called", "ret": null}, "fn_lc": [[245, 4], [256, 43]], "fn_var_ln": {"kwargs": [[251, 8], [251, 14]], "secrets_manager_backend": [[253, 8], [253, 31]]}, "fn_var_occur": {"kwargs": [["kwargs", "None"], ["secrets_manager_backend", "SecretsManagerBackend", "kwargs"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend", "kwargs"], ["secrets_manager_backend", "get_conn_value", "None"]]}, "name": "test_connection_prefix_none_value", "params": {"mock_get_secret": "", "self": ""}, "params_descr": {"mock_get_secret": "", "self": ""}, "params_occur": {"mock_get_secret": [["mock_get_secret", "assert_not_called"]], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_get_secret": [], "self": []}, "q_name": "TestSecretsManagerBackend.test_connection_prefix_none_value", "ret_exprs": [], "ret_type": "", "variables": {"kwargs": "", "secrets_manager_backend": ""}, "variables_p": {"kwargs": [["int", 0.2905496869743683], ["Type[str]", 0.12926307727597966]], "secrets_manager_backend": [["int", 0.2978334480495983], ["List[str]", 0.20086382421583326], ["str", 0.1786465659448247]]}}, {"docstring": {"func": "Test that if Variable key is not present in AWS Secrets Manager,", "long_descr": "SecretsManagerBackend.get_variables should return None,\nSecretsManagerBackend._get_secret should not be called", "ret": null}, "fn_lc": [[259, 4], [270, 43]], "fn_var_ln": {"kwargs": [[265, 8], [265, 14]], "secrets_manager_backend": [[267, 8], [267, 31]]}, "fn_var_occur": {"kwargs": [["kwargs", "None"], ["secrets_manager_backend", "SecretsManagerBackend", "kwargs"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend", "kwargs"], ["secrets_manager_backend", "get_variable", "None"]]}, "name": "test_variable_prefix_none_value", "params": {"mock_get_secret": "", "self": ""}, "params_descr": {"mock_get_secret": "", "self": ""}, "params_occur": {"mock_get_secret": [["mock_get_secret", "assert_not_called"]], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_get_secret": [], "self": []}, "q_name": "TestSecretsManagerBackend.test_variable_prefix_none_value", "ret_exprs": [], "ret_type": "", "variables": {"kwargs": "", "secrets_manager_backend": ""}, "variables_p": {"kwargs": [["int", 0.2905496869743683], ["Type[str]", 0.12926307727597966]], "secrets_manager_backend": [["int", 0.2941529454695845], ["List[str]", 0.21674998796246495], ["str", 0.16858094549677], ["list", 0.08338518992807474]]}}, {"docstring": {"func": "Test that if Config key is not present in AWS Secrets Manager,", "long_descr": "SecretsManagerBackend.get_config should return None,\nSecretsManagerBackend._get_secret should not be called", "ret": null}, "fn_lc": [[273, 4], [284, 43]], "fn_var_ln": {"kwargs": [[279, 8], [279, 14]], "secrets_manager_backend": [[281, 8], [281, 31]]}, "fn_var_occur": {"kwargs": [["kwargs", "None"], ["secrets_manager_backend", "SecretsManagerBackend", "kwargs"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend", "kwargs"], ["secrets_manager_backend", "get_config", "None"]]}, "name": "test_config_prefix_none_value", "params": {"mock_get_secret": "", "self": ""}, "params_descr": {"mock_get_secret": "", "self": ""}, "params_occur": {"mock_get_secret": [["mock_get_secret", "assert_not_called"]], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_get_secret": [], "self": []}, "q_name": "TestSecretsManagerBackend.test_config_prefix_none_value", "ret_exprs": [], "ret_type": "", "variables": {"kwargs": "", "secrets_manager_backend": ""}, "variables_p": {"kwargs": [["int", 0.2905496869743683], ["Type[str]", 0.12926307727597966]], "secrets_manager_backend": [["List[str]", 0.24486873086597896], ["list", 0.1085237162543456], ["str", 0.09758980546687132], ["int", 0.08823073200815243]]}}, {"docstring": {"func": "Test that if Connection ID is looked up in AWS Secrets Manager", "long_descr": null, "ret": null}, "fn_lc": [[300, 4], [311, 76]], "fn_var_ln": {"kwargs": [[307, 8], [307, 14]], "secrets_manager_backend": [[309, 8], [309, 31]]}, "fn_var_occur": {"kwargs": [["kwargs", "connections_lookup_pattern"], ["secrets_manager_backend", "SecretsManagerBackend", "kwargs"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend", "kwargs"], ["secrets_manager_backend", "get_conn_value", "connection_id"]]}, "name": "test_connection_lookup_pattern", "params": {"connection_id": "", "connections_lookup_pattern": "", "mock_client": "", "num_client_calls": "", "self": ""}, "params_descr": {"connection_id": "", "connections_lookup_pattern": "", "mock_client": "", "num_client_calls": "", "self": ""}, "params_occur": {"connection_id": [["secrets_manager_backend", "get_conn_value", "connection_id"]], "connections_lookup_pattern": [["kwargs", "connections_lookup_pattern"]], "mock_client": [["mock_client", "get_secret_value", "return_value", "None"], ["mock_client", "get_secret_value", "call_count", "num_client_calls"]], "num_client_calls": [["mock_client", "get_secret_value", "call_count", "num_client_calls"]], "self": []}, "params_p": {"args": [], "connection_id": [], "connections_lookup_pattern": [["str", 0.32685676332582775], ["Callable[[List, bool], None]", 0.09651104034852931], ["Type", 0.09488868533687948]], "kwargs": [], "mock_client": [], "num_client_calls": [["mock.MagicMock", 0.12027908841041138]], "self": []}, "q_name": "TestSecretsManagerBackend.test_connection_lookup_pattern", "ret_exprs": [], "ret_type": "", "variables": {"kwargs": "", "secrets_manager_backend": ""}, "variables_p": {"kwargs": [["dict", 0.21690574385828043], ["int", 0.1785614189286051], ["bool", 0.10784323843079123], ["list", 0.10345560452029852], ["List[Dict[str, str]]", 0.09251149035789663], ["List[str]", 0.09251149035789663]], "secrets_manager_backend": [["str", 0.2674041002098117], ["int", 0.20841579684993844], ["List[str]", 0.20824280848009144]]}}, {"docstring": {"func": "Test that if Variable key is looked up in AWS Secrets Manager", "long_descr": null, "ret": null}, "fn_lc": [[327, 4], [338, 76]], "fn_var_ln": {"kwargs": [[334, 8], [334, 14]], "secrets_manager_backend": [[336, 8], [336, 31]]}, "fn_var_occur": {"kwargs": [["kwargs", "variables_lookup_pattern"], ["secrets_manager_backend", "SecretsManagerBackend", "kwargs"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend", "kwargs"], ["secrets_manager_backend", "get_variable", "variable_key"]]}, "name": "test_variable_lookup_pattern", "params": {"mock_client": "", "num_client_calls": "", "self": "", "variable_key": "", "variables_lookup_pattern": ""}, "params_descr": {"mock_client": "", "num_client_calls": "", "self": "", "variable_key": "", "variables_lookup_pattern": ""}, "params_occur": {"mock_client": [["mock_client", "get_secret_value", "return_value", "None"], ["mock_client", "get_secret_value", "call_count", "num_client_calls"]], "num_client_calls": [["mock_client", "get_secret_value", "call_count", "num_client_calls"]], "self": [], "variable_key": [["secrets_manager_backend", "get_variable", "variable_key"]], "variables_lookup_pattern": [["kwargs", "variables_lookup_pattern"]]}, "params_p": {"args": [], "kwargs": [], "mock_client": [], "num_client_calls": [], "self": [], "variable_key": [["str", 0.6090274332567839]], "variables_lookup_pattern": [["int", 0.4961836350095823], ["str", 0.09294949446805198], ["dict", 0.09294949446805198]]}, "q_name": "TestSecretsManagerBackend.test_variable_lookup_pattern", "ret_exprs": [], "ret_type": "", "variables": {"kwargs": "", "secrets_manager_backend": ""}, "variables_p": {"kwargs": [["Exception", 0.1796360502811084], ["int", 0.15052928929050108], ["Dict[str, str]", 0.10252938937180985], ["memoryview", 0.09557335601268263], ["RuntimeError", 0.08903055360218953], ["str", 0.08861633384940464], ["dict", 0.08508275554117829]], "secrets_manager_backend": [["str", 0.25641197473372973], ["int", 0.23200119526663915], ["List[str]", 0.1907930089158301], ["list", 0.09497062713864526]]}}, {"docstring": {"func": "Test that if Variable key is looked up in AWS Secrets Manager", "long_descr": null, "ret": null}, "fn_lc": [[354, 4], [363, 76]], "fn_var_ln": {"kwargs": [[359, 8], [359, 14]], "secrets_manager_backend": [[361, 8], [361, 31]]}, "fn_var_occur": {"kwargs": [["kwargs", "config_lookup_pattern"], ["secrets_manager_backend", "SecretsManagerBackend", "kwargs"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend", "kwargs"], ["secrets_manager_backend", "get_config", "config_key"]]}, "name": "test_config_lookup_pattern", "params": {"config_key": "", "config_lookup_pattern": "", "mock_client": "", "num_client_calls": "", "self": ""}, "params_descr": {"config_key": "", "config_lookup_pattern": "", "mock_client": "", "num_client_calls": "", "self": ""}, "params_occur": {"config_key": [["secrets_manager_backend", "get_config", "config_key"]], "config_lookup_pattern": [["kwargs", "config_lookup_pattern"]], "mock_client": [["mock_client", "get_secret_value", "return_value", "None"], ["mock_client", "get_secret_value", "call_count", "num_client_calls"]], "num_client_calls": [["mock_client", "get_secret_value", "call_count", "num_client_calls"]], "self": []}, "params_p": {"args": [], "config_key": [["IO[str]", 0.10836438676518866], ["str", 0.0917131615204049]], "config_lookup_pattern": [["dict", 0.10001188117037262], ["str", 0.09171361716742786]], "kwargs": [], "mock_client": [], "num_client_calls": [], "self": []}, "q_name": "TestSecretsManagerBackend.test_config_lookup_pattern", "ret_exprs": [], "ret_type": "", "variables": {"kwargs": "", "secrets_manager_backend": ""}, "variables_p": {"kwargs": [["int", 0.10701586582852812], ["Tuple[dict]", 0.09553255066915053], ["List[str]", 0.0953601558300941], ["bool", 0.09431276503324106]], "secrets_manager_backend": [["List[str]", 0.22939869329649995], ["list", 0.1061441005451159], ["str", 0.10514421625023025], ["int", 0.09763992497022217], ["List[Tuple[Any, Any]]", 0.08388707290285866]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[366, 4], [391, 9]], "fn_var_ln": {"client": [[375, 8], [375, 27]], "conn_wrapper": [[383, 8], [383, 20]], "create_session": [[377, 8], [377, 52]], "mock_create_session": [[376, 8], [376, 27]], "mock_session": [[374, 8], [374, 20]], "mock_session_factory_call_kwargs": [[381, 8], [381, 40]], "mock_session_factory_instance": [[372, 8], [372, 37]], "mock_ssm_client": [[373, 8], [373, 23]], "secrets_manager_backend": [[367, 8], [367, 31]]}, "fn_var_occur": {"client": [["mock_session", "client", "mock_ssm_client"], ["secrets_manager_backend", "client"]], "conn_wrapper": [["conn_wrapper", "mock_session_factory_call_kwargs"], ["conn_wrapper", "conn_id"], ["conn_wrapper", "role_arn"], ["conn_wrapper", "region_name"]], "create_session": [["mock_session_factory_instance", "create_session", "mock_create_session"]], "mock_create_session": [["mock_create_session", "mock", "MagicMock", "return_value", "mock_session"], ["mock_session_factory_instance", "create_session", "mock_create_session"]], "mock_session": [["mock_session", "mock", "MagicMock"], ["mock_session", "client", "mock_ssm_client"], ["mock_create_session", "mock", "MagicMock", "return_value", "mock_session"]], "mock_session_factory_call_kwargs": [["mock_session_factory_call_kwargs", "mock_session_factory", "call_args", "kwargs"], ["conn_wrapper", "mock_session_factory_call_kwargs"]], "mock_session_factory_instance": [["mock_session_factory_instance", "mock_session_factory", "return_value"], ["mock_session_factory_instance", "create_session", "mock_create_session"]], "mock_ssm_client": [["mock_ssm_client", "mock", "MagicMock", "return_value"], ["mock_session", "client", "mock_ssm_client"], ["mock_ssm_client", "assert_called_once_with", "service_name", "region_name", "use_ssl", "False"]], "secrets_manager_backend": [["secrets_manager_backend", "SecretsManagerBackend", "use_ssl", "False", "role_arn", "region_name"], ["secrets_manager_backend", "client"]]}, "name": "test_passing_client_kwargs", "params": {"mock_session_factory": "", "self": ""}, "params_descr": {"mock_session_factory": "", "self": ""}, "params_occur": {"mock_session_factory": [["mock_session_factory_instance", "mock_session_factory", "return_value"], ["mock_session_factory", "call_count"], ["mock_session_factory_call_kwargs", "mock_session_factory", "call_args", "kwargs"]], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_session_factory": [["mock.MagicMock", 0.19456467526363752]], "self": []}, "q_name": "TestSecretsManagerBackend.test_passing_client_kwargs", "ret_exprs": [], "ret_type": "", "variables": {"client": "", "conn_wrapper": "", "create_session": "", "mock_create_session": "", "mock_session": "", "mock_session_factory_call_kwargs": "", "mock_session_factory_instance": "", "mock_ssm_client": "", "secrets_manager_backend": ""}, "variables_p": {"client": [], "conn_wrapper": [["str", 0.5450536402778225], ["int", 0.0831012741020358]], "create_session": [["str", 0.3911529790045585], ["Dict[str, Dict[str, Any]]", 0.19236699389762046], ["Dict[str, Union[None, Any, int]]", 0.11039056244905537], ["List[Dict[str, str]]", 0.09699516058911854], ["Dict[str, str]", 0.09148852931848561]], "mock_create_session": [["mock.Mock", 0.10028717455281906]], "mock_session": [["mock.Mock", 0.09088931793771951]], "mock_session_factory_call_kwargs": [["str", 0.5977697517356289], ["int", 0.12491399653177232], ["List[Dict[str, str]]", 0.07458531709253667]], "mock_session_factory_instance": [["Dict[str, List[Any]]", 0.21193341324778645], ["List[str]", 0.20384651336863405], ["str", 0.15980536484084865], ["List[Tuple[str, Any]]", 0.13541420639708188], ["list", 0.09590904406980671]], "mock_ssm_client": [["mock.Mock", 0.7908959431693692], ["mock.MagicMock", 0.09490380098863818]], "secrets_manager_backend": [["str", 0.7145345236378475], ["List[Dict[str, Any]]", 0.10049896904725365], ["int", 0.09664755628759275]]}}], "name": "TestSecretsManagerBackend", "q_name": "TestSecretsManagerBackend", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["__future__", "annotations", "json", "unittest", "mock", "pytest", "moto", "mock_secretsmanager", "airflow", "providers", "amazon", "aws", "secrets", "secrets_manager", "SecretsManagerBackend"], "mod_var_ln": {}, "mod_var_occur": {}, "no_types_annot": {"D": 0, "I": 0, "U": 105}, "session_id": "jN2IiHW0qGyGClZBFPsBnBYKk2z2LH3epiiiuntFOGY", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {}, "variables_p": {}}}