{"error": null, "response": {"classes": [{"cls_lc": [[41, 0], [160, 62]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[42, 4], [56, 9]], "fn_var_ln": {"emr_container": [[45, 8], [45, 26]]}, "fn_var_occur": {"emr_container": [["self", "emr_container", "EmrContainerOperator", "task_id", "name", "virtual_cluster_id", "execution_role_arn", "release_label", "job_driver", "configuration_overrides", "poll_interval", "client_request_token", "GENERATED_UUID", "tags"]]}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "emr_container", "EmrContainerOperator", "task_id", "name", "virtual_cluster_id", "execution_role_arn", "release_label", "job_driver", "configuration_overrides", "poll_interval", "client_request_token", "GENERATED_UUID", "tags"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestEmrContainerOperator.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"emr_container": ""}, "variables_p": {"emr_container": [["str", 1.0]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[60, 4], [74, 65]], "fn_var_ln": {"return_value": [[66, 8], [66, 44]]}, "fn_var_occur": {"return_value": [["mock_submit_job", "return_value"], ["mock_check_query_status", "return_value"]]}, "name": "test_execute_without_failure", "params": {"mock_check_query_status": "", "mock_submit_job": "", "self": ""}, "params_descr": {"mock_check_query_status": "", "mock_submit_job": "", "self": ""}, "params_occur": {"mock_check_query_status": [["mock_check_query_status", "return_value"], ["mock_check_query_status", "assert_called_once_with"]], "mock_submit_job": [["mock_submit_job", "return_value"], ["mock_submit_job", "assert_called_once_with", "GENERATED_UUID"]], "self": [["self", "emr_container", "execute", "None"], ["self", "emr_container", "release_label"]]}, "params_p": {"args": [], "kwargs": [], "mock_check_query_status": [["unittesmock.MagicMock", 0.9999999999999999]], "mock_submit_job": [["unittesmock.MagicMock", 0.7267315371402298]], "self": []}, "q_name": "TestEmrContainerOperator.test_execute_without_failure", "ret_exprs": [], "ret_type": "", "variables": {"return_value": ""}, "variables_p": {"return_value": [["str", 0.24817949449837207], ["int", 0.12601752922295067], ["Optional[bytes]", 0.10477414017586131], ["Dict[str, Any]", 0.0698704010168187], ["Dict[str, str]", 0.066441457547688]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[81, 4], [94, 58]], "fn_var_ln": {"boto3_session_mock": [[87, 8], [87, 26]], "emr_client_mock": [[83, 8], [83, 23]], "emr_session_mock": [[85, 8], [85, 24]], "return_value": [[92, 12], [92, 40]]}, "fn_var_occur": {"boto3_session_mock": [["boto3_session_mock", "MagicMock", "return_value", "emr_session_mock"], ["patch", "boto3_session_mock"]], "emr_client_mock": [["emr_client_mock", "MagicMock"], ["emr_client_mock", "start_job_run", "return_value", "SUBMIT_JOB_SUCCESS_RETURN"], ["emr_session_mock", "client", "return_value", "emr_client_mock"]], "emr_session_mock": [["emr_session_mock", "MagicMock"], ["emr_session_mock", "client", "return_value", "emr_client_mock"], ["boto3_session_mock", "MagicMock", "return_value", "emr_session_mock"]], "return_value": [["emr_client_mock", "start_job_run", "return_value", "SUBMIT_JOB_SUCCESS_RETURN"], ["emr_session_mock", "client", "return_value", "emr_client_mock"], ["boto3_session_mock", "MagicMock", "return_value", "emr_session_mock"], ["mock_isinstance", "return_value", "True"]]}, "name": "test_execute_with_polling", "params": {"mock_check_query_status": "", "self": ""}, "params_descr": {"mock_check_query_status": "", "self": ""}, "params_occur": {"mock_check_query_status": [["mock_check_query_status", "call_count"]], "self": [["self", "emr_container", "execute", "None"]]}, "params_p": {"args": [], "kwargs": [], "mock_check_query_status": [["str", 0.18543395572929264], ["List[str]", 0.11944320794749028], ["bytes", 0.11187663948239035], ["unittesmock.MagicMock", 0.09348892346498842]], "self": []}, "q_name": "TestEmrContainerOperator.test_execute_with_polling", "ret_exprs": [], "ret_type": "", "variables": {"boto3_session_mock": "", "emr_client_mock": "", "emr_session_mock": "", "return_value": ""}, "variables_p": {"boto3_session_mock": [["mock.Mock", 0.3182662530929859], ["unittesmock.MagicMock", 0.20139692413462165]], "emr_client_mock": [["unittesmock.MagicMock", 0.8006811518253517]], "emr_session_mock": [["unittesmock.MagicMock", 0.6596726437163132]], "return_value": [["int", 0.23450810389908164], ["tests.mock.zwave.MockNode", 0.10653318044595393], ["mock.Mock", 0.10208559060459399], ["list", 0.08741471538575858], ["Dict[str, Union[Any, Any]]", 0.07699654608792968]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[99, 4], [110, 101]], "fn_var_ln": {"return_value": [[104, 8], [104, 48]]}, "fn_var_occur": {"return_value": [["mock_submit_job", "return_value"], ["mock_check_query_status", "return_value"], ["mock_get_job_failure_reason", "return_value"]]}, "name": "test_execute_with_failure", "params": {"mock_check_query_status": "", "mock_get_job_failure_reason": "", "mock_submit_job": "", "self": ""}, "params_descr": {"mock_check_query_status": "", "mock_get_job_failure_reason": "", "mock_submit_job": "", "self": ""}, "params_occur": {"mock_check_query_status": [["mock_check_query_status", "return_value"]], "mock_get_job_failure_reason": [["mock_get_job_failure_reason", "return_value"]], "mock_submit_job": [["mock_submit_job", "return_value"]], "self": [["self", "emr_container", "execute", "None"]]}, "params_p": {"args": [], "kwargs": [], "mock_check_query_status": [["unittesmock.MagicMock", 0.8825488280048602]], "mock_get_job_failure_reason": [["unittesmock.MagicMock", 0.7082454506151754]], "mock_submit_job": [["unittesmock.MagicMock", 0.38842895820556766], ["mock.Mock", 0.31895697862948724]], "self": []}, "q_name": "TestEmrContainerOperator.test_execute_with_failure", "ret_exprs": [], "ret_type": "", "variables": {"return_value": ""}, "variables_p": {"return_value": [["str", 0.166466349739534], ["int", 0.10668723982899735], ["Optional[bytes]", 0.09979006169423335], ["Dict[str, Any]", 0.09473660798846559], ["List[Dict[str, str]]", 0.08594132123401672], ["Dict[str, List[Any]]", 0.0844144414104605]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[117, 4], [146, 72]], "fn_var_ln": {"boto3_session_mock": [[123, 8], [123, 26]], "emr_client_mock": [[119, 8], [119, 23]], "emr_session_mock": [[121, 8], [121, 24]], "return_value": [[140, 12], [140, 40]], "timeout_container": [[125, 8], [125, 25]]}, "fn_var_occur": {"boto3_session_mock": [["boto3_session_mock", "MagicMock", "return_value", "emr_session_mock"], ["patch", "boto3_session_mock"]], "emr_client_mock": [["emr_client_mock", "MagicMock"], ["emr_client_mock", "start_job_run", "return_value", "SUBMIT_JOB_SUCCESS_RETURN"], ["emr_session_mock", "client", "return_value", "emr_client_mock"]], "emr_session_mock": [["emr_session_mock", "MagicMock"], ["emr_session_mock", "client", "return_value", "emr_client_mock"], ["boto3_session_mock", "MagicMock", "return_value", "emr_session_mock"]], "return_value": [["emr_client_mock", "start_job_run", "return_value", "SUBMIT_JOB_SUCCESS_RETURN"], ["emr_session_mock", "client", "return_value", "emr_client_mock"], ["boto3_session_mock", "MagicMock", "return_value", "emr_session_mock"], ["mock_isinstance", "return_value", "True"]], "timeout_container": [["timeout_container", "EmrContainerOperator", "task_id", "name", "virtual_cluster_id", "execution_role_arn", "release_label", "job_driver", "configuration_overrides", "poll_interval", "max_polling_attempts"], ["timeout_container", "execute", "None"]]}, "name": "test_execute_with_polling_timeout", "params": {"mock_check_query_status": "", "self": ""}, "params_descr": {"mock_check_query_status": "", "self": ""}, "params_occur": {"mock_check_query_status": [["mock_check_query_status", "call_count"]], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_check_query_status": [["str", 0.2031699039885525], ["unittesmock.MagicMock", 0.10026348696867908]], "self": []}, "q_name": "TestEmrContainerOperator.test_execute_with_polling_timeout", "ret_exprs": [], "ret_type": "", "variables": {"boto3_session_mock": "", "emr_client_mock": "", "emr_session_mock": "", "return_value": "", "timeout_container": ""}, "variables_p": {"boto3_session_mock": [["mock.Mock", 0.3182662530929859], ["unittesmock.MagicMock", 0.20139692413462165]], "emr_client_mock": [["unittesmock.MagicMock", 0.8006811518253517]], "emr_session_mock": [["unittesmock.MagicMock", 0.6596726437163132]], "return_value": [["int", 0.23450810389908164], ["tests.mock.zwave.MockNode", 0.10653318044595393], ["mock.Mock", 0.10208559060459399], ["list", 0.08741471538575858], ["Dict[str, Union[Any, Any]]", 0.07699654608792968]], "timeout_container": [["str", 0.6829544080827553], ["Dict[int, List[str]]", 0.0949434268839856]]}}, {"docstring": {"func": "Test the execute method raise TaskDeferred if running operator in deferrable mode", "long_descr": null, "ret": null}, "fn_lc": [[152, 4], [160, 62]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_operator_defer", "params": {"mock_check_query_status": "", "mock_submit_job": "", "self": ""}, "params_descr": {"mock_check_query_status": "", "mock_submit_job": "", "self": ""}, "params_occur": {"mock_check_query_status": [], "mock_submit_job": [], "self": [["self", "emr_container", "deferrable", "True"], ["self", "emr_container", "wait_for_completion", "False"], ["self", "emr_container", "execute", "context", "None"]]}, "params_p": {"args": [], "kwargs": [], "mock_check_query_status": [["int", 0.08344945854259847], ["str", 0.08275536345026932]], "mock_submit_job": [["int", 0.08344945854259847], ["str", 0.08275536345026932]], "self": []}, "q_name": "TestEmrContainerOperator.test_operator_defer", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}], "name": "TestEmrContainerOperator", "q_name": "TestEmrContainerOperator", "variables": {}, "variables_p": {}}, {"cls_lc": [[163, 0], [197, 55]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[164, 4], [173, 9]], "fn_var_ln": {"emr_container": [[167, 8], [167, 26]]}, "fn_var_occur": {"emr_container": [["self", "emr_container", "EmrEksCreateClusterOperator", "task_id", "virtual_cluster_name", "eks_cluster_name", "eks_namespace", "tags"]]}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "emr_container", "EmrEksCreateClusterOperator", "task_id", "virtual_cluster_name", "eks_cluster_name", "eks_namespace", "tags"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestEmrEksCreateClusterOperator.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"emr_container": ""}, "variables_p": {"emr_container": [["str", 0.9999999999999999]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[176, 4], [184, 80]], "fn_var_ln": {"return_value": [[177, 8], [177, 51]]}, "fn_var_occur": {"return_value": [["mock_create_emr_on_eks_cluster", "return_value"]]}, "name": "test_emr_on_eks_execute_without_failure", "params": {"mock_create_emr_on_eks_cluster": "", "self": ""}, "params_descr": {"mock_create_emr_on_eks_cluster": "", "self": ""}, "params_occur": {"mock_create_emr_on_eks_cluster": [["mock_create_emr_on_eks_cluster", "return_value"], ["mock_create_emr_on_eks_cluster", "assert_called_once_with"]], "self": [["self", "emr_container", "execute", "None"], ["self", "emr_container", "virtual_cluster_name"]]}, "params_p": {"args": [], "kwargs": [], "mock_create_emr_on_eks_cluster": [["unittesmock.MagicMock", 0.4073062886986319], ["mock.MagicMock", 0.08409748729249311]], "self": []}, "q_name": "TestEmrEksCreateClusterOperator.test_emr_on_eks_execute_without_failure", "ret_exprs": [], "ret_type": "", "variables": {"return_value": ""}, "variables_p": {"return_value": [["str", 0.4511004106759899], ["Dict[str, Any]", 0.09672108744655274], ["int", 0.09530715585156445], ["list", 0.0896465202879886]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[187, 4], [197, 55]], "fn_var_ln": {"expected_exception_msg": [[188, 8], [188, 30]], "side_effect": [[194, 8], [194, 50]]}, "fn_var_occur": {"expected_exception_msg": [["mock_create_emr_on_eks_cluster", "side_effect", "AirflowException", "expected_exception_msg"], ["expected_exception_msg", "str", "ctx", "value"]], "side_effect": [["mock_create_emr_on_eks_cluster", "side_effect", "AirflowException", "expected_exception_msg"]]}, "name": "test_emr_on_eks_execute_with_failure", "params": {"mock_create_emr_on_eks_cluster": "", "self": ""}, "params_descr": {"mock_create_emr_on_eks_cluster": "", "self": ""}, "params_occur": {"mock_create_emr_on_eks_cluster": [["mock_create_emr_on_eks_cluster", "side_effect", "AirflowException", "expected_exception_msg"]], "self": [["self", "emr_container", "execute", "None"]]}, "params_p": {"args": [], "kwargs": [], "mock_create_emr_on_eks_cluster": [], "self": []}, "q_name": "TestEmrEksCreateClusterOperator.test_emr_on_eks_execute_with_failure", "ret_exprs": [], "ret_type": "", "variables": {"expected_exception_msg": "", "side_effect": ""}, "variables_p": {"expected_exception_msg": [["str", 0.904218367009656], ["Dict[str, Set[str]]", 0.09578163299034415]], "side_effect": [["str", 0.5079343203391776], ["Dict[str, List[Any]]", 0.1095756259265884], ["Dict[str, Dict[str, Any]]", 0.09801852893200384]]}}], "name": "TestEmrEksCreateClusterOperator", "q_name": "TestEmrEksCreateClusterOperator", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["__future__", "annotations", "unittest", "mock", "unittest", "mock", "MagicMock", "patch", "pytest", "airflow", "configuration", "conf", "airflow", "exceptions", "AirflowException", "TaskDeferred", "airflow", "providers", "amazon", "aws", "hooks", "emr", "EmrContainerHook", "airflow", "providers", "amazon", "aws", "operators", "emr", "EmrContainerOperator", "EmrEksCreateClusterOperator", "airflow", "providers", "amazon", "aws", "triggers", "emr", "EmrContainerTrigger"], "mod_var_ln": {"CREATE_EMR_ON_EKS_CLUSTER_RETURN": [[36, 0], [36, 32]], "GENERATED_UUID": [[38, 0], [38, 14]], "SUBMIT_JOB_SUCCESS_RETURN": [[30, 0], [30, 25]]}, "mod_var_occur": {"CREATE_EMR_ON_EKS_CLUSTER_RETURN": [], "GENERATED_UUID": [["self", "emr_container", "EmrContainerOperator", "task_id", "name", "virtual_cluster_id", "execution_role_arn", "release_label", "job_driver", "configuration_overrides", "poll_interval", "client_request_token", "GENERATED_UUID", "tags"], ["mock_submit_job", "assert_called_once_with", "GENERATED_UUID"]], "SUBMIT_JOB_SUCCESS_RETURN": [["emr_client_mock", "start_job_run", "return_value", "SUBMIT_JOB_SUCCESS_RETURN"], ["emr_client_mock", "start_job_run", "return_value", "SUBMIT_JOB_SUCCESS_RETURN"]]}, "no_types_annot": {"D": 0, "I": 0, "U": 39}, "session_id": "Xmd6zMt79RxMtVvWMFISx4RacsWJVLNOwingRLs5ils", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"CREATE_EMR_ON_EKS_CLUSTER_RETURN": "", "GENERATED_UUID": "", "SUBMIT_JOB_SUCCESS_RETURN": ""}, "variables_p": {"CREATE_EMR_ON_EKS_CLUSTER_RETURN": [["int", 0.7999999999999999], ["Tuple[int, int]", 0.1], ["property", 0.1]], "GENERATED_UUID": [["str", 0.6327704548053588], ["List[str]", 0.09031015532266061]], "SUBMIT_JOB_SUCCESS_RETURN": [["int", 0.36895528000076455], ["List[str]", 0.15208556169536389], ["List[List[int]]", 0.13697995545808672], ["Dict[str, Union[None, Any, Any]]", 0.0859699921383044], ["List[int]", 0.08101331401726061], ["str", 0.08004017265795839]]}}}