{"error": null, "response": {"classes": [{"cls_lc": [[36, 0], [152, 38]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[37, 4], [45, 39]], "fn_var_ln": {"bio": [[42, 8], [42, 16]], "bucket": [[39, 8], [39, 19]], "content": [[38, 8], [38, 20]], "input_key": [[40, 8], [40, 22]], "output_key": [[41, 8], [41, 23]], "tmp_dir": [[43, 8], [43, 20]], "transform_script": [[44, 8], [44, 29]]}, "fn_var_occur": {"bio": [["self", "bio", "io", "BytesIO", "self", "content"]], "bucket": [["self", "bucket"]], "content": [["self", "content"], ["self", "bio", "io", "BytesIO", "self", "content"]], "input_key": [["self", "input_key"]], "output_key": [["self", "output_key"]], "tmp_dir": [["self", "tmp_dir", "mkdtemp", "prefix"], ["self", "transform_script", "os", "path", "join", "self", "tmp_dir"]], "transform_script": [["self", "transform_script", "os", "path", "join", "self", "tmp_dir"], ["os", "mknod", "self", "transform_script"]]}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "content"], ["self", "bucket"], ["self", "input_key"], ["self", "output_key"], ["self", "bio", "io", "BytesIO", "self", "content"], ["self", "tmp_dir", "mkdtemp", "prefix"], ["self", "transform_script", "os", "path", "join", "self", "tmp_dir"], ["os", "mknod", "self", "transform_script"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestS3FileTransformOperator.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"bio": "", "bucket": "", "content": "", "input_key": "", "output_key": "", "tmp_dir": "", "transform_script": ""}, "variables_p": {"bio": [["os.stat_result", 0.6862430391544245], ["bytes", 0.22388087305810864], ["io.StringIO", 0.08987608778746674]], "bucket": [["bytes", 0.4997365223697067], ["str", 0.26782073667321993], ["float", 0.19463311351695292], ["Type[Callable[..., Any]]", 0.037809627440120494]], "content": [["bytes", 0.3318789043342451], ["io.TextIOWrapper", 0.14753278654440385], ["str", 0.10424281324742894], ["Tuple[int]", 0.09901279878887938]], "input_key": [["str", 0.7366991183764883], ["Union[str, int]", 0.164675390815231], ["int", 0.09862549080828073]], "output_key": [["str", 0.7211244824988372], ["int", 0.10131432930225284], ["bytes", 0.08657832226346876]], "tmp_dir": [["str", 1.0]], "transform_script": [["str", 0.7209397775367185], ["Callable(os.path.join)[..., Any][[[Named(a, Union[_PathLike[str], str]), Variable(Union[_PathLike[str], str])], str][Any, Any]]", 0.18562837055618936], ["int", 0.09343185190709213]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[47, 4], [53, 23]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "teardown_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["shutil", "rmtree", "self", "tmp_dir"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestS3FileTransformOperator.teardown_method", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[58, 4], [74, 9]], "fn_var_ln": {"input_path": [[61, 8], [61, 18]], "op": [[63, 8], [63, 10]], "output_path": [[61, 20], [61, 31]], "process_output": [[59, 8], [59, 22]]}, "fn_var_occur": {"input_path": [["input_path", "output_path", "self", "s3_paths"], ["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "transform_script", "self", "transform_script", "replace", "True", "task_id"]], "op": [["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "transform_script", "self", "transform_script", "replace", "True", "task_id"], ["op", "execute", "None"]], "output_path": [["input_path", "output_path", "self", "s3_paths"], ["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "transform_script", "self", "transform_script", "replace", "True", "task_id"]], "process_output": [["self", "mock_process", "mock_popen", "process_output", "process_output"], ["mock_log", "info", "assert_has_calls", "mock", "call", "line", "decode", "sys", "getdefaultencoding", "line", "process_output"]]}, "name": "test_execute_with_transform_script", "params": {"mock_log": "", "mock_popen": "", "self": ""}, "params_descr": {"mock_log": "", "mock_popen": "", "self": ""}, "params_occur": {"mock_log": [["mock_log", "info", "assert_has_calls", "mock", "call", "line", "decode", "sys", "getdefaultencoding", "line", "process_output"]], "mock_popen": [["self", "mock_process", "mock_popen", "process_output", "process_output"]], "self": [["self", "mock_process", "mock_popen", "process_output", "process_output"], ["input_path", "output_path", "self", "s3_paths"], ["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "transform_script", "self", "transform_script", "replace", "True", "task_id"]]}, "params_p": {"args": [], "kwargs": [], "mock_log": [["mock.Mock", 0.0833953894495841]], "mock_popen": [], "self": []}, "q_name": "TestS3FileTransformOperator.test_execute_with_transform_script", "ret_exprs": [], "ret_type": "", "variables": {"input_path": "", "op": "", "output_path": "", "process_output": ""}, "variables_p": {"input_path": [["str", 0.4019790506982738], ["tempfile.TemporaryDirectory", 0.0990002924834281]], "op": [["bytes", 0.4020889771135242], ["str", 0.38836629027382313], ["Dict[str, Any]", 0.09866912284455492]], "output_path": [["tempfile.TemporaryDirectory", 0.10432675853035403], ["str", 0.09141659530472301]], "process_output": [["List[str]", 0.21869822138621509], ["str", 0.19298819927802607], ["Dict[str, List[Any]]", 0.09998883356070068], ["List[Tuple[str, Any]]", 0.09504863118418426], ["Dict[str, Any]", 0.09426326402485204]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[78, 4], [93, 62]], "fn_var_ln": {"input_path": [[80, 8], [80, 18]], "op": [[82, 8], [82, 10]], "output_path": [[80, 20], [80, 31]]}, "fn_var_occur": {"input_path": [["input_path", "output_path", "self", "s3_paths"], ["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "transform_script", "self", "transform_script", "replace", "True", "task_id"]], "op": [["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "transform_script", "self", "transform_script", "replace", "True", "task_id"], ["op", "execute", "None"]], "output_path": [["input_path", "output_path", "self", "s3_paths"], ["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "transform_script", "self", "transform_script", "replace", "True", "task_id"]]}, "name": "test_execute_with_failing_transform_script", "params": {"mock_popen": "", "self": ""}, "params_descr": {"mock_popen": "", "self": ""}, "params_occur": {"mock_popen": [["self", "mock_process", "mock_popen", "return_code"]], "self": [["self", "mock_process", "mock_popen", "return_code"], ["input_path", "output_path", "self", "s3_paths"], ["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "transform_script", "self", "transform_script", "replace", "True", "task_id"]]}, "params_p": {"args": [], "kwargs": [], "mock_popen": [], "self": []}, "q_name": "TestS3FileTransformOperator.test_execute_with_failing_transform_script", "ret_exprs": [], "ret_type": "", "variables": {"input_path": "", "op": "", "output_path": ""}, "variables_p": {"input_path": [["str", 0.4019790506982738], ["tempfile.TemporaryDirectory", 0.0990002924834281]], "op": [["bytes", 0.4020889771135242], ["str", 0.38836629027382313], ["Dict[str, Any]", 0.09866912284455492]], "output_path": [["tempfile.TemporaryDirectory", 0.10432675853035403], ["str", 0.09141659530472301]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[97, 4], [112, 62]], "fn_var_ln": {"input_path": [[99, 8], [99, 18]], "op": [[102, 8], [102, 10]], "output_path": [[99, 20], [99, 31]], "script_args": [[100, 8], [100, 19]]}, "fn_var_occur": {"input_path": [["input_path", "output_path", "self", "s3_paths"], ["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "transform_script", "self", "transform_script", "script_args", "script_args", "replace", "True", "task_id"]], "op": [["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "transform_script", "self", "transform_script", "script_args", "script_args", "replace", "True", "task_id"], ["op", "execute", "None"]], "output_path": [["input_path", "output_path", "self", "s3_paths"], ["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "transform_script", "self", "transform_script", "script_args", "script_args", "replace", "True", "task_id"]], "script_args": [["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "transform_script", "self", "transform_script", "script_args", "script_args", "replace", "True", "task_id"], ["script_args", "mock_popen", "call_args", "args"]]}, "name": "test_execute_with_transform_script_args", "params": {"mock_popen": "", "self": ""}, "params_descr": {"mock_popen": "", "self": ""}, "params_occur": {"mock_popen": [["self", "mock_process", "mock_popen", "process_output"], ["script_args", "mock_popen", "call_args", "args"]], "self": [["self", "mock_process", "mock_popen", "process_output"], ["input_path", "output_path", "self", "s3_paths"], ["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "transform_script", "self", "transform_script", "script_args", "script_args", "replace", "True", "task_id"]]}, "params_p": {"args": [], "kwargs": [], "mock_popen": [], "self": []}, "q_name": "TestS3FileTransformOperator.test_execute_with_transform_script_args", "ret_exprs": [], "ret_type": "", "variables": {"input_path": "", "op": "", "output_path": "", "script_args": ""}, "variables_p": {"input_path": [["str", 0.4019790506982738], ["tempfile.TemporaryDirectory", 0.0990002924834281]], "op": [["bytes", 0.20770831884965976], ["io.TextIOWrapper", 0.12556609019902046], ["boto.s3.connection.S3Connection", 0.09674192479706446], ["Optional[bytes]", 0.09582351004989915], ["str", 0.09061135175451311], ["int", 0.08911531062036206], ["set", 0.08893494095920264]], "output_path": [["tempfile.TemporaryDirectory", 0.10432675853035403], ["str", 0.09141659530472301]], "script_args": [["Dict[str, Any]", 0.2192822324100153], ["Type[tuple]", 0.2131182979954205], ["Dict[str, str]", 0.11073228419214394], ["bool", 0.09730982599442001], ["str", 0.09485643777860171], ["List[Dict[str, str]]", 0.08636645964129853]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[116, 4], [133, 52]], "fn_var_ln": {"conn": [[131, 8], [131, 12]], "input_path": [[117, 8], [117, 18]], "op": [[120, 8], [120, 10]], "output_path": [[117, 20], [117, 31]], "result": [[132, 8], [132, 14]], "select_expression": [[118, 8], [118, 25]]}, "fn_var_occur": {"conn": [["conn", "boto3", "client"], ["result", "conn", "get_object", "Bucket", "self", "bucket", "Key", "self", "output_key"]], "input_path": [["input_path", "output_path", "self", "s3_paths"], ["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "select_expression", "select_expression", "replace", "True", "task_id"], ["mock_select_key", "assert_called_once_with", "key", "input_path", "expression", "select_expression"]], "op": [["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "select_expression", "select_expression", "replace", "True", "task_id"], ["op", "execute", "None"]], "output_path": [["input_path", "output_path", "self", "s3_paths"], ["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "select_expression", "select_expression", "replace", "True", "task_id"]], "result": [["result", "conn", "get_object", "Bucket", "self", "bucket", "Key", "self", "output_key"], ["self", "content", "result", "read"]], "select_expression": [["op", "S3FileTransformOperator", "source_s3_key", "input_path", "dest_s3_key", "output_path", "select_expression", "select_expression", "replace", "True", "task_id"], ["mock_select_key", "assert_called_once_with", "key", "input_path", "expression", "select_expression"]]}, "name": "test_execute_with_select_expression", "params": {"mock_select_key": "", "self": ""}, "params_descr": {"mock_select_key": "", "self": ""}, "params_occur": {"mock_select_key": [["mock_select_key", "assert_called_once_with", "key", "input_path", "expression", "select_expression"]], "self": [["input_path", "output_path", "self", "s3_paths"], ["result", "conn", "get_object", "Bucket", "self", "bucket", "Key", "self", "output_key"], ["self", "content", "result", "read"]]}, "params_p": {"args": [], "kwargs": [], "mock_select_key": [["str", 0.19096093117815321], ["Tuple[str, mock.Mock]", 0.1008440948841533], ["bool", 0.08835406119848017]], "self": []}, "q_name": "TestS3FileTransformOperator.test_execute_with_select_expression", "ret_exprs": [], "ret_type": "", "variables": {"conn": "", "input_path": "", "op": "", "output_path": "", "result": "", "select_expression": ""}, "variables_p": {"conn": [], "input_path": [["str", 0.5737820097372995], ["Dict[str, str]", 0.08615056541053928]], "op": [["str", 0.42994591916591773], ["Dict[str, Any]", 0.17857804664372487], ["bytes", 0.0912657170305398], ["Dict[int, bytes]", 0.08699195392356322]], "output_path": [["str", 0.5157222551928319]], "result": [["Dict[str, Any]", 0.13480428851257306], ["float", 0.11541684721647825]], "select_expression": [["str", 0.41987098989341953], ["bytes", 0.3023682861487681], ["List[str]", 0.0898328466216381], ["int", 0.08941479176580198]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[136, 4], [141, 66]], "fn_var_ln": {"mock_proc": [[137, 8], [137, 17]], "returncode": [[138, 8], [138, 28]]}, "fn_var_occur": {"mock_proc": [["mock_proc", "mock", "MagicMock"], ["mock_proc", "returncode", "return_code"], ["mock_proc", "stdout", "readline", "side_effect", "process_output"], ["mock_proc", "wait", "return_value", "None"], ["mock_popen", "return_value", "__enter__", "return_value", "mock_proc"]], "returncode": [["mock_proc", "returncode", "return_code"]]}, "name": "mock_process", "params": {"mock_popen": "", "process_output": "", "return_code": ""}, "params_descr": {"mock_popen": "", "process_output": "", "return_code": ""}, "params_occur": {"mock_popen": [["mock_popen", "return_value", "__enter__", "return_value", "mock_proc"]], "process_output": [["mock_proc", "stdout", "readline", "side_effect", "process_output"]], "return_code": [["mock_proc", "returncode", "return_code"]]}, "params_p": {"args": [], "kwargs": [], "mock_popen": [["str", 0.4434934029717707], ["int", 0.26193572746815275], ["bytes", 0.05875388717468289]], "process_output": [["str", 0.3740865147184083], ["bool", 0.08211112679216714], ["List[str]", 0.08089273314352867]], "return_code": [["str", 0.45164123592791444], ["bool", 0.3452166811711415], ["Optional[int]", 0.08806985584389698]], "self": []}, "q_name": "TestS3FileTransformOperator.mock_process", "ret_exprs": [], "ret_type": "", "variables": {"mock_proc": "", "returncode": ""}, "variables_p": {"mock_proc": [["mock.MagicMock", 0.9103412378278234], ["mock.Mock", 0.0896587621721766]], "returncode": [["str", 0.3163564375203703], ["property", 0.12482515375645907], ["Dict[str, Union[Any, Any, Any]]", 0.09147159806586085], ["Dict[str, Dict[str, Any]]", 0.09147159806586085], ["List[Dict[str, Any]]", 0.09147159806586085], ["list", 0.09147159806586085], ["Dict[str, Optional[Any]]", 0.0762247786703018]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[143, 4], [152, 38]], "fn_var_ln": {"conn": [[144, 8], [144, 12]], "input_path": [[149, 8], [149, 18]], "output_path": [[150, 8], [150, 19]], "s3_url": [[148, 8], [148, 14]]}, "fn_var_occur": {"conn": [["conn", "boto3", "client"], ["conn", "create_bucket", "Bucket", "self", "bucket"], ["conn", "upload_fileobj", "Bucket", "self", "bucket", "Key", "self", "input_key", "Fileobj", "self", "bio"]], "input_path": [["input_path", "s3_url", "format", "self", "bucket", "self", "input_key"], ["input_path", "output_path"]], "output_path": [["output_path", "s3_url", "format", "self", "bucket", "self", "output_key"], ["input_path", "output_path"]], "s3_url": [["input_path", "s3_url", "format", "self", "bucket", "self", "input_key"], ["output_path", "s3_url", "format", "self", "bucket", "self", "output_key"]]}, "name": "s3_paths", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["conn", "create_bucket", "Bucket", "self", "bucket"], ["conn", "upload_fileobj", "Bucket", "self", "bucket", "Key", "self", "input_key", "Fileobj", "self", "bio"], ["input_path", "s3_url", "format", "self", "bucket", "self", "input_key"], ["output_path", "s3_url", "format", "self", "bucket", "self", "output_key"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestS3FileTransformOperator.s3_paths", "ret_exprs": ["return input_path, output_path"], "ret_type": "", "ret_type_p": [["str", 0.32510788041236943]], "variables": {"conn": "", "input_path": "", "output_path": "", "s3_url": ""}, "variables_p": {"conn": [["list", 0.37114305680491]], "input_path": [["str", 0.7845997712514956], ["list", 0.11498343446151509]], "output_path": [["str", 0.27865057649634944]], "s3_url": [["str", 1.0]]}}], "name": "TestS3FileTransformOperator", "q_name": "TestS3FileTransformOperator", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["__future__", "annotations", "errno", "io", "os", "shutil", "sys", "tempfile", "mkdtemp", "unittest", "mock", "boto3", "pytest", "moto", "mock_s3", "airflow", "exceptions", "AirflowException", "airflow", "providers", "amazon", "aws", "operators", "s3", "S3FileTransformOperator"], "mod_var_ln": {}, "mod_var_occur": {}, "no_types_annot": {"D": 0, "I": 0, "U": 46}, "session_id": "1kzIuLz4PgrpX1cVzx5SvPwUlxK-kRmWZrQWsfMGNtg", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {}, "variables_p": {}}}