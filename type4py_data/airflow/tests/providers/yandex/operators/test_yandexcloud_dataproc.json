{"error": null, "response": {"classes": [{"cls_lc": [[66, 0], [377, 9]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[67, 4], [77, 9]], "fn_var_ln": {"dag": [[69, 8], [69, 16]], "dag_id": [[68, 8], [68, 14]]}, "fn_var_occur": {"dag": [["self", "dag", "DAG", "dag_id", "default_args", "datetime", "datetime", "today", "datetime", "datetime", "today", "datetime", "timedelta", "days", "schedule"]], "dag_id": [["self", "dag", "DAG", "dag_id", "default_args", "datetime", "datetime", "today", "datetime", "datetime", "today", "datetime", "timedelta", "days", "schedule"]]}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "dag", "DAG", "dag_id", "default_args", "datetime", "datetime", "today", "datetime", "datetime", "today", "datetime", "timedelta", "days", "schedule"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestDataprocClusterCreateOperator.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dag_id": ""}, "variables_p": {"dag": [["datetime.datetime.datetime", 0.3439659104254562], ["datetime.date.time.timedelta", 0.21711491816808318], ["datetime.timedelta", 0.08789812061997927], ["datetime.datetime", 0.08749200264529575], ["datetime.datetime.date", 0.08552443638238652]], "dag_id": [["str", 0.32832983905484237], ["int", 0.2009580032038882], ["Type[prm.journals.models.moods.Mood]", 0.10415466181012945], ["List[Union[Any, Any]]", 0.08707639491591514], ["datetime.date", 0.08568922295774425], ["datetime.datetime.datetime", 0.08503498855197297]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[82, 4], [140, 9]], "fn_var_ln": {"context": [[94, 8], [94, 15]], "operator": [[83, 8], [83, 16]]}, "fn_var_occur": {"context": [["context", "MagicMock"], ["operator", "execute", "context"], ["context", "xcom_push", "assert_has_calls", "call", "key", "value", "create_cluster_mock", "response", "id", "call", "key", "value", "CONNECTION_ID"]], "operator": [["operator", "DataprocCreateClusterOperator", "task_id", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "connection_id", "CONNECTION_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "log_group_id", "LOG_GROUP_ID"], ["operator", "execute", "context"]]}, "name": "test_create_cluster", "params": {"_": "", "create_cluster_mock": "", "self": ""}, "params_descr": {"_": "", "create_cluster_mock": "", "self": ""}, "params_occur": {"_": [], "create_cluster_mock": [["create_cluster_mock", "assert_called_once_with", "cluster_description", "cluster_image_version", "cluster_name", "None", "computenode_count", "computenode_disk_size", "None", "computenode_disk_type", "None", "computenode_resource_preset", "None", "computenode_max_hosts_count", "None", "computenode_measurement_duration", "None", "computenode_warmup_duration", "None", "computenode_stabilization_duration", "None", "computenode_preemptible", "False", "computenode_cpu_utilization_target", "None", "computenode_decommission_timeout", "None", "datanode_count", "datanode_disk_size", "None", "datanode_disk_type", "None", "datanode_resource_preset", "None", "folder_id", "masternode_disk_size", "None", "masternode_disk_type", "None", "masternode_resource_preset", "None", "s3_bucket", "service_account_id", "None", "services", "ssh_public_keys", "subnet_id", "zone", "log_group_id", "LOG_GROUP_ID", "properties", "None", "enable_ui_proxy", "False", "host_group_ids", "None", "security_group_ids", "None", "initialization_actions", "None"], ["context", "xcom_push", "assert_has_calls", "call", "key", "value", "create_cluster_mock", "response", "id", "call", "key", "value", "CONNECTION_ID"]], "self": []}, "params_p": {"_": [["str", 0.20085887832276078]], "args": [], "create_cluster_mock": [["unittesmock.MagicMock", 0.4114738263657018], ["str", 0.08812511381253076]], "kwargs": [], "self": []}, "q_name": "TestDataprocClusterCreateOperator.test_create_cluster", "ret_exprs": [], "ret_type": "", "variables": {"context": "", "operator": ""}, "variables_p": {"context": [["mock.Mock", 0.5225820326345032], ["unittesmock.MagicMock", 0.09592865182450683]], "operator": [["int", 0.18914009567910645], ["Tuple[Any, Any, Any]", 0.09816958248210068], ["List['Book']", 0.09682428534590058], ["Dict[str, Any]", 0.09280223654263389]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[145, 4], [154, 68]], "fn_var_ln": {"context": [[150, 8], [150, 15]], "operator": [[146, 8], [146, 16]]}, "fn_var_occur": {"context": [["context", "MagicMock"], ["context", "xcom_pull", "return_value"], ["operator", "execute", "context"], ["context", "xcom_pull", "assert_called_once_with", "key"]], "operator": [["operator", "DataprocDeleteClusterOperator", "task_id", "connection_id", "CONNECTION_ID"], ["operator", "execute", "context"]]}, "name": "test_delete_cluster_operator", "params": {"_": "", "delete_cluster_mock": "", "self": ""}, "params_descr": {"_": "", "delete_cluster_mock": "", "self": ""}, "params_occur": {"_": [], "delete_cluster_mock": [["delete_cluster_mock", "assert_called_once_with"]], "self": []}, "params_p": {"_": [["tests.async_mock.MagicMock", 0.19035256020717886], ["unittesmock.MagicMock", 0.19035256020717886]], "args": [], "delete_cluster_mock": [["unittesmock.MagicMock", 0.37661361538700255]], "kwargs": [], "self": []}, "q_name": "TestDataprocClusterCreateOperator.test_delete_cluster_operator", "ret_exprs": [], "ret_type": "", "variables": {"context": "", "operator": ""}, "variables_p": {"context": [["mock.Mock", 0.6893100512424911], ["int", 0.10533001962442956]], "operator": [["str", 0.5229076957410275], ["List[int]", 0.10055641411105015], ["Dict[int, str]", 0.09294148481878109]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[159, 4], [183, 9]], "fn_var_ln": {"context": [[164, 8], [164, 15]], "operator": [[160, 8], [160, 16]]}, "fn_var_occur": {"context": [["context", "MagicMock"], ["context", "xcom_pull", "return_value"], ["operator", "execute", "context"], ["context", "xcom_pull", "assert_has_calls", "call", "key", "call", "key"]], "operator": [["operator", "DataprocCreateHiveJobOperator", "task_id", "query"], ["operator", "execute", "context"]]}, "name": "test_create_hive_job_operator", "params": {"_": "", "create_hive_job_mock": "", "self": ""}, "params_descr": {"_": "", "create_hive_job_mock": "", "self": ""}, "params_occur": {"_": [], "create_hive_job_mock": [["create_hive_job_mock", "assert_called_once_with", "cluster_id", "continue_on_failure", "False", "name", "properties", "None", "query", "query_file_uri", "None", "script_variables", "None"]], "self": []}, "params_p": {"_": [["bool", 0.4402797381748274], ["int", 0.1990170016158919], ["str", 0.11378831778581198], ["List[str]", 0.08522868383007991]], "args": [], "create_hive_job_mock": [["str", 0.09952005724477343]], "kwargs": [], "self": []}, "q_name": "TestDataprocClusterCreateOperator.test_create_hive_job_operator", "ret_exprs": [], "ret_type": "", "variables": {"context": "", "operator": ""}, "variables_p": {"context": [["mock.Mock", 0.6396018980881641], ["int", 0.1242352043397609]], "operator": [["set", 0.17324147454328157], ["str", 0.1689412618725451], ["pydynasync.models.Changes", 0.11538767180534586], ["list", 0.0875238197609654], ["dict", 0.08578832990891781], ["Type[List[Any]]", 0.08068624663929083]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[188, 4], [253, 9]], "fn_var_ln": {"context": [[214, 8], [214, 15]], "operator": [[189, 8], [189, 16]]}, "fn_var_occur": {"context": [["context", "MagicMock"], ["context", "xcom_pull", "return_value"], ["operator", "execute", "context"], ["context", "xcom_pull", "assert_has_calls", "call", "key", "call", "key"]], "operator": [["operator", "DataprocCreateMapReduceJobOperator", "task_id", "main_class", "file_uris", "args", "properties"], ["operator", "execute", "context"]]}, "name": "test_create_mapreduce_job_operator", "params": {"_": "", "create_mapreduce_job_mock": "", "self": ""}, "params_descr": {"_": "", "create_mapreduce_job_mock": "", "self": ""}, "params_occur": {"_": [], "create_mapreduce_job_mock": [["create_mapreduce_job_mock", "assert_called_once_with", "archive_uris", "None", "args", "cluster_id", "file_uris", "jar_file_uris", "None", "main_class", "main_jar_file_uri", "None", "name", "properties"]], "self": []}, "params_p": {"_": [["bool", 0.4402797381748274], ["int", 0.1990170016158919], ["str", 0.11378831778581198], ["List[str]", 0.08522868383007991]], "args": [], "create_mapreduce_job_mock": [["str", 0.2819592622951861], ["bool", 0.22830484888052854], ["bytes", 0.10957346733943249]], "kwargs": [], "self": []}, "q_name": "TestDataprocClusterCreateOperator.test_create_mapreduce_job_operator", "ret_exprs": [], "ret_type": "", "variables": {"context": "", "operator": ""}, "variables_p": {"context": [["mock.Mock", 0.6396018980881641], ["int", 0.1242352043397609]], "operator": [["int", 0.2929626851883391], ["str", 0.2573282183322665]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[258, 4], [315, 9]], "fn_var_ln": {"context": [[283, 8], [283, 15]], "operator": [[259, 8], [259, 16]]}, "fn_var_occur": {"context": [["context", "MagicMock"], ["context", "xcom_pull", "return_value"], ["operator", "execute", "context"], ["context", "xcom_pull", "assert_has_calls", "call", "key", "call", "key"]], "operator": [["operator", "DataprocCreateSparkJobOperator", "task_id", "main_jar_file_uri", "main_class", "file_uris", "archive_uris", "jar_file_uris", "args", "properties"], ["operator", "execute", "context"]]}, "name": "test_create_spark_job_operator", "params": {"_": "", "create_spark_job_mock": "", "self": ""}, "params_descr": {"_": "", "create_spark_job_mock": "", "self": ""}, "params_occur": {"_": [], "create_spark_job_mock": [["create_spark_job_mock", "assert_called_once_with", "archive_uris", "args", "cluster_id", "file_uris", "jar_file_uris", "main_class", "main_jar_file_uri", "name", "properties", "packages", "None", "repositories", "None", "exclude_packages", "None"]], "self": []}, "params_p": {"_": [["bool", 0.4402797381748274], ["int", 0.1990170016158919], ["str", 0.11378831778581198], ["List[str]", 0.08522868383007991]], "args": [], "create_spark_job_mock": [["str", 0.3869480776328448], ["bytes", 0.10916139175025513], ["int", 0.09449279577498079]], "kwargs": [], "self": []}, "q_name": "TestDataprocClusterCreateOperator.test_create_spark_job_operator", "ret_exprs": [], "ret_type": "", "variables": {"context": "", "operator": ""}, "variables_p": {"context": [["mock.Mock", 0.6396018980881641], ["int", 0.1242352043397609]], "operator": [["str", 0.2961575396894855], ["List[int]", 0.12560913375687913], ["int", 0.09098255160951202], ["List[Tuple[str, int]]", 0.08932937218822776]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[320, 4], [377, 9]], "fn_var_ln": {"context": [[346, 8], [346, 15]], "operator": [[321, 8], [321, 16]]}, "fn_var_occur": {"context": [["context", "MagicMock"], ["context", "xcom_pull", "return_value"], ["operator", "execute", "context"], ["context", "xcom_pull", "assert_has_calls", "call", "key", "call", "key"]], "operator": [["operator", "DataprocCreatePysparkJobOperator", "task_id", "main_python_file_uri", "python_file_uris", "file_uris", "archive_uris", "args", "jar_file_uris", "properties"], ["operator", "execute", "context"]]}, "name": "test_create_pyspark_job_operator", "params": {"_": "", "create_pyspark_job_mock": "", "self": ""}, "params_descr": {"_": "", "create_pyspark_job_mock": "", "self": ""}, "params_occur": {"_": [], "create_pyspark_job_mock": [["create_pyspark_job_mock", "assert_called_once_with", "archive_uris", "args", "cluster_id", "file_uris", "jar_file_uris", "main_python_file_uri", "name", "properties", "python_file_uris", "packages", "None", "repositories", "None", "exclude_packages", "None"]], "self": []}, "params_p": {"_": [["bool", 0.4402797381748274], ["int", 0.1990170016158919], ["str", 0.11378831778581198], ["List[str]", 0.08522868383007991]], "args": [], "create_pyspark_job_mock": [["str", 0.3138669721445263], ["bool", 0.09791220409107107]], "kwargs": [], "self": []}, "q_name": "TestDataprocClusterCreateOperator.test_create_pyspark_job_operator", "ret_exprs": [], "ret_type": "", "variables": {"context": "", "operator": ""}, "variables_p": {"context": [["mock.Mock", 0.6396018980881641], ["int", 0.1242352043397609]], "operator": [["str", 0.29129609607235674], ["dict", 0.223115867830054], ["List[Dict[str, Any]]", 0.1031803060608032], ["bool", 0.09642822544151172]]}}], "name": "TestDataprocClusterCreateOperator", "q_name": "TestDataprocClusterCreateOperator", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["__future__", "annotations", "datetime", "unittest", "mock", "MagicMock", "call", "patch", "airflow", "models", "dag", "DAG", "airflow", "providers", "yandex", "operators", "yandexcloud_dataproc", "DataprocCreateClusterOperator", "DataprocCreateHiveJobOperator", "DataprocCreateMapReduceJobOperator", "DataprocCreatePysparkJobOperator", "DataprocCreateSparkJobOperator", "DataprocDeleteClusterOperator"], "mod_var_ln": {"AVAILABILITY_ZONE_ID": [[36, 0], [36, 20]], "CLUSTER_IMAGE_VERSION": [[39, 0], [39, 21]], "CLUSTER_NAME": [[38, 0], [38, 12]], "CONNECTION_ID": [[33, 0], [33, 13]], "FOLDER_ID": [[42, 0], [42, 9]], "LOG_GROUP_ID": [[63, 0], [63, 12]], "OAUTH_TOKEN": [[54, 0], [54, 11]], "S3_BUCKET_NAME_FOR_LOGS": [[48, 0], [48, 23]], "SERVICE_ACCOUNT_ID": [[51, 0], [51, 18]], "SSH_PUBLIC_KEYS": [[57, 0], [57, 15]], "SUBNET_ID": [[45, 0], [45, 9]]}, "mod_var_occur": {"AVAILABILITY_ZONE_ID": [["operator", "DataprocCreateClusterOperator", "task_id", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "connection_id", "CONNECTION_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "log_group_id", "LOG_GROUP_ID"]], "CLUSTER_IMAGE_VERSION": [["operator", "DataprocCreateClusterOperator", "task_id", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "connection_id", "CONNECTION_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "log_group_id", "LOG_GROUP_ID"]], "CLUSTER_NAME": [], "CONNECTION_ID": [["operator", "DataprocCreateClusterOperator", "task_id", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "connection_id", "CONNECTION_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "log_group_id", "LOG_GROUP_ID"], ["context", "xcom_push", "assert_has_calls", "call", "key", "value", "create_cluster_mock", "response", "id", "call", "key", "value", "CONNECTION_ID"], ["operator", "DataprocDeleteClusterOperator", "task_id", "connection_id", "CONNECTION_ID"]], "FOLDER_ID": [["operator", "DataprocCreateClusterOperator", "task_id", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "connection_id", "CONNECTION_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "log_group_id", "LOG_GROUP_ID"]], "LOG_GROUP_ID": [["operator", "DataprocCreateClusterOperator", "task_id", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "connection_id", "CONNECTION_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "log_group_id", "LOG_GROUP_ID"], ["create_cluster_mock", "assert_called_once_with", "cluster_description", "cluster_image_version", "cluster_name", "None", "computenode_count", "computenode_disk_size", "None", "computenode_disk_type", "None", "computenode_resource_preset", "None", "computenode_max_hosts_count", "None", "computenode_measurement_duration", "None", "computenode_warmup_duration", "None", "computenode_stabilization_duration", "None", "computenode_preemptible", "False", "computenode_cpu_utilization_target", "None", "computenode_decommission_timeout", "None", "datanode_count", "datanode_disk_size", "None", "datanode_disk_type", "None", "datanode_resource_preset", "None", "folder_id", "masternode_disk_size", "None", "masternode_disk_type", "None", "masternode_resource_preset", "None", "s3_bucket", "service_account_id", "None", "services", "ssh_public_keys", "subnet_id", "zone", "log_group_id", "LOG_GROUP_ID", "properties", "None", "enable_ui_proxy", "False", "host_group_ids", "None", "security_group_ids", "None", "initialization_actions", "None"]], "OAUTH_TOKEN": [], "S3_BUCKET_NAME_FOR_LOGS": [["operator", "DataprocCreateClusterOperator", "task_id", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "connection_id", "CONNECTION_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "log_group_id", "LOG_GROUP_ID"]], "SERVICE_ACCOUNT_ID": [], "SSH_PUBLIC_KEYS": [["operator", "DataprocCreateClusterOperator", "task_id", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "connection_id", "CONNECTION_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "log_group_id", "LOG_GROUP_ID"]], "SUBNET_ID": [["operator", "DataprocCreateClusterOperator", "task_id", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "connection_id", "CONNECTION_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "log_group_id", "LOG_GROUP_ID"]]}, "no_types_annot": {"D": 0, "I": 0, "U": 44}, "session_id": "LLPltdEezK47Nf-11WQMStdKxsCYyeF6mxYnbtNxI74", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"AVAILABILITY_ZONE_ID": "", "CLUSTER_IMAGE_VERSION": "", "CLUSTER_NAME": "", "CONNECTION_ID": "", "FOLDER_ID": "", "LOG_GROUP_ID": "", "OAUTH_TOKEN": "", "S3_BUCKET_NAME_FOR_LOGS": "", "SERVICE_ACCOUNT_ID": "", "SSH_PUBLIC_KEYS": "", "SUBNET_ID": ""}, "variables_p": {"AVAILABILITY_ZONE_ID": [["str", 0.6002605273765889], ["int", 0.19501598027532654], ["DefaultDict[Any, dict]", 0.10121237044483569]], "CLUSTER_IMAGE_VERSION": [["int", 0.39510623974377], ["Union[Literal, Literal]", 0.21256410297822464], ["str", 0.19445547507568006], ["Pattern[str]", 0.09317486050704545]], "CLUSTER_NAME": [["str", 0.7], ["Optional[str]", 0.2], ["List[str]", 0.1]], "CONNECTION_ID": [["str", 0.9022777407647957]], "FOLDER_ID": [["str", 0.9022777407647957]], "LOG_GROUP_ID": [["str", 0.8051124135162244], ["int", 0.10012464522744458], ["Tuple[str, str]", 0.09476294125633104]], "OAUTH_TOKEN": [["str", 0.6000000000000001], ["staticmethod", 0.10000000000000002], ["Dict[str, int]", 0.10000000000000002], ["int", 0.10000000000000002]], "S3_BUCKET_NAME_FOR_LOGS": [["bool", 0.303372898750654], ["str", 0.3014789473171511], ["int", 0.29709324149919447], ["Pattern[str]", 0.09805491243300032]], "SERVICE_ACCOUNT_ID": [["str", 0.9999999999522646], ["Optional[str]", 4.7735199253132644e-11]], "SSH_PUBLIC_KEYS": [["str", 0.8007157833162832], ["int", 0.09255326273968857]], "SUBNET_ID": [["str", 0.9022777407647957]]}}}