{"error": null, "response": {"classes": [{"cls_lc": [[69, 0], [197, 43]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[70, 4], [73, 38]], "fn_var_ln": {"hook": [[73, 12], [73, 21]], "return_value": [[72, 12], [72, 44]]}, "fn_var_occur": {"hook": [["self", "hook", "DataprocHook"]], "return_value": [["get_connection_mock", "return_value", "self", "connection"]]}, "name": "_init_hook", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["get_connection_mock", "return_value", "self", "connection"], ["self", "hook", "DataprocHook"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestYandexCloudDataprocHook._init_hook", "ret_exprs": [], "ret_type": "", "variables": {"hook": "", "return_value": ""}, "variables_p": {"hook": [["str", 0.30000000000000004], ["Dict[str, Any]", 0.1], ["dict", 0.1], ["int", 0.1]], "return_value": [["str", 0.26696977190064286], ["Optional[bytes]", 0.15161191934503038], ["list", 0.14721732497676188]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[75, 4], [77, 25]], "fn_var_ln": {"connection": [[76, 8], [76, 23]]}, "fn_var_occur": {"connection": [["self", "connection", "Connection", "extra", "json", "dumps", "OAUTH_TOKEN"]]}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "connection", "Connection", "extra", "json", "dumps", "OAUTH_TOKEN"], ["self", "_init_hook"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestYandexCloudDataprocHook.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"connection": ""}, "variables_p": {"connection": [["dict", 0.7975923699759627], ["list", 0.10645247852064767]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[80, 4], [93, 43]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_create_dataproc_cluster_mocked", "params": {"create_operation_mock": "", "self": ""}, "params_descr": {"create_operation_mock": "", "self": ""}, "params_occur": {"create_operation_mock": [["create_operation_mock", "called"]], "self": [["self", "_init_hook"], ["self", "hook", "client", "create_cluster", "cluster_name", "CLUSTER_NAME", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "service_account_id", "SERVICE_ACCOUNT_ID"]]}, "params_p": {"args": [], "create_operation_mock": [], "kwargs": [], "self": []}, "q_name": "TestYandexCloudDataprocHook.test_create_dataproc_cluster_mocked", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[96, 4], [99, 43]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_delete_dataproc_cluster_mocked", "params": {"create_operation_mock": "", "self": ""}, "params_descr": {"create_operation_mock": "", "self": ""}, "params_occur": {"create_operation_mock": [["create_operation_mock", "called"]], "self": [["self", "_init_hook"], ["self", "hook", "client", "delete_cluster"]]}, "params_p": {"args": [], "create_operation_mock": [], "kwargs": [], "self": []}, "q_name": "TestYandexCloudDataprocHook.test_delete_dataproc_cluster_mocked", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[102, 4], [113, 43]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_create_hive_job_hook", "params": {"create_operation_mock": "", "self": ""}, "params_descr": {"create_operation_mock": "", "self": ""}, "params_occur": {"create_operation_mock": [["create_operation_mock", "called"]], "self": [["self", "_init_hook"], ["self", "hook", "client", "create_hive_job", "cluster_id", "continue_on_failure", "False", "name", "properties", "None", "query", "script_variables", "None"]]}, "params_p": {"args": [], "create_operation_mock": [], "kwargs": [], "self": []}, "q_name": "TestYandexCloudDataprocHook.test_create_hive_job_hook", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[116, 4], [148, 43]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_create_mapreduce_job_hook", "params": {"create_operation_mock": "", "self": ""}, "params_descr": {"create_operation_mock": "", "self": ""}, "params_occur": {"create_operation_mock": [["create_operation_mock", "called"]], "self": [["self", "_init_hook"], ["self", "hook", "client", "create_mapreduce_job", "archive_uris", "None", "args", "cluster_id", "file_uris", "jar_file_uris", "None", "main_class", "main_jar_file_uri", "None", "name", "properties"]]}, "params_p": {"args": [], "create_operation_mock": [], "kwargs": [], "self": []}, "q_name": "TestYandexCloudDataprocHook.test_create_mapreduce_job_hook", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[151, 4], [173, 43]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_create_spark_job_hook", "params": {"create_operation_mock": "", "self": ""}, "params_descr": {"create_operation_mock": "", "self": ""}, "params_occur": {"create_operation_mock": [["create_operation_mock", "called"]], "self": [["self", "_init_hook"], ["self", "hook", "client", "create_spark_job", "archive_uris", "args", "cluster_id", "file_uris", "jar_file_uris", "main_class", "main_jar_file_uri", "name", "properties"]]}, "params_p": {"args": [], "create_operation_mock": [], "kwargs": [], "self": []}, "q_name": "TestYandexCloudDataprocHook.test_create_spark_job_hook", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[176, 4], [197, 43]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_create_pyspark_job_hook", "params": {"create_operation_mock": "", "self": ""}, "params_descr": {"create_operation_mock": "", "self": ""}, "params_occur": {"create_operation_mock": [["create_operation_mock", "called"]], "self": [["self", "_init_hook"], ["self", "hook", "client", "create_pyspark_job", "archive_uris", "args", "cluster_id", "file_uris", "jar_file_uris", "main_python_file_uri", "name", "properties", "python_file_uris"]]}, "params_p": {"args": [], "create_operation_mock": [], "kwargs": [], "self": []}, "q_name": "TestYandexCloudDataprocHook.test_create_pyspark_job_hook", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}], "name": "TestYandexCloudDataprocHook", "q_name": "TestYandexCloudDataprocHook", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["__future__", "annotations", "json", "unittest", "mock", "patch", "pytest", "airflow", "models", "Connection", "yandexcloud", "airflow", "providers", "yandex", "hooks", "yandexcloud_dataproc", "DataprocHook"], "mod_var_ln": {"AVAILABILITY_ZONE_ID": [[38, 0], [38, 20]], "CLUSTER_IMAGE_VERSION": [[41, 0], [41, 21]], "CLUSTER_NAME": [[40, 0], [40, 12]], "CONNECTION_ID": [[35, 0], [35, 13]], "FOLDER_ID": [[44, 0], [44, 9]], "HAS_CREDENTIALS": [[65, 0], [65, 15]], "OAUTH_TOKEN": [[56, 0], [56, 11]], "S3_BUCKET_NAME_FOR_LOGS": [[50, 0], [50, 23]], "SERVICE_ACCOUNT_ID": [[53, 0], [53, 18]], "SSH_PUBLIC_KEYS": [[59, 0], [59, 15]], "SUBNET_ID": [[47, 0], [47, 9]], "yandexcloud": [[31, 4], [31, 15]]}, "mod_var_occur": {"AVAILABILITY_ZONE_ID": [["self", "hook", "client", "create_cluster", "cluster_name", "CLUSTER_NAME", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "service_account_id", "SERVICE_ACCOUNT_ID"]], "CLUSTER_IMAGE_VERSION": [["self", "hook", "client", "create_cluster", "cluster_name", "CLUSTER_NAME", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "service_account_id", "SERVICE_ACCOUNT_ID"]], "CLUSTER_NAME": [["self", "hook", "client", "create_cluster", "cluster_name", "CLUSTER_NAME", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "service_account_id", "SERVICE_ACCOUNT_ID"]], "CONNECTION_ID": [], "FOLDER_ID": [["self", "hook", "client", "create_cluster", "cluster_name", "CLUSTER_NAME", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "service_account_id", "SERVICE_ACCOUNT_ID"]], "HAS_CREDENTIALS": [], "OAUTH_TOKEN": [["HAS_CREDENTIALS", "OAUTH_TOKEN"], ["self", "connection", "Connection", "extra", "json", "dumps", "OAUTH_TOKEN"]], "S3_BUCKET_NAME_FOR_LOGS": [["self", "hook", "client", "create_cluster", "cluster_name", "CLUSTER_NAME", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "service_account_id", "SERVICE_ACCOUNT_ID"]], "SERVICE_ACCOUNT_ID": [["self", "hook", "client", "create_cluster", "cluster_name", "CLUSTER_NAME", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "service_account_id", "SERVICE_ACCOUNT_ID"]], "SSH_PUBLIC_KEYS": [["self", "hook", "client", "create_cluster", "cluster_name", "CLUSTER_NAME", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "service_account_id", "SERVICE_ACCOUNT_ID"]], "SUBNET_ID": [["self", "hook", "client", "create_cluster", "cluster_name", "CLUSTER_NAME", "ssh_public_keys", "SSH_PUBLIC_KEYS", "folder_id", "FOLDER_ID", "subnet_id", "SUBNET_ID", "zone", "AVAILABILITY_ZONE_ID", "s3_bucket", "S3_BUCKET_NAME_FOR_LOGS", "cluster_image_version", "CLUSTER_IMAGE_VERSION", "service_account_id", "SERVICE_ACCOUNT_ID"]], "yandexcloud": []}, "no_types_annot": {"D": 0, "I": 0, "U": 29}, "session_id": "sgWOmtKm3VRqfzHBRxYQKLyS3vNMqrP23-Kbuv4vdCs", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"AVAILABILITY_ZONE_ID": "", "CLUSTER_IMAGE_VERSION": "", "CLUSTER_NAME": "", "CONNECTION_ID": "", "FOLDER_ID": "", "HAS_CREDENTIALS": "", "OAUTH_TOKEN": "", "S3_BUCKET_NAME_FOR_LOGS": "", "SERVICE_ACCOUNT_ID": "", "SSH_PUBLIC_KEYS": "", "SUBNET_ID": "", "yandexcloud": ""}, "variables_p": {"AVAILABILITY_ZONE_ID": [["str", 0.8962663747531472], ["int", 0.10373362524685259]], "CLUSTER_IMAGE_VERSION": [["str", 0.7859962432522646], ["FrozenSet", 0.11618058219791269], ["List[str]", 0.09782317454982277]], "CLUSTER_NAME": [["str", 1.0]], "CONNECTION_ID": [["Optional[str]", 0.09999999999999999], ["int", 0.09999999999999999], ["List[int]", 0.09999999999999999], ["services.ticketing.transfer.models.TicketID", 0.09999999999999999], ["Type[models.User]", 0.09999999999999999], ["shop.transfer.models.ShopID", 0.09999999999999999], ["Type[pipeline.netfile.models.AbstractSchedule]", 0.09999999999999999]], "FOLDER_ID": [["str", 0.8807028920025539], ["int", 0.11929710799744614]], "HAS_CREDENTIALS": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "OAUTH_TOKEN": [["dict", 0.3984359899274137], ["List[str]", 0.10305203169526544], ["str", 0.09446211723816607]], "S3_BUCKET_NAME_FOR_LOGS": [["str", 0.7112443552649185], ["int", 0.2887556447350814]], "SERVICE_ACCOUNT_ID": [["str", 1.0]], "SSH_PUBLIC_KEYS": [["str", 1.0]], "SUBNET_ID": [["str", 0.8807028920025539], ["int", 0.11929710799744614]], "yandexcloud": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]]}}}