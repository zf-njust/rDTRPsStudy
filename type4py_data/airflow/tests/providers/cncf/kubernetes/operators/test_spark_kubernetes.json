{"error": null, "response": {"classes": [], "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[30, 0], [45, 5]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_spark_kubernetes_operator", "params": {"mock_kubernetes_hook": ""}, "params_descr": {"mock_kubernetes_hook": ""}, "params_occur": {"mock_kubernetes_hook": [["mock_kubernetes_hook", "assert_called_once_with", "conn_id", "in_cluster", "True", "cluster_context", "config_file"]]}, "params_p": {"args": [], "kwargs": [], "mock_kubernetes_hook": [["unittesmock.MagicMock", 0.6859522093786355]]}, "q_name": "test_spark_kubernetes_operator", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[51, 0], [89, 110]], "fn_var_ln": {"last_timestamp": [[61, 4], [61, 30]], "object_mock": [[59, 4], [59, 15]], "op": [[64, 4], [64, 6]], "operator_output": [[65, 4], [65, 19]], "reason": [[60, 4], [60, 22]], "return_value": [[52, 4], [52, 39]], "side_effect": [[62, 4], [62, 27]]}, "fn_var_occur": {"last_timestamp": [["object_mock", "last_timestamp", "datetime", "tzinfo", "tz", "tzutc"]], "object_mock": [["object_mock", "MagicMock"], ["object_mock", "reason"], ["object_mock", "last_timestamp", "datetime", "tzinfo", "tz", "tzutc"], ["mock_stream", "side_effect", "object_mock"]], "op": [["op", "SparkKubernetesOperator", "task_id", "application_file", "watch", "True"], ["operator_output", "op", "execute"]], "operator_output": [["operator_output", "op", "execute"]], "reason": [["object_mock", "reason"]], "return_value": [["mock_load_body_to_dict", "return_value"], ["mock_kubernetes_hook", "return_value", "create_custom_object", "return_value"], ["mock_kubernetes_hook", "return_value", "get_namespace", "return_value"], ["mock_kubernetes_hook", "return_value", "create_custom_object", "assert_called_once_with", "group", "version", "plural", "body", "namespace"], ["mock_stream", "assert_any_call", "mock_kubernetes_hook", "return_value", "core_v1_client", "list_namespaced_event", "namespace", "watch", "True", "field_selector"], ["mock_stream", "assert_any_call", "mock_kubernetes_hook", "return_value", "core_v1_client", "read_namespaced_pod_log", "name", "namespace", "timestamps", "True"]], "side_effect": [["mock_stream", "side_effect", "object_mock"]]}, "name": "test_execute_with_watch", "params": {"mock_kubernetes_hook": "", "mock_load_body_to_dict": "", "mock_stream": ""}, "params_descr": {"mock_kubernetes_hook": "", "mock_load_body_to_dict": "", "mock_stream": ""}, "params_occur": {"mock_kubernetes_hook": [["mock_kubernetes_hook", "return_value", "create_custom_object", "return_value"], ["mock_kubernetes_hook", "return_value", "get_namespace", "return_value"], ["mock_kubernetes_hook", "return_value", "create_custom_object", "assert_called_once_with", "group", "version", "plural", "body", "namespace"], ["mock_stream", "assert_any_call", "mock_kubernetes_hook", "return_value", "core_v1_client", "list_namespaced_event", "namespace", "watch", "True", "field_selector"], ["mock_stream", "assert_any_call", "mock_kubernetes_hook", "return_value", "core_v1_client", "read_namespaced_pod_log", "name", "namespace", "timestamps", "True"]], "mock_load_body_to_dict": [["mock_load_body_to_dict", "return_value"]], "mock_stream": [["mock_stream", "side_effect", "object_mock"], ["mock_stream", "call_count"], ["mock_stream", "assert_any_call", "mock_kubernetes_hook", "return_value", "core_v1_client", "list_namespaced_event", "namespace", "watch", "True", "field_selector"], ["mock_stream", "assert_any_call", "mock_kubernetes_hook", "return_value", "core_v1_client", "read_namespaced_pod_log", "name", "namespace", "timestamps", "True"]]}, "params_p": {"args": [], "kwargs": [], "mock_kubernetes_hook": [], "mock_load_body_to_dict": [["unittesmock.MagicMock", 0.2414962795642278], ["mock.Mock", 0.1560286010592099]], "mock_stream": []}, "q_name": "test_execute_with_watch", "ret_exprs": [], "ret_type": "", "variables": {"last_timestamp": "", "object_mock": "", "op": "", "operator_output": "", "reason": "", "return_value": "", "side_effect": ""}, "variables_p": {"last_timestamp": [["Dict[str, Union[int, str]]", 0.26360142429980626], ["str", 0.1037361520832562], ["unittesmock._patch[Union[unittesmock.AsyncMock, unittesmock.MagicMock]]", 0.09449308320496966], ["bool", 0.08829968321261149]], "object_mock": [], "op": [["int", 0.29750725616009954], ["str", 0.2000947995811085], ["Dict[str, Union[Any, Any, Any, str]]", 0.08828099384590546], ["List[Tuple[Any, Any]]", 0.08369208757755021], ["datetime.timedelta", 0.08357713874157535]], "operator_output": [["str", 0.4708759984730564], ["List[Dict[str, Any]]", 0.1024342102508022], ["set", 0.07351666690003965]], "reason": [["Dict[int, Dict[str, Any]]", 0.22534638571475643], ["Tuple[Literal, Literal, Literal]", 0.20935800768538151], ["str", 0.19752931247054933], ["List[str]", 0.16641002232610663], ["property", 0.07148526777121711]], "return_value": [["Dict[str, Dict[str, Any]]", 0.2208861715234029], ["Dict[str, Union[Any, Any]]", 0.17986401683365827], ["Dict[str, int]", 0.07940541415050836], ["str", 0.06793252277622279]], "side_effect": [["str", 0.46146968833119484], ["List[Dict[str, float]]", 0.10543346334745063], ["Dict[str, Dict[str, str]]", 0.0831681400737581]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[96, 0], [116, 41]], "fn_var_ln": {"last_timestamp": [[109, 4], [109, 30]], "message": [[108, 4], [108, 23]], "object_mock": [[106, 4], [106, 15]], "op": [[112, 4], [112, 6]], "reason": [[107, 4], [107, 22]], "return_value": [[99, 4], [99, 39]], "side_effect": [[111, 4], [111, 27]]}, "fn_var_occur": {"last_timestamp": [["object_mock", "last_timestamp", "datetime", "tzinfo", "tz", "tzutc"]], "message": [["object_mock", "message"]], "object_mock": [["object_mock", "MagicMock"], ["object_mock", "reason"], ["object_mock", "message"], ["object_mock", "last_timestamp", "datetime", "tzinfo", "tz", "tzutc"], ["mock_stream", "side_effect", "object_mock"]], "op": [["op", "SparkKubernetesOperator", "task_id", "application_file", "watch", "True"], ["op", "execute"]], "reason": [["object_mock", "reason"]], "return_value": [["mock_load_body_to_dict", "return_value"], ["mock_kubernetes_hook", "return_value", "create_custom_object", "return_value"], ["mock_kubernetes_hook", "return_value", "get_namespace", "return_value"]], "side_effect": [["mock_stream", "side_effect", "object_mock"]]}, "name": "test_raise_exception_when_job_fails", "params": {"mock_kubernetes_hook": "", "mock_load_body_to_dict": "", "mock_on_kill": "", "mock_stream": ""}, "params_descr": {"mock_kubernetes_hook": "", "mock_load_body_to_dict": "", "mock_on_kill": "", "mock_stream": ""}, "params_occur": {"mock_kubernetes_hook": [["mock_kubernetes_hook", "return_value", "create_custom_object", "return_value"], ["mock_kubernetes_hook", "return_value", "get_namespace", "return_value"]], "mock_load_body_to_dict": [["mock_load_body_to_dict", "return_value"]], "mock_on_kill": [["mock_on_kill", "has_called_once"]], "mock_stream": [["mock_stream", "side_effect", "object_mock"]]}, "params_p": {"args": [], "kwargs": [], "mock_kubernetes_hook": [["unittesmock.MagicMock", 0.187114446554032], ["mock.MagicMock", 0.09534296089893125]], "mock_load_body_to_dict": [["mock.Mock", 0.24877579519162352], ["unittesmock.MagicMock", 0.173015935065931]], "mock_on_kill": [["unittesmock.MagicMock", 0.4903242464772935], ["mock.Mock", 0.12279987104742132]], "mock_stream": [["unittesmock.MagicMock", 0.4903242464772935], ["mock.Mock", 0.12279987104742132]]}, "q_name": "test_raise_exception_when_job_fails", "ret_exprs": [], "ret_type": "", "variables": {"last_timestamp": "", "message": "", "object_mock": "", "op": "", "reason": "", "return_value": "", "side_effect": ""}, "variables_p": {"last_timestamp": [["Dict[str, Union[int, str]]", 0.26360142429980626], ["str", 0.1037361520832562], ["unittesmock._patch[Union[unittesmock.AsyncMock, unittesmock.MagicMock]]", 0.09449308320496966], ["bool", 0.08829968321261149]], "message": [["Dict[int, Dict[str, Any]]", 0.22534638571475643], ["Tuple[Literal, Literal, Literal]", 0.20935800768538151], ["str", 0.19752931247054933], ["List[str]", 0.16641002232610663], ["property", 0.07148526777121711]], "object_mock": [], "op": [["str", 0.5748898362001962], ["int", 0.09345463895817581], ["tuple", 0.0856709300229327]], "reason": [["Dict[int, Dict[str, Any]]", 0.22534638571475643], ["Tuple[Literal, Literal, Literal]", 0.20935800768538151], ["str", 0.19752931247054933], ["List[str]", 0.16641002232610663], ["property", 0.07148526777121711]], "return_value": [["Dict[str, Dict[str, Any]]", 0.2208861715234029], ["Dict[str, Union[Any, Any]]", 0.17986401683365827], ["Dict[str, int]", 0.07940541415050836], ["str", 0.06793252277622279]], "side_effect": [["str", 0.46146968833119484], ["List[Dict[str, float]]", 0.10543346334745063], ["Dict[str, Dict[str, str]]", 0.0831681400737581]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[121, 0], [139, 110]], "fn_var_ln": {"op": [[129, 4], [129, 6]], "operator_output": [[130, 4], [130, 19]], "return_value": [[122, 4], [122, 39]]}, "fn_var_occur": {"op": [["op", "SparkKubernetesOperator", "task_id", "application_file"], ["operator_output", "op", "execute"]], "operator_output": [["operator_output", "op", "execute"]], "return_value": [["mock_load_body_to_dict", "return_value"], ["mock_kubernetes_hook", "return_value", "create_custom_object", "return_value"], ["mock_kubernetes_hook", "return_value", "get_namespace", "return_value"], ["mock_kubernetes_hook", "return_value", "create_custom_object", "assert_called_once_with", "group", "version", "plural", "body", "namespace"]]}, "name": "test_execute_without_watch", "params": {"mock_kubernetes_hook": "", "mock_load_body_to_dict": ""}, "params_descr": {"mock_kubernetes_hook": "", "mock_load_body_to_dict": ""}, "params_occur": {"mock_kubernetes_hook": [["mock_kubernetes_hook", "return_value", "create_custom_object", "return_value"], ["mock_kubernetes_hook", "return_value", "get_namespace", "return_value"], ["mock_kubernetes_hook", "return_value", "create_custom_object", "assert_called_once_with", "group", "version", "plural", "body", "namespace"]], "mock_load_body_to_dict": [["mock_load_body_to_dict", "return_value"]]}, "params_p": {"args": [], "kwargs": [], "mock_kubernetes_hook": [["unittesmock.MagicMock", 0.21721100512955838], ["mock.MagicMock", 0.2074461451414734]], "mock_load_body_to_dict": [["unittesmock.MagicMock", 0.781416884908029]]}, "q_name": "test_execute_without_watch", "ret_exprs": [], "ret_type": "", "variables": {"op": "", "operator_output": "", "return_value": ""}, "variables_p": {"op": [["int", 0.19711082864733623], ["str", 0.1921783762124461], ["bool", 0.10770659930355804], ["bytes", 0.10055480112602182]], "operator_output": [["str", 0.4708759984730564], ["List[Dict[str, Any]]", 0.1024342102508022], ["set", 0.07351666690003965]], "return_value": [["Dict[str, Dict[str, Any]]", 0.2208861715234029], ["Dict[str, Union[Any, Any]]", 0.17986401683365827], ["Dict[str, int]", 0.07940541415050836], ["str", 0.06793252277622279]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[144, 0], [158, 5]], "fn_var_ln": {"op": [[148, 4], [148, 6]], "return_value": [[145, 4], [145, 39]]}, "fn_var_occur": {"op": [["op", "SparkKubernetesOperator", "task_id", "application_file"], ["op", "on_kill"]], "return_value": [["mock_load_body_to_dict", "return_value"], ["mock_kubernetes_hook", "return_value", "get_namespace", "return_value"], ["mock_kubernetes_hook", "return_value", "delete_custom_object", "assert_called_once_with", "group", "version", "plural", "namespace", "name"]]}, "name": "test_on_kill", "params": {"mock_kubernetes_hook": "", "mock_load_body_to_dict": ""}, "params_descr": {"mock_kubernetes_hook": "", "mock_load_body_to_dict": ""}, "params_occur": {"mock_kubernetes_hook": [["mock_kubernetes_hook", "return_value", "get_namespace", "return_value"], ["mock_kubernetes_hook", "return_value", "delete_custom_object", "assert_called_once_with", "group", "version", "plural", "namespace", "name"]], "mock_load_body_to_dict": [["mock_load_body_to_dict", "return_value"]]}, "params_p": {"args": [], "kwargs": [], "mock_kubernetes_hook": [["unittesmock.MagicMock", 0.5579985661739303], ["mock.MagicMock", 0.17604899757537637]], "mock_load_body_to_dict": [["unittesmock.MagicMock", 0.781416884908029]]}, "q_name": "test_on_kill", "ret_exprs": [], "ret_type": "", "variables": {"op": "", "return_value": ""}, "variables_p": {"op": [["str", 0.5178033926427257], ["dict", 0.17723596967875396], ["Union[Literal, Literal]", 0.08551727348439983]], "return_value": [["str", 0.19106023461212723], ["Optional[bytes]", 0.111640524068916], ["int", 0.10779185967584946], ["Dict[str, List[Any]]", 0.08116452462345057], ["List[Dict[str, str]]", 0.07777026652666454], ["datetime.datetime", 0.07599381689714794]]}}], "imports": ["__future__", "annotations", "datetime", "datetime", "unittest", "mock", "MagicMock", "patch", "pytest", "dateutil", "tz", "airflow", "AirflowException", "airflow", "providers", "cncf", "kubernetes", "operators", "spark_kubernetes", "SparkKubernetesOperator"], "mod_var_ln": {}, "mod_var_occur": {}, "no_types_annot": {"D": 0, "I": 0, "U": 36}, "session_id": "iL8OOmH7DY4Bv6otRcvYQTiseL9u7MKms86L28p1yL4", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {}, "variables_p": {}}}