{"error": null, "response": {"classes": [{"cls_lc": [[57, 0], [147, 52]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[59, 4], [61, 36]], "fn_var_ln": {"admin_user": [[61, 8], [61, 23]], "app": [[60, 8], [60, 16]]}, "fn_var_occur": {"admin_user": [["self", "admin_user", "admin_user"]], "app": [["self", "app", "google_openid_app"]]}, "name": "_set_attrs", "params": {"admin_user": "", "google_openid_app": "", "self": ""}, "params_descr": {"admin_user": "", "google_openid_app": "", "self": ""}, "params_occur": {"admin_user": [["self", "admin_user", "admin_user"]], "google_openid_app": [["self", "app", "google_openid_app"]], "self": [["self", "app", "google_openid_app"], ["self", "admin_user", "admin_user"]]}, "params_p": {"admin_user": [["str", 0.29985204764889617], ["bool", 0.21344698383635627], ["int", 0.10079783688675482], ["Optional[str]", 0.09959643138246592], ["Dict[str, Any]", 0.09104355129070843]], "args": [], "google_openid_app": [["Optional[int]", 0.08717906136741799], ["bool", 0.08717906136741799], ["Optional[str]", 0.08717906136741799]], "kwargs": [], "self": []}, "q_name": "TestGoogleOpenID._set_attrs", "ret_exprs": [], "ret_type": "None", "variables": {"admin_user": "", "app": ""}, "variables_p": {"admin_user": [["str", 0.40987524350883425], ["Dict[str, Union[str, Set]]", 0.105174867732668], ["Dict[str, Any]", 0.08738177665434481]], "app": [["flask.app.Flask", 0.469801754494644], ["asyncworker.app.App", 0.08912835553805726], ["str", 0.08630439906987275]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[64, 4], [79, 51]], "fn_var_ln": {"response": [[73, 12], [73, 20]], "return_value": [[66, 8], [66, 38]]}, "fn_var_occur": {"response": [["response", "test_client", "get", "headers"], ["response", "status_code"], ["str", "response", "json"]], "return_value": [["mock_verify_token", "return_value", "True"]]}, "name": "test_success", "params": {"mock_verify_token": "", "self": ""}, "params_descr": {"mock_verify_token": "", "self": ""}, "params_occur": {"mock_verify_token": [["mock_verify_token", "return_value", "True"]], "self": [["self", "app", "test_client", "test_client"]]}, "params_p": {"args": [], "kwargs": [], "mock_verify_token": [["mock.MagicMock", 0.08965658453972991]], "self": []}, "q_name": "TestGoogleOpenID.test_success", "ret_exprs": [], "ret_type": "", "variables": {"response": "", "return_value": ""}, "variables_p": {"response": [], "return_value": [["list", 0.16029958167037964], ["List[str]", 0.14553720445254295], ["Optional[bytes]", 0.12694362101953677], ["str", 0.11176311340731358], ["Tuple[int, int]", 0.09377314312562458], ["int", 0.07926586939411204], ["Dict[str, Dict[str, Any]]", 0.06948960229955532], ["app.repositories.IRoleRepository", 0.06773598319833721]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[83, 4], [94, 52]], "fn_var_ln": {"response": [[91, 12], [91, 20]], "return_value": [[84, 8], [84, 38]]}, "fn_var_occur": {"response": [["response", "test_client", "get", "headers", "auth_header"], ["response", "status_code"], ["response", "data", "decode"]], "return_value": [["mock_verify_token", "return_value", "True"]]}, "name": "test_malformed_headers", "params": {"auth_header": "", "mock_verify_token": "", "self": ""}, "params_descr": {"auth_header": "", "mock_verify_token": "", "self": ""}, "params_occur": {"auth_header": [["response", "test_client", "get", "headers", "auth_header"]], "mock_verify_token": [["mock_verify_token", "return_value", "True"]], "self": [["self", "app", "test_client", "test_client"]]}, "params_p": {"args": [], "auth_header": [], "kwargs": [], "mock_verify_token": [], "self": []}, "q_name": "TestGoogleOpenID.test_malformed_headers", "ret_exprs": [], "ret_type": "", "variables": {"response": "", "return_value": ""}, "variables_p": {"response": [], "return_value": [["list", 0.16029958167037964], ["List[str]", 0.14553720445254295], ["Optional[bytes]", 0.12694362101953677], ["str", 0.11176311340731358], ["Tuple[int, int]", 0.09377314312562458], ["int", 0.07926586939411204], ["Dict[str, Dict[str, Any]]", 0.06948960229955532], ["app.repositories.IRoleRepository", 0.06773598319833721]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[97, 4], [110, 52]], "fn_var_ln": {"response": [[105, 12], [105, 20]], "return_value": [[98, 8], [98, 38]]}, "fn_var_occur": {"response": [["response", "test_client", "get", "headers"], ["response", "status_code"], ["response", "data", "decode"]], "return_value": [["mock_verify_token", "return_value", "True"]]}, "name": "test_invalid_iss_in_jwt_token", "params": {"mock_verify_token": "", "self": ""}, "params_descr": {"mock_verify_token": "", "self": ""}, "params_occur": {"mock_verify_token": [["mock_verify_token", "return_value", "True"]], "self": [["self", "app", "test_client", "test_client"]]}, "params_p": {"args": [], "kwargs": [], "mock_verify_token": [], "self": []}, "q_name": "TestGoogleOpenID.test_invalid_iss_in_jwt_token", "ret_exprs": [], "ret_type": "", "variables": {"response": "", "return_value": ""}, "variables_p": {"response": [], "return_value": [["list", 0.16029958167037964], ["List[str]", 0.14553720445254295], ["Optional[bytes]", 0.12694362101953677], ["str", 0.11176311340731358], ["Tuple[int, int]", 0.09377314312562458], ["int", 0.07926586939411204], ["Dict[str, Dict[str, Any]]", 0.06948960229955532], ["app.repositories.IRoleRepository", 0.06773598319833721]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[113, 4], [126, 52]], "fn_var_ln": {"response": [[121, 12], [121, 20]], "return_value": [[114, 8], [114, 38]]}, "fn_var_occur": {"response": [["response", "test_client", "get", "headers"], ["response", "status_code"], ["response", "data", "decode"]], "return_value": [["mock_verify_token", "return_value", "True"]]}, "name": "test_user_not_exists", "params": {"mock_verify_token": "", "self": ""}, "params_descr": {"mock_verify_token": "", "self": ""}, "params_occur": {"mock_verify_token": [["mock_verify_token", "return_value", "True"]], "self": [["self", "app", "test_client", "test_client"]]}, "params_p": {"args": [], "kwargs": [], "mock_verify_token": [], "self": []}, "q_name": "TestGoogleOpenID.test_user_not_exists", "ret_exprs": [], "ret_type": "", "variables": {"response": "", "return_value": ""}, "variables_p": {"response": [], "return_value": [["list", 0.16029958167037964], ["List[str]", 0.14553720445254295], ["Optional[bytes]", 0.12694362101953677], ["str", 0.11176311340731358], ["Tuple[int, int]", 0.09377314312562458], ["int", 0.07926586939411204], ["Dict[str, Dict[str, Any]]", 0.06948960229955532], ["app.repositories.IRoleRepository", 0.06773598319833721]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[129, 4], [134, 52]], "fn_var_ln": {"response": [[131, 12], [131, 20]]}, "fn_var_occur": {"response": [["response", "test_client", "get"], ["response", "status_code"], ["response", "data", "decode"]]}, "name": "test_missing_id_token", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "app", "test_client", "test_client"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestGoogleOpenID.test_missing_id_token", "ret_exprs": [], "ret_type": "", "variables": {"response": ""}, "variables_p": {"response": []}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[138, 4], [147, 52]], "fn_var_ln": {"response": [[142, 12], [142, 20]], "side_effect": [[139, 8], [139, 37]]}, "fn_var_occur": {"response": [["response", "test_client", "get", "headers"], ["response", "status_code"], ["response", "data", "decode"]], "side_effect": [["mock_verify_token", "side_effect", "GoogleAuthError"]]}, "name": "test_invalid_id_token", "params": {"mock_verify_token": "", "self": ""}, "params_descr": {"mock_verify_token": "", "self": ""}, "params_occur": {"mock_verify_token": [["mock_verify_token", "side_effect", "GoogleAuthError"]], "self": [["self", "app", "test_client", "test_client"]]}, "params_p": {"args": [], "kwargs": [], "mock_verify_token": [["tests.test_util.aiohttp.AiohttpClientMocker", 0.38761526900287796]], "self": []}, "q_name": "TestGoogleOpenID.test_invalid_id_token", "ret_exprs": [], "ret_type": "", "variables": {"response": "", "side_effect": ""}, "variables_p": {"response": [], "side_effect": [["str", 0.3140429991495234], ["Dict[str, Union[Any, Any]]", 0.11417583543486803], ["mock._patch[Literal]", 0.10410278668436763], ["Dict[str, Dict[str, str]]", 0.08764415761454245]]}}], "name": "TestGoogleOpenID", "q_name": "TestGoogleOpenID", "variables": {}, "variables_p": {}}], "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[31, 0], [37, 39]], "fn_var_ln": {"confs": [[32, 4], [32, 9]]}, "fn_var_occur": {"confs": [["conf_vars", "confs"]]}, "name": "google_openid_app", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "google_openid_app", "ret_exprs": ["return create_app(testing=True)"], "ret_type": "", "ret_type_p": [["dict", 0.10270262630246049], ["str", 0.09972629502087178], ["List[str]", 0.09908612312197267]], "variables": {"confs": ""}, "variables_p": {"confs": [["str", 0.2844275469263919], ["list", 0.14149072373554294], ["Dict[int, str]", 0.11893654951357625], ["int", 0.0681471656786011], ["List[str]", 0.06188657764696494]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[41, 0], [54, 21]], "fn_var_ln": {"appbuilder": [[42, 4], [42, 14]], "role_admin": [[43, 4], [43, 14]], "tester": [[44, 4], [44, 10]]}, "fn_var_occur": {"appbuilder": [["appbuilder", "google_openid_app", "appbuilder"], ["role_admin", "appbuilder", "sm", "find_role"], ["tester", "appbuilder", "sm", "find_user", "username"], ["appbuilder", "sm", "add_user", "username", "first_name", "last_name", "email", "role", "role_admin", "password"]], "role_admin": [["role_admin", "appbuilder", "sm", "find_role"], ["appbuilder", "sm", "add_user", "username", "first_name", "last_name", "email", "role", "role_admin", "password"]], "tester": [["tester", "appbuilder", "sm", "find_user", "username"]]}, "name": "admin_user", "params": {"google_openid_app": ""}, "params_descr": {"google_openid_app": ""}, "params_occur": {"google_openid_app": [["appbuilder", "google_openid_app", "appbuilder"]]}, "params_p": {"args": [], "google_openid_app": [["bool", 0.15809261974929575], ["str", 0.13046806030310892], ["dict", 0.11473338625031568], ["cli_ui.tests.MessageRecorder", 0.07110454090760744]], "kwargs": []}, "q_name": "admin_user", "ret_exprs": ["return role_admin"], "ret_type": "", "ret_type_p": [["int", 0.7499999997066159], ["str", 0.25000000002784034], ["bool", 6.595952460178308e-11], ["float", 6.335468858983151e-11]], "variables": {"appbuilder": "", "role_admin": "", "tester": ""}, "variables_p": {"appbuilder": [], "role_admin": [], "tester": [["str", 0.3977948918035744], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.13771148522684548], ["Type[taxonomy.db.models.taxon.Taxon]", 0.07932989427083896]]}}], "imports": ["__future__", "annotations", "unittest", "mock", "pytest", "flask_login", "current_user", "google", "auth", "exceptions", "GoogleAuthError", "airflow", "www", "app", "create_app", "tests", "test_utils", "config", "conf_vars", "tests", "test_utils", "db", "clear_db_pools"], "mod_var_ln": {}, "mod_var_occur": {}, "no_types_annot": {"D": 1, "I": 0, "U": 33}, "session_id": "-jP_gL9aTrhTOwf4YCbpf1PtSXj38sG9VSRSXGWBa54", "set": null, "tc": [false, null], "type_annot_cove": 0.03, "typed_seq": "", "untyped_seq": "", "variables": {}, "variables_p": {}}}