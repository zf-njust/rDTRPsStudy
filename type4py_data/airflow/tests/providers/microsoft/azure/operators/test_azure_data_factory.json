{"error": null, "response": {"classes": [{"cls_lc": [[62, 0], [263, 9]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[63, 4], [84, 9]], "fn_var_ln": {"config": [[66, 8], [66, 19]], "mock_context": [[65, 8], [65, 25]], "mock_ti": [[64, 8], [64, 20]]}, "fn_var_occur": {"config": [["self", "config", "TASK_ID", "AZURE_DATA_FACTORY_CONN_ID", "PIPELINE_NAME"]], "mock_context": [["self", "mock_context", "self", "mock_ti"]], "mock_ti": [["self", "mock_ti", "MagicMock"], ["self", "mock_context", "self", "mock_ti"]]}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "mock_ti", "MagicMock"], ["self", "mock_context", "self", "mock_ti"], ["self", "config", "TASK_ID", "AZURE_DATA_FACTORY_CONN_ID", "PIPELINE_NAME"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestAzureDataFactoryRunPipelineOperator.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"config": "", "mock_context": "", "mock_ti": ""}, "variables_p": {"config": [["Final", 0.22556482600226874], ["Dict[str, Dict[str, Any]]", 0.22352015019706956], ["Dict[str, str]", 0.08349994316730301], ["str", 0.0679762902940425]], "mock_context": [["unittesmock.MagicMock", 0.3192978773292947], ["str", 0.2302032910610023], ["Dict[str, Tuple[str, Any]]", 0.15180877532370887]], "mock_ti": [["unittesmock.MagicMock", 0.12421377068200695], ["mock.Mock", 0.10467112661195548], ["Dict[str, Any]", 0.0862524470801677], ["List[int]", 0.08356094750572061], ["Dict[str, str]", 0.08206885407860746]]}}, {"docstring": {"func": "Helper function to create a mock pipeline run with a given execution status.", "long_descr": null, "ret": null}, "fn_lc": [[87, 4], [93, 18]], "fn_var_ln": {"run": [[90, 8], [90, 11]], "status": [[91, 8], [91, 18]]}, "fn_var_occur": {"run": [["run", "MagicMock"], ["run", "status", "status"]], "status": [["run", "status", "status"]]}, "name": "create_pipeline_run", "params": {"status": "builtins.str"}, "params_descr": {"status": ""}, "params_occur": {"status": [["run", "status", "status"]]}, "params_p": {"args": [], "kwargs": [], "self": [], "status": [["str", 0.3556954119198467], ["int", 0.31838069382179446], ["medtagger.types.LabelID", 0.08664899896542569]]}, "q_name": "TestAzureDataFactoryRunPipelineOperator.create_pipeline_run", "ret_exprs": ["return run"], "ret_type": "", "ret_type_p": [["bool", 1.0]], "variables": {"run": "", "status": ""}, "variables_p": {"run": [["int", 0.3162822237228662], ["str", 0.18630815743600168], ["bytes", 0.10270378283489279]], "status": [["int", 0.9999999999470058], ["dict", 2.93689672791059e-11], ["str", 1.3835494385978269e-11], ["Dict[str, str]", 9.789655759701967e-12]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[107, 4], [180, 17]], "fn_var_ln": {"operator": [[108, 8], [108, 16]], "return_value": [[119, 12], [119, 46]]}, "fn_var_occur": {"operator": [["operator", "AzureDataFactoryRunPipelineOperator", "self", "config"], ["operator", "azure_data_factory_conn_id", "self", "config"], ["operator", "pipeline_name", "self", "config"], ["operator", "resource_group_name", "self", "config"], ["operator", "factory_name", "self", "config"], ["operator", "check_interval", "self", "config"], ["operator", "timeout", "self", "config"], ["operator", "wait_for_termination"], ["operator", "execute", "context", "self", "mock_context"], ["operator", "execute", "context", "self", "mock_context"], ["operator", "execute", "context", "self", "mock_context"], ["operator", "run_id", "PIPELINE_RUN_RESPONSE"]], "return_value": [["mock_get_pipeline_run", "return_value", "TestAzureDataFactoryRunPipelineOperator", "create_pipeline_run", "pipeline_run_status"], ["mock_get_pipeline_run", "assert_called_once_with", "run_id", "mock_run_pipeline", "return_value", "run_id", "factory_name", "self", "config", "resource_group_name", "self", "config"], ["mock_get_pipeline_run", "assert_called_with", "run_id", "mock_run_pipeline", "return_value", "run_id", "factory_name", "self", "config", "resource_group_name", "self", "config"]]}, "name": "test_execute_wait_for_termination", "params": {"expected_output": "", "mock_run_pipeline": "", "pipeline_run_status": "", "self": ""}, "params_descr": {"expected_output": "", "mock_run_pipeline": "", "pipeline_run_status": "", "self": ""}, "params_occur": {"expected_output": [], "mock_run_pipeline": [["mock_run_pipeline", "assert_called_once_with", "pipeline_name", "self", "config", "resource_group_name", "self", "config", "factory_name", "self", "config", "reference_pipeline_run_id", "None", "is_recovery", "None", "start_activity_name", "None", "start_from_failure", "None", "parameters", "None"], ["mock_get_pipeline_run", "assert_called_once_with", "run_id", "mock_run_pipeline", "return_value", "run_id", "factory_name", "self", "config", "resource_group_name", "self", "config"], ["mock_get_pipeline_run", "assert_called_with", "run_id", "mock_run_pipeline", "return_value", "run_id", "factory_name", "self", "config", "resource_group_name", "self", "config"]], "pipeline_run_status": [["mock_get_pipeline_run", "return_value", "TestAzureDataFactoryRunPipelineOperator", "create_pipeline_run", "pipeline_run_status"], ["pipeline_run_status", "AzureDataFactoryPipelineRunStatus", "TERMINAL_STATUSES"]], "self": [["operator", "AzureDataFactoryRunPipelineOperator", "self", "config"], ["operator", "azure_data_factory_conn_id", "self", "config"], ["operator", "pipeline_name", "self", "config"], ["operator", "resource_group_name", "self", "config"], ["operator", "factory_name", "self", "config"], ["operator", "check_interval", "self", "config"], ["operator", "timeout", "self", "config"], ["operator", "execute", "context", "self", "mock_context"], ["operator", "execute", "context", "self", "mock_context"], ["pytest", "raises", "AzureDataFactoryPipelineRunException", "match", "PIPELINE_RUN_RESPONSE", "self", "config"], ["operator", "execute", "context", "self", "mock_context"], ["self", "mock_ti", "xcom_push", "assert_called_once_with", "key", "value", "PIPELINE_RUN_RESPONSE"], ["mock_run_pipeline", "assert_called_once_with", "pipeline_name", "self", "config", "resource_group_name", "self", "config", "factory_name", "self", "config", "reference_pipeline_run_id", "None", "is_recovery", "None", "start_activity_name", "None", "start_from_failure", "None", "parameters", "None"], ["mock_get_pipeline_run", "assert_called_once_with", "run_id", "mock_run_pipeline", "return_value", "run_id", "factory_name", "self", "config", "resource_group_name", "self", "config"], ["mock_get_pipeline_run", "assert_called_with", "run_id", "mock_run_pipeline", "return_value", "run_id", "factory_name", "self", "config", "resource_group_name", "self", "config"]]}, "params_p": {"args": [], "expected_output": [["List[Tuple[int, str]]", 0.1018524111880502], ["salon.models.Stylist", 0.0974056336991539], ["Callable", 0.09117082350634129], ["bool", 0.09056149471820242]], "kwargs": [], "mock_run_pipeline": [["Optional[str]", 0.1155822142810456], ["unittesmock.MagicMock", 0.0953670196463715], ["List[str]", 0.09267289732682317], ["str", 0.08964155176069978]], "pipeline_run_status": [["unittesmock.MagicMock", 0.5772873447875492], ["int", 0.09679488621830291]], "self": []}, "q_name": "TestAzureDataFactoryRunPipelineOperator.test_execute_wait_for_termination", "ret_exprs": [], "ret_type": "", "variables": {"operator": "", "return_value": ""}, "variables_p": {"operator": [["Dict[int, str]", 0.6066983698627094], ["str", 0.299271654211155], ["Type[psef.models.rubric.RubricItem]", 0.0940299759261358]], "return_value": [["str", 0.4712636182329637], ["list", 0.0954156464258528], ["tests.utils.MockCoroutine", 0.08864246955133871], ["List[Dict[str, str]]", 0.08860696109729986]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[183, 4], [216, 53]], "fn_var_ln": {"operator": [[184, 8], [184, 16]]}, "fn_var_occur": {"operator": [["operator", "AzureDataFactoryRunPipelineOperator", "wait_for_termination", "False", "self", "config"], ["operator", "azure_data_factory_conn_id", "self", "config"], ["operator", "pipeline_name", "self", "config"], ["operator", "resource_group_name", "self", "config"], ["operator", "factory_name", "self", "config"], ["operator", "check_interval", "self", "config"], ["operator", "wait_for_termination"], ["operator", "execute", "context", "self", "mock_context"], ["operator", "run_id", "PIPELINE_RUN_RESPONSE"]]}, "name": "test_execute_no_wait_for_termination", "params": {"mock_run_pipeline": "", "self": ""}, "params_descr": {"mock_run_pipeline": "", "self": ""}, "params_occur": {"mock_run_pipeline": [["mock_run_pipeline", "assert_called_once_with", "pipeline_name", "self", "config", "resource_group_name", "self", "config", "factory_name", "self", "config", "reference_pipeline_run_id", "None", "is_recovery", "None", "start_activity_name", "None", "start_from_failure", "None", "parameters", "None"]], "self": [["operator", "AzureDataFactoryRunPipelineOperator", "wait_for_termination", "False", "self", "config"], ["operator", "azure_data_factory_conn_id", "self", "config"], ["operator", "pipeline_name", "self", "config"], ["operator", "resource_group_name", "self", "config"], ["operator", "factory_name", "self", "config"], ["operator", "check_interval", "self", "config"], ["operator", "execute", "context", "self", "mock_context"], ["self", "mock_ti", "xcom_push", "assert_called_once_with", "key", "value", "PIPELINE_RUN_RESPONSE"], ["mock_run_pipeline", "assert_called_once_with", "pipeline_name", "self", "config", "resource_group_name", "self", "config", "factory_name", "self", "config", "reference_pipeline_run_id", "None", "is_recovery", "None", "start_activity_name", "None", "start_from_failure", "None", "parameters", "None"]]}, "params_p": {"args": [], "kwargs": [], "mock_run_pipeline": [["str", 0.09940692590686186]], "self": []}, "q_name": "TestAzureDataFactoryRunPipelineOperator.test_execute_no_wait_for_termination", "ret_exprs": [], "ret_type": "", "variables": {"operator": ""}, "variables_p": {"operator": [["str", 0.5886637076869835], ["bool", 0.09839805682311831], ["Dict[str, Union[int, str]]", 0.09636741848944749]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[231, 4], [263, 9]], "fn_var_ln": {"EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK": [[245, 8], [245, 43]], "conn": [[252, 8], [252, 12]], "conn_factory_name": [[254, 8], [254, 25]], "conn_resource_group_name": [[253, 8], [253, 32]], "ti": [[232, 8], [232, 10]], "url": [[244, 8], [244, 11]]}, "fn_var_occur": {"EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK": [["url", "EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK", "format", "run_id", "PIPELINE_RUN_RESPONSE", "subscription_id", "SUBSCRIPTION_ID", "resource_group_name", "resource_group", "resource_group", "conn_resource_group_name", "factory_name", "factory", "factory", "conn_factory_name"]], "conn": [["conn", "AzureDataFactoryHook", "get_connection"], ["conn_resource_group_name", "conn", "extra_dejson"], ["conn_factory_name", "conn", "extra_dejson"]], "conn_factory_name": [["conn_factory_name", "conn", "extra_dejson"], ["url", "EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK", "format", "run_id", "PIPELINE_RUN_RESPONSE", "subscription_id", "SUBSCRIPTION_ID", "resource_group_name", "resource_group", "resource_group", "conn_resource_group_name", "factory_name", "factory", "factory", "conn_factory_name"]], "conn_resource_group_name": [["conn_resource_group_name", "conn", "extra_dejson"], ["url", "EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK", "format", "run_id", "PIPELINE_RUN_RESPONSE", "subscription_id", "SUBSCRIPTION_ID", "resource_group_name", "resource_group", "resource_group", "conn_resource_group_name", "factory_name", "factory", "factory", "conn_factory_name"]], "ti": [["ti", "create_task_instance_of_operator", "AzureDataFactoryRunPipelineOperator", "dag_id", "execution_date", "DEFAULT_DATE", "task_id", "TASK_ID", "azure_data_factory_conn_id", "AZURE_DATA_FACTORY_CONN_ID", "pipeline_name", "PIPELINE_NAME", "resource_group_name", "resource_group", "factory_name", "factory"], ["ti", "xcom_push", "key", "value", "PIPELINE_RUN_RESPONSE"], ["url", "ti", "task", "get_extra_links", "ti"]], "url": [["url", "ti", "task", "get_extra_links", "ti"], ["url", "EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK", "format", "run_id", "PIPELINE_RUN_RESPONSE", "subscription_id", "SUBSCRIPTION_ID", "resource_group_name", "resource_group", "resource_group", "conn_resource_group_name", "factory_name", "factory", "factory", "conn_factory_name"]]}, "name": "test_run_pipeline_operator_link", "params": {"create_task_instance_of_operator": "", "factory": "", "resource_group": "", "self": ""}, "params_descr": {"create_task_instance_of_operator": "", "factory": "", "resource_group": "", "self": ""}, "params_occur": {"create_task_instance_of_operator": [["ti", "create_task_instance_of_operator", "AzureDataFactoryRunPipelineOperator", "dag_id", "execution_date", "DEFAULT_DATE", "task_id", "TASK_ID", "azure_data_factory_conn_id", "AZURE_DATA_FACTORY_CONN_ID", "pipeline_name", "PIPELINE_NAME", "resource_group_name", "resource_group", "factory_name", "factory"]], "factory": [["ti", "create_task_instance_of_operator", "AzureDataFactoryRunPipelineOperator", "dag_id", "execution_date", "DEFAULT_DATE", "task_id", "TASK_ID", "azure_data_factory_conn_id", "AZURE_DATA_FACTORY_CONN_ID", "pipeline_name", "PIPELINE_NAME", "resource_group_name", "resource_group", "factory_name", "factory"], ["url", "EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK", "format", "run_id", "PIPELINE_RUN_RESPONSE", "subscription_id", "SUBSCRIPTION_ID", "resource_group_name", "resource_group", "resource_group", "conn_resource_group_name", "factory_name", "factory", "factory", "conn_factory_name"]], "resource_group": [["ti", "create_task_instance_of_operator", "AzureDataFactoryRunPipelineOperator", "dag_id", "execution_date", "DEFAULT_DATE", "task_id", "TASK_ID", "azure_data_factory_conn_id", "AZURE_DATA_FACTORY_CONN_ID", "pipeline_name", "PIPELINE_NAME", "resource_group_name", "resource_group", "factory_name", "factory"], ["url", "EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK", "format", "run_id", "PIPELINE_RUN_RESPONSE", "subscription_id", "SUBSCRIPTION_ID", "resource_group_name", "resource_group", "resource_group", "conn_resource_group_name", "factory_name", "factory", "factory", "conn_factory_name"]], "self": []}, "params_p": {"args": [], "create_task_instance_of_operator": [], "factory": [], "kwargs": [], "resource_group": [], "self": []}, "q_name": "TestAzureDataFactoryRunPipelineOperator.test_run_pipeline_operator_link", "ret_exprs": [], "ret_type": "", "variables": {"EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK": "", "conn": "", "conn_factory_name": "", "conn_resource_group_name": "", "ti": "", "url": ""}, "variables_p": {"EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK": [["str", 1.0000000000000002]], "conn": [["int", 0.38109396231761566], ["list", 0.13572938523999897], ["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.10301215478656614], ["raiden.utils.PaymentID", 0.08549762117338039]], "conn_factory_name": [["str", 0.6976799278960562], ["Optional[str]", 0.21345592864354396], ["Tuple[Literal, Literal]", 0.08886414346039975]], "conn_resource_group_name": [["str", 1.0]], "ti": [["List[str]", 0.10119897550621795], ["str", 0.09911572947326423]], "url": [["str", 0.7240273742296814], ["bytes", 0.18224153244346603]]}}], "name": "TestAzureDataFactoryRunPipelineOperator", "q_name": "TestAzureDataFactoryRunPipelineOperator", "variables": {}, "variables_p": {}}, {"cls_lc": [[327, 8], [328, 16]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [], "name": "CreateRunResponse", "q_name": "TestAzureDataFactoryRunPipelineOperatorWithDeferrable.test_azure_data_factory_run_pipeline_operator_async_succeeded_before_deferred.<locals>.CreateRunResponse", "variables": {}, "variables_p": {}}, {"cls_lc": [[350, 8], [351, 16]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [], "name": "CreateRunResponse", "q_name": "TestAzureDataFactoryRunPipelineOperatorWithDeferrable.test_azure_data_factory_run_pipeline_operator_async_error_before_deferred.<locals>.CreateRunResponse", "variables": {}, "variables_p": {}}, {"cls_lc": [[368, 8], [369, 16]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [], "name": "CreateRunResponse", "q_name": "TestAzureDataFactoryRunPipelineOperatorWithDeferrable.test_azure_data_factory_run_pipeline_operator_async.<locals>.CreateRunResponse", "variables": {}, "variables_p": {}}, {"cls_lc": [[266, 0], [398, 13]], "cls_var_ln": {"OPERATOR": [[267, 4], [267, 12]]}, "cls_var_occur": {"OPERATOR": []}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[271, 4], [275, 22]], "fn_var_ln": {"dag_run": [[272, 8], [272, 15]]}, "fn_var_occur": {"dag_run": [["dag_run", "DagRun", "dag_id", "dag_id", "run_type", "execution_date", "timezone", "datetime", "run_id", "run_id"]]}, "name": "get_dag_run", "params": {"dag_id": "builtins.str", "run_id": "builtins.str", "self": ""}, "params_descr": {"dag_id": "", "run_id": "", "self": ""}, "params_occur": {"dag_id": [["dag_run", "DagRun", "dag_id", "dag_id", "run_type", "execution_date", "timezone", "datetime", "run_id", "run_id"]], "run_id": [["dag_run", "DagRun", "dag_id", "dag_id", "run_type", "execution_date", "timezone", "datetime", "run_id", "run_id"]], "self": []}, "params_p": {"args": [], "dag_id": [["int", 0.32688083748890223], ["transfer.models.SnippetID", 0.10627750428116241], ["Optional[bool]", 0.09948542670943818], ["Optional[int]", 0.09948542670943818], ["str", 0.0915475277511814]], "kwargs": [], "run_id": [["int", 0.32688083748890223], ["transfer.models.SnippetID", 0.10627750428116241], ["Optional[bool]", 0.09948542670943818], ["Optional[int]", 0.09948542670943818], ["str", 0.0915475277511814]], "self": []}, "q_name": "TestAzureDataFactoryRunPipelineOperatorWithDeferrable.get_dag_run", "ret_exprs": ["return dag_run"], "ret_type": "airflow.models.dagrun.DagRun", "ret_type_p": [["bool", 0.6437993109259741], ["dict", 0.10228013498535118], ["int", 0.08976040223472107], ["Optional[int]", 0.08500185080039943], ["str", 0.07915830105355431]], "variables": {"dag_run": ""}, "variables_p": {"dag_run": [["str", 0.3179282837101777], ["Optional[magic.models.deck.Deck]", 0.18789139464573545], ["Dict[str, str]", 0.10993137318225703], ["list", 0.0964724502110449], ["ajapaik.ajapaik.models.Album", 0.09568811217626776], ["int", 0.09383873818474564]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[277, 4], [278, 64]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "get_task_instance", "params": {"self": "", "task": "airflow.models.baseoperator.BaseOperator"}, "params_descr": {"self": "", "task": ""}, "params_occur": {"self": [], "task": [["TaskInstance", "task", "timezone", "datetime"]]}, "params_p": {"args": [], "kwargs": [], "self": [], "task": [["str", 0.26596564966980624], ["dict", 0.1628079443609661]]}, "q_name": "TestAzureDataFactoryRunPipelineOperatorWithDeferrable.get_task_instance", "ret_exprs": ["return TaskInstance(task, timezone.datetime(2022, 1, 1))"], "ret_type": "airflow.models.taskinstance.TaskInstance", "ret_type_p": [["viewer.models.Gallery", 0.11129551788410393], ["Dict[str, Any]", 0.09983532944483395], ["str", 0.09138217213498612], ["int", 0.09138217213498612], ["List[str]", 0.08922481181167476], ["bool", 0.08788040696549498]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[280, 4], [286, 9]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "get_conn", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestAzureDataFactoryRunPipelineOperatorWithDeferrable.get_conn", "ret_exprs": ["return Connection( conn_id=\"test_conn\", extra={},)"], "ret_type": "airflow.models.Connection", "ret_type_p": [["str", 0.3549697862065865], ["List[Union[int, Any]]", 0.23631749049592662], ["List[Union[int, str]]", 0.23631749049592662], ["\"SqlFile\"", 0.09494904438808308], ["bool", 0.07744618841347722]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[288, 4], [313, 9]], "fn_var_ln": {"dag": [[290, 12], [290, 15]], "dag_run": [[300, 8], [300, 29]], "execution_date": [[292, 8], [292, 22]], "task_instance": [[299, 8], [299, 21]], "tzinfo": [[291, 8], [291, 14]], "xcom_push": [[301, 8], [301, 31]]}, "fn_var_occur": {"dag": [["dag", "None"], ["dag", "DAG", "dag_id"], ["dag_run", "DagRun", "dag_id", "dag", "dag_id", "execution_date", "execution_date", "run_id", "DagRun", "generate_run_id", "DagRunType", "MANUAL", "execution_date"], ["dag", "execution_date", "isoformat", "task", "task_instance", "task_instance", "dag_run", "run_id", "dag_run", "execution_date", "execution_date", "execution_date"]], "dag_run": [["dag_run", "DagRun", "dag_id", "dag", "dag_id", "execution_date", "execution_date", "run_id", "DagRun", "generate_run_id", "DagRunType", "MANUAL", "execution_date"], ["task_instance", "dag_run", "dag_run"], ["dag", "execution_date", "isoformat", "task", "task_instance", "task_instance", "dag_run", "run_id", "dag_run", "execution_date", "execution_date", "execution_date"]], "execution_date": [["execution_date", "timezone", "datetime", "tzinfo", "tzinfo"], ["dag_run", "DagRun", "dag_id", "dag", "dag_id", "execution_date", "execution_date", "run_id", "DagRun", "generate_run_id", "DagRunType", "MANUAL", "execution_date"], ["dag", "execution_date", "isoformat", "task", "task_instance", "task_instance", "dag_run", "run_id", "dag_run", "execution_date", "execution_date", "execution_date"]], "task_instance": [["task_instance", "TaskInstance", "task", "task"], ["task_instance", "dag_run", "dag_run"], ["task_instance", "xcom_push", "mock", "Mock"], ["dag", "execution_date", "isoformat", "task", "task_instance", "task_instance", "dag_run", "run_id", "dag_run", "execution_date", "execution_date", "execution_date"]], "tzinfo": [["tzinfo", "pendulum", "timezone"], ["execution_date", "timezone", "datetime", "tzinfo", "tzinfo"]], "xcom_push": [["task_instance", "xcom_push", "mock", "Mock"]]}, "name": "create_context", "params": {"dag": "", "self": "", "task": ""}, "params_descr": {"dag": "", "self": "", "task": ""}, "params_occur": {"dag": [["dag", "None"], ["dag", "DAG", "dag_id"], ["dag_run", "DagRun", "dag_id", "dag", "dag_id", "execution_date", "execution_date", "run_id", "DagRun", "generate_run_id", "DagRunType", "MANUAL", "execution_date"], ["dag", "execution_date", "isoformat", "task", "task_instance", "task_instance", "dag_run", "run_id", "dag_run", "execution_date", "execution_date", "execution_date"]], "self": [], "task": [["task_instance", "TaskInstance", "task", "task"], ["dag", "execution_date", "isoformat", "task", "task_instance", "task_instance", "dag_run", "run_id", "dag_run", "execution_date", "execution_date", "execution_date"]]}, "params_p": {"args": [], "dag": [["core.models.User", 0.09505855770119749], ["dict", 0.09443353659046937]], "kwargs": [], "self": [], "task": [["Dict[str, Any]", 0.10731785090950996], ["dict", 0.08306726852419884], ["models.Task", 0.08205356399440819]]}, "q_name": "TestAzureDataFactoryRunPipelineOperatorWithDeferrable.create_context", "ret_exprs": ["return { \"dag\": dag, \"ts\": execution_date.isoformat(), \"task\": task, \"ti\": task_instance, \"task_instance\": task_instance, \"run_id\": dag_run.run_id, \"dag_run\": dag_run, \"execution_date\": execution_date, \"data_interval_end\": execution_date, \"logical_date\": execution_date,}"], "ret_type": "", "ret_type_p": [["int", 0.21043530006714545], ["Callable", 0.10310806680491644], ["float", 0.09931121621090325], ["Dict[int, dict]", 0.09753785541554616], ["cmk.utils.type_defs.HostName", 0.09722759981171762], ["cmk.utils.type_defs.ServiceName", 0.09722759981171762], ["str", 0.09681804949109173]], "variables": {"dag": "", "dag_run": "", "execution_date": "", "task_instance": "", "tzinfo": "", "xcom_push": ""}, "variables_p": {"dag": [["list", 0.18469147607575137], ["dict", 0.1433969031420679], ["str", 0.09975082567351394]], "dag_run": [["int", 0.5960945529994207], ["Dict[str, str]", 0.12489984180792207], ["List[str]", 0.09448879481006968], ["str", 0.09207078022414338]], "execution_date": [["int", 0.28722443073627313], ["Type[prm.journals.models.moods.Mood]", 0.11335597038810503], ["List[Union[Any, Any]]", 0.0953747325593698]], "task_instance": [["kippo.tasks.models.KippoTask", 0.1995324285302391], ["taskiapplication.models.task.Task", 0.1438213855938901]], "tzinfo": [["int", 0.1665122240604473]], "xcom_push": [["List[str]", 0.11539457579881093], ["mock.MagicMock", 0.10447608657228281], ["Dict[str, List[str]]", 0.09702262411955585], ["str", 0.09482244766417133], ["List[int]", 0.09467376249613606]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[324, 4], [334, 36]], "fn_var_ln": {"return_value": [[331, 8], [331, 38]], "run_id": [[330, 8], [330, 32]]}, "fn_var_occur": {"return_value": [["mock_run_pipeline", "return_value", "CreateRunResponse"]], "run_id": [["CreateRunResponse", "run_id", "AZ_PIPELINE_RUN_ID"]]}, "name": "test_azure_data_factory_run_pipeline_operator_async_succeeded_before_deferred", "params": {"mock_defer": "", "mock_get_status": "", "mock_run_pipeline": "", "self": ""}, "params_descr": {"mock_defer": "", "mock_get_status": "", "mock_run_pipeline": "", "self": ""}, "params_occur": {"mock_defer": [["mock_defer", "called"]], "mock_get_status": [], "mock_run_pipeline": [["mock_run_pipeline", "return_value", "CreateRunResponse"]], "self": [["self", "OPERATOR", "execute", "context", "self", "create_context", "self", "OPERATOR"]]}, "params_p": {"args": [], "kwargs": [], "mock_defer": [["unittesmock.MagicMock", 0.3856891127475045], ["mock.Mock", 0.09648872264944981]], "mock_get_status": [], "mock_run_pipeline": [["unittesmock.MagicMock", 0.8723201972644509], ["mock.MagicMock", 0.12767980273554905]], "self": []}, "q_name": "TestAzureDataFactoryRunPipelineOperatorWithDeferrable.test_azure_data_factory_run_pipeline_operator_async_succeeded_before_deferred", "ret_exprs": [], "ret_type": "", "variables": {"return_value": "", "run_id": ""}, "variables_p": {"return_value": [["str", 0.20521891366803405], ["unittesmock.MagicMock", 0.19080608379299807], ["List[Tuple[str, str]]", 0.10741953448407443], ["int", 0.10461173595458528], ["tests.utils.MockCoroutine", 0.10166425418862822], ["Optional[str]", 0.08771228467967022], ["Optional[bytes]", 0.08701842084035936]], "run_id": [["str", 0.3221068996402669], ["int", 0.30162455892300666], ["Optional[str]", 0.10746341784302445]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[345, 4], [358, 36]], "fn_var_ln": {"return_value": [[354, 8], [354, 38]], "run_id": [[353, 8], [353, 32]]}, "fn_var_occur": {"return_value": [["mock_get_status", "return_value", "status"], ["mock_run_pipeline", "return_value", "CreateRunResponse"]], "run_id": [["CreateRunResponse", "run_id", "AZ_PIPELINE_RUN_ID"]]}, "name": "test_azure_data_factory_run_pipeline_operator_async_error_before_deferred", "params": {"mock_defer": "", "mock_get_status": "", "mock_run_pipeline": "", "self": "", "status": ""}, "params_descr": {"mock_defer": "", "mock_get_status": "", "mock_run_pipeline": "", "self": "", "status": ""}, "params_occur": {"mock_defer": [["mock_defer", "called"]], "mock_get_status": [["mock_get_status", "return_value", "status"]], "mock_run_pipeline": [["mock_run_pipeline", "return_value", "CreateRunResponse"]], "self": [["self", "OPERATOR", "execute", "context", "self", "create_context", "self", "OPERATOR"]], "status": [["mock_get_status", "return_value", "status"]]}, "params_p": {"args": [], "kwargs": [], "mock_defer": [["unittesmock.MagicMock", 0.6704720078865762], ["mock.Mock", 0.11740871739892862], ["mock.MagicMock", 0.09604266046937358]], "mock_get_status": [["unittesmock.MagicMock", 0.9062279866651206]], "mock_run_pipeline": [["mock.Mock", 0.5720590195989422], ["unittesmock.MagicMock", 0.4279409804010579]], "self": [], "status": [["unittesmock.MagicMock", 0.9062279866651206]]}, "q_name": "TestAzureDataFactoryRunPipelineOperatorWithDeferrable.test_azure_data_factory_run_pipeline_operator_async_error_before_deferred", "ret_exprs": [], "ret_type": "", "variables": {"return_value": "", "run_id": ""}, "variables_p": {"return_value": [["Dict[str, Dict[str, Any]]", 0.21115052762499176], ["Dict[str, Union[Any, Any]]", 0.18905012159702508], ["unittesmock.MagicMock", 0.10194880922404745], ["Dict[str, int]", 0.08869494660558763], ["Dict[str, Union[Any, Any, Any]]", 0.08116180693370462], ["int", 0.07297423857994234]], "run_id": [["str", 0.3221068996402669], ["int", 0.30162455892300666], ["Optional[str]", 0.10746341784302445]]}}, {"docstring": {"func": "Assert that AzureDataFactoryRunPipelineOperator(..., deferrable=True) deferred", "long_descr": null, "ret": null}, "fn_lc": [[365, 4], [379, 53]], "fn_var_ln": {"return_value": [[372, 8], [372, 38]], "run_id": [[371, 8], [371, 32]]}, "fn_var_occur": {"return_value": [["mock_run_pipeline", "return_value", "CreateRunResponse"]], "run_id": [["CreateRunResponse", "run_id", "AZ_PIPELINE_RUN_ID"]]}, "name": "test_azure_data_factory_run_pipeline_operator_async", "params": {"mock_get_status": "", "mock_run_pipeline": "", "self": "", "status": ""}, "params_descr": {"mock_get_status": "", "mock_run_pipeline": "", "self": "", "status": ""}, "params_occur": {"mock_get_status": [], "mock_run_pipeline": [["mock_run_pipeline", "return_value", "CreateRunResponse"]], "self": [["self", "OPERATOR", "execute", "context", "self", "create_context", "self", "OPERATOR"]], "status": []}, "params_p": {"args": [], "kwargs": [], "mock_get_status": [["Callable", 0.20627487637135045]], "mock_run_pipeline": [["unittesmock.MagicMock", 0.18606717197586622]], "self": [], "status": [["Callable", 0.20627487637135045]]}, "q_name": "TestAzureDataFactoryRunPipelineOperatorWithDeferrable.test_azure_data_factory_run_pipeline_operator_async", "ret_exprs": [], "ret_type": "", "variables": {"return_value": "", "run_id": ""}, "variables_p": {"return_value": [["str", 0.20521891366803405], ["unittesmock.MagicMock", 0.19080608379299807], ["List[Tuple[str, str]]", 0.10741953448407443], ["int", 0.10461173595458528], ["tests.utils.MockCoroutine", 0.10166425418862822], ["Optional[str]", 0.08771228467967022], ["Optional[bytes]", 0.08701842084035936]], "run_id": [["str", 0.3221068996402669], ["int", 0.30162455892300666], ["Optional[str]", 0.10746341784302445]]}}, {"docstring": {"func": "Assert that execute_complete log success message", "long_descr": null, "ret": null}, "fn_lc": [[381, 4], [389, 51]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_azure_data_factory_run_pipeline_operator_async_execute_complete_success", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["mock", "patch", "object", "self", "OPERATOR", "log", "mock_log_info"], ["self", "OPERATOR", "execute_complete", "context", "event", "AZ_PIPELINE_RUN_ID"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestAzureDataFactoryRunPipelineOperatorWithDeferrable.test_azure_data_factory_run_pipeline_operator_async_execute_complete_success", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Assert that execute_complete raise exception on error", "long_descr": null, "ret": null}, "fn_lc": [[391, 4], [398, 13]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_azure_data_factory_run_pipeline_operator_async_execute_complete_fail", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "OPERATOR", "execute_complete", "context", "event", "AZ_PIPELINE_RUN_ID"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestAzureDataFactoryRunPipelineOperatorWithDeferrable.test_azure_data_factory_run_pipeline_operator_async_execute_complete_fail", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}], "name": "TestAzureDataFactoryRunPipelineOperatorWithDeferrable", "q_name": "TestAzureDataFactoryRunPipelineOperatorWithDeferrable", "variables": {"OPERATOR": ""}, "variables_p": {"OPERATOR": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]]}}], "funcs": [], "imports": ["__future__", "annotations", "json", "unittest", "mock", "unittest", "mock", "MagicMock", "patch", "pendulum", "pytest", "airflow", "exceptions", "AirflowException", "TaskDeferred", "airflow", "models", "DAG", "Connection", "airflow", "models", "baseoperator", "BaseOperator", "airflow", "models", "dagrun", "DagRun", "airflow", "models", "taskinstance", "TaskInstance", "airflow", "providers", "microsoft", "azure", "hooks", "data_factory", "AzureDataFactoryHook", "AzureDataFactoryPipelineRunException", "AzureDataFactoryPipelineRunStatus", "airflow", "providers", "microsoft", "azure", "operators", "data_factory", "AzureDataFactoryRunPipelineOperator", "airflow", "providers", "microsoft", "azure", "triggers", "data_factory", "AzureDataFactoryTrigger", "airflow", "utils", "db", "timezone", "airflow", "utils", "types", "DagRunType"], "mod_var_ln": {"AZURE_DATA_FACTORY_CONN_ID": [[44, 0], [44, 26]], "AZ_PIPELINE_RUN_ID": [[59, 0], [59, 18]], "CONN_EXTRAS": [[46, 0], [46, 11]], "DEFAULT_DATE": [[41, 0], [41, 12]], "EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK": [[53, 0], [53, 35]], "PIPELINE_NAME": [[45, 0], [45, 13]], "PIPELINE_RUN_RESPONSE": [[52, 0], [52, 21]], "SUBSCRIPTION_ID": [[42, 0], [42, 15]], "TASK_ID": [[43, 0], [43, 7]]}, "mod_var_occur": {"AZURE_DATA_FACTORY_CONN_ID": [["self", "config", "TASK_ID", "AZURE_DATA_FACTORY_CONN_ID", "PIPELINE_NAME"], ["ti", "create_task_instance_of_operator", "AzureDataFactoryRunPipelineOperator", "dag_id", "execution_date", "DEFAULT_DATE", "task_id", "TASK_ID", "azure_data_factory_conn_id", "AZURE_DATA_FACTORY_CONN_ID", "pipeline_name", "PIPELINE_NAME", "resource_group_name", "resource_group", "factory_name", "factory"]], "AZ_PIPELINE_RUN_ID": [["CreateRunResponse", "run_id", "AZ_PIPELINE_RUN_ID"], ["CreateRunResponse", "run_id", "AZ_PIPELINE_RUN_ID"], ["CreateRunResponse", "run_id", "AZ_PIPELINE_RUN_ID"], ["self", "OPERATOR", "execute_complete", "context", "event", "AZ_PIPELINE_RUN_ID"], ["self", "OPERATOR", "execute_complete", "context", "event", "AZ_PIPELINE_RUN_ID"]], "CONN_EXTRAS": [["db", "merge_conn", "Connection", "conn_id", "conn_type", "login", "password", "extra", "json", "dumps", "CONN_EXTRAS"]], "DEFAULT_DATE": [["ti", "create_task_instance_of_operator", "AzureDataFactoryRunPipelineOperator", "dag_id", "execution_date", "DEFAULT_DATE", "task_id", "TASK_ID", "azure_data_factory_conn_id", "AZURE_DATA_FACTORY_CONN_ID", "pipeline_name", "PIPELINE_NAME", "resource_group_name", "resource_group", "factory_name", "factory"]], "EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK": [["EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK"], ["url", "EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK", "format", "run_id", "PIPELINE_RUN_RESPONSE", "subscription_id", "SUBSCRIPTION_ID", "resource_group_name", "resource_group", "resource_group", "conn_resource_group_name", "factory_name", "factory", "factory", "conn_factory_name"]], "PIPELINE_NAME": [["self", "config", "TASK_ID", "AZURE_DATA_FACTORY_CONN_ID", "PIPELINE_NAME"], ["ti", "create_task_instance_of_operator", "AzureDataFactoryRunPipelineOperator", "dag_id", "execution_date", "DEFAULT_DATE", "task_id", "TASK_ID", "azure_data_factory_conn_id", "AZURE_DATA_FACTORY_CONN_ID", "pipeline_name", "PIPELINE_NAME", "resource_group_name", "resource_group", "factory_name", "factory"]], "PIPELINE_RUN_RESPONSE": [["pytest", "raises", "AzureDataFactoryPipelineRunException", "match", "PIPELINE_RUN_RESPONSE"], ["pytest", "raises", "AzureDataFactoryPipelineRunException", "match", "PIPELINE_RUN_RESPONSE", "self", "config"], ["operator", "run_id", "PIPELINE_RUN_RESPONSE"], ["self", "mock_ti", "xcom_push", "assert_called_once_with", "key", "value", "PIPELINE_RUN_RESPONSE"], ["operator", "run_id", "PIPELINE_RUN_RESPONSE"], ["self", "mock_ti", "xcom_push", "assert_called_once_with", "key", "value", "PIPELINE_RUN_RESPONSE"], ["ti", "xcom_push", "key", "value", "PIPELINE_RUN_RESPONSE"], ["url", "EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK", "format", "run_id", "PIPELINE_RUN_RESPONSE", "subscription_id", "SUBSCRIPTION_ID", "resource_group_name", "resource_group", "resource_group", "conn_resource_group_name", "factory_name", "factory", "factory", "conn_factory_name"]], "SUBSCRIPTION_ID": [["CONN_EXTRAS", "SUBSCRIPTION_ID"], ["url", "EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK", "format", "run_id", "PIPELINE_RUN_RESPONSE", "subscription_id", "SUBSCRIPTION_ID", "resource_group_name", "resource_group", "resource_group", "conn_resource_group_name", "factory_name", "factory", "factory", "conn_factory_name"]], "TASK_ID": [["self", "config", "TASK_ID", "AZURE_DATA_FACTORY_CONN_ID", "PIPELINE_NAME"], ["ti", "create_task_instance_of_operator", "AzureDataFactoryRunPipelineOperator", "dag_id", "execution_date", "DEFAULT_DATE", "task_id", "TASK_ID", "azure_data_factory_conn_id", "AZURE_DATA_FACTORY_CONN_ID", "pipeline_name", "PIPELINE_NAME", "resource_group_name", "resource_group", "factory_name", "factory"]]}, "no_types_annot": {"D": 6, "I": 0, "U": 66}, "session_id": "C7Ix0vMy9XTqTQqFPIynKlxPrpzFSOAfjv0TndAamho", "set": null, "tc": [false, null], "type_annot_cove": 0.08, "typed_seq": "", "untyped_seq": "", "variables": {"AZURE_DATA_FACTORY_CONN_ID": "", "AZ_PIPELINE_RUN_ID": "", "CONN_EXTRAS": "", "DEFAULT_DATE": "", "EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK": "", "PIPELINE_NAME": "", "PIPELINE_RUN_RESPONSE": "", "SUBSCRIPTION_ID": "", "TASK_ID": ""}, "variables_p": {"AZURE_DATA_FACTORY_CONN_ID": [["str", 0.6880274936205224], ["int", 0.21982187025909578]], "AZ_PIPELINE_RUN_ID": [["int", 0.49445520138856], ["bytes", 0.12021681901555416], ["str", 0.10772035782363186]], "CONN_EXTRAS": [["dict", 0.29809874208940573], ["list", 0.16908239991566965], ["str", 0.15485591641735996], ["bool", 0.11193072802316598]], "DEFAULT_DATE": [["str", 0.2920557573971164], ["int", 0.1257741034025085], ["float", 0.09543984221176098], ["bool", 0.09024906207287535]], "EXPECTED_PIPELINE_RUN_OP_EXTRA_LINK": [["str", 1.0]], "PIPELINE_NAME": [["str", 1.0]], "PIPELINE_RUN_RESPONSE": [["str", 0.6991045708784187], ["dict", 0.12055329260238566], ["Dict[str, str]", 0.09278884739633618], ["Dict[str, float]", 0.08755328912285933]], "SUBSCRIPTION_ID": [["str", 0.8008643682964538], ["int", 0.19913563170354598]], "TASK_ID": [["str", 0.896458067096059], ["Optional[str]", 0.10354193290394112]]}}}