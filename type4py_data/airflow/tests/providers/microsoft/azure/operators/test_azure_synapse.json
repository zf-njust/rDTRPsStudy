{"error": null, "response": {"classes": [{"cls_lc": [[41, 0], [109, 82]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[42, 4], [62, 9]], "fn_var_ln": {"config": [[45, 8], [45, 19]], "mock_context": [[44, 8], [44, 25]], "mock_ti": [[43, 8], [43, 20]]}, "fn_var_occur": {"config": [["self", "config", "TASK_ID", "AZURE_SYNAPSE_CONN_ID"]], "mock_context": [["self", "mock_context", "self", "mock_ti"]], "mock_ti": [["self", "mock_ti", "MagicMock"], ["self", "mock_context", "self", "mock_ti"]]}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "mock_ti", "MagicMock"], ["self", "mock_context", "self", "mock_ti"], ["self", "config", "TASK_ID", "AZURE_SYNAPSE_CONN_ID"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestAzureSynapseRunSparkBatchOperator.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"config": "", "mock_context": "", "mock_ti": ""}, "variables_p": {"config": [["str", 0.29727242388933117], ["int", 0.20047398332021785], ["Dict[str, int]", 0.08836554207539905]], "mock_context": [["unittesmock.MagicMock", 0.3192978773292947], ["str", 0.2302032910610023], ["Dict[str, Tuple[str, Any]]", 0.15180877532370887]], "mock_ti": [["unittesmock.MagicMock", 0.12421377068200695], ["mock.Mock", 0.10467112661195548], ["Dict[str, Any]", 0.0862524470801677], ["List[int]", 0.08356094750572061], ["Dict[str, str]", 0.08206885407860746]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[67, 4], [76, 50]], "fn_var_ln": {"op": [[72, 8], [72, 10]], "return_value": [[71, 8], [71, 39]]}, "fn_var_occur": {"op": [["op", "AzureSynapseRunSparkBatchOperator", "task_id", "azure_synapse_conn_id", "AZURE_SYNAPSE_CONN_ID", "spark_pool", "payload"], ["op", "execute", "context", "self", "mock_context"], ["op", "job_id", "JOB_RUN_RESPONSE"]], "return_value": [["mock_get_job_run_status", "return_value"], ["mock_run_spark_job", "return_value", "MagicMock", "JOB_RUN_RESPONSE"]]}, "name": "test_azure_synapse_run_spark_batch_operator_success", "params": {"mock_conn": "", "mock_get_job_run_status": "", "mock_run_spark_job": "", "self": ""}, "params_descr": {"mock_conn": "", "mock_get_job_run_status": "", "mock_run_spark_job": "", "self": ""}, "params_occur": {"mock_conn": [], "mock_get_job_run_status": [["mock_get_job_run_status", "return_value"]], "mock_run_spark_job": [["mock_run_spark_job", "return_value", "MagicMock", "JOB_RUN_RESPONSE"]], "self": [["op", "execute", "context", "self", "mock_context"]]}, "params_p": {"args": [], "kwargs": [], "mock_conn": [["mock.Mock", 0.3503279418305162], ["tests.async_mock.MagicMock", 0.2721570689582644], ["Generator[None, Any, None]", 0.186611791072394]], "mock_get_job_run_status": [["unittesmock.MagicMock", 0.832692215991945]], "mock_run_spark_job": [["mock.MagicMock", 0.12707933078191402], ["unittesmock.MagicMock", 0.08404216713880705]], "self": []}, "q_name": "TestAzureSynapseRunSparkBatchOperator.test_azure_synapse_run_spark_batch_operator_success", "ret_exprs": [], "ret_type": "", "variables": {"op": "", "return_value": ""}, "variables_p": {"op": [["List[List[int]]", 0.17741483942889044], ["RuntimeError", 0.09718664325199396]], "return_value": [["str", 0.18424595453575], ["Optional[bytes]", 0.12847052541110462], ["list", 0.09240979345940768], ["unittesmock.MagicMock", 0.08872540119638295], ["tests.utils.MockCoroutine", 0.08691896247621796], ["int", 0.08456603194227497]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[81, 4], [93, 49]], "fn_var_ln": {"op": [[86, 8], [86, 10]], "return_value": [[85, 8], [85, 39]]}, "fn_var_occur": {"op": [["op", "AzureSynapseRunSparkBatchOperator", "task_id", "azure_synapse_conn_id", "AZURE_SYNAPSE_CONN_ID", "spark_pool", "payload"], ["op", "execute", "context", "self", "mock_context"]], "return_value": [["mock_get_job_run_status", "return_value"], ["mock_run_spark_job", "return_value", "MagicMock", "JOB_RUN_RESPONSE"]]}, "name": "test_azure_synapse_run_spark_batch_operator_error", "params": {"mock_conn": "", "mock_get_job_run_status": "", "mock_run_spark_job": "", "self": ""}, "params_descr": {"mock_conn": "", "mock_get_job_run_status": "", "mock_run_spark_job": "", "self": ""}, "params_occur": {"mock_conn": [], "mock_get_job_run_status": [["mock_get_job_run_status", "return_value"]], "mock_run_spark_job": [["mock_run_spark_job", "return_value", "MagicMock", "JOB_RUN_RESPONSE"]], "self": [["op", "execute", "context", "self", "mock_context"]]}, "params_p": {"args": [], "kwargs": [], "mock_conn": [["mock.Mock", 0.35362200475843597], ["tests.async_mock.MagicMock", 0.27957537772389207], ["Generator[None, Any, None]", 0.17407861127601923]], "mock_get_job_run_status": [["unittesmock.MagicMock", 0.8334950381414848]], "mock_run_spark_job": [["unittesmock.MagicMock", 0.2539366140813308], ["mock.MagicMock", 0.12163710744133309]], "self": []}, "q_name": "TestAzureSynapseRunSparkBatchOperator.test_azure_synapse_run_spark_batch_operator_error", "ret_exprs": [], "ret_type": "", "variables": {"op": "", "return_value": ""}, "variables_p": {"op": [["List[List[int]]", 0.17741483942889044], ["RuntimeError", 0.09718664325199396]], "return_value": [["str", 0.18424595453575], ["Optional[bytes]", 0.12847052541110462], ["list", 0.09240979345940768], ["unittesmock.MagicMock", 0.08872540119638295], ["tests.utils.MockCoroutine", 0.08691896247621796], ["int", 0.08456603194227497]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[99, 4], [109, 82]], "fn_var_ln": {"op": [[104, 8], [104, 10]], "return_value": [[103, 8], [103, 39]]}, "fn_var_occur": {"op": [["op", "AzureSynapseRunSparkBatchOperator", "task_id", "azure_synapse_conn_id", "AZURE_SYNAPSE_CONN_ID", "spark_pool", "payload"], ["op", "execute", "context", "self", "mock_context"], ["op", "on_kill"]], "return_value": [["mock_get_job_run_status", "return_value"], ["mock_run_spark_job", "return_value", "MagicMock", "JOB_RUN_RESPONSE"]]}, "name": "test_azure_synapse_run_spark_batch_operator_on_kill", "params": {"mock_cancel_job_run": "", "mock_conn": "", "mock_get_job_run_status": "", "mock_run_spark_job": "", "self": ""}, "params_descr": {"mock_cancel_job_run": "", "mock_conn": "", "mock_get_job_run_status": "", "mock_run_spark_job": "", "self": ""}, "params_occur": {"mock_cancel_job_run": [["mock_cancel_job_run", "assert_called_once_with", "job_id", "JOB_RUN_RESPONSE"]], "mock_conn": [], "mock_get_job_run_status": [["mock_get_job_run_status", "return_value"]], "mock_run_spark_job": [["mock_run_spark_job", "return_value", "MagicMock", "JOB_RUN_RESPONSE"]], "self": [["op", "execute", "context", "self", "mock_context"]]}, "params_p": {"args": [], "kwargs": [], "mock_cancel_job_run": [], "mock_conn": [["mock.Mock", 0.3474775932412395]], "mock_get_job_run_status": [["unittesmock.MagicMock", 0.4960885423825514]], "mock_run_spark_job": [["unittesmock.MagicMock", 0.11388821813660406]], "self": []}, "q_name": "TestAzureSynapseRunSparkBatchOperator.test_azure_synapse_run_spark_batch_operator_on_kill", "ret_exprs": [], "ret_type": "", "variables": {"op": "", "return_value": ""}, "variables_p": {"op": [["List[List[int]]", 0.17741483942889044], ["RuntimeError", 0.09718664325199396]], "return_value": [["str", 0.18424595453575], ["Optional[bytes]", 0.12847052541110462], ["list", 0.09240979345940768], ["unittesmock.MagicMock", 0.08872540119638295], ["tests.utils.MockCoroutine", 0.08691896247621796], ["int", 0.08456603194227497]]}}], "name": "TestAzureSynapseRunSparkBatchOperator", "q_name": "TestAzureSynapseRunSparkBatchOperator", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["__future__", "annotations", "json", "unittest", "mock", "unittest", "mock", "MagicMock", "pytest", "airflow", "models", "Connection", "airflow", "providers", "microsoft", "azure", "operators", "synapse", "AzureSynapseRunSparkBatchOperator", "airflow", "utils", "db", "timezone"], "mod_var_ln": {"AZURE_SYNAPSE_CONN_ID": [[32, 0], [32, 21]], "CONN_EXTRAS": [[33, 0], [33, 11]], "DEFAULT_DATE": [[29, 0], [29, 12]], "JOB_RUN_RESPONSE": [[38, 0], [38, 16]], "SUBSCRIPTION_ID": [[30, 0], [30, 15]], "TASK_ID": [[31, 0], [31, 7]]}, "mod_var_occur": {"AZURE_SYNAPSE_CONN_ID": [["self", "config", "TASK_ID", "AZURE_SYNAPSE_CONN_ID"], ["db", "merge_conn", "Connection", "conn_id", "AZURE_SYNAPSE_CONN_ID", "conn_type", "host", "login", "password", "extra", "json", "dumps", "CONN_EXTRAS"], ["op", "AzureSynapseRunSparkBatchOperator", "task_id", "azure_synapse_conn_id", "AZURE_SYNAPSE_CONN_ID", "spark_pool", "payload"], ["op", "AzureSynapseRunSparkBatchOperator", "task_id", "azure_synapse_conn_id", "AZURE_SYNAPSE_CONN_ID", "spark_pool", "payload"], ["op", "AzureSynapseRunSparkBatchOperator", "task_id", "azure_synapse_conn_id", "AZURE_SYNAPSE_CONN_ID", "spark_pool", "payload"]], "CONN_EXTRAS": [["db", "merge_conn", "Connection", "conn_id", "AZURE_SYNAPSE_CONN_ID", "conn_type", "host", "login", "password", "extra", "json", "dumps", "CONN_EXTRAS"]], "DEFAULT_DATE": [], "JOB_RUN_RESPONSE": [["mock_run_spark_job", "return_value", "MagicMock", "JOB_RUN_RESPONSE"], ["op", "job_id", "JOB_RUN_RESPONSE"], ["mock_run_spark_job", "return_value", "MagicMock", "JOB_RUN_RESPONSE"], ["pytest", "raises", "Exception", "match", "JOB_RUN_RESPONSE"], ["mock_run_spark_job", "return_value", "MagicMock", "JOB_RUN_RESPONSE"], ["mock_cancel_job_run", "assert_called_once_with", "job_id", "JOB_RUN_RESPONSE"]], "SUBSCRIPTION_ID": [["CONN_EXTRAS", "SUBSCRIPTION_ID"]], "TASK_ID": [["self", "config", "TASK_ID", "AZURE_SYNAPSE_CONN_ID"]]}, "no_types_annot": {"D": 0, "I": 0, "U": 29}, "session_id": "vx5ra1J1n8GoqX4yRvXxAmrWfvaUfRcsHISx_Mx4NTs", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"AZURE_SYNAPSE_CONN_ID": "", "CONN_EXTRAS": "", "DEFAULT_DATE": "", "JOB_RUN_RESPONSE": "", "SUBSCRIPTION_ID": "", "TASK_ID": ""}, "variables_p": {"AZURE_SYNAPSE_CONN_ID": [["int", 0.579437690854544], ["Pattern[Any]", 0.09326543357107363]], "CONN_EXTRAS": [["str", 0.3208529019624764], ["List[int]", 0.12105490357345068], ["int", 0.10630680262156683], ["Tuple[int, int, int, int]", 0.08177880688590197], ["float", 0.07883832492947844]], "DEFAULT_DATE": [["str", 0.6363860493653496], ["List[str]", 0.09854130901534286], ["Dict[str, Callable[[Any], bool]]", 0.09209337908587]], "JOB_RUN_RESPONSE": [["rotkehlchen.tests.utils.mock.MockResponse", 0.14893066305623595], ["str", 0.14279408932485826], ["Pattern[str]", 0.09045738261750766], ["tests.utils.MockCoroutine", 0.08422986927032282], ["jj.mock._remote_mock.RemoteMock", 0.08360348741089069], ["List[Tuple[str, Any]]", 0.08198026581078799], ["Dict[Any, Union[Any, Any]]", 0.07915320947621357]], "SUBSCRIPTION_ID": [["str", 0.9999999998710318], ["int", 1.078511434222292e-10]], "TASK_ID": [["int", 0.8081213362116061], ["str", 0.19187866378839386]]}}}