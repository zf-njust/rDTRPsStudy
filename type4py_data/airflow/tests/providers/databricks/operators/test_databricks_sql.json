{"error": null, "response": {"classes": [], "funcs": [{"docstring": {"func": "Test the execute function in case where SQL query was successful.", "long_descr": null, "ret": null}, "fn_lc": [[115, 0], [151, 9]], "fn_var_ln": {"db_mock": [[127, 8], [127, 15]], "descriptions": [[129, 8], [129, 28]], "execute_results": [[131, 8], [131, 23]], "op": [[120, 8], [120, 10]]}, "fn_var_occur": {"db_mock": [["db_mock", "db_mock_class", "return_value"], ["db_mock", "run", "return_value", "hook_results"], ["db_mock", "descriptions", "hook_descriptions"], ["db_mock", "run", "assert_called_once_with", "sql", "sql", "parameters", "None", "handler", "fetch_all_handler", "autocommit", "False", "return_last", "return_last", "split_statements", "split_statement"]], "descriptions": [["db_mock", "descriptions", "hook_descriptions"]], "execute_results": [["execute_results", "op", "execute", "None"], ["execute_results", "expected_results"]], "op": [["op", "DatabricksSqlOperator", "task_id", "TASK_ID", "sql", "sql", "do_xcom_push", "True", "return_last", "return_last", "split_statements", "split_statement"], ["execute_results", "op", "execute", "None"]]}, "name": "test_exec_success", "params": {"expected_results": "", "hook_descriptions": "", "hook_results": "", "return_last": "", "split_statement": "", "sql": ""}, "params_descr": {"expected_results": "", "hook_descriptions": "", "hook_results": "", "return_last": "", "split_statement": "", "sql": ""}, "params_occur": {"expected_results": [["execute_results", "expected_results"]], "hook_descriptions": [["db_mock", "descriptions", "hook_descriptions"]], "hook_results": [["db_mock", "run", "return_value", "hook_results"]], "return_last": [["op", "DatabricksSqlOperator", "task_id", "TASK_ID", "sql", "sql", "do_xcom_push", "True", "return_last", "return_last", "split_statements", "split_statement"], ["db_mock", "run", "assert_called_once_with", "sql", "sql", "parameters", "None", "handler", "fetch_all_handler", "autocommit", "False", "return_last", "return_last", "split_statements", "split_statement"]], "split_statement": [["op", "DatabricksSqlOperator", "task_id", "TASK_ID", "sql", "sql", "do_xcom_push", "True", "return_last", "return_last", "split_statements", "split_statement"], ["db_mock", "run", "assert_called_once_with", "sql", "sql", "parameters", "None", "handler", "fetch_all_handler", "autocommit", "False", "return_last", "return_last", "split_statements", "split_statement"]], "sql": [["op", "DatabricksSqlOperator", "task_id", "TASK_ID", "sql", "sql", "do_xcom_push", "True", "return_last", "return_last", "split_statements", "split_statement"], ["db_mock", "run", "assert_called_once_with", "sql", "sql", "parameters", "None", "handler", "fetch_all_handler", "autocommit", "False", "return_last", "return_last", "split_statements", "split_statement"]]}, "params_p": {"args": [], "expected_results": [["dict", 0.2968861312613347], ["int", 0.09159561162343052], ["float", 0.09159561162343052]], "hook_descriptions": [["str", 0.16894508839022013], ["bool", 0.08543665110189487]], "hook_results": [["int", 0.0988016173814349]], "kwargs": [], "return_last": [["Union[float, str]", 0.10313752685149685], ["float", 0.10313752685149685], ["int", 0.09100674811750009]], "split_statement": [["Union[float, str]", 0.10313752685149685], ["float", 0.10313752685149685], ["int", 0.09100674811750009]], "sql": [["Union[float, str]", 0.10313752685149685], ["float", 0.10313752685149685], ["int", 0.09100674811750009]]}, "q_name": "test_exec_success", "ret_exprs": [], "ret_type": "", "variables": {"db_mock": "", "descriptions": "", "execute_results": "", "op": ""}, "variables_p": {"db_mock": [["Union[mock.AsyncMock, mock.MagicMock]", 0.24887025531779636], ["Dict[str, str]", 0.08624347844220474]], "descriptions": [["str", 0.5484165538108772], ["List[str]", 0.19529511280854514], ["Optional[str]", 0.17065154972843236], ["tuple", 0.08563678365214547]], "execute_results": [["set", 0.46615813343349494], ["List[str]", 0.10986384292364258], ["Dict[str, Literal]", 0.10198384664316038], ["Dict[str, Union[None, Any, Any, str]]", 0.0962470290208883]], "op": [["Dict[str, Union[Any, bool, str]]", 0.18458426137581613], ["Dict[str, str]", 0.1431471417622676], ["str", 0.08214640808580173]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[154, 0], [170, 102]], "fn_var_ln": {"db_mock": [[165, 8], [165, 15]], "descriptions": [[167, 8], [167, 28]], "hook_descriptions": [[155, 4], [155, 21]], "hook_results": [[156, 4], [156, 16]], "op": [[159, 8], [159, 10]], "result": [[168, 8], [168, 14]], "serialized_result": [[169, 8], [169, 25]]}, "fn_var_occur": {"db_mock": [["db_mock", "db_mock_class", "return_value"], ["db_mock", "run", "return_value", "hook_results"], ["db_mock", "descriptions", "hook_descriptions"]], "descriptions": [["db_mock", "descriptions", "hook_descriptions"]], "hook_descriptions": [["db_mock", "descriptions", "hook_descriptions"]], "hook_results": [["hook_results", "Row", "id", "value", "Row", "id", "value"], ["db_mock", "run", "return_value", "hook_results"]], "op": [["op", "DatabricksSqlOperator", "task_id", "TASK_ID", "sql", "do_xcom_push", "True", "return_last", "True"], ["result", "op", "execute"]], "result": [["result", "op", "execute"], ["serialized_result", "serialize", "result"]], "serialized_result": [["serialized_result", "serialize", "result"], ["serialized_result", "serialize"]]}, "name": "test_return_value_serialization", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "test_return_value_serialization", "ret_exprs": [], "ret_type": "", "variables": {"db_mock": "", "descriptions": "", "hook_descriptions": "", "hook_results": "", "op": "", "result": "", "serialized_result": ""}, "variables_p": {"db_mock": [["Union[mock.AsyncMock, mock.MagicMock]", 0.2704813870023553]], "descriptions": [["str", 0.5484165538108772], ["List[str]", 0.19529511280854514], ["Optional[str]", 0.17065154972843236], ["tuple", 0.08563678365214547]], "hook_descriptions": [["str", 0.5017098276057169], ["List[str]", 0.17576743920430482], ["int", 0.10720267762911766]], "hook_results": [["int", 0.11186532005572812], ["list", 0.10269781286700187], ["str", 0.09545138859095101], ["dict", 0.09069793943993959]], "op": [["Dict[str, Union[Any, bool, str]]", 0.1649969610812043], ["Dict[str, str]", 0.14691699167919342], ["str", 0.08894857028002268]], "result": [["List[int]", 0.21273906646855678], ["Dict[str, str]", 0.1983929331854811], ["Dict[str, int]", 0.1983929331854811], ["Dict[str, Union[Any, Any]]", 0.11036880467525025], ["Dict[str, Union[int, str]]", 0.09919646659274055], ["Dict[str, float]", 0.09919646659274055], ["Dict[str, Dict[str, str]]", 0.0817133292997496]], "serialized_result": [["Dict[str, bool]", 0.1838637065860953], ["Dict[str, Union[None, Any, Any, str]]", 0.12880918285029444], ["dict", 0.08910292640831674]]}}, {"docstring": {"func": "Test the execute function in case where SQL query was successful and data is written as CSV", "long_descr": null, "ret": null}, "fn_lc": [[271, 0], [314, 9]], "fn_var_ln": {"db_mock": [[285, 8], [285, 15]], "descriptions": [[288, 8], [288, 28]], "mock_results": [[286, 8], [286, 20]], "op": [[277, 8], [277, 10]], "results": [[292, 12], [292, 19]], "tempfile_path": [[276, 8], [276, 21]]}, "fn_var_occur": {"db_mock": [["db_mock", "db_mock_class", "return_value"], ["db_mock", "run", "return_value", "mock_results"], ["db_mock", "descriptions", "descriptions"], ["db_mock", "run", "assert_called_once_with", "sql", "sql", "parameters", "None", "handler", "fetch_all_handler", "autocommit", "False", "return_last", "return_last", "split_statements", "split_statements"]], "descriptions": [["db_mock", "descriptions", "descriptions"]], "mock_results": [["mock_results", "hook_results"], ["db_mock", "run", "return_value", "mock_results"]], "op": [["op", "DatabricksSqlOperator", "task_id", "TASK_ID", "sql", "sql", "output_path", "tempfile_path", "return_last", "return_last", "do_xcom_push", "do_xcom_push", "split_statements", "split_statements"], ["op", "execute", "None"]], "results": [["results", "line", "strip", "line", "open", "tempfile_path"]], "tempfile_path": [["tempfile_path", "tempfile", "mkstemp"], ["op", "DatabricksSqlOperator", "task_id", "TASK_ID", "sql", "sql", "output_path", "tempfile_path", "return_last", "return_last", "do_xcom_push", "do_xcom_push", "split_statements", "split_statements"], ["results", "line", "strip", "line", "open", "tempfile_path"], ["os", "remove", "tempfile_path"]]}, "name": "test_exec_write_file", "params": {"descriptions": "", "do_xcom_push": "", "hook_results": "", "return_last": "", "split_statements": "", "sql": ""}, "params_descr": {"descriptions": "", "do_xcom_push": "", "hook_results": "", "return_last": "", "split_statements": "", "sql": ""}, "params_occur": {"descriptions": [["db_mock", "descriptions", "descriptions"]], "do_xcom_push": [["op", "DatabricksSqlOperator", "task_id", "TASK_ID", "sql", "sql", "output_path", "tempfile_path", "return_last", "return_last", "do_xcom_push", "do_xcom_push", "split_statements", "split_statements"]], "hook_results": [["mock_results", "hook_results"]], "return_last": [["op", "DatabricksSqlOperator", "task_id", "TASK_ID", "sql", "sql", "output_path", "tempfile_path", "return_last", "return_last", "do_xcom_push", "do_xcom_push", "split_statements", "split_statements"], ["db_mock", "run", "assert_called_once_with", "sql", "sql", "parameters", "None", "handler", "fetch_all_handler", "autocommit", "False", "return_last", "return_last", "split_statements", "split_statements"]], "split_statements": [["op", "DatabricksSqlOperator", "task_id", "TASK_ID", "sql", "sql", "output_path", "tempfile_path", "return_last", "return_last", "do_xcom_push", "do_xcom_push", "split_statements", "split_statements"], ["db_mock", "run", "assert_called_once_with", "sql", "sql", "parameters", "None", "handler", "fetch_all_handler", "autocommit", "False", "return_last", "return_last", "split_statements", "split_statements"]], "sql": [["op", "DatabricksSqlOperator", "task_id", "TASK_ID", "sql", "sql", "output_path", "tempfile_path", "return_last", "return_last", "do_xcom_push", "do_xcom_push", "split_statements", "split_statements"], ["db_mock", "run", "assert_called_once_with", "sql", "sql", "parameters", "None", "handler", "fetch_all_handler", "autocommit", "False", "return_last", "return_last", "split_statements", "split_statements"]]}, "params_p": {"args": [], "descriptions": [["int", 0.1968852106706643], ["float", 0.10348732353002132]], "do_xcom_push": [["int", 0.2914805924203185], ["str", 0.20678204364461217], ["Optional[List[str]]", 0.13066383954819608], ["bool", 0.13066383954819608]], "hook_results": [["str", 0.3044155614221888]], "kwargs": [], "return_last": [["int", 0.2914805924203185], ["str", 0.20678204364461217], ["Optional[List[str]]", 0.13066383954819608], ["bool", 0.13066383954819608]], "split_statements": [["int", 0.2914805924203185], ["str", 0.20678204364461217], ["Optional[List[str]]", 0.13066383954819608], ["bool", 0.13066383954819608]], "sql": [["int", 0.2914805924203185], ["str", 0.20678204364461217], ["Optional[List[str]]", 0.13066383954819608], ["bool", 0.13066383954819608]]}, "q_name": "test_exec_write_file", "ret_exprs": [], "ret_type": "", "variables": {"db_mock": "", "descriptions": "", "mock_results": "", "op": "", "results": "", "tempfile_path": ""}, "variables_p": {"db_mock": [["Union[mock.AsyncMock, mock.MagicMock]", 0.2633647512543923], ["mock.Mock", 0.0917965450635733]], "descriptions": [["str", 0.5484165538108772], ["List[str]", 0.19529511280854514], ["Optional[str]", 0.17065154972843236], ["tuple", 0.08563678365214547]], "mock_results": [["Dict[str, str]", 0.09823189370574907], ["Dict[str, Any]", 0.09812782376455464], ["List[str]", 0.0931507731463758], ["Dict[Any, Union[Any, Any]]", 0.09030766494105148], ["os._Environ[str]", 0.08961309529776354], ["List[Dict[str, Any]]", 0.08710750483971165]], "op": [["List[List[int]]", 0.13982892763022306], ["Dict[str, str]", 0.10103634110157682], ["Dict[str, Dict[str, Any]]", 0.08116154431154907], ["int", 0.07764896920655774]], "results": [["str", 0.7941623221830891], ["bytes", 0.07458289205159312], ["Dict[str, str]", 0.06565774334429841], ["List[str]", 0.06559704242101931]], "tempfile_path": [["str", 0.5568658347005013]]}}], "imports": ["__future__", "annotations", "os", "tempfile", "unittest", "mock", "patch", "pytest", "airflow", "providers", "common", "sql", "hooks", "sql", "fetch_all_handler", "airflow", "providers", "databricks", "operators", "databricks_sql", "DatabricksSqlOperator", "Row", "airflow", "serialization", "serde", "serialize"], "mod_var_ln": {"DATE": [[30, 0], [30, 4]], "DEFAULT_CONN_ID": [[32, 0], [32, 15]], "TASK_ID": [[31, 0], [31, 7]]}, "mod_var_occur": {"DATE": [], "DEFAULT_CONN_ID": [["db_mock_class", "assert_called_once_with", "DEFAULT_CONN_ID", "http_path", "None", "session_configuration", "None", "sql_endpoint_name", "None", "http_headers", "None", "catalog", "None", "schema", "None", "caller"], ["db_mock_class", "assert_called_once_with", "DEFAULT_CONN_ID", "http_path", "None", "session_configuration", "None", "sql_endpoint_name", "None", "http_headers", "None", "catalog", "None", "schema", "None", "caller"]], "TASK_ID": [["op", "DatabricksSqlOperator", "task_id", "TASK_ID", "sql", "sql", "do_xcom_push", "True", "return_last", "return_last", "split_statements", "split_statement"], ["op", "DatabricksSqlOperator", "task_id", "TASK_ID", "sql", "do_xcom_push", "True", "return_last", "True"], ["op", "DatabricksSqlOperator", "task_id", "TASK_ID", "sql", "sql", "output_path", "tempfile_path", "return_last", "return_last", "do_xcom_push", "do_xcom_push", "split_statements", "split_statements"]]}, "no_types_annot": {"D": 0, "I": 0, "U": 34}, "session_id": "ZUoLlAMP_qHPRGmYE7MFV8Qptm5nqLQ21uXbs7TC3i8", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"DATE": "", "DEFAULT_CONN_ID": "", "TASK_ID": ""}, "variables_p": {"DATE": [["str", 0.3], ["int", 0.09999999999999999]], "DEFAULT_CONN_ID": [["str", 0.38701672351903016], ["int", 0.3275165902007849]], "TASK_ID": [["str", 0.5864494566333684], ["Optional[str]", 0.08955212224604875], ["int", 0.08897527430543468]]}}}