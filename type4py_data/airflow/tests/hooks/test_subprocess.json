{"error": null, "response": {"classes": [{"cls_lc": [[34, 0], [107, 36]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": "Produce bash command to echo env vars into filename.", "long_descr": "Will always echo the special test var named ``OS_ENV_KEY`` into the file to test whether\n``os.environ`` is passed or not.", "ret": null}, "fn_lc": [[52, 8], [58, 88]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "build_cmd", "params": {"filename": "", "keys": ""}, "params_descr": {"filename": "", "keys": ""}, "params_occur": {"filename": [["join", "k", "k", "filename", "k", "keys", "OS_ENV_KEY"]], "keys": [["join", "k", "k", "filename", "k", "keys", "OS_ENV_KEY"]]}, "params_p": {"args": [], "filename": [["str", 0.6037269480400648], ["List[str]", 0.11474945645572143], ["Optional[str]", 0.09572910118390374], ["Callable[[T], bool]", 0.09421754399375376], ["dict", 0.09157695032655626]], "keys": [["str", 0.6037269480400648], ["List[str]", 0.11474945645572143], ["Optional[str]", 0.09572910118390374], ["Callable[[T], bool]", 0.09421754399375376], ["dict", 0.09157695032655626]], "kwargs": [], "self": []}, "q_name": "TestSubprocessHook.test_env.<locals>.build_cmd", "ret_exprs": ["return \"n\".join(f\"echo {k}=${k}>> {filename}\" for k in [*keys, OS_ENV_KEY])"], "ret_type": "", "ret_type_p": [["str", 0.8014014560376885], ["Optional[str]", 0.19859854396231155]], "variables": {}, "variables_p": {}}, {"docstring": {"func": "Test that env variables are exported correctly to the command environment.", "long_descr": "When ``env`` is ``None``, ``os.environ`` should be passed to ``Popen``.\nOtherwise, the variables in ``env`` should be available, and ``os.environ`` should not.", "ret": null}, "fn_lc": [[44, 4], [65, 37]], "fn_var_ln": {"actual": [[64, 12], [64, 18]], "command": [[62, 12], [62, 19]], "hook": [[50, 8], [50, 12]], "tmp_file": [[61, 12], [61, 20]]}, "fn_var_occur": {"actual": [["actual", "dict", "x", "split", "x", "tmp_file", "read_text", "splitlines"], ["actual", "expected"]], "command": [["command", "build_cmd", "env", "env", "keys", "tmp_file", "as_posix"], ["hook", "run_command", "command", "command", "env", "env"]], "hook": [["hook", "run_command", "command", "command", "env", "env"]], "tmp_file": [["tmp_file", "Path", "tmp_dir"], ["command", "build_cmd", "env", "env", "keys", "tmp_file", "as_posix"], ["actual", "dict", "x", "split", "x", "tmp_file", "read_text", "splitlines"]]}, "name": "test_env", "params": {"env": "", "expected": "", "self": ""}, "params_descr": {"env": "", "expected": "", "self": ""}, "params_occur": {"env": [["command", "build_cmd", "env", "env", "keys", "tmp_file", "as_posix"], ["hook", "run_command", "command", "command", "env", "env"]], "expected": [["actual", "expected"]], "self": []}, "params_p": {"args": [], "env": [["str", 0.2765636246919437], ["Iterable[pathlib.Path]", 0.13973893823875583], ["Tuple[str]", 0.11959327835055292], ["List[str]", 0.10913548853801154], ["Dict[str, bytes]", 0.09635860237581544], ["Final", 0.08617463376946789]], "expected": [["str", 0.3083769130301047], ["bool", 0.2067492709488018], ["int", 0.10636511448963808], ["MutableMapping[str, str]", 0.10619824068035881], ["Optional[str]", 0.08696151763747509]], "kwargs": [], "self": []}, "q_name": "TestSubprocessHook.test_env", "ret_exprs": [], "ret_type": "", "variables": {"actual": "", "command": "", "hook": "", "tmp_file": ""}, "variables_p": {"actual": [["int", 0.4517315753290941], ["list", 0.2309915353921331], ["str", 0.08379460705798256], ["Dict[str, Callable[[], Any]]", 0.07904552765106575], ["Dict[str, str]", 0.07884526918966628], ["DefaultDict[Any, List[Any]]", 0.07559148538005818]], "command": [["Set[str]", 0.9999999999999999]], "hook": [["list", 0.2659908255146725], ["Dict[str, Union[int, str]]", 0.09897679789912403], ["int", 0.08870185664603583], ["Dict[str, Union[dict, str]]", 0.08776079393658875]], "tmp_file": [["str", 0.2783196750079285], ["List[str]", 0.1947395019495233], ["int", 0.10382135361863437], ["list", 0.09418615334150979], ["dict", 0.08960501895842113]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[76, 4], [79, 40]], "fn_var_ln": {"hook": [[77, 8], [77, 12]], "result": [[78, 8], [78, 14]]}, "fn_var_occur": {"hook": [["hook", "SubprocessHook"], ["result", "hook", "run_command", "command", "val"]], "result": [["result", "hook", "run_command", "command", "val"], ["result", "output", "expected"]]}, "name": "test_return_value", "params": {"expected": "", "self": "", "val": ""}, "params_descr": {"expected": "", "self": "", "val": ""}, "params_occur": {"expected": [["result", "output", "expected"]], "self": [], "val": [["result", "hook", "run_command", "command", "val"]]}, "params_p": {"args": [], "expected": [["str", 0.478591199868823], ["dict", 0.12869288089608574], ["bytes", 0.10536568395449794], ["List[str]", 0.09099695436593008]], "kwargs": [], "self": [], "val": [["str", 0.48036492871952174], ["List[str]", 0.13057530132811962], ["pathlib.Path", 0.09750265426261684], ["Optional[object]", 0.09352503474460956], ["Optional[int]", 0.09285772295206084]]}, "q_name": "TestSubprocessHook.test_return_value", "ret_exprs": [], "ret_type": "", "variables": {"hook": "", "result": ""}, "variables_p": {"hook": [["str", 0.18943635154354016], ["Tuple[Literal, Literal, Literal]", 0.1219669861014679], ["list", 0.11810249095655473]], "result": [["dict", 0.37117589819234104], ["Tuple[Optional[int], Optional[int]]", 0.09627802573915864], ["bool", 0.08974815154967884]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[90, 4], [101, 9]], "fn_var_ln": {"hook": [[91, 8], [91, 12]]}, "fn_var_occur": {"hook": [["hook", "SubprocessHook"], ["hook", "run_command", "command"]]}, "name": "test_should_exec_subprocess", "params": {"mock_popen": "", "mock_temporary_directory": "", "self": ""}, "params_descr": {"mock_popen": "", "mock_temporary_directory": "", "self": ""}, "params_occur": {"mock_popen": [["mock_popen", "assert_called_once_with", "cwd", "env", "preexec_fn", "mock", "ANY", "stderr", "STDOUT", "stdout", "PIPE"]], "mock_temporary_directory": [], "self": []}, "params_p": {"args": [], "kwargs": [], "mock_popen": [["unittesmock.MagicMock", 1.0]], "mock_temporary_directory": [["unittesmock.MagicMock", 0.9999999932276671], ["mock.Mock", 1.5597455505422783e-09], ["mock.MagicMock", 4.068995593306485e-10]], "self": []}, "q_name": "TestSubprocessHook.test_should_exec_subprocess", "ret_exprs": [], "ret_type": "", "variables": {"hook": ""}, "variables_p": {"hook": [["int", 0.22915153564836083], ["List[int]", 0.11812560288174694], ["str", 0.09943893546637601], ["Tuple[str, str, str]", 0.09532444091711119], ["IO[bytes]", 0.08703563248450925], ["float", 0.08439745473172018]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[103, 4], [107, 36]], "fn_var_ln": {"command": [[105, 8], [105, 15]], "hook": [[104, 8], [104, 12]], "result": [[106, 8], [106, 14]]}, "fn_var_occur": {"command": [["result", "hook", "run_command", "command", "command"]], "hook": [["hook", "SubprocessHook"], ["result", "hook", "run_command", "command", "command"]], "result": [["result", "hook", "run_command", "command", "command"], ["result", "exit_code"]]}, "name": "test_task_decode", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSubprocessHook.test_task_decode", "ret_exprs": [], "ret_type": "", "variables": {"command": "", "hook": "", "result": ""}, "variables_p": {"command": [["str", 0.4893160748589848], ["List[str]", 0.12917462478768432], ["Tuple[Literal, Literal, Literal, Literal, Literal, Literal]", 0.10820674463828894], ["Dict[str, List[str]]", 0.0926859342319826], ["set", 0.09063467255918554], ["pathlib.Path", 0.08998194892387383]], "hook": [["str", 0.18943635154354016], ["Tuple[Literal, Literal, Literal]", 0.1219669861014679], ["list", 0.11810249095655473]], "result": [["dict", 0.7069309577251136], ["List[str]", 0.1340944232528289]]}}], "name": "TestSubprocessHook", "q_name": "TestSubprocessHook", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["__future__", "annotations", "pathlib", "Path", "subprocess", "PIPE", "STDOUT", "tempfile", "TemporaryDirectory", "unittest", "mock", "unittest", "mock", "MagicMock", "pytest", "airflow", "hooks", "subprocess", "SubprocessHook"], "mod_var_ln": {"OS_ENV_KEY": [[30, 0], [30, 10]], "OS_ENV_VAL": [[31, 0], [31, 10]]}, "mod_var_occur": {"OS_ENV_KEY": [["join", "k", "k", "filename", "k", "keys", "OS_ENV_KEY"]], "OS_ENV_VAL": []}, "no_types_annot": {"D": 0, "I": 0, "U": 25}, "session_id": "asL9DC_fTRwQ7_rycJEDxpUKbXkv9xrk2Gmb0umc59c", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"OS_ENV_KEY": "", "OS_ENV_VAL": ""}, "variables_p": {"OS_ENV_KEY": [["str", 0.4410151986444941], ["List[str]", 0.14858289998117727], ["Tuple[str, str, str]", 0.13820256226017077], ["Dict[str, str]", 0.09204289132257805], ["Set[str]", 0.08055001633336624]], "OS_ENV_VAL": [["str", 0.5529136984415661], ["list", 0.14217135729125718], ["Optional[str]", 0.11660535515139858], ["int", 0.09672280953875288]]}}}