{"error": null, "response": {"classes": [{"cls_lc": [[59, 0], [67, 37]], "cls_var_ln": {"field_date": [[64, 4], [64, 14]], "field_float": [[63, 4], [63, 15]], "field_integer": [[62, 4], [62, 17]], "field_string": [[61, 4], [61, 16]], "id": [[60, 4], [60, 6]]}, "cls_var_occur": {"field_date": [], "field_float": [], "field_integer": [], "field_string": [], "id": []}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[66, 4], [67, 37]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "__repr__", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["str", "self", "field_string"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "SomeModel.__repr__", "ret_exprs": ["return str(self.field_string)"], "ret_type": "", "ret_type_p": [["str", 1.0000000000000002]], "variables": {}, "variables_p": {}}], "name": "SomeModel", "q_name": "SomeModel", "variables": {"field_date": "", "field_float": "", "field_integer": "", "field_string": "", "id": ""}, "variables_p": {"field_date": [["str", 0.7109622234141484], ["List[str]", 0.10737554986865874]], "field_float": [["Tuple[str]", 0.19999999999999998], ["List[str]", 0.19999999999999998], ["Tuple[str, str, str]", 0.19999999999999998], ["Tuple[str, str, str, str]", 0.09999999999999999], ["list", 0.09999999999999999], ["List[Tuple[str, Any]]", 0.09999999999999999], ["Tuple[str, str, str, str, str, str, str, str]", 0.09999999999999999]], "field_integer": [["Tuple[str]", 0.19999999999999998], ["List[str]", 0.19999999999999998], ["Tuple[str, str, str]", 0.19999999999999998], ["Tuple[str, str, str, str]", 0.09999999999999999], ["list", 0.09999999999999999], ["List[Tuple[str, Any]]", 0.09999999999999999], ["Tuple[str, str, str, str, str, str, str, str]", 0.09999999999999999]], "field_string": [["str", 0.5442577224347888], ["bool", 0.15619886340341388], ["int", 0.1433445507583835], ["property", 0.07809943170170694], ["venv.Lib.site-packages.werkzeug.utils.environ_property", 0.07809943170170694]], "id": [["int", 0.5], ["str", 0.2], ["Optional[int]", 0.1], ["Type[legocollector.inventory.models.Color]", 0.1]]}}, {"cls_lc": [[70, 0], [79, 81]], "cls_var_ln": {"base_permissions": [[72, 4], [72, 20]], "datamodel": [[71, 4], [71, 13]], "list_columns": [[79, 4], [79, 16]]}, "cls_var_occur": {"base_permissions": [], "datamodel": [], "list_columns": []}, "funcs": [], "name": "SomeModelView", "q_name": "SomeModelView", "variables": {"base_permissions": "", "datamodel": "", "list_columns": ""}, "variables_p": {"base_permissions": [["str", 0.9999999999999999]], "datamodel": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "list_columns": [["List[str]", 0.8244689258751468], ["str", 0.08776553706242667], ["bool", 0.08776553706242667]]}}, {"cls_lc": [[82, 0], [88, 24]], "cls_var_ln": {"route_base": [[83, 4], [83, 14]]}, "cls_var_occur": {"route_base": []}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[87, 4], [88, 24]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "some_action", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "SomeBaseView.some_action", "ret_exprs": ["return \"action!\""], "ret_type": "", "ret_type_p": [["int", 0.30000000000000004], ["Callable", 0.2], ["models.Question", 0.1], ["str", 0.1]], "variables": {}, "variables_p": {}}], "name": "SomeBaseView", "q_name": "SomeBaseView", "variables": {"route_base": ""}, "variables_p": {"route_base": [["str", 0.6000000000000001], ["Type[leasing.models.renRentAdjustment]", 0.10000000000000002], ["sqlalchemy.exdeclarative.DeclarativeMeta", 0.10000000000000002], ["int", 0.10000000000000002], ["Type[server.openslides.assignments.models.AssignmentPoll]", 0.10000000000000002]]}}], "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[91, 0], [93, 19]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "_clear_db_dag_and_runs", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "_clear_db_dag_and_runs", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[96, 0], [99, 78]], "fn_var_ln": {"dag_resource_name": [[97, 4], [97, 21]]}, "fn_var_occur": {"dag_resource_name": [["dag_resource_name", "permissions", "resource_name_for_dag", "dag_id"], ["security_manager", "delete_permission", "dag_action_name", "dag_resource_name"]]}, "name": "_delete_dag_permissions", "params": {"dag_id": "", "security_manager": ""}, "params_descr": {"dag_id": "", "security_manager": ""}, "params_occur": {"dag_id": [["dag_resource_name", "permissions", "resource_name_for_dag", "dag_id"]], "security_manager": [["security_manager", "DAG_ACTIONS"], ["security_manager", "delete_permission", "dag_action_name", "dag_resource_name"]]}, "params_p": {"args": [], "dag_id": [["str", 0.7878237815223118], ["int", 0.13957173143004806]], "kwargs": [], "security_manager": [["str", 0.4006076984559346], ["bool", 0.19427732937714148], ["cmk.utils.type_defs.UserId", 0.10520667920342554], ["transfer.models.PaymentMethod", 0.09715611456369741]]}, "q_name": "_delete_dag_permissions", "ret_exprs": [], "ret_type": "", "variables": {"dag_resource_name": ""}, "variables_p": {"dag_resource_name": [["str", 0.9999999999999998]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[102, 0], [107, 20]], "fn_var_ln": {"dag_model": [[103, 4], [103, 13]]}, "fn_var_occur": {"dag_model": [["dag_model", "DagModel", "dag_id", "dag_id"], ["session", "add", "dag_model"]]}, "name": "_create_dag_model", "params": {"dag_id": "", "security_manager": "", "session": ""}, "params_descr": {"dag_id": "", "security_manager": "", "session": ""}, "params_occur": {"dag_id": [["dag_model", "DagModel", "dag_id", "dag_id"], ["security_manager", "sync_perm_for_dag", "dag_id", "access_control", "None"]], "security_manager": [["security_manager", "sync_perm_for_dag", "dag_id", "access_control", "None"]], "session": [["session", "add", "dag_model"], ["session", "commit"]]}, "params_p": {"args": [], "dag_id": [["int", 0.5075325310380653], ["str", 0.10270847669726263], ["models.User", 0.07746896386838445]], "kwargs": [], "security_manager": [["raiden.utils.ChannelID", 0.1274897050501509], ["id3c.db.session.DatabaseSession", 0.11662519414230126], ["str", 0.09324725193264846], ["int", 0.08170485552473213]], "session": [["Optional[Set[int]]", 0.09111052775475034], ["int", 0.09034802734651542], ["sqlalchemy.orm.Session", 0.08070185607866956], ["str", 0.078387683982529]]}, "q_name": "_create_dag_model", "ret_exprs": ["return dag_model"], "ret_type": "", "ret_type_p": [["str", 0.09436929809285875], ["django.db.models.QuerySet", 0.08588754061080173], ["int", 0.08255278018312394], ["Optional[str]", 0.07621784026067095]], "variables": {"dag_model": ""}, "variables_p": {"dag_model": [["dict", 0.25960187294974923], ["Tuple[str]", 0.1294924425780029], ["Dict[str, str]", 0.10600302829966478], ["str", 0.09205197683228947], ["persephone.rnn_ctc.Model", 0.08527317752526156], ["app.models.LoginModel", 0.07662889009260941], ["tensorflow.keras.Model", 0.07645785612599736], ["set", 0.076354939554234]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[110, 0], [113, 63]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "_delete_dag_model", "params": {"dag_model": "", "security_manager": "", "session": ""}, "params_descr": {"dag_model": "", "security_manager": "", "session": ""}, "params_occur": {"dag_model": [["session", "delete", "dag_model"], ["_delete_dag_permissions", "dag_model", "dag_id", "security_manager"]], "security_manager": [["_delete_dag_permissions", "dag_model", "dag_id", "security_manager"]], "session": [["session", "delete", "dag_model"], ["session", "commit"]]}, "params_p": {"args": [], "dag_model": [["str", 0.3169446604405432], ["datetime.datetime", 0.21129644029369546], ["int", 0.10564822014684773], ["Dict[int, Dict[str, float]]", 0.10564822014684773]], "kwargs": [], "security_manager": [["str", 0.48431574393174537], ["limbic.emotion.models.LexiconLimbicModel", 0.11967476837262515], ["Callable", 0.11272964061728975], ["Optional[str]", 0.09929433879776696]], "session": [["bool", 0.1256119533197751], ["Callable", 0.10672859923462753], ["app.models.GameMember", 0.10347780208733905], ["app.models.course.Course", 0.10347780208733905], ["str", 0.09501352903503367], ["zerver.models.UserProfile", 0.08908068368602683], ["Dict[str, Dict[str, Any]]", 0.08621868826073428]]}, "q_name": "_delete_dag_model", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[117, 0], [120, 53]], "fn_var_ln": {"dag": [[118, 4], [118, 7]]}, "fn_var_occur": {"dag": [["dag", "_create_dag_model", "dag_id", "session", "security_manager"], ["_delete_dag_model", "dag", "session", "security_manager"]]}, "name": "_create_dag_model_context", "params": {"dag_id": "", "security_manager": "", "session": ""}, "params_descr": {"dag_id": "", "security_manager": "", "session": ""}, "params_occur": {"dag_id": [["dag", "_create_dag_model", "dag_id", "session", "security_manager"]], "security_manager": [["dag", "_create_dag_model", "dag_id", "session", "security_manager"], ["_delete_dag_model", "dag", "session", "security_manager"]], "session": [["dag", "_create_dag_model", "dag_id", "session", "security_manager"], ["_delete_dag_model", "dag", "session", "security_manager"]]}, "params_p": {"args": [], "dag_id": [["int", 0.508656017034548], ["str", 0.38866435055169574], ["Optional[float]", 0.10267963241375623]], "kwargs": [], "security_manager": [["str", 0.09600661058111114], ["int", 0.09437959217019086], ["dict", 0.08652446976581953], ["List[int]", 0.08077374629143919]], "session": [["str", 0.09600661058111114], ["int", 0.09437959217019086], ["dict", 0.08652446976581953], ["List[int]", 0.08077374629143919]]}, "q_name": "_create_dag_model_context", "ret_exprs": [], "ret_type": "", "variables": {"dag": ""}, "variables_p": {"dag": [["str", 0.40966876035314825], ["List[dict]", 0.11617807412538965], ["Dict[str, Any]", 0.09406465905702982], ["List[Tuple[str, Any]]", 0.08520593897650497]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[124, 0], [126, 28]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "clear_db_after_suite", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "clear_db_after_suite", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[130, 0], [131, 28]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "clear_db_before_test", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "clear_db_before_test", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[135, 0], [138, 15]], "fn_var_ln": {"_app": [[136, 4], [136, 8]]}, "fn_var_occur": {"_app": [["_app", "application", "create_app", "testing", "True"], ["_app", "config", "False"]]}, "name": "app", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "app", "ret_exprs": ["return _app"], "ret_type": "", "ret_type_p": [["routemaster.app.App", 0.10749143497008523]], "variables": {"_app": ""}, "variables_p": {"_app": [["flask.app.Flask", 0.9071039599438442]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[142, 0], [146, 25]], "fn_var_ln": {"app_builder": [[143, 4], [143, 15]]}, "fn_var_occur": {"app_builder": [["app_builder", "app", "appbuilder"], ["app_builder", "add_view", "SomeBaseView", "category"], ["app_builder", "add_view", "SomeModelView", "category"]]}, "name": "app_builder", "params": {"app": ""}, "params_descr": {"app": ""}, "params_occur": {"app": [["app_builder", "app", "appbuilder"], ["app", "appbuilder"]]}, "params_p": {"app": [["sphinx.application.Sphinx", 0.3028132510563328]], "args": [], "kwargs": []}, "q_name": "app_builder", "ret_exprs": ["return app.appbuilder"], "ret_type": "", "ret_type_p": [], "variables": {"app_builder": ""}, "variables_p": {"app_builder": []}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[150, 0], [151, 25]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "security_manager", "params": {"app_builder": ""}, "params_descr": {"app_builder": ""}, "params_occur": {"app_builder": [["app_builder", "sm"]]}, "params_p": {"app_builder": [["str", 0.45691365371645004], ["bool", 0.18014826667699158], ["List[str]", 0.09340953077690084]], "args": [], "kwargs": []}, "q_name": "security_manager", "ret_exprs": ["return app_builder.sm"], "ret_type": "", "ret_type_p": [["rotkehlchen.db.settings.ModifiableDBSettings", 0.12836675400678482], ["str", 0.11331610243976273], ["datetime.datetime", 0.08135098475471016]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[155, 0], [156, 34]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "session", "params": {"app_builder": ""}, "params_descr": {"app_builder": ""}, "params_occur": {"app_builder": [["app_builder", "get_session"]]}, "params_p": {"app_builder": [["str", 0.23432803949429376], ["alerta.database.base.Query", 0.2238405395361949], ["Iterable[zerver.models.Stream]", 0.08568457798067715], ["Optional[str]", 0.0789271581735079]], "args": [], "kwargs": []}, "q_name": "session", "ret_exprs": ["return app_builder.get_session"], "ret_type": "", "ret_type_p": [["bool", 0.07703492808144148]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[160, 0], [161, 20]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "db", "params": {"app": ""}, "params_descr": {"app": ""}, "params_occur": {"app": [["SQLA", "app"]]}, "params_p": {"app": [], "args": [], "kwargs": []}, "q_name": "db", "ret_exprs": ["return SQLA(app)"], "ret_type": "", "ret_type_p": [["sphinx.application.Sphinx", 0.10390776397813711]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[165, 0], [173, 36]], "fn_var_ln": {"_role": [[171, 8], [171, 13]], "params": [[166, 4], [166, 10]]}, "fn_var_occur": {"_role": [["_role", "None"], ["_role", "security_manager", "find_role", "params"], ["_role", "params"]], "params": [["params", "request", "param"], ["params", "params", "params"], ["params", "get", "True"], ["security_manager", "bulk_sync_roles", "params"], ["_role", "security_manager", "find_role", "params"], ["_role", "params"], ["delete_role", "app", "params"]]}, "name": "role", "params": {"app": "", "request": "", "security_manager": ""}, "params_descr": {"app": "", "request": "", "security_manager": ""}, "params_occur": {"app": [["delete_role", "app", "params"]], "request": [["params", "request", "param"]], "security_manager": [["security_manager", "bulk_sync_roles", "params"], ["_role", "security_manager", "find_role", "params"]]}, "params_p": {"app": [["Dict[str, Any]", 0.09215158293780512], ["Optional[dict]", 0.08450738829325555]], "args": [], "kwargs": [], "request": [], "security_manager": [["tests.e2e.Helper", 0.14116601045975122], ["sqlalchemy.orm.Session", 0.08003427158368644]]}, "q_name": "role", "ret_exprs": [], "ret_type": "", "variables": {"_role": "", "params": ""}, "variables_p": {"_role": [["str", 0.3040604910937776], ["Callable", 0.12693816004650757], ["set", 0.12641847984079974], ["Set[str]", 0.061536013382957104], ["int", 0.06105582522742889]], "params": [["chalice.app.Chalice", 0.26615922242204787]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[177, 0], [184, 57]], "fn_var_ln": {"dags": [[179, 4], [179, 8]], "dags_ids": [[178, 4], [178, 12]]}, "fn_var_occur": {"dags": [["dags", "_create_dag_model", "dag_id", "session", "security_manager", "dag_id", "dags_ids"]], "dags_ids": [["dags_ids", "request", "param"], ["dags", "_create_dag_model", "dag_id", "session", "security_manager", "dag_id", "dags_ids"]]}, "name": "mock_dag_models", "params": {"request": "", "security_manager": "", "session": ""}, "params_descr": {"request": "", "security_manager": "", "session": ""}, "params_occur": {"request": [["dags_ids", "request", "param"]], "security_manager": [["dags", "_create_dag_model", "dag_id", "session", "security_manager", "dag_id", "dags_ids"], ["_delete_dag_model", "dag", "session", "security_manager"]], "session": [["dags", "_create_dag_model", "dag_id", "session", "security_manager", "dag_id", "dags_ids"], ["_delete_dag_model", "dag", "session", "security_manager"]]}, "params_p": {"args": [], "kwargs": [], "request": [["str", 0.12066388324425943]], "security_manager": [["str", 0.10181103503902932]], "session": [["str", 0.10181103503902932]]}, "q_name": "mock_dag_models", "ret_exprs": [], "ret_type": "", "variables": {"dags": "", "dags_ids": ""}, "variables_p": {"dags": [["int", 0.25996373918133037], ["str", 0.17136309107292147], ["Tuple[str, str, str, str, str, str, str]", 0.09218416272429895], ["Dict[Any, str]", 0.08274058254376676]], "dags_ids": [["str", 0.08656521840529213]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[188, 0], [197, 61]], "fn_var_ln": {"dags": [[189, 4], [189, 8]]}, "fn_var_occur": {"dags": [["dags", "DAG", "access_control", "permissions", "ACTION_CAN_READ", "DAG"]]}, "name": "sample_dags", "params": {"security_manager": ""}, "params_descr": {"security_manager": ""}, "params_occur": {"security_manager": [["_delete_dag_permissions", "dag", "dag_id", "security_manager"]]}, "params_p": {"args": [], "kwargs": [], "security_manager": [["int", 0.18751525359928617], ["dict", 0.05876340108499555]]}, "q_name": "sample_dags", "ret_exprs": [], "ret_type": "", "variables": {"dags": ""}, "variables_p": {"dags": [["str", 0.2897383999683676]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[202, 4], [204, 102]], "fn_var_ln": {"root_dag_id": [[203, 8], [203, 19]]}, "fn_var_occur": {"root_dag_id": [["root_dag_id", "security_manager", "_get_root_dag_id", "dag_id"], ["security_manager", "has_access", "perm", "permissions", "resource_name_for_dag", "root_dag_id", "user"]]}, "name": "_has_dag_perm", "params": {"dag_id": "", "perm": "", "user": ""}, "params_descr": {"dag_id": "", "perm": "", "user": ""}, "params_occur": {"dag_id": [["root_dag_id", "security_manager", "_get_root_dag_id", "dag_id"]], "perm": [["security_manager", "has_access", "perm", "permissions", "resource_name_for_dag", "root_dag_id", "user"]], "user": [["security_manager", "has_access", "perm", "permissions", "resource_name_for_dag", "root_dag_id", "user"]]}, "params_p": {"args": [], "dag_id": [["int", 0.4086307284542522], ["str", 0.2660211353850189], ["Optional[int]", 0.12104585499089746], ["Optional[str]", 0.12104585499089746], ["transfer.models.ChannelID", 0.08325642617893392]], "kwargs": [], "perm": [["str", 0.6009693429480797], ["int", 0.20030214811767974], ["TextIO", 0.10498866547919179], ["bytes", 0.09373984345504899]], "user": [["str", 0.6009693429480797], ["int", 0.20030214811767974], ["TextIO", 0.10498866547919179], ["bytes", 0.09373984345504899]]}, "q_name": "has_dag_perm.<locals>._has_dag_perm", "ret_exprs": ["return security_manager.has_access(perm, permissions.resource_name_for_dag(root_dag_id), user)"], "ret_type": "", "ret_type_p": [["str", 0.26725108883751303], ["int", 0.1682589858758509], ["salon.models.Stylist", 0.1306425386135201], ["ebl.fragmentarium.application.fragment_updater.FragmentUpdater", 0.08412949293792545], ["bytes", 0.08405727193899999]], "variables": {"root_dag_id": ""}, "variables_p": {"root_dag_id": [["str", 0.6719807161205785], ["Dict[str, Dict[str, Any]]", 0.11139445604563528], ["tuple", 0.09286453947958904]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[201, 0], [206, 24]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "has_dag_perm", "params": {"security_manager": ""}, "params_descr": {"security_manager": ""}, "params_occur": {"security_manager": []}, "params_p": {"args": [], "kwargs": [], "security_manager": [["int", 0.19999999999999998], ["str", 0.19999999999999998], ["Iterable['Context']", 0.09999999999999999], ["dict", 0.09999999999999999], ["bool", 0.09999999999999999]]}, "q_name": "has_dag_perm", "ret_exprs": ["return _has_dag_perm"], "ret_type": "", "ret_type_p": [["int", 0.30000000000000004], ["Callable", 0.2], ["models.Question", 0.1], ["str", 0.1]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[211, 4], [213, 99]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "_assert_user_has_dag_perms", "params": {"dag_id": "", "perms": "", "user": ""}, "params_descr": {"dag_id": "", "perms": "", "user": ""}, "params_occur": {"dag_id": [["has_dag_perm", "perm", "dag_id", "user", "perm", "dag_id"]], "perms": [], "user": [["has_dag_perm", "perm", "dag_id", "user", "perm", "dag_id"]]}, "params_p": {"args": [], "dag_id": [["str", 0.5001682754698042], ["Dict[str, Any]", 0.1926589171080331], ["bool", 0.11961645527519783], ["dict", 0.0996945254184356], ["int", 0.08786182672852927]], "kwargs": [], "perms": [["Sequence[services.ticketing.models.tickeTicket]", 0.14117644297892312], ["bool", 0.12787376087519292], ["Sequence[str]", 0.11640607295948431], ["int", 0.0820647996197746], ["List[int]", 0.08064087436498228], ["dict", 0.07931561584329704], ["str", 0.07931561584329704]], "user": [["str", 0.5001682754698042], ["Dict[str, Any]", 0.1926589171080331], ["bool", 0.11961645527519783], ["dict", 0.0996945254184356], ["int", 0.08786182672852927]]}, "q_name": "assert_user_has_dag_perms.<locals>._assert_user_has_dag_perms", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[210, 0], [215, 37]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "assert_user_has_dag_perms", "params": {"has_dag_perm": ""}, "params_descr": {"has_dag_perm": ""}, "params_occur": {"has_dag_perm": []}, "params_p": {"args": [], "has_dag_perm": [["dict", 0.1], ["str", 0.1]], "kwargs": []}, "q_name": "assert_user_has_dag_perms", "ret_exprs": ["return _assert_user_has_dag_perms"], "ret_type": "", "ret_type_p": [["str", 0.3107988512569455], ["Optional[str]", 0.1796515974948915], ["bool", 0.08777239995453524]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[220, 4], [222, 107]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "_assert_user_does_not_have_dag_perms", "params": {"dag_id": "", "perms": "", "user": ""}, "params_descr": {"dag_id": "", "perms": "", "user": ""}, "params_occur": {"dag_id": [["has_dag_perm", "perm", "dag_id", "user", "perm", "dag_id"]], "perms": [], "user": [["has_dag_perm", "perm", "dag_id", "user", "perm", "dag_id"]]}, "params_p": {"args": [], "dag_id": [["str", 0.28898135716622314], ["Optional[str]", 0.21066812045087396], ["bool", 0.11090765046366025], ["int", 0.09320733983237217]], "kwargs": [], "perms": [["str", 0.6405359964938622], ["bool", 0.27425646434278617]], "user": [["str", 0.28898135716622314], ["Optional[str]", 0.21066812045087396], ["bool", 0.11090765046366025], ["int", 0.09320733983237217]]}, "q_name": "assert_user_does_not_have_dag_perms.<locals>._assert_user_does_not_have_dag_perms", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[219, 0], [224, 47]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "assert_user_does_not_have_dag_perms", "params": {"has_dag_perm": ""}, "params_descr": {"has_dag_perm": ""}, "params_occur": {"has_dag_perm": []}, "params_p": {"args": [], "has_dag_perm": [["List[Dict[str, Any]]", 0.29414509218847423], ["str", 0.1960967281256495], ["dict", 0.12675909620463746], ["int", 0.09804836406282474], ["Dict[str, Any]", 0.0977802418882585], ["bool", 0.08912211346733084]], "kwargs": []}, "q_name": "assert_user_does_not_have_dag_perms", "ret_exprs": ["return _assert_user_does_not_have_dag_perms"], "ret_type": "", "ret_type_p": [["str", 0.38069322126620475], ["int", 0.186662887026678], ["bool", 0.07690372727075388]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[232, 0], [243, 63]], "fn_var_ln": {"_": [[233, 4], [233, 5]], "_role": [[241, 4], [241, 9]], "params": [[233, 7], [233, 13]]}, "fn_var_occur": {"_": [["_", "params", "role"]], "_role": [["_role", "security_manager", "find_role", "params"], ["_role", "None"], ["len", "_role", "permissions", "len", "params"]], "params": [["_", "params", "role"], ["security_manager", "init_role", "params", "params"], ["_role", "security_manager", "find_role", "params"], ["len", "_role", "permissions", "len", "params"]]}, "name": "test_init_role_baseview", "params": {"app": "", "role": "", "security_manager": ""}, "params_descr": {"app": "", "role": "", "security_manager": ""}, "params_occur": {"app": [], "role": [["_", "params", "role"]], "security_manager": [["security_manager", "init_role", "params", "params"], ["_role", "security_manager", "find_role", "params"]]}, "params_p": {"app": [["int", 0.32907042077990206], ["str", 0.21938028051993472], ["abilian.app.Application", 0.21938028051993472]], "args": [], "kwargs": [], "role": [["IO[str]", 0.1312033847362702]], "security_manager": [["app.GrpyApp", 0.4889725465962001], ["tests.e2e.Helper", 0.11798340067776929], ["instark.application.managers.NotificationManager", 0.09186730419411981]]}, "q_name": "test_init_role_baseview", "ret_exprs": [], "ret_type": "", "variables": {"_": "", "_role": "", "params": ""}, "variables_p": {"_": [["dict", 0.2212271543796262], ["List[bool]", 0.11554245908167242], ["int", 0.10654071870494732], ["List[Tuple[Any, Any]]", 0.09591419161477599], ["Dict[str, str]", 0.08772438052745901], ["Dict[str, Any]", 0.08510372408609651]], "_role": [["int", 0.435138260895251], ["set", 0.17038434488266818], ["List[str]", 0.10402930069071588], ["List[List[bool]]", 0.0923517779041589]], "params": [["list", 0.18370607380858933], ["Type[str]", 0.17735081021602203], ["dict", 0.14657021374268753], ["int", 0.11060009680306607], ["Dict[str, Callable[[], Any]]", 0.10627481964613468], ["cmk.base.plugins.agent_based.job.Job", 0.09698363095093926], ["defaultdict", 0.09097499745576376], ["Dict[str, str]", 0.08753935737679741]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[251, 0], [254, 63]], "fn_var_ln": {"_role": [[252, 4], [252, 9]], "params": [[252, 11], [252, 17]]}, "fn_var_occur": {"_role": [["_role", "params", "role"], ["_role", "None"], ["len", "_role", "permissions", "len", "params"]], "params": [["_role", "params", "role"], ["len", "_role", "permissions", "len", "params"]]}, "name": "test_bulk_sync_roles_baseview", "params": {"app": "", "role": "", "security_manager": ""}, "params_descr": {"app": "", "role": "", "security_manager": ""}, "params_occur": {"app": [], "role": [["_role", "params", "role"]], "security_manager": []}, "params_p": {"app": [["int", 0.3333333332202191], ["str", 0.2222222221468127], ["abilian.app.Application", 0.2222222221468127]], "args": [], "kwargs": [], "role": [], "security_manager": [["int", 0.3333333332202191], ["str", 0.2222222221468127], ["abilian.app.Application", 0.2222222221468127]]}, "q_name": "test_bulk_sync_roles_baseview", "ret_exprs": [], "ret_type": "", "variables": {"_role": "", "params": ""}, "variables_p": {"_role": [["float", 0.1993973203107671], ["list", 0.1966485428658729], ["str", 0.10873911265464443], ["Iterator[Tuple[str, ...]]", 0.10233234223870973], ["List[Dict[str, Any]]", 0.10233234223870973], ["set", 0.10233234223870973], ["List[str]", 0.09523079109769869]], "params": [["list", 0.3352637205125838], ["Dict[str, Dict[str, Any]]", 0.16709358775947783], ["set", 0.13528192405214148], ["List[int]", 0.11067433495908204], ["str", 0.08715554260771673], ["Type[range]", 0.08226544505449904], ["List[str]", 0.08226544505449904]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[273, 0], [280, 62]], "fn_var_ln": {"_role": [[274, 4], [274, 9]], "params": [[274, 11], [274, 17]]}, "fn_var_occur": {"_role": [["_role", "params", "role"], ["len", "_role", "permissions", "len", "params"]], "params": [["_role", "params", "role"], ["len", "_role", "permissions", "len", "params"], ["security_manager", "bulk_sync_roles", "params"]]}, "name": "test_bulk_sync_roles_modelview", "params": {"app": "", "role": "", "security_manager": ""}, "params_descr": {"app": "", "role": "", "security_manager": ""}, "params_occur": {"app": [], "role": [["_role", "params", "role"], ["role", "None"]], "security_manager": [["security_manager", "bulk_sync_roles", "params"]]}, "params_p": {"app": [["int", 0.3333333332202191], ["str", 0.2222222221468127], ["abilian.app.Application", 0.2222222221468127]], "args": [], "kwargs": [], "role": [], "security_manager": [["app.GrpyApp", 0.20594138145218555], ["app.utils.models.ModelManager", 0.11286698630509305]]}, "q_name": "test_bulk_sync_roles_modelview", "ret_exprs": [], "ret_type": "", "variables": {"_role": "", "params": ""}, "variables_p": {"_role": [["list", 0.3352637205125838], ["Dict[str, Dict[str, Any]]", 0.16709358775947783], ["set", 0.13528192405214148], ["List[int]", 0.11067433495908204], ["str", 0.08715554260771673], ["Type[range]", 0.08226544505449904], ["List[str]", 0.08226544505449904]], "params": [["Dict[str, int]", 0.3584591585777463], ["str", 0.19459471435226544], ["Dict[str, List[Any]]", 0.1491920859173261], ["dict", 0.10370821347255446], ["set", 0.09897847512207862], ["List[str]", 0.09506735255802899]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[288, 0], [298, 34]], "fn_var_ln": {"_role": [[289, 4], [289, 9]], "new_role_perms_len": [[295, 4], [295, 22]], "params": [[289, 11], [289, 17]], "perm": [[290, 4], [290, 8]], "role_perms_len": [[292, 4], [292, 18]]}, "fn_var_occur": {"_role": [["_role", "params", "role"], ["security_manager", "add_permission_to_role", "_role", "perm"], ["role_perms_len", "len", "_role", "permissions"], ["new_role_perms_len", "len", "_role", "permissions"]], "new_role_perms_len": [["new_role_perms_len", "len", "_role", "permissions"], ["role_perms_len", "new_role_perms_len"]], "params": [["_role", "params", "role"], ["security_manager", "bulk_sync_roles", "params"]], "perm": [["perm", "security_manager", "get_permission", "permissions", "ACTION_CAN_EDIT", "permissions", "RESOURCE_ROLE"], ["security_manager", "add_permission_to_role", "_role", "perm"]], "role_perms_len": [["role_perms_len", "len", "_role", "permissions"], ["role_perms_len", "new_role_perms_len"]]}, "name": "test_update_and_verify_permission_role", "params": {"app": "", "role": "", "security_manager": ""}, "params_descr": {"app": "", "role": "", "security_manager": ""}, "params_occur": {"app": [], "role": [["_role", "params", "role"]], "security_manager": [["perm", "security_manager", "get_permission", "permissions", "ACTION_CAN_EDIT", "permissions", "RESOURCE_ROLE"], ["security_manager", "add_permission_to_role", "_role", "perm"], ["security_manager", "bulk_sync_roles", "params"]]}, "params_p": {"app": [["int", 0.29446174750141557], ["str", 0.19630783166761037], ["abilian.app.Application", 0.19630783166761037]], "args": [], "kwargs": [], "role": [["Dict[str, Any]", 0.21030371449813326], ["dict", 0.08134941096069262], ["str", 0.07784272565459843]], "security_manager": [["tests.setup.SetupTest", 0.19486362925597928], ["tests.e2e.Helper", 0.10110653125905462], ["server.service.manager.rental_manager.RentalManager", 0.09979381033857006], ["app.GrpyApp", 0.09646675871006019]]}, "q_name": "test_update_and_verify_permission_role", "ret_exprs": [], "ret_type": "", "variables": {"_role": "", "new_role_perms_len": "", "params": "", "perm": "", "role_perms_len": ""}, "variables_p": {"_role": [["Optional[str]", 0.2879592060522098], ["List[str]", 0.2063620944915066], ["List[int]", 0.1791025346541841], ["manager.CliManager", 0.1253749346716564], ["dict", 0.08810097596677001]], "new_role_perms_len": [["int", 0.2521950437615611], ["Dict[int, List[Any]]", 0.17141571452873267], ["float", 0.15002411500452525], ["bool", 0.08460886605051235], ["List[str]", 0.08268630928491753], ["list", 0.08202672880765267], ["List[float]", 0.07778087732903752]], "params": [["bytes", 0.12125095779089089], ["Dict[str, Any]", 0.10470342225109912], ["int", 0.10470342225109912], ["str", 0.09546392264065215], ["Dict[str, Union[dict, str]]", 0.08874598535878143], ["Dict[str, Dict[str, Any]]", 0.08551101147709007], ["dict", 0.08551101147709007]], "perm": [["Dict[str, Union[Any, Any, Any, Any]]", 0.10911916738782487]], "role_perms_len": [["int", 0.4689431057436567], ["List[int]", 0.24625068482767823], ["set", 0.11547372841282025], ["List[str]", 0.08847023258082841], ["list", 0.08086224843501649]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[301, 0], [303, 35]], "fn_var_ln": {"public": [[302, 4], [302, 10]]}, "fn_var_occur": {"public": [["public", "security_manager", "find_role"], ["public", "permissions"]]}, "name": "test_verify_public_role_has_no_permissions", "params": {"security_manager": ""}, "params_descr": {"security_manager": ""}, "params_occur": {"security_manager": [["public", "security_manager", "find_role"]]}, "params_p": {"args": [], "kwargs": [], "security_manager": [["Dict[str, Any]", 0.08749639214370972], ["mtg_ssm.scryfall.models.ScryObject", 0.08749639214370972]]}, "q_name": "test_verify_public_role_has_no_permissions", "ret_exprs": [], "ret_type": "", "variables": {"public": ""}, "variables_p": {"public": [["dict", 0.18164589027846656], ["frozenset[str]", 0.09704870109517344], ["str", 0.08092116833326442]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[306, 0], [315, 73]], "fn_var_ln": {"user": [[308, 8], [308, 12]]}, "fn_var_occur": {"user": [["user", "AnonymousUser"], ["security_manager", "get_user_roles", "user", "security_manager", "get_public_role"], ["security_manager", "get_accessible_dag_ids", "user", "set"]]}, "name": "test_verify_default_anon_user_has_no_accessible_dag_ids", "params": {"app": "", "security_manager": "", "session": ""}, "params_descr": {"app": "", "security_manager": "", "session": ""}, "params_occur": {"app": [["app", "app_context"], ["app", "config"]], "security_manager": [["security_manager", "get_user_roles", "user", "security_manager", "get_public_role"], ["_create_dag_model_context", "session", "security_manager"], ["security_manager", "sync_roles"], ["security_manager", "get_accessible_dag_ids", "user", "set"]], "session": [["_create_dag_model_context", "session", "security_manager"]]}, "params_p": {"app": [["raiden.utils.List[raiden.raiden_service.RaidenService]", 0.9999999999999998]], "args": [], "kwargs": [], "security_manager": [["tests.setup.SetupTest", 0.09851936240417301]], "session": [["sqlalchemy.orm.Session", 0.3035717543675229], ["models.UserAuth", 0.08167057039651963], ["List[Dict[str, Any]]", 0.08124686780981114], ["str", 0.08029028205490125]]}, "q_name": "test_verify_default_anon_user_has_no_accessible_dag_ids", "ret_exprs": [], "ret_type": "", "variables": {"user": ""}, "variables_p": {"user": [["str", 0.20338439639353473], ["Dict[str, Dict[str, Any]]", 0.13265626837938443], ["Dict[str, Union[int, str]]", 0.10796291567668423], ["Dict[str, str]", 0.10718772795554257], ["app.models.User", 0.09959168813704483], ["zerver.models.UserProfile", 0.09534891354987986], ["metaswitch_tinder.database.models.User", 0.08454791637686077]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[318, 0], [331, 83]], "fn_var_ln": {"dag_id": [[324, 8], [324, 14]], "user": [[320, 8], [320, 12]]}, "fn_var_occur": {"dag_id": [["_create_dag_model_context", "dag_id", "session", "security_manager"], ["security_manager", "can_read_dag", "dag_id", "user", "False"], ["security_manager", "can_edit_dag", "dag_id", "user", "False"], ["has_dag_perm", "permissions", "ACTION_CAN_READ", "dag_id", "user", "False"], ["has_dag_perm", "permissions", "ACTION_CAN_EDIT", "dag_id", "user", "False"]], "user": [["user", "AnonymousUser"], ["security_manager", "get_user_roles", "user", "security_manager", "get_public_role"], ["security_manager", "can_read_dag", "dag_id", "user", "False"], ["security_manager", "can_edit_dag", "dag_id", "user", "False"], ["has_dag_perm", "permissions", "ACTION_CAN_READ", "dag_id", "user", "False"], ["has_dag_perm", "permissions", "ACTION_CAN_EDIT", "dag_id", "user", "False"]]}, "name": "test_verify_default_anon_user_has_no_access_to_specific_dag", "params": {"app": "", "has_dag_perm": "", "security_manager": "", "session": ""}, "params_descr": {"app": "", "has_dag_perm": "", "security_manager": "", "session": ""}, "params_occur": {"app": [["app", "app_context"], ["app", "config"]], "has_dag_perm": [["has_dag_perm", "permissions", "ACTION_CAN_READ", "dag_id", "user", "False"], ["has_dag_perm", "permissions", "ACTION_CAN_EDIT", "dag_id", "user", "False"]], "security_manager": [["security_manager", "get_user_roles", "user", "security_manager", "get_public_role"], ["_create_dag_model_context", "dag_id", "session", "security_manager"], ["security_manager", "sync_roles"], ["security_manager", "can_read_dag", "dag_id", "user", "False"], ["security_manager", "can_edit_dag", "dag_id", "user", "False"]], "session": [["_create_dag_model_context", "dag_id", "session", "security_manager"]]}, "params_p": {"app": [["raiden.utils.List[raiden.raiden_service.RaidenService]", 0.9999999999999999]], "args": [], "has_dag_perm": [["int", 0.3272994427342151], ["ajapaik.ajapaik_object_recognition.models.ObjectDetectionAnnotation", 0.12352422510176908], ["str", 0.09501369445545967], ["List[int]", 0.09225436880976183], ["float", 0.0869164781959896], ["app.db_models.user.User", 0.08495587016449781]], "kwargs": [], "security_manager": [["List[src.main.core.models.area.Area]", 0.09714682750267675], ["raiden.utils.BlockIdentifier", 0.09562556851545762], ["bool", 0.07683333195014351]], "session": [["str", 0.20297083514840863], ["app.models.user.User", 0.18577371972061105], ["app.models.User", 0.18577371972061105]]}, "q_name": "test_verify_default_anon_user_has_no_access_to_specific_dag", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "user": ""}, "variables_p": {"dag_id": [["str", 0.2041847836060452], ["Optional[int]", 0.11045622698415783], ["verification_token.models.Token", 0.10017019395276916], ["sqlalchemy.orm.Session", 0.09783642278391401], ["int", 0.096085087139545]], "user": [["Dict[str, str]", 0.28641031749768997], ["str", 0.20913495050613384], ["Dict[str, Dict[str, Any]]", 0.1259739160884132], ["zerver.models.UserProfile", 0.09733453473227979], ["app.models.User", 0.0972005403936843], ["Dict[str, Union[int, str]]", 0.09537569644504505]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[339, 0], [349, 81]], "fn_var_ln": {"test_dag_ids": [[340, 4], [340, 16]], "user": [[343, 8], [343, 12]]}, "fn_var_occur": {"test_dag_ids": [["test_dag_ids", "mock_dag_models"], ["security_manager", "get_accessible_dag_ids", "user", "set", "test_dag_ids"]], "user": [["user", "AnonymousUser"], ["security_manager", "get_user_roles", "user", "security_manager", "get_public_role"], ["security_manager", "get_accessible_dag_ids", "user", "set", "test_dag_ids"]]}, "name": "test_verify_anon_user_with_admin_role_has_all_dag_access", "params": {"app": "", "mock_dag_models": "", "security_manager": ""}, "params_descr": {"app": "", "mock_dag_models": "", "security_manager": ""}, "params_occur": {"app": [["app", "app_context"], ["app", "config"]], "mock_dag_models": [["test_dag_ids", "mock_dag_models"]], "security_manager": [["security_manager", "get_user_roles", "user", "security_manager", "get_public_role"], ["security_manager", "sync_roles"], ["security_manager", "get_accessible_dag_ids", "user", "set", "test_dag_ids"]]}, "params_p": {"app": [["app.GrpyApp", 0.2641034312005559]], "args": [], "kwargs": [], "mock_dag_models": [["str", 0.2631875230218008], ["tests.test_util.aiohttp.AiohttpClientMocker", 0.07779768996741791]], "security_manager": [["tests.setup.SetupTest", 0.6863501472938701]]}, "q_name": "test_verify_anon_user_with_admin_role_has_all_dag_access", "ret_exprs": [], "ret_type": "", "variables": {"test_dag_ids": "", "user": ""}, "variables_p": {"test_dag_ids": [["str", 0.3157977635336342], ["int", 0.09108380962641648]], "user": [["str", 0.20338439639353473], ["Dict[str, Dict[str, Any]]", 0.13265626837938443], ["Dict[str, Union[int, str]]", 0.10796291567668423], ["Dict[str, str]", 0.10718772795554257], ["app.models.User", 0.09959168813704483], ["zerver.models.UserProfile", 0.09534891354987986], ["metaswitch_tinder.database.models.User", 0.08454791637686077]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[352, 0], [372, 86]], "fn_var_ln": {"roles": [[360, 8], [360, 18]], "test_dag_ids": [[363, 8], [363, 20]], "user": [[356, 8], [356, 12]]}, "fn_var_occur": {"roles": [["user", "roles", "security_manager", "get_user_roles", "user"], ["user", "roles", "security_manager", "get_public_role"]], "test_dag_ids": [], "user": [["user", "AnonymousUser"], ["user", "roles", "security_manager", "get_user_roles", "user"], ["user", "roles", "security_manager", "get_public_role"], ["security_manager", "can_read_dag", "dag_id", "user", "True"], ["security_manager", "can_edit_dag", "dag_id", "user", "True"], ["has_dag_perm", "permissions", "ACTION_CAN_READ", "dag_id", "user", "True"], ["has_dag_perm", "permissions", "ACTION_CAN_EDIT", "dag_id", "user", "True"]]}, "name": "test_verify_anon_user_with_admin_role_has_access_to_each_dag", "params": {"app": "", "has_dag_perm": "", "security_manager": "", "session": ""}, "params_descr": {"app": "", "has_dag_perm": "", "security_manager": "", "session": ""}, "params_occur": {"app": [["app", "app_context"], ["app", "config"]], "has_dag_perm": [["has_dag_perm", "permissions", "ACTION_CAN_READ", "dag_id", "user", "True"], ["has_dag_perm", "permissions", "ACTION_CAN_EDIT", "dag_id", "user", "True"]], "security_manager": [["user", "roles", "security_manager", "get_user_roles", "user"], ["user", "roles", "security_manager", "get_public_role"], ["_create_dag_model_context", "dag_id", "session", "security_manager"], ["security_manager", "sync_roles"], ["security_manager", "can_read_dag", "dag_id", "user", "True"], ["security_manager", "can_edit_dag", "dag_id", "user", "True"]], "session": [["_create_dag_model_context", "dag_id", "session", "security_manager"]]}, "params_p": {"app": [["raiden.utils.List[raiden.raiden_service.RaidenService]", 1.0]], "args": [], "has_dag_perm": [["bool", 0.39922530482664975], ["app.models.user.User", 0.19477706575285553], ["app.models.User", 0.19477706575285553], ["str", 0.10553406730630456]], "kwargs": [], "security_manager": [["User", 0.09333736992896595]], "session": [["app.models.User", 0.18523741834612334], ["app.models.user.User", 0.18523741834612334], ["str", 0.17529223576749553], ["instark.application.managers.SessionManager", 0.15575065793849843]]}, "q_name": "test_verify_anon_user_with_admin_role_has_access_to_each_dag", "ret_exprs": [], "ret_type": "", "variables": {"roles": "", "test_dag_ids": "", "user": ""}, "variables_p": {"roles": [], "test_dag_ids": [["str", 0.9999999998655771], ["dict", 1.3442296793178256e-10]], "user": [["metaswitch_tinder.database.models.User", 0.20060925562512283], ["contests.models.User", 0.11937203861012335], ["grpy.core.models.User", 0.11899777410706272], ["core.models.MyUser", 0.10051907818681538], ["muse_for_music.models.users.User", 0.09412180707865316], ["legistar.models.EventItem", 0.0924039152888576], ["abilian.core.models.subjects.User", 0.09180974523093322], ["Dict[str, Any]", 0.09114383047725841], ["users.models.JustfixUser", 0.09102255539517326]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[375, 0], [380, 57]], "fn_var_ln": {"is_anonymous": [[377, 4], [377, 21]], "roles": [[379, 4], [379, 14]], "user": [[376, 4], [376, 8]]}, "fn_var_occur": {"is_anonymous": [["user", "is_anonymous", "False"]], "roles": [["roles", "app_builder", "sm", "find_role"], ["user", "roles", "roles"], ["security_manager", "get_user_roles", "user", "roles"]], "user": [["user", "mock", "MagicMock"], ["user", "is_anonymous", "False"], ["user", "roles", "roles"], ["security_manager", "get_user_roles", "user", "roles"]]}, "name": "test_get_user_roles", "params": {"app_builder": "", "security_manager": ""}, "params_descr": {"app_builder": "", "security_manager": ""}, "params_occur": {"app_builder": [["roles", "app_builder", "sm", "find_role"]], "security_manager": [["security_manager", "get_user_roles", "user", "roles"]]}, "params_p": {"app_builder": [["str", 0.3128970616779433]], "args": [], "kwargs": [], "security_manager": [["bool", 0.1122607708912734], ["application.domain.common.AuthProvider", 0.09910888157775936], ["application.domain.common.TenantProvider", 0.09910888157775936], ["tests.setup.SetupTest", 0.08805236319075127]]}, "q_name": "test_get_user_roles", "ret_exprs": [], "ret_type": "", "variables": {"is_anonymous": "", "roles": "", "user": ""}, "variables_p": {"is_anonymous": [["bool", 0.4519548436396449], ["Tuple[str, str]", 0.2094114661488718], ["str", 0.16500763668386395], ["Set[str]", 0.0837079356853946]], "roles": [["Dict[str, int]", 0.20610356841859098], ["bytes", 0.10389114899430547], ["str", 0.08590616542587594]], "user": [["mock.MagicMock", 0.3762643277028068], ["mock.Mock", 0.16532560302311175]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[383, 0], [427, 47]], "fn_var_ln": {"perms_views": [[424, 8], [424, 19]], "user": [[422, 8], [422, 12]], "viewer_role_perms": [[384, 4], [384, 21]]}, "fn_var_occur": {"perms_views": [["perms_views", "set"], ["perms_views", "update", "perm", "action", "name", "perm", "resource", "name", "perm", "role", "permissions"], ["perms_views", "viewer_role_perms"]], "user": [["user", "AnonymousUser"], ["security_manager", "get_user_roles", "user"]], "viewer_role_perms": [["viewer_role_perms", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_AUDIT_LOG", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG_DEPENDENCIES", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG_CODE", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG_RUN", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DATASET", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_CLUSTER_ACTIVITY", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_IMPORT_ERROR", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG_WARNING", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_JOB", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_PLUGIN", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_SLA_MISS", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_TASK_INSTANCE", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_TASK_LOG", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_XCOM", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_WEBSITE", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_MY_PASSWORD", "permissions", "ACTION_CAN_EDIT", "permissions", "RESOURCE_MY_PASSWORD", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_MY_PROFILE", "permissions", "ACTION_CAN_EDIT", "permissions", "RESOURCE_MY_PROFILE", "permissions", "ACTION_CAN_ACCESS_MENU", "permissions", "RESOURCE_BROWSE_MENU", "permissions", "ACTION_CAN_ACCESS_MENU", "permissions", "RESOURCE_DAG", "permissions", "ACTION_CAN_ACCESS_MENU", "permissions", "RESOURCE_DAG_DEPENDENCIES", "permissions", "ACTION_CAN_ACCESS_MENU", "permissions", "RESOURCE_DAG_RUN", "permissions", "ACTION_CAN_ACCESS_MENU", "permissions", "RESOURCE_DATASET", "permissions", "ACTION_CAN_ACCESS_MENU", "permissions", "RESOURCE_CLUSTER_ACTIVITY", "permissions", "ACTION_CAN_ACCESS_MENU", "permissions", "RESOURCE_JOB", "permissions", "ACTION_CAN_ACCESS_MENU", "permissions", "RESOURCE_AUDIT_LOG", "permissions", "ACTION_CAN_ACCESS_MENU", "permissions", "RESOURCE_PLUGIN", "permissions", "ACTION_CAN_ACCESS_MENU", "permissions", "RESOURCE_SLA_MISS", "permissions", "ACTION_CAN_ACCESS_MENU", "permissions", "RESOURCE_TASK_INSTANCE", "permissions", "ACTION_CAN_ACCESS_MENU", "permissions", "RESOURCE_DOCS_MENU", "permissions", "ACTION_CAN_ACCESS_MENU", "permissions", "RESOURCE_DOCS"], ["perms_views", "viewer_role_perms"]]}, "name": "test_get_user_roles_for_anonymous_user", "params": {"app": "", "security_manager": ""}, "params_descr": {"app": "", "security_manager": ""}, "params_occur": {"app": [["app", "config"], ["app", "app_context"]], "security_manager": [["security_manager", "get_user_roles", "user"]]}, "params_p": {"app": [["app.GrpyApp", 0.20840252292601624], ["routemaster.app.App", 0.09502603276407492], ["raiden.utils.List[raiden.raiden_service.RaidenService]", 0.0886500107235624]], "args": [], "kwargs": [], "security_manager": [["app.GrpyApp", 0.47183685208272436], ["tests.setup.SetupTest", 0.1921522464638898], ["routemaster.app.App", 0.08518068679046048], ["aioapp.app.Application", 0.08441413245487729]]}, "q_name": "test_get_user_roles_for_anonymous_user", "ret_exprs": [], "ret_type": "", "variables": {"perms_views": "", "user": "", "viewer_role_perms": ""}, "variables_p": {"perms_views": [["dict", 0.09102724120465942], ["OrderedDict[str, Any]", 0.09046224570038171], ["models.groups.Groups", 0.09006596419610409], ["Set[str]", 0.0837653331429854]], "user": [["metaswitch_tinder.database.models.User", 0.184133439898099], ["cleancoderscom.entities.user.User", 0.1180943659545145], ["Dict[str, Union[int, str]]", 0.112919979458097], ["Dict[str, Dict[str, Any]]", 0.11202689382668757], ["zerver.models.UserProfile", 0.10729327988522454], ["app.models.User", 0.09240024402178282], ["str", 0.09064670904759663]], "viewer_role_perms": [["bytes", 0.19535180742667624], ["list", 0.1118966547471907], ["db.facade.DBFacade", 0.09312256674070195]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[430, 0], [449, 39]], "fn_var_ln": {"action": [[431, 4], [431, 10]], "resource": [[432, 4], [432, 12]]}, "fn_var_occur": {"action": [["create_user_scope", "app", "username", "role_name", "permissions", "action", "resource", "user"], ["user", "perms", "action", "resource"]], "resource": [["create_user_scope", "app", "username", "role_name", "permissions", "action", "resource", "user"], ["user", "perms", "action", "resource"]]}, "name": "test_get_current_user_permissions", "params": {"app": ""}, "params_descr": {"app": ""}, "params_occur": {"app": [["app", "app_context"], ["create_user_scope", "app", "username", "role_name", "permissions", "action", "resource", "user"], ["create_user_scope", "app", "username", "user"]]}, "params_p": {"app": [["abilian.app.Application", 0.46417421982527296]], "args": [], "kwargs": []}, "q_name": "test_get_current_user_permissions", "ret_exprs": [], "ret_type": "", "variables": {"action": "", "resource": ""}, "variables_p": {"action": [["str", 0.48667610137137685]], "resource": [["str", 0.48667610137137685]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[452, 0], [476, 78]], "fn_var_ln": {"dag_id": [[455, 4], [455, 10]], "dag_model": [[468, 12], [468, 21]], "permission_action": [[454, 4], [454, 21]], "role_name": [[453, 4], [453, 13]], "username": [[456, 4], [456, 12]]}, "fn_var_occur": {"dag_id": [["dag_model", "DagModel", "dag_id", "dag_id", "fileloc", "schedule_interval"], ["security_manager", "sync_perm_for_dag", "dag_id", "access_control", "role_name", "permission_action"]], "dag_model": [["dag_model", "DagModel", "dag_id", "dag_id", "fileloc", "schedule_interval"], ["session", "add", "dag_model"]], "permission_action": [["permission_action", "permissions", "ACTION_CAN_READ"], ["security_manager", "sync_perm_for_dag", "dag_id", "access_control", "role_name", "permission_action"]], "role_name": [["create_user_scope", "app", "username", "username", "role_name", "role_name", "permissions", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG", "user"], ["security_manager", "sync_perm_for_dag", "dag_id", "access_control", "role_name", "permission_action"]], "username": [["create_user_scope", "app", "username", "username", "role_name", "role_name", "permissions", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG", "user"]]}, "name": "test_get_accessible_dag_ids", "params": {"app": "", "security_manager": "", "session": ""}, "params_descr": {"app": "", "security_manager": "", "session": ""}, "params_occur": {"app": [["app", "app_context"], ["create_user_scope", "app", "username", "username", "role_name", "role_name", "permissions", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG", "user"]], "security_manager": [["security_manager", "sync_perm_for_dag", "dag_id", "access_control", "role_name", "permission_action"], ["security_manager", "get_accessible_dag_ids", "user"]], "session": [["session", "add", "dag_model"], ["session", "commit"]]}, "params_p": {"app": [["str", 0.3134372094238277]], "args": [], "kwargs": [], "security_manager": [["tests.setup.SetupTest", 0.2707266420363536]], "session": [["sqlalchemy.orm.Session", 0.20752957930257707], ["sqlalchemy.orm.session.Session", 0.12785054672749574], ["str", 0.08426200627931449], ["List[cmk.utils.type_defs.HostName]", 0.07784823718922988]]}, "q_name": "test_get_accessible_dag_ids", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dag_model": "", "permission_action": "", "role_name": "", "username": ""}, "variables_p": {"dag_id": [["int", 0.5827501168282734], ["str", 0.10203261062762961]], "dag_model": [["dict", 0.25129509002331124], ["str", 0.1795161619184873], ["Tuple[str]", 0.14467685450298937], ["set", 0.09027252719934578], ["tensorflow.keras.Model", 0.08442091664993177], ["Dict[str, str]", 0.08415956626995322]], "permission_action": [["str", 0.2843746931180938], ["Type[bootcamp.news.models.News]", 0.11498611905453086]], "role_name": [["str", 0.784232103523097], ["list", 0.12035879810941232], ["Optional[str]", 0.09540909836749056]], "username": [["ajapaik.ajapaik.models.Area", 0.19722678717012573], ["List[Union[Any, Any, Any, Any]]", 0.10755029198901835], ["str", 0.10445453650054844], ["tests.mypy.modules.success.Model", 0.09657636473869546], ["dict", 0.08879460768355084]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[479, 0], [503, 71]], "fn_var_ln": {"dag_id": [[485, 4], [485, 10]], "dag_model": [[495, 12], [495, 21]], "permission_action": [[484, 4], [484, 21]], "role_name": [[483, 4], [483, 13]], "username": [[482, 4], [482, 12]]}, "fn_var_occur": {"dag_id": [["dag_model", "DagModel", "dag_id", "dag_id", "fileloc", "schedule_interval"], ["security_manager", "sync_perm_for_dag", "dag_id", "access_control", "role_name", "permission_action"]], "dag_model": [["dag_model", "DagModel", "dag_id", "dag_id", "fileloc", "schedule_interval"], ["session", "add", "dag_model"]], "permission_action": [["permission_action", "permissions", "ACTION_CAN_EDIT"], ["security_manager", "sync_perm_for_dag", "dag_id", "access_control", "role_name", "permission_action"]], "role_name": [["create_user_scope", "app", "username", "username", "role_name", "role_name", "permissions", "permissions", "ACTION_CAN_EDIT", "permissions", "RESOURCE_DAG", "user"], ["security_manager", "sync_perm_for_dag", "dag_id", "access_control", "role_name", "permission_action"]], "username": [["create_user_scope", "app", "username", "username", "role_name", "role_name", "permissions", "permissions", "ACTION_CAN_EDIT", "permissions", "RESOURCE_DAG", "user"]]}, "name": "test_dont_get_inaccessible_dag_ids_for_dag_resource_permission", "params": {"app": "", "security_manager": "", "session": ""}, "params_descr": {"app": "", "security_manager": "", "session": ""}, "params_occur": {"app": [["app", "app_context"], ["create_user_scope", "app", "username", "username", "role_name", "role_name", "permissions", "permissions", "ACTION_CAN_EDIT", "permissions", "RESOURCE_DAG", "user"]], "security_manager": [["security_manager", "sync_perm_for_dag", "dag_id", "access_control", "role_name", "permission_action"], ["security_manager", "get_readable_dag_ids", "user", "set"]], "session": [["session", "add", "dag_model"], ["session", "commit"]]}, "params_p": {"app": [["str", 0.1922362529514036], ["Dict[str, str]", 0.09857949486238725], ["zerver.models.Client", 0.09361572124785147]], "args": [], "kwargs": [], "security_manager": [["tests.setup.SetupTest", 0.2910297088898899]], "session": [["sqlalchemy.orm.Session", 0.2212046274221633], ["sqlalchemy.orm.session.Session", 0.1250677630725439], ["app.models.Game", 0.07589689798555363], ["str", 0.07588169359703738]]}, "q_name": "test_dont_get_inaccessible_dag_ids_for_dag_resource_permission", "ret_exprs": [], "ret_type": "", "variables": {"dag_id": "", "dag_model": "", "permission_action": "", "role_name": "", "username": ""}, "variables_p": {"dag_id": [["int", 0.5827501168282734], ["str", 0.10203261062762961]], "dag_model": [["dict", 0.25129509002331124], ["str", 0.1795161619184873], ["Tuple[str]", 0.14467685450298937], ["set", 0.09027252719934578], ["tensorflow.keras.Model", 0.08442091664993177], ["Dict[str, str]", 0.08415956626995322]], "permission_action": [["str", 0.2843746931180938], ["Type[bootcamp.news.models.News]", 0.11498611905453086]], "role_name": [["str", 0.7203322444605569], ["Optional[str]", 0.09482956588192819], ["list", 0.092407588337451]], "username": [["str", 0.3314176440883946], ["ajapaik.ajapaik.models.Area", 0.1980785717891437]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[506, 0], [511, 72]], "fn_var_ln": {"action_name": [[508, 4], [508, 15]], "perms": [[510, 4], [510, 14]], "resource_name": [[509, 4], [509, 17]], "user": [[507, 4], [507, 8]]}, "fn_var_occur": {"action_name": [["user", "perms", "action_name", "resource_name"], ["security_manager", "has_access", "action_name", "resource_name", "user"]], "perms": [["user", "perms", "action_name", "resource_name"]], "resource_name": [["user", "perms", "action_name", "resource_name"], ["security_manager", "has_access", "action_name", "resource_name", "user"]], "user": [["user", "mock", "MagicMock"], ["user", "perms", "action_name", "resource_name"], ["security_manager", "has_access", "action_name", "resource_name", "user"]]}, "name": "test_has_access", "params": {"security_manager": ""}, "params_descr": {"security_manager": ""}, "params_occur": {"security_manager": [["security_manager", "has_access", "action_name", "resource_name", "user"]]}, "params_p": {"args": [], "kwargs": [], "security_manager": [["tests.basilisp.helpers.CompileFn", 0.18148193390867332], ["cmk.utils.type_defs.UserId", 0.09008073494556243]]}, "q_name": "test_has_access", "ret_exprs": [], "ret_type": "", "variables": {"action_name": "", "perms": "", "resource_name": "", "user": ""}, "variables_p": {"action_name": [["frozenset[Union[Any, Any]]", 0.3894512555465889], ["str", 0.31232304365858243], ["List[str]", 0.12381555428674162], ["Pattern[str]", 0.0919534629303508], ["dict", 0.08245668357773618]], "perms": [["Type[str]", 0.6141331529097783], ["str", 0.27101750471056235], ["int", 0.11484934237965928]], "resource_name": [["frozenset[Union[Any, Any]]", 0.3894512555465889], ["str", 0.31232304365858243], ["List[str]", 0.12381555428674162], ["Pattern[str]", 0.0919534629303508], ["dict", 0.08245668357773618]], "user": [["mock.MagicMock", 0.43042734039344144], ["mock.Mock", 0.21759026455871158]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[514, 0], [519, 105]], "fn_var_ln": {"prefixed_test_dag_id": [[516, 4], [516, 24]], "test_dag_id": [[515, 4], [515, 15]]}, "fn_var_occur": {"prefixed_test_dag_id": [["prefixed_test_dag_id", "test_dag_id"], ["security_manager", "get_permission", "permissions", "ACTION_CAN_READ", "prefixed_test_dag_id", "None"], ["security_manager", "get_permission", "permissions", "ACTION_CAN_EDIT", "prefixed_test_dag_id", "None"]], "test_dag_id": [["prefixed_test_dag_id", "test_dag_id"], ["security_manager", "sync_perm_for_dag", "test_dag_id", "access_control", "None"]]}, "name": "test_sync_perm_for_dag_creates_permissions_on_resources", "params": {"security_manager": ""}, "params_descr": {"security_manager": ""}, "params_occur": {"security_manager": [["security_manager", "sync_perm_for_dag", "test_dag_id", "access_control", "None"], ["security_manager", "get_permission", "permissions", "ACTION_CAN_READ", "prefixed_test_dag_id", "None"], ["security_manager", "get_permission", "permissions", "ACTION_CAN_EDIT", "prefixed_test_dag_id", "None"]]}, "params_p": {"args": [], "kwargs": [], "security_manager": [["tests.setup.SetupTest", 0.9999999999999999]]}, "q_name": "test_sync_perm_for_dag_creates_permissions_on_resources", "ret_exprs": [], "ret_type": "", "variables": {"prefixed_test_dag_id": "", "test_dag_id": ""}, "variables_p": {"prefixed_test_dag_id": [["list", 0.19756476573796028], ["str", 0.18123750677444234], ["dict", 0.126631842751819], ["int", 0.11987950799588847], ["List[str]", 0.09674905597121645]], "test_dag_id": [["str", 0.7748560769821089], ["int", 0.11326162325902173]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[522, 0], [557, 65]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_has_all_dag_access", "params": {"app": "", "security_manager": ""}, "params_descr": {"app": "", "security_manager": ""}, "params_occur": {"app": [["app", "app_context"], ["create_user_scope", "app", "username", "role_name", "role_name", "user"], ["app", "app_context"], ["create_user_scope", "app", "username", "role_name", "permissions", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG", "user"], ["app", "app_context"], ["create_user_scope", "app", "username", "role_name", "permissions", "permissions", "ACTION_CAN_EDIT", "permissions", "RESOURCE_DAG", "user"], ["app", "app_context"], ["create_user_scope", "app", "username", "role_name", "permissions", "user"]], "security_manager": [["security_manager", "has_all_dags_access", "user"], ["security_manager", "has_all_dags_access", "user"], ["security_manager", "has_all_dags_access", "user"], ["security_manager", "has_all_dags_access", "user"]]}, "params_p": {"app": [["abilian.app.Application", 0.456205795788377]], "args": [], "kwargs": [], "security_manager": [["tests.setup.SetupTest", 0.3866117936563796], ["app.GrpyApp", 0.27009615199500686]]}, "q_name": "test_has_all_dag_access", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[560, 0], [568, 50]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_access_control_with_non_existent_role", "params": {"security_manager": ""}, "params_descr": {"security_manager": ""}, "params_occur": {"security_manager": [["security_manager", "_sync_dag_view_permissions", "dag_id", "access_control", "permissions", "ACTION_CAN_EDIT", "permissions", "ACTION_CAN_READ"]]}, "params_p": {"args": [], "kwargs": [], "security_manager": [["tests.setup.SetupTest", 0.09471980312478298], ["int", 0.09189280393947691]]}, "q_name": "test_access_control_with_non_existent_role", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[571, 0], [587, 13]], "fn_var_ln": {"role_name": [[573, 4], [573, 13]], "username": [[572, 4], [572, 12]]}, "fn_var_occur": {"role_name": [["create_user_scope", "app", "username", "username", "role_name", "role_name", "permissions", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG", "user"]], "username": [["create_user_scope", "app", "username", "username", "role_name", "role_name", "permissions", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG", "user"]]}, "name": "test_all_dag_access_doesnt_give_non_dag_access", "params": {"app": "", "security_manager": ""}, "params_descr": {"app": "", "security_manager": ""}, "params_occur": {"app": [["app", "app_context"], ["create_user_scope", "app", "username", "username", "role_name", "role_name", "permissions", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG", "user"]], "security_manager": [["security_manager", "has_access", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_DAG", "user"], ["security_manager", "has_access", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_TASK_INSTANCE", "user"]]}, "params_p": {"app": [["abilian.app.Application", 0.2670828965724158]], "args": [], "kwargs": [], "security_manager": [["tests.setup.SetupTest", 0.8988867190675889]]}, "q_name": "test_all_dag_access_doesnt_give_non_dag_access", "ret_exprs": [], "ret_type": "", "variables": {"role_name": "", "username": ""}, "variables_p": {"role_name": [["str", 0.784232103523097], ["list", 0.12035879810941232], ["Optional[str]", 0.09540909836749056]], "username": [["ajapaik.ajapaik.models.Area", 0.19722678717012573], ["List[Union[Any, Any, Any, Any]]", 0.10755029198901835], ["str", 0.10445453650054844], ["tests.mypy.modules.success.Model", 0.09657636473869546], ["dict", 0.08879460768355084]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[590, 0], [608, 58]], "fn_var_ln": {"invalid_actions": [[591, 4], [591, 19]], "rolename": [[596, 4], [596, 12]], "username": [[595, 4], [595, 12]]}, "fn_var_occur": {"invalid_actions": [], "rolename": [["create_user_scope", "app", "username", "username", "role_name", "rolename"], ["security_manager", "_sync_dag_view_permissions", "access_control", "rolename", "action"]], "username": [["create_user_scope", "app", "username", "username", "role_name", "rolename"]]}, "name": "test_access_control_with_invalid_permission", "params": {"app": "", "security_manager": ""}, "params_descr": {"app": "", "security_manager": ""}, "params_occur": {"app": [["create_user_scope", "app", "username", "username", "role_name", "rolename"]], "security_manager": [["security_manager", "_sync_dag_view_permissions", "access_control", "rolename", "action"]]}, "params_p": {"app": [["app.executor.Application", 0.08804620373757169]], "args": [], "kwargs": [], "security_manager": [["app.GrpyApp", 0.21607987683296703], ["app.utils.models.ModelManager", 0.10965649557911192], ["tests.e2e.Helper", 0.09386495110188171]]}, "q_name": "test_access_control_with_invalid_permission", "ret_exprs": [], "ret_type": "", "variables": {"invalid_actions": "", "rolename": "", "username": ""}, "variables_p": {"invalid_actions": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "rolename": [["str", 0.4097018440336502], ["dict", 0.1872264308544807]], "username": [["str", 0.7315214265172676], ["Dict[str, Union[Any, Any, Any]]", 0.0825681408854923]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[611, 0], [643, 13]], "fn_var_ln": {"negated_role": [[619, 4], [619, 16]], "role_name": [[618, 4], [618, 13]], "username": [[617, 4], [617, 12]]}, "fn_var_occur": {"negated_role": [["security_manager", "bulk_sync_roles", "negated_role"], ["set_user_single_role", "app", "user", "role_name", "negated_role"]], "role_name": [["create_user_scope", "app", "username", "username", "role_name", "role_name", "permissions", "user"], ["security_manager", "_sync_dag_view_permissions", "access_control", "role_name", "permissions", "ACTION_CAN_EDIT", "permissions", "ACTION_CAN_READ"], ["set_user_single_role", "app", "user", "role_name", "negated_role"]], "username": [["create_user_scope", "app", "username", "username", "role_name", "role_name", "permissions", "user"]]}, "name": "test_access_control_is_set_on_init", "params": {"app": "", "assert_user_does_not_have_dag_perms": "", "assert_user_has_dag_perms": "", "security_manager": ""}, "params_descr": {"app": "", "assert_user_does_not_have_dag_perms": "", "assert_user_has_dag_perms": "", "security_manager": ""}, "params_occur": {"app": [["app", "app_context"], ["create_user_scope", "app", "username", "username", "role_name", "role_name", "permissions", "user"], ["set_user_single_role", "app", "user", "role_name", "negated_role"]], "assert_user_does_not_have_dag_perms": [["assert_user_does_not_have_dag_perms", "perms", "permissions", "ACTION_CAN_EDIT", "permissions", "ACTION_CAN_READ", "dag_id", "user", "user"]], "assert_user_has_dag_perms": [["assert_user_has_dag_perms", "perms", "permissions", "ACTION_CAN_EDIT", "permissions", "ACTION_CAN_READ", "dag_id", "user", "user"]], "security_manager": [["security_manager", "_sync_dag_view_permissions", "access_control", "role_name", "permissions", "ACTION_CAN_EDIT", "permissions", "ACTION_CAN_READ"], ["security_manager", "bulk_sync_roles", "negated_role"]]}, "params_p": {"app": [], "args": [], "assert_user_does_not_have_dag_perms": [["raiden.utils.List[raiden.raiden_service.RaidenService]", 0.10175154615300636], ["raiden.utils.List[raiden.utils.TokenAddress]", 0.08915645854912195]], "assert_user_has_dag_perms": [["raiden.utils.List[raiden.raiden_service.RaidenService]", 0.10175154615300636], ["raiden.utils.List[raiden.utils.TokenAddress]", 0.08915645854912195]], "kwargs": [], "security_manager": [["server.service.manager.rental_manager.RentalManager", 0.1001570753774635], ["tests.setup.SetupTest", 0.09718390609317551]]}, "q_name": "test_access_control_is_set_on_init", "ret_exprs": [], "ret_type": "", "variables": {"negated_role": "", "role_name": "", "username": ""}, "variables_p": {"negated_role": [], "role_name": [["str", 0.7925191768106398], ["Optional[str]", 0.1143332358003532], ["list", 0.09314758738900689]], "username": [["str", 0.3663709198773365], ["Tuple[str, Any]", 0.21986220576229362], ["Dict[str, str]", 0.09205424575291733]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[646, 0], [677, 13]], "fn_var_ln": {"_perms": [[671, 12], [671, 23]], "role_name": [[653, 4], [653, 13]], "username": [[652, 4], [652, 12]]}, "fn_var_occur": {"_perms": [["user", "_perms", "None"]], "role_name": [["create_user_scope", "app", "username", "username", "role_name", "role_name", "permissions", "user"], ["set_user_single_role", "app", "user", "role_name"]], "username": [["create_user_scope", "app", "username", "username", "role_name", "role_name", "permissions", "user"]]}, "name": "test_access_control_stale_perms_are_revoked", "params": {"app": "", "assert_user_does_not_have_dag_perms": "", "assert_user_has_dag_perms": "", "security_manager": ""}, "params_descr": {"app": "", "assert_user_does_not_have_dag_perms": "", "assert_user_has_dag_perms": "", "security_manager": ""}, "params_occur": {"app": [["app", "app_context"], ["create_user_scope", "app", "username", "username", "role_name", "role_name", "permissions", "user"], ["set_user_single_role", "app", "user", "role_name"]], "assert_user_does_not_have_dag_perms": [["assert_user_does_not_have_dag_perms", "perms", "permissions", "ACTION_CAN_EDIT", "dag_id", "user", "user"]], "assert_user_has_dag_perms": [["assert_user_has_dag_perms", "perms", "READ_WRITE", "dag_id", "user", "user"], ["assert_user_has_dag_perms", "perms", "permissions", "ACTION_CAN_READ", "dag_id", "user", "user"]], "security_manager": [["security_manager", "_sync_dag_view_permissions", "access_control", "READ_WRITE"], ["security_manager", "_sync_dag_view_permissions", "access_control", "READ_ONLY"]]}, "params_p": {"app": [["abilian.app.Application", 0.08227535508541961]], "args": [], "assert_user_does_not_have_dag_perms": [["zerver.models.UserProfile", 0.11516497147666145], ["app.GrpyApp", 0.09386755327223194], ["models.Station", 0.0931821914669991]], "assert_user_has_dag_perms": [["app.GrpyApp", 0.19939719510987244], ["core.models.MyUser", 0.09443064300784283]], "kwargs": [], "security_manager": [["tests.setup.SetupTest", 0.3922011853073037]]}, "q_name": "test_access_control_stale_perms_are_revoked", "ret_exprs": [], "ret_type": "", "variables": {"_perms": "", "role_name": "", "username": ""}, "variables_p": {"_perms": [["Type[Optional[Any]]", 0.19999999999999998], ["list", 0.09999999999999999], ["str", 0.09999999999999999]], "role_name": [["str", 0.8278036990261982], ["Optional[str]", 0.09290946630895919], ["list", 0.07928683466484251]], "username": [["str", 0.3663709198773365], ["Tuple[str, Any]", 0.21986220576229362], ["Dict[str, str]", 0.09205424575291733]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[680, 0], [687, 40]], "fn_var_ln": {"ab_perm_role": [[681, 4], [681, 16]], "num_pv_after": [[686, 4], [686, 16]], "num_pv_before": [[684, 4], [684, 17]]}, "fn_var_occur": {"ab_perm_role": [["ab_perm_role", "assoc_permission_role"], ["num_pv_before", "db", "session", "query", "ab_perm_role", "count"], ["num_pv_after", "db", "session", "query", "ab_perm_role", "count"]], "num_pv_after": [["num_pv_after", "db", "session", "query", "ab_perm_role", "count"], ["num_pv_before", "num_pv_after"]], "num_pv_before": [["num_pv_before", "db", "session", "query", "ab_perm_role", "count"], ["num_pv_before", "num_pv_after"]]}, "name": "test_no_additional_dag_permission_views_created", "params": {"db": "", "security_manager": ""}, "params_descr": {"db": "", "security_manager": ""}, "params_occur": {"db": [["num_pv_before", "db", "session", "query", "ab_perm_role", "count"], ["num_pv_after", "db", "session", "query", "ab_perm_role", "count"]], "security_manager": [["security_manager", "sync_roles"], ["security_manager", "sync_roles"]]}, "params_p": {"args": [], "db": [["abilian.core.sqlalchemy.SQLAlchemy", 0.20059655048752179], ["sqlalchemy.orm.Session", 0.18537177936634958], ["app.db.session.Session", 0.09569230266412226], ["str", 0.08050150812356116], ["sqlalchemy.orm.scoping.scoped_session", 0.06986936795450392]], "kwargs": [], "security_manager": [["instark.application.managers.SessionManager", 0.12452012551867178], ["Callable", 0.09366967824887928], ["db.Db", 0.09117645819091298]]}, "q_name": "test_no_additional_dag_permission_views_created", "ret_exprs": [], "ret_type": "", "variables": {"ab_perm_role": "", "num_pv_after": "", "num_pv_before": ""}, "variables_p": {"ab_perm_role": [["str", 0.11803279606892784], ["track.tests.factories.RecordFactory", 0.09418346923630284], ["int", 0.09387386254832064], ["Type[ajapaik.ajapaik.models.MyXtdCommenWikimediaCommonsUpload]", 0.09162834495923253], ["Dict[str, Dict[str, int]]", 0.08944195805141923]], "num_pv_after": [["int", 0.7941729312449121], ["Dict[str, Union[datetime.timedelta, str]]", 0.10488844424314801], ["set", 0.10093862451193977]], "num_pv_before": [["int", 0.7941729312449121], ["Dict[str, Union[datetime.timedelta, str]]", 0.10488844424314801], ["set", 0.10093862451193977]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[690, 0], [693, 58]], "fn_var_ln": {"test_security_manager": [[691, 4], [691, 25]]}, "fn_var_occur": {"test_security_manager": [["test_security_manager", "MockSecurityManager", "appbuilder", "app_builder"], ["len", "test_security_manager", "VIEWER_VMS"], ["test_security_manager", "VIEWER_VMS"]]}, "name": "test_override_role_vm", "params": {"app_builder": ""}, "params_descr": {"app_builder": ""}, "params_occur": {"app_builder": [["test_security_manager", "MockSecurityManager", "appbuilder", "app_builder"]]}, "params_p": {"app_builder": [["tests.test_util.aiohttp.AiohttpClientMocker", 0.1916794713920037], ["abilian.app.Application", 0.11228903259935517], ["str", 0.09175965167013521]], "args": [], "kwargs": []}, "q_name": "test_override_role_vm", "ret_exprs": [], "ret_type": "", "variables": {"test_security_manager": ""}, "variables_p": {"test_security_manager": [["str", 0.533922899732852], ["datetime.datetime", 0.08499255075362261], ["List[Tuple[str, Any]]", 0.08236524815997527], ["Dict[str, Union[Any, Any]]", 0.0822532679494498], ["Dict[str, List[Any]]", 0.0820455585914011]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[696, 0], [710, 13]], "fn_var_ln": {"roles_to_check": [[697, 4], [697, 18]]}, "fn_var_occur": {"roles_to_check": [["roles_to_check", "security_manager", "get_all_roles"], ["len", "roles_to_check"]]}, "name": "test_correct_roles_have_perms_to_read_config", "params": {"security_manager": ""}, "params_descr": {"security_manager": ""}, "params_occur": {"security_manager": [["roles_to_check", "security_manager", "get_all_roles"], ["security_manager", "permission_exists_in_one_or_more_roles", "permissions", "RESOURCE_CONFIG", "permissions", "ACTION_CAN_READ", "role", "id"], ["security_manager", "permission_exists_in_one_or_more_roles", "permissions", "RESOURCE_CONFIG", "permissions", "ACTION_CAN_READ", "role", "id", "role", "name", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_CONFIG"]]}, "params_p": {"args": [], "kwargs": [], "security_manager": []}, "q_name": "test_correct_roles_have_perms_to_read_config", "ret_exprs": [], "ret_type": "", "variables": {"roles_to_check": ""}, "variables_p": {"roles_to_check": [["data_capture.schedules.base.BasePriceList", 0.11555917431715837], ["dict", 0.10434162341728781], ["list", 0.10018508519962663], ["List[bool]", 0.08570696315351797]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[713, 0], [752, 58]], "fn_var_ln": {"_sync_dag_view_permissions": [[725, 4], [725, 47]], "access_control": [[714, 4], [714, 18]], "all_perms": [[740, 8], [740, 17]], "collect_dags_from_db": [[719, 4], [719, 36]], "collect_dags_from_db_mock": [[716, 4], [716, 29]], "dag_resource_name": [[739, 8], [739, 25]], "dagbag_class_mock": [[720, 4], [720, 21]], "dagbag_mock": [[717, 4], [717, 15]], "dags": [[718, 4], [718, 20]], "return_value": [[721, 4], [721, 34]]}, "fn_var_occur": {"_sync_dag_view_permissions": [["security_manager", "_sync_dag_view_permissions", "mock", "Mock"], ["security_manager", "_sync_dag_view_permissions", "assert_called_once_with", "permissions", "resource_name_for_dag", "access_control"]], "access_control": [["access_control", "permissions", "ACTION_CAN_READ"], ["security_manager", "_sync_dag_view_permissions", "assert_called_once_with", "permissions", "resource_name_for_dag", "access_control"]], "all_perms": [["all_perms", "security_manager", "get_all_permissions"], ["dag_resource_name", "all_perms"], ["dag_resource_name", "all_perms"], ["all_perms", "security_manager", "get_all_permissions"], ["dag_resource_name", "all_perms"], ["dag_resource_name", "all_perms"]], "collect_dags_from_db": [["dagbag_mock", "collect_dags_from_db", "collect_dags_from_db_mock"]], "collect_dags_from_db_mock": [["collect_dags_from_db_mock", "mock", "Mock"], ["dagbag_mock", "collect_dags_from_db", "collect_dags_from_db_mock"], ["collect_dags_from_db_mock", "assert_called_once_with"]], "dag_resource_name": [["dag_resource_name", "permissions", "resource_name_for_dag", "dag", "dag_id"], ["dag_resource_name", "all_perms"], ["dag_resource_name", "all_perms"], ["dag_resource_name", "permissions", "resource_name_for_dag", "dag", "dag_id"], ["dag_resource_name", "all_perms"], ["dag_resource_name", "all_perms"]], "dagbag_class_mock": [["dagbag_class_mock", "mock", "Mock"], ["dagbag_class_mock", "return_value", "dagbag_mock"], ["monkeypatch", "setitem", "airflow", "www", "security", "__dict__", "dagbag_class_mock"], ["dagbag_class_mock", "assert_called_once_with", "read_dags_from_db", "True"]], "dagbag_mock": [["dagbag_mock", "mock", "Mock"], ["dagbag_mock", "dags", "dag", "dag_id", "dag", "dag", "sample_dags"], ["dagbag_mock", "collect_dags_from_db", "collect_dags_from_db_mock"], ["dagbag_class_mock", "return_value", "dagbag_mock"], ["dagbag_mock", "dags"]], "dags": [["dagbag_mock", "dags", "dag", "dag_id", "dag", "dag", "sample_dags"], ["dagbag_mock", "dags"]], "return_value": [["dagbag_class_mock", "return_value", "dagbag_mock"]]}, "name": "test_create_dag_specific_permissions", "params": {"monkeypatch": "", "sample_dags": "", "security_manager": "", "session": ""}, "params_descr": {"monkeypatch": "", "sample_dags": "", "security_manager": "", "session": ""}, "params_occur": {"monkeypatch": [["monkeypatch", "setitem", "airflow", "www", "security", "__dict__", "dagbag_class_mock"]], "sample_dags": [["dagbag_mock", "dags", "dag", "dag_id", "dag", "dag", "sample_dags"]], "security_manager": [["security_manager", "_sync_dag_view_permissions", "mock", "Mock"], ["all_perms", "security_manager", "get_all_permissions"], ["security_manager", "create_dag_specific_permissions"], ["all_perms", "security_manager", "get_all_permissions"], ["security_manager", "_sync_dag_view_permissions", "assert_called_once_with", "permissions", "resource_name_for_dag", "access_control"], ["security_manager", "create_dag_specific_permissions"]], "session": []}, "params_p": {"args": [], "kwargs": [], "monkeypatch": [["ultron8.api.models.trigger.TriggerUpdate", 0.12200879494826843]], "sample_dags": [["tests.test_util.aiohttp.AiohttpClientMocker", 0.2810191718458475], ["mock.MagicMock", 0.1420175350741307], ["asgard.models.accounAccount", 0.14096689708337945], ["asgard.backends.base.Interval", 0.14096689708337945], ["str", 0.07400962385766612], ["deeplearning.ml4pl.models.log_database.Database", 0.07353695206896267]], "security_manager": [["aioapp.app.Application", 0.10344408519941788]], "session": [["bool", 0.22769074122336364], ["str", 0.16744437123457884], ["sqlalchemy.orm.session.Session", 0.15060691315020677], ["int", 0.0758180994490285]]}, "q_name": "test_create_dag_specific_permissions", "ret_exprs": [], "ret_type": "", "variables": {"_sync_dag_view_permissions": "", "access_control": "", "all_perms": "", "collect_dags_from_db": "", "collect_dags_from_db_mock": "", "dag_resource_name": "", "dagbag_class_mock": "", "dagbag_mock": "", "dags": "", "return_value": ""}, "variables_p": {"_sync_dag_view_permissions": [["flask.app.Flask", 0.20120053839962085], ["str", 0.10443174330329444], ["int", 0.10143244283557151], ["Iterable", 0.10097429550426235]], "access_control": [["int", 0.09734709448551902]], "all_perms": [["str", 0.4004821670701173], ["tests.pathfinding.utils.SimpleReachabilityContainer", 0.1157702582092516], ["grpy.repo.base.Connection", 0.09698252798967164], ["List[Dict[str, Any]]", 0.09582305325008461], ["List[str]", 0.0932317422948577]], "collect_dags_from_db": [["int", 0.33054501289375715], ["str", 0.2263295955602142], ["datetime.datetime.datetime", 0.11301686524611497], ["Dict[str, Union[int, str]]", 0.07989326061328321], ["List[Dict[str, Any]]", 0.07908604773991774]], "collect_dags_from_db_mock": [], "dag_resource_name": [["str", 1.0000000000000002]], "dagbag_class_mock": [], "dagbag_mock": [["mock.Mock", 0.08922708894218279]], "dags": [["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.11755806294651555], ["str", 0.08834487318509433], ["property", 0.08715125379153336], ["list", 0.08680206179749463], ["Dict[str, Dict[str, Any]]", 0.0746224315424234]], "return_value": [["int", 0.32670636774850165], ["Optional[bytes]", 0.17577345162237487], ["str", 0.11454264545952107], ["List[str]", 0.10410573768593873], ["Dict[str, Union[Any, Any, Any]]", 0.08582024505339268]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[755, 0], [762, 47]], "fn_var_ln": {"perms": [[757, 8], [757, 13]]}, "fn_var_occur": {"perms": [["perms", "security_manager", "get_all_permissions"], ["isinstance", "perms", "set"]]}, "name": "test_get_all_permissions", "params": {"security_manager": ""}, "params_descr": {"security_manager": ""}, "params_occur": {"security_manager": [["perms", "security_manager", "get_all_permissions"]]}, "params_p": {"args": [], "kwargs": [], "security_manager": [["tests.setup.SetupTest", 0.2795442825488867]]}, "q_name": "test_get_all_permissions", "ret_exprs": [], "ret_type": "", "variables": {"perms": ""}, "variables_p": {"perms": [["app.usecases.users.GetItemWithRoles", 0.09506169912635157]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[765, 0], [775, 45]], "fn_var_ln": {"pvs": [[767, 8], [767, 11]]}, "fn_var_occur": {"pvs": [["pvs", "security_manager", "_get_all_non_dag_permissions"], ["isinstance", "pvs", "dict"], ["pvs", "items"]]}, "name": "test_get_all_non_dag_permissions", "params": {"security_manager": ""}, "params_descr": {"security_manager": ""}, "params_occur": {"security_manager": [["pvs", "security_manager", "_get_all_non_dag_permissions"], ["isinstance", "perm", "security_manager", "permission_model"]]}, "params_p": {"args": [], "kwargs": [], "security_manager": [["tests.setup.SetupTest", 1.0]]}, "q_name": "test_get_all_non_dag_permissions", "ret_exprs": [], "ret_type": "", "variables": {"pvs": ""}, "variables_p": {"pvs": [["str", 0.12895378103772165], ["datetime.timedelta", 0.11255458406589604], ["homeassistancomponents.media_source.models.BrowseMediaSource", 0.1046818892833787], ["bool", 0.10007275887580112], ["tests.mypy.modules.success.Model", 0.08296754779666063], ["int", 0.08098369030421332]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[778, 0], [787, 27]], "fn_var_ln": {"roles": [[780, 8], [780, 13]]}, "fn_var_occur": {"roles": [["roles", "security_manager", "_get_all_roles_with_permissions"], ["isinstance", "roles", "dict"], ["roles", "items"]]}, "name": "test_get_all_roles_with_permissions", "params": {"security_manager": ""}, "params_descr": {"security_manager": ""}, "params_occur": {"security_manager": [["roles", "security_manager", "_get_all_roles_with_permissions"], ["isinstance", "role", "security_manager", "role_model"]]}, "params_p": {"args": [], "kwargs": [], "security_manager": [["tests.setup.SetupTest", 0.3776327761476596], ["app.GrpyApp", 0.11829798189273252], ["aioapp.app.Application", 0.10711342741206838]]}, "q_name": "test_get_all_roles_with_permissions", "ret_exprs": [], "ret_type": "", "variables": {"roles": ""}, "variables_p": {"roles": [["app.datatypes.Price", 0.1985576387219649], ["app.usecases.users.GetItemWithRoles", 0.18440994467978256]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[790, 0], [798, 49]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_prefixed_dag_id_is_deprecated", "params": {"security_manager": ""}, "params_descr": {"security_manager": ""}, "params_occur": {"security_manager": [["security_manager", "prefixed_dag_id"]]}, "params_p": {"args": [], "kwargs": [], "security_manager": []}, "q_name": "test_prefixed_dag_id_is_deprecated", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[801, 0], [838, 44]], "fn_var_ln": {"dag1": [[822, 12], [822, 16]], "dag2": [[823, 12], [823, 16]], "dag3": [[824, 12], [824, 16]], "mock_roles": [[808, 8], [808, 18]], "parent_dag_name": [[804, 4], [804, 19]], "role_name": [[803, 4], [803, 13]], "subdag_name": [[805, 4], [805, 15]], "subsubdag_name": [[806, 4], [806, 18]], "username": [[802, 4], [802, 12]]}, "fn_var_occur": {"dag1": [["dag1", "DagModel", "dag_id", "parent_dag_name"], ["session", "add_all", "dag1", "dag2", "dag3"], ["dag1", "dag2", "dag3"]], "dag2": [["dag2", "DagModel", "dag_id", "subdag_name", "is_subdag", "True", "root_dag_id", "parent_dag_name"], ["session", "add_all", "dag1", "dag2", "dag3"], ["dag1", "dag2", "dag3"]], "dag3": [["dag3", "DagModel", "dag_id", "subsubdag_name", "is_subdag", "True", "root_dag_id", "parent_dag_name"], ["session", "add_all", "dag1", "dag2", "dag3"], ["dag1", "dag2", "dag3"]], "mock_roles": [["mock_roles", "role_name", "permissions", "ACTION_CAN_READ", "parent_dag_name", "permissions", "ACTION_CAN_EDIT", "parent_dag_name"], ["security_manager", "bulk_sync_roles", "mock_roles"]], "parent_dag_name": [["subdag_name", "parent_dag_name"], ["subsubdag_name", "parent_dag_name"], ["mock_roles", "role_name", "permissions", "ACTION_CAN_READ", "parent_dag_name", "permissions", "ACTION_CAN_EDIT", "parent_dag_name"], ["dag1", "DagModel", "dag_id", "parent_dag_name"], ["dag2", "DagModel", "dag_id", "subdag_name", "is_subdag", "True", "root_dag_id", "parent_dag_name"], ["dag3", "DagModel", "dag_id", "subsubdag_name", "is_subdag", "True", "root_dag_id", "parent_dag_name"], ["security_manager", "_sync_dag_view_permissions", "parent_dag_name", "access_control", "role_name", "READ_WRITE"], ["assert_user_has_dag_perms", "perms", "READ_WRITE", "dag_id", "parent_dag_name", "user", "user"], ["assert_user_has_dag_perms", "perms", "READ_WRITE", "dag_id", "parent_dag_name", "user", "user"], ["assert_user_has_dag_perms", "perms", "READ_WRITE", "dag_id", "parent_dag_name", "user", "user"]], "role_name": [["mock_roles", "role_name", "permissions", "ACTION_CAN_READ", "parent_dag_name", "permissions", "ACTION_CAN_EDIT", "parent_dag_name"], ["create_user_scope", "app", "username", "username", "role_name", "role_name", "user"], ["security_manager", "_sync_dag_view_permissions", "parent_dag_name", "access_control", "role_name", "READ_WRITE"]], "subdag_name": [["subdag_name", "parent_dag_name"], ["dag2", "DagModel", "dag_id", "subdag_name", "is_subdag", "True", "root_dag_id", "parent_dag_name"]], "subsubdag_name": [["subsubdag_name", "parent_dag_name"], ["dag3", "DagModel", "dag_id", "subsubdag_name", "is_subdag", "True", "root_dag_id", "parent_dag_name"]], "username": [["create_user_scope", "app", "username", "username", "role_name", "role_name", "user"]]}, "name": "test_parent_dag_access_applies_to_subdag", "params": {"app": "", "assert_user_has_dag_perms": "", "security_manager": "", "session": ""}, "params_descr": {"app": "", "assert_user_has_dag_perms": "", "security_manager": "", "session": ""}, "params_occur": {"app": [["app", "app_context"], ["create_user_scope", "app", "username", "username", "role_name", "role_name", "user"]], "assert_user_has_dag_perms": [["assert_user_has_dag_perms", "perms", "READ_WRITE", "dag_id", "parent_dag_name", "user", "user"], ["assert_user_has_dag_perms", "perms", "READ_WRITE", "dag_id", "parent_dag_name", "user", "user"], ["assert_user_has_dag_perms", "perms", "READ_WRITE", "dag_id", "parent_dag_name", "user", "user"]], "security_manager": [["security_manager", "bulk_sync_roles", "mock_roles"], ["security_manager", "_sync_dag_view_permissions", "parent_dag_name", "access_control", "role_name", "READ_WRITE"]], "session": [["session", "add_all", "dag1", "dag2", "dag3"], ["session", "commit"], ["session", "query", "DagModel", "delete"]]}, "params_p": {"app": [["Dict[str, str]", 0.10055417252845641]], "args": [], "assert_user_has_dag_perms": [["core.models.MyUser", 0.12440809028555677], ["str", 0.10058835292986386], ["models.Station", 0.08761784210641933]], "kwargs": [], "security_manager": [["tests.test_util.aiohttp.AiohttpClientMocker", 0.26252291167767605]], "session": [["sqlalchemy.orm.Session", 0.4684303383262177], ["estimark.application.domain.models.Entity", 0.16257591322536008], ["app.models.Game", 0.06819110407354285]]}, "q_name": "test_parent_dag_access_applies_to_subdag", "ret_exprs": [], "ret_type": "", "variables": {"dag1": "", "dag2": "", "dag3": "", "mock_roles": "", "parent_dag_name": "", "role_name": "", "subdag_name": "", "subsubdag_name": "", "username": ""}, "variables_p": {"dag1": [["str", 0.16510049419464629], ["Tuple[Any, Any]", 0.15497509408821478], ["abilian.core.models.subjects.User", 0.10176034352213882], ["list", 0.10124753390806202], ["List[Union[Any, Any, Any, Any]]", 0.08288402705367581], ["List[str]", 0.07735811313312925]], "dag2": [["str", 0.2775018622892374], ["Dict[str, Any]", 0.17645990258513164], ["List[str]", 0.09709987827602153], ["Tuple[Any, Any]", 0.09508360747913173], ["db_models.User", 0.09008111820309907]], "dag3": [["str", 0.2775018622892374], ["Dict[str, Any]", 0.17645990258513164], ["List[str]", 0.09709987827602153], ["Tuple[Any, Any]", 0.09508360747913173], ["db_models.User", 0.09008111820309907]], "mock_roles": [["str", 0.26497731506414773], ["Dict[str, str]", 0.12954216476010944], ["Dict[str, Union[int, str]]", 0.11057970060950219], ["dict", 0.0899439204010368]], "parent_dag_name": [["List[str]", 0.3205636454741058], ["str", 0.2735508172222646], ["list", 0.16608707370040748], ["Set[str]", 0.1316243176209625], ["set", 0.10817414598225956]], "role_name": [["str", 0.8098695852895497], ["List[str]", 0.09790951574132609], ["Any[Any]", 0.09222089896912414]], "subdag_name": [["str", 0.9999999999999999]], "subsubdag_name": [["str", 0.9999999999999999]], "username": [["str", 0.2916528446315507], ["Tuple[str, Any]", 0.18852263542102732], ["Dict[str, str]", 0.09466602102574952]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[841, 0], [872, 44]], "fn_var_ln": {"dag1": [[863, 12], [863, 16]], "dag2": [[864, 12], [864, 16]], "dag_id": [[846, 4], [846, 10]], "dag_id_2": [[847, 4], [847, 12]], "mock_roles": [[849, 8], [849, 18]], "role_name": [[845, 4], [845, 13]], "username": [[844, 4], [844, 12]]}, "fn_var_occur": {"dag1": [["dag1", "DagModel", "dag_id", "dag_id"], ["session", "add_all", "dag1", "dag2"], ["security_manager", "sync_perm_for_dag", "dag1", "dag_id", "access_control", "role_name", "READ_WRITE"]], "dag2": [["dag2", "DagModel", "dag_id", "dag_id_2"], ["session", "add_all", "dag1", "dag2"], ["security_manager", "sync_perm_for_dag", "dag2", "dag_id", "access_control", "role_name", "READ_WRITE"]], "dag_id": [["mock_roles", "role_name", "permissions", "ACTION_CAN_READ", "dag_id", "permissions", "ACTION_CAN_EDIT", "dag_id"], ["dag1", "DagModel", "dag_id", "dag_id"], ["dag2", "DagModel", "dag_id", "dag_id_2"], ["security_manager", "sync_perm_for_dag", "dag1", "dag_id", "access_control", "role_name", "READ_WRITE"], ["security_manager", "sync_perm_for_dag", "dag2", "dag_id", "access_control", "role_name", "READ_WRITE"], ["assert_user_has_dag_perms", "perms", "READ_WRITE", "dag_id", "dag_id", "user", "user"], ["assert_user_does_not_have_dag_perms", "perms", "READ_WRITE", "dag_id", "dag_id_2", "user", "user"]], "dag_id_2": [["dag2", "DagModel", "dag_id", "dag_id_2"], ["assert_user_does_not_have_dag_perms", "perms", "READ_WRITE", "dag_id", "dag_id_2", "user", "user"]], "mock_roles": [["mock_roles", "role_name", "permissions", "ACTION_CAN_READ", "dag_id", "permissions", "ACTION_CAN_EDIT", "dag_id"], ["security_manager", "bulk_sync_roles", "mock_roles"]], "role_name": [["mock_roles", "role_name", "permissions", "ACTION_CAN_READ", "dag_id", "permissions", "ACTION_CAN_EDIT", "dag_id"], ["create_user_scope", "app", "username", "username", "role_name", "role_name", "user"], ["security_manager", "sync_perm_for_dag", "dag1", "dag_id", "access_control", "role_name", "READ_WRITE"], ["security_manager", "sync_perm_for_dag", "dag2", "dag_id", "access_control", "role_name", "READ_WRITE"]], "username": [["create_user_scope", "app", "username", "username", "role_name", "role_name", "user"]]}, "name": "test_permissions_work_for_dags_with_dot_in_dagname", "params": {"app": "", "assert_user_does_not_have_dag_perms": "", "assert_user_has_dag_perms": "", "security_manager": "", "session": ""}, "params_descr": {"app": "", "assert_user_does_not_have_dag_perms": "", "assert_user_has_dag_perms": "", "security_manager": "", "session": ""}, "params_occur": {"app": [["app", "app_context"], ["create_user_scope", "app", "username", "username", "role_name", "role_name", "user"]], "assert_user_does_not_have_dag_perms": [["assert_user_does_not_have_dag_perms", "perms", "READ_WRITE", "dag_id", "dag_id_2", "user", "user"]], "assert_user_has_dag_perms": [["assert_user_has_dag_perms", "perms", "READ_WRITE", "dag_id", "dag_id", "user", "user"]], "security_manager": [["security_manager", "bulk_sync_roles", "mock_roles"], ["security_manager", "sync_perm_for_dag", "dag1", "dag_id", "access_control", "role_name", "READ_WRITE"], ["security_manager", "sync_perm_for_dag", "dag2", "dag_id", "access_control", "role_name", "READ_WRITE"]], "session": [["session", "add_all", "dag1", "dag2"], ["session", "commit"], ["session", "query", "DagModel", "delete"]]}, "params_p": {"app": [["abilian.app.Application", 0.10170920074580224]], "args": [], "assert_user_does_not_have_dag_perms": [["str", 0.12296810519040774], ["bool", 0.11561150269029231], ["Iterable[int]", 0.10293508480774174], ["app.GrpyApp", 0.09046454560374738]], "assert_user_has_dag_perms": [["str", 0.12296810519040774], ["bool", 0.11561150269029231], ["Iterable[int]", 0.10293508480774174], ["app.GrpyApp", 0.09046454560374738]], "kwargs": [], "security_manager": [["tests.e2e.Helper", 0.2872043814004986]], "session": [["sqlalchemy.orm.Session", 0.3204553372488588], ["base.Connection", 0.10170972620432839], ["estimark.application.domain.models.Entity", 0.09221294987540314], ["tests.test_util.aiohttp.AiohttpClientMocker", 0.07863082321227512], ["Tuple[int, int]", 0.0733523518650668], ["str", 0.0733523518650668]]}, "q_name": "test_permissions_work_for_dags_with_dot_in_dagname", "ret_exprs": [], "ret_type": "", "variables": {"dag1": "", "dag2": "", "dag_id": "", "dag_id_2": "", "mock_roles": "", "role_name": "", "username": ""}, "variables_p": {"dag1": [["str", 0.5191164714722034], ["List[str]", 0.08708800882174192], ["fal.models.Season", 0.08415519242784078], ["int", 0.07781927416441818]], "dag2": [["str", 0.5191164714722034], ["List[str]", 0.08708800882174192], ["fal.models.Season", 0.08415519242784078], ["int", 0.07781927416441818]], "dag_id": [["str", 0.8828154193430725], ["Union[Literal, str]", 0.05918795995733306], ["Callable(id)[[object], int]", 0.05799662069959444]], "dag_id_2": [["int", 0.774755625792224], ["List[int]", 0.1348901760373269], ["Tuple[Literal, Literal, Literal]", 0.09035419817044905]], "mock_roles": [["str", 0.3721809735224599], ["Dict[str, Union[int, str]]", 0.1725647863372315], ["int", 0.09859025767679327], ["Dict[str, Union[Any, str]]", 0.09667882896506098], ["Tuple[str]", 0.08978990675130534], ["Dict[Any, Dict[str, Any]]", 0.08742790677178527], ["Dict[str, Any]", 0.08276733997536387]], "role_name": [["str", 0.9999999999999998]], "username": [["str", 0.2916528446315507], ["Tuple[str, Any]", 0.18852263542102732], ["Dict[str, str]", 0.09466602102574952]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[875, 0], [878, 41]], "fn_var_ln": {"user": [[877, 4], [877, 8]]}, "fn_var_occur": {"user": [["user", "User"], ["user", "metadata", "Base", "metadata"]]}, "name": "test_fab_models_use_airflow_base_meta", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "test_fab_models_use_airflow_base_meta", "ret_exprs": [], "ret_type": "", "variables": {"user": ""}, "variables_p": {"user": [["str", 0.30000000000000004], ["negmas.elicitation.user.User", 0.2], ["List[Union[Any, Any]]", 0.1], ["List[Tuple[int, str, str]]", 0.1], ["users.tests.factories.UserFactory", 0.1], ["list", 0.1]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[882, 0], [885, 34]], "fn_var_ln": {"mocked_security_manager": [[883, 4], [883, 27]], "update_user": [[884, 4], [884, 39]]}, "fn_var_occur": {"mocked_security_manager": [["mocked_security_manager", "MockSecurityManager", "appbuilder", "app_builder"], ["mocked_security_manager", "update_user", "mock", "MagicMock"]], "update_user": [["mocked_security_manager", "update_user", "mock", "MagicMock"]]}, "name": "mock_security_manager", "params": {"app_builder": ""}, "params_descr": {"app_builder": ""}, "params_occur": {"app_builder": [["mocked_security_manager", "MockSecurityManager", "appbuilder", "app_builder"]]}, "params_p": {"app_builder": [["List[str]", 0.14298857615793337], ["str", 0.08251211234931084]], "args": [], "kwargs": []}, "q_name": "mock_security_manager", "ret_exprs": ["return mocked_security_manager"], "ret_type": "", "ret_type_p": [["str", 0.10161601887356479], ["Dict[str, Sequence[str]]", 0.0965314923876816]], "variables": {"mocked_security_manager": "", "update_user": ""}, "variables_p": {"mocked_security_manager": [["str", 0.35834040449958676], ["Dict[str, Union[Any, Any]]", 0.15861042835255304], ["tests.conftesConfluentAvroConsumerMock", 0.1504882501104365], ["Dict[str, str]", 0.08520877779953283]], "update_user": [["Dict[str, Union[Any, Any, Any]]", 0.21221883578806244], ["List[str]", 0.12235772014772009], ["Optional[bytes]", 0.11219376231517499], ["str", 0.10221972801255459], ["Dict[str, Union[Any, Any, Any, Any]]", 0.08796682213682727], ["List[Union[Any, Any, Any]]", 0.08796682213682727], ["int", 0.08778260159474927]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[889, 0], [894, 15]], "fn_var_ln": {"fail_login_count": [[892, 4], [892, 25]], "last_login": [[893, 4], [893, 19]], "login_count": [[891, 4], [891, 20]], "user": [[890, 4], [890, 8]]}, "fn_var_occur": {"fail_login_count": [["user", "fail_login_count", "None"]], "last_login": [["user", "last_login", "None"]], "login_count": [["user", "login_count", "None"]], "user": [["user", "mock", "MagicMock"], ["user", "login_count", "None"], ["user", "fail_login_count", "None"], ["user", "last_login", "None"]]}, "name": "new_user", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "new_user", "ret_exprs": ["return user"], "ret_type": "", "ret_type_p": [["zam_repondeur.models.Lecture", 0.10239245143344484], ["django.db.models.QuerySet", 0.10132712480004419], ["app.models.user.User", 0.09817621778474422], ["user_models.User", 0.09803185008035116], ["User", 0.09611033251726377], ["core.models.User", 0.09611033251726377], ["app.models.User", 0.09611033251726377]], "variables": {"fail_login_count": "", "last_login": "", "login_count": "", "user": ""}, "variables_p": {"fail_login_count": [["int", 0.6600127952618732], ["Dict[str, Union[int, str]]", 0.08969590461778493]], "last_login": [["int", 0.2678584028912534], ["datetime.datetime.datetime", 0.12723856712560702], ["dict", 0.108128889690093], ["tuple", 0.10130048391237538], ["topicdb.core.models.attribute.Attribute", 0.09215941273122141], ["str", 0.08259455340229659]], "login_count": [["int", 0.783716697756634], ["Dict[str, Union[int, str]]", 0.10113347519128295]], "user": [["mock.MagicMock", 0.44709776300838916]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[898, 0], [903, 15]], "fn_var_ln": {"fail_login_count": [[901, 4], [901, 25]], "last_login": [[902, 4], [902, 19]], "login_count": [[900, 4], [900, 20]], "user": [[899, 4], [899, 8]]}, "fn_var_occur": {"fail_login_count": [["user", "fail_login_count"]], "last_login": [["user", "last_login", "datetime", "datetime"]], "login_count": [["user", "login_count"]], "user": [["user", "mock", "MagicMock"], ["user", "login_count"], ["user", "fail_login_count"], ["user", "last_login", "datetime", "datetime"]]}, "name": "old_user", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "old_user", "ret_exprs": ["return user"], "ret_type": "", "ret_type_p": [["core.models.UserPreferences", 0.10883592860443443], ["zam_repondeur.models.Lecture", 0.10732459897306644], ["user_models.User", 0.10148795006208981], ["int", 0.09688615581154594], ["asgard.models.user.User", 0.0954164088090984], ["django.db.models.QuerySet", 0.09498991481970777], ["set", 0.09440796386450649]], "variables": {"fail_login_count": "", "last_login": "", "login_count": "", "user": ""}, "variables_p": {"fail_login_count": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "last_login": [["datetime.time", 0.3334477138990036], ["datetime.datetime", 0.3044129779089211], ["datetime.timedelta", 0.17020017473541843], ["int", 0.09832421184431608], ["datetime.datetime.timedelta", 0.09361492161234101]], "login_count": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "user": [["mock.MagicMock", 0.4814827454518609]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[907, 0], [913, 56]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_update_user_auth_stat_first_successful_auth", "params": {"mock_security_manager": "", "new_user": ""}, "params_descr": {"mock_security_manager": "", "new_user": ""}, "params_occur": {"mock_security_manager": [["mock_security_manager", "update_user_auth_stat", "new_user", "success", "True"], ["mock_security_manager", "update_user", "called_once"]], "new_user": [["mock_security_manager", "update_user_auth_stat", "new_user", "success", "True"], ["new_user", "login_count"], ["new_user", "fail_login_count"], ["new_user", "last_login", "datetime", "datetime"]]}, "params_p": {"args": [], "kwargs": [], "mock_security_manager": [["tests.test_util.aiohttp.AiohttpClientMocker", 0.9018416465779547], ["tests.async_mock.MagicMock", 0.09815835342204518]], "new_user": [["tests.async_mock.MagicMock", 0.4215116868339442]]}, "q_name": "test_update_user_auth_stat_first_successful_auth", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[917, 0], [923, 56]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_update_user_auth_stat_subsequent_successful_auth", "params": {"mock_security_manager": "", "old_user": ""}, "params_descr": {"mock_security_manager": "", "old_user": ""}, "params_occur": {"mock_security_manager": [["mock_security_manager", "update_user_auth_stat", "old_user", "success", "True"], ["mock_security_manager", "update_user", "called_once"]], "old_user": [["mock_security_manager", "update_user_auth_stat", "old_user", "success", "True"], ["old_user", "login_count"], ["old_user", "fail_login_count"], ["old_user", "last_login", "datetime", "datetime"]]}, "params_p": {"args": [], "kwargs": [], "mock_security_manager": [["tests.test_util.aiohttp.AiohttpClientMocker", 0.6117430628718279], ["tests.async_mock.MagicMock", 0.1783603443229958]], "old_user": [["tests.async_mock.Mock", 0.8065591911299215], ["tests.async_mock.MagicMock", 0.09603227755807597]]}, "q_name": "test_update_user_auth_stat_subsequent_successful_auth", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[927, 0], [933, 56]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_update_user_auth_stat_first_unsuccessful_auth", "params": {"mock_security_manager": "", "new_user": ""}, "params_descr": {"mock_security_manager": "", "new_user": ""}, "params_occur": {"mock_security_manager": [["mock_security_manager", "update_user_auth_stat", "new_user", "success", "False"], ["mock_security_manager", "update_user", "called_once"]], "new_user": [["mock_security_manager", "update_user_auth_stat", "new_user", "success", "False"], ["new_user", "login_count"], ["new_user", "fail_login_count"], ["new_user", "last_login", "None"]]}, "params_p": {"args": [], "kwargs": [], "mock_security_manager": [["tests.test_util.aiohttp.AiohttpClientMocker", 0.7032476578385346], ["tests.async_mock.MagicMock", 0.12538744508298863]], "new_user": [["tests.async_mock.MagicMock", 0.22503723000618314], ["tests.async_mock.Mock", 0.1826392452793834], ["mock.MagicMock", 0.09171780975480845], ["aiohttp.test_utils.TestServer", 0.09160349587641295]]}, "q_name": "test_update_user_auth_stat_first_unsuccessful_auth", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[937, 0], [943, 56]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "test_update_user_auth_stat_subsequent_unsuccessful_auth", "params": {"mock_security_manager": "", "old_user": ""}, "params_descr": {"mock_security_manager": "", "old_user": ""}, "params_occur": {"mock_security_manager": [["mock_security_manager", "update_user_auth_stat", "old_user", "success", "False"], ["mock_security_manager", "update_user", "called_once"]], "old_user": [["mock_security_manager", "update_user_auth_stat", "old_user", "success", "False"], ["old_user", "login_count"], ["old_user", "fail_login_count"], ["old_user", "last_login", "datetime", "datetime"]]}, "params_p": {"args": [], "kwargs": [], "mock_security_manager": [["tests.test_util.aiohttp.AiohttpClientMocker", 0.4426277292565927], ["tests.async_mock.MagicMock", 0.19492276535553196], ["mock.Mock", 0.09095681793144177]], "old_user": [["tests.async_mock.Mock", 0.8044223478321375], ["tests.async_mock.MagicMock", 0.09656113308913837]]}, "q_name": "test_update_user_auth_stat_subsequent_unsuccessful_auth", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Test that usernames are case insensitive", "long_descr": null, "ret": null}, "fn_lc": [[946, 0], [956, 61]], "fn_var_ln": {"users": [[953, 4], [953, 9]]}, "fn_var_occur": {"users": [["users", "security_manager", "get_all_users"], ["len", "users"]]}, "name": "test_users_can_be_found", "params": {"app": "", "caplog": "", "security_manager": "", "session": ""}, "params_descr": {"app": "", "caplog": "", "security_manager": "", "session": ""}, "params_occur": {"app": [["create_user", "app"], ["create_user", "app"], ["create_user", "app"], ["create_user", "app"], ["delete_user", "app"]], "caplog": [["caplog", "text"]], "security_manager": [["security_manager", "find_user"], ["users", "security_manager", "get_all_users"]], "session": []}, "params_p": {"app": [["raiden.utils.List[raiden.raiden_service.RaidenService]", 0.4956035428716049], ["bool", 0.1984610788115492], ["solo.server.app.App", 0.10674828354427221]], "args": [], "caplog": [["cli_ui.tests.MessageRecorder", 0.17337503388089723], ["paradigm.models.Parameter", 0.08544025834279538], ["paradigm.models.Plain", 0.08544025834279538], ["paradigm.models.Overloaded", 0.08544025834279538]], "kwargs": [], "security_manager": [["core.models.Recipe", 0.1866719312667806], ["str", 0.11021097391663434]], "session": [["str", 0.20375731403960776], ["bool", 0.1384156412281618], ["tests.fixtures.cloud_uploader.Uploader", 0.10187865701980388], ["Dict[str, Sequence[str]]", 0.07973245656745702], ["tests.async_mock.MagicMock", 0.06319010927063089]]}, "q_name": "test_users_can_be_found", "ret_exprs": [], "ret_type": "", "variables": {"users": ""}, "variables_p": {"users": [["list", 0.25985678145725205], ["grpy.core.models.User", 0.14715064009684178], ["List[None]", 0.12161497900881688], ["str", 0.11490709141441639], ["Dict[str, str]", 0.0912149308602508], ["Generator[List[Any], None, None]", 0.08885755076320812], ["Tuple[Any, Any, int]", 0.08707820734146844]]}}], "imports": ["__future__", "annotations", "contextlib", "datetime", "logging", "unittest", "mock", "pytest", "time_machine", "flask_appbuilder", "SQLA", "Model", "expose", "has_access", "flask_appbuilder", "views", "BaseView", "ModelView", "sqlalchemy", "Column", "Date", "Float", "Integer", "String", "airflow", "exceptions", "AirflowException", "airflow", "models", "DagModel", "airflow", "models", "base", "Base", "airflow", "models", "dag", "DAG", "airflow", "security", "permissions", "airflow", "www", "app", "application", "airflow", "www", "fab_security", "manager", "AnonymousUser", "airflow", "www", "fab_security", "sqla", "models", "User", "assoc_permission_role", "airflow", "www", "utils", "CustomSQLAInterface", "tests", "test_utils", "api_connexion_utils", "create_user", "create_user_scope", "delete_role", "delete_user", "set_user_single_role", "tests", "test_utils", "asserts", "assert_queries_count", "tests", "test_utils", "db", "clear_db_dags", "clear_db_runs", "tests", "test_utils", "mock_security_manager", "MockSecurityManager", "airflow.www.security"], "mod_var_ln": {"READ_ONLY": [[52, 0], [52, 9]], "READ_WRITE": [[51, 0], [51, 10]], "log": [[56, 0], [56, 3]]}, "mod_var_occur": {"READ_ONLY": [["security_manager", "_sync_dag_view_permissions", "access_control", "READ_ONLY"]], "READ_WRITE": [["security_manager", "_sync_dag_view_permissions", "access_control", "READ_WRITE"], ["assert_user_has_dag_perms", "perms", "READ_WRITE", "dag_id", "user", "user"], ["security_manager", "_sync_dag_view_permissions", "parent_dag_name", "access_control", "role_name", "READ_WRITE"], ["assert_user_has_dag_perms", "perms", "READ_WRITE", "dag_id", "parent_dag_name", "user", "user"], ["assert_user_has_dag_perms", "perms", "READ_WRITE", "dag_id", "parent_dag_name", "user", "user"], ["assert_user_has_dag_perms", "perms", "READ_WRITE", "dag_id", "parent_dag_name", "user", "user"], ["security_manager", "sync_perm_for_dag", "dag1", "dag_id", "access_control", "role_name", "READ_WRITE"], ["security_manager", "sync_perm_for_dag", "dag2", "dag_id", "access_control", "role_name", "READ_WRITE"], ["assert_user_has_dag_perms", "perms", "READ_WRITE", "dag_id", "dag_id", "user", "user"], ["assert_user_does_not_have_dag_perms", "perms", "READ_WRITE", "dag_id", "dag_id_2", "user", "user"]], "log": []}, "no_types_annot": {"D": 0, "I": 0, "U": 312}, "session_id": "cvfSl3ym6WC-shRuMJzxVlRc3-9kapg4UswlXg8PoGw", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"READ_ONLY": "", "READ_WRITE": "", "log": ""}, "variables_p": {"READ_ONLY": [["chalice.app.Chalice", 0.07666225634537052]], "READ_WRITE": [], "log": [["str", 0.30000000000000004], ["logging.Logger", 0.2], ["bool", 0.1], ["Dict[str, Union[Any, Any, Any]]", 0.1], ["Dict[str, Union[Any, Any, Any, Any]]", 0.1], ["Dict[str, Union[dict, Any, Any, Any, Any]]", 0.1]]}}}