{"error": null, "response": {"classes": [{"cls_lc": [[53, 0], [168, 85]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[55, 4], [57, 38]], "fn_var_ln": {"session": [[57, 8], [57, 19]]}, "fn_var_occur": {"session": [["cls", "session", "settings", "Session"]]}, "name": "setup_class", "params": {"cls": ""}, "params_descr": {"cls": ""}, "params_occur": {"cls": [["cls", "session", "settings", "Session"]]}, "params_p": {"args": [], "cls": [["dict", 0.09709721532517386], ["int", 0.09617337073103932]], "kwargs": [], "self": []}, "q_name": "TestSecurity.setup_class", "ret_exprs": [], "ret_type": "", "variables": {"session": ""}, "variables_p": {"session": [["dict", 0.1156286589837508], ["Dict[str, Dict[str, Any]]", 0.10930269242356241], ["Dict[str, Any]", 0.09157834477877765], ["str", 0.08805315081471299], ["Dict[str, None]", 0.08633523777603773]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[59, 4], [71, 44]], "fn_var_ln": {"app": [[64, 8], [64, 16]], "appbuilder": [[65, 8], [65, 23]], "client": [[71, 8], [71, 19]], "db": [[69, 8], [69, 15]], "security_manager": [[67, 8], [67, 29]]}, "fn_var_occur": {"app": [["self", "app", "application", "create_app", "testing", "True"], ["self", "appbuilder", "self", "app", "appbuilder"], ["self", "app", "config", "False"], ["self", "db", "SQLA", "self", "app"], ["self", "client", "self", "app", "test_client"]], "appbuilder": [["self", "appbuilder", "self", "app", "appbuilder"], ["self", "security_manager", "self", "appbuilder", "sm"]], "client": [["self", "client", "self", "app", "test_client"]], "db": [["self", "db", "SQLA", "self", "app"]], "security_manager": [["self", "security_manager", "self", "appbuilder", "sm"]]}, "name": "setup_method", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "app", "application", "create_app", "testing", "True"], ["self", "appbuilder", "self", "app", "appbuilder"], ["self", "app", "config", "False"], ["self", "security_manager", "self", "appbuilder", "sm"], ["self", "delete_roles"], ["self", "db", "SQLA", "self", "app"], ["self", "client", "self", "app", "test_client"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSecurity.setup_method", "ret_exprs": [], "ret_type": "", "variables": {"app": "", "appbuilder": "", "client": "", "db": "", "security_manager": ""}, "variables_p": {"app": [["flask.app.Flask", 0.8960895021963721], ["str", 0.10391049780362784]], "appbuilder": [["int", 0.516141916798704], ["bytes", 0.18078338351517442]], "client": [["int", 0.75954940801549], ["Final", 0.1631853350242139]], "db": [["Dict[str, Union[int, str]]", 0.15383837324949814], ["dict", 0.07946522483248249], ["Union[int, str]", 0.07561066133477802], ["Counter", 0.07031877657883508]], "security_manager": [["int", 0.243166169435795], ["dict", 0.20287267635312856], ["str", 0.18833795634488432], ["bool", 0.11226637016119384], ["Dict[str, str]", 0.07876957757732314]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[73, 4], [75, 44]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "delete_roles", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["delete_role", "self", "app", "role_name"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSecurity.delete_roles", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[78, 4], [93, 62]], "fn_var_ln": {"client": [[87, 8], [87, 14]], "response": [[92, 8], [92, 16]], "user_without_access": [[79, 8], [79, 27]]}, "fn_var_occur": {"client": [["client", "client_with_login", "self", "app", "username", "password"], ["response", "client", "get", "url", "replace", "str", "user_without_access", "id", "follow_redirects", "True"]], "response": [["response", "client", "get", "url", "replace", "str", "user_without_access", "id", "follow_redirects", "True"], ["check_content_not_in_response", "expected_text", "response"]], "user_without_access": [["user_without_access", "create_user", "self", "app", "username", "role_name", "permissions", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_WEBSITE"], ["response", "client", "get", "url", "replace", "str", "user_without_access", "id", "follow_redirects", "True"]]}, "name": "test_user_model_view_with_access", "params": {"_": "", "expected_text": "", "self": "", "url": ""}, "params_descr": {"_": "", "expected_text": "", "self": "", "url": ""}, "params_occur": {"_": [], "expected_text": [["check_content_not_in_response", "expected_text", "response"]], "self": [["user_without_access", "create_user", "self", "app", "username", "role_name", "permissions", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_WEBSITE"], ["client", "client_with_login", "self", "app", "username", "password"]], "url": [["response", "client", "get", "url", "replace", "str", "user_without_access", "id", "follow_redirects", "True"]]}, "params_p": {"_": [["str", 0.1736874172015714], ["bool", 0.0981292137478977]], "args": [], "expected_text": [["str", 0.6145883621912405], ["int", 0.09312609489447946], ["dict", 0.09248466494492051]], "kwargs": [], "self": [], "url": [["str", 0.48824072172924227], ["Dict[str, Any]", 0.09416544149156184]]}, "q_name": "TestSecurity.test_user_model_view_with_access", "ret_exprs": [], "ret_type": "", "variables": {"client": "", "response": "", "user_without_access": ""}, "variables_p": {"client": [["Dict[str, Union[int, str]]", 0.09048684356142947]], "response": [["Dict[str, str]", 0.25251035409509437], ["List[str]", 0.082225988869333], ["bytes", 0.07964982945622602]], "user_without_access": [["str", 0.4272335085690504], ["Dict[str, str]", 0.20604626784096736], ["Optional[str]", 0.0969472110621876], ["List[str]", 0.09467802673576375], ["Dict[str, bool]", 0.08761964488640575]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[96, 4], [111, 58]], "fn_var_ln": {"client": [[105, 8], [105, 14]], "response": [[110, 8], [110, 16]], "user_with_access": [[98, 8], [98, 24]]}, "fn_var_occur": {"client": [["client", "client_with_login", "self", "app", "username", "password"], ["response", "client", "get", "url", "replace", "str", "user_with_access", "id", "follow_redirects", "True"]], "response": [["response", "client", "get", "url", "replace", "str", "user_with_access", "id", "follow_redirects", "True"], ["check_content_in_response", "expected_text", "response"]], "user_with_access": [["user_with_access", "create_user", "self", "app", "username", "role_name", "permissions", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_WEBSITE", "permission"], ["response", "client", "get", "url", "replace", "str", "user_with_access", "id", "follow_redirects", "True"]]}, "name": "test_user_model_view_without_access", "params": {"expected_text": "", "permission": "", "self": "", "url": ""}, "params_descr": {"expected_text": "", "permission": "", "self": "", "url": ""}, "params_occur": {"expected_text": [["check_content_in_response", "expected_text", "response"]], "permission": [["user_with_access", "create_user", "self", "app", "username", "role_name", "permissions", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_WEBSITE", "permission"]], "self": [["user_with_access", "create_user", "self", "app", "username", "role_name", "permissions", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_WEBSITE", "permission"], ["client", "client_with_login", "self", "app", "username", "password"]], "url": [["response", "client", "get", "url", "replace", "str", "user_with_access", "id", "follow_redirects", "True"]]}, "params_p": {"args": [], "expected_text": [["Dict[str, Any]", 0.36184143533509405], ["dict", 0.11110696015507017], ["int", 0.0874514572308546], ["Callable", 0.08566551419624424], ["Callable[[Any, Any], Any]", 0.08537309922021273]], "kwargs": [], "permission": [["bool", 0.20502036291358608], ["Optional[str]", 0.13724618298591235], ["str", 0.08738200464306065]], "self": [], "url": []}, "q_name": "TestSecurity.test_user_model_view_without_access", "ret_exprs": [], "ret_type": "", "variables": {"client": "", "response": "", "user_with_access": ""}, "variables_p": {"client": [["Dict[str, Union[int, str]]", 0.0932470944169143]], "response": [["Dict[str, str]", 0.2735551878877021], ["Dict[str, Any]", 0.15461005558798796]], "user_with_access": [["str", 0.5321897290945268], ["Dict[str, str]", 0.29100272761788143]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[113, 4], [139, 84]], "fn_var_ln": {"client": [[130, 8], [130, 14]], "response": [[136, 8], [136, 16]], "user_to_delete": [[115, 8], [115, 22]]}, "fn_var_occur": {"client": [["client", "client_with_login", "self", "app", "username", "password"], ["response", "client", "post", "user_to_delete", "id", "follow_redirects", "True"]], "response": [["response", "client", "post", "user_to_delete", "id", "follow_redirects", "True"], ["check_content_not_in_response", "response"]], "user_to_delete": [["user_to_delete", "create_user", "self", "app", "username", "role_name"], ["response", "client", "post", "user_to_delete", "id", "follow_redirects", "True"], ["bool", "self", "security_manager", "get_user_by_id", "user_to_delete", "id", "True"]]}, "name": "test_user_model_view_without_delete_access", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["user_to_delete", "create_user", "self", "app", "username", "role_name"], ["create_user", "self", "app", "username", "role_name", "permissions", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_WEBSITE"], ["client", "client_with_login", "self", "app", "username", "password"], ["bool", "self", "security_manager", "get_user_by_id", "user_to_delete", "id", "True"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSecurity.test_user_model_view_without_delete_access", "ret_exprs": [], "ret_type": "", "variables": {"client": "", "response": "", "user_to_delete": ""}, "variables_p": {"client": [["tests.utils.FakeRequest", 0.19766733153140667]], "response": [["str", 0.16398274312537053], ["Dict[str, Any]", 0.16104950866094064], ["int", 0.08466064807081575]], "user_to_delete": [["Dict[str, str]", 0.2580075546153484], ["str", 0.17458891749729866], ["dict", 0.09353931444906313], ["Dict[str, Any]", 0.08657288221511883], ["Type[List[Any]]", 0.0808463369581182], ["tuple", 0.07964755685145404]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[141, 4], [168, 85]], "fn_var_ln": {"client": [[159, 8], [159, 14]], "response": [[165, 8], [165, 16]], "user_to_delete": [[143, 8], [143, 22]]}, "fn_var_occur": {"client": [["client", "client_with_login", "self", "app", "username", "password"], ["response", "client", "post", "user_to_delete", "id", "follow_redirects", "True"]], "response": [["response", "client", "post", "user_to_delete", "id", "follow_redirects", "True"], ["check_content_in_response", "response"], ["check_content_not_in_response", "user_to_delete", "username", "response"]], "user_to_delete": [["user_to_delete", "create_user", "self", "app", "username", "role_name"], ["response", "client", "post", "user_to_delete", "id", "follow_redirects", "True"], ["check_content_not_in_response", "user_to_delete", "username", "response"], ["bool", "self", "security_manager", "get_user_by_id", "user_to_delete", "id", "False"]]}, "name": "test_user_model_view_with_delete_access", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["user_to_delete", "create_user", "self", "app", "username", "role_name"], ["create_user", "self", "app", "username", "role_name", "permissions", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_WEBSITE", "permissions", "ACTION_CAN_DELETE", "permissions", "RESOURCE_USER"], ["client", "client_with_login", "self", "app", "username", "password"], ["bool", "self", "security_manager", "get_user_by_id", "user_to_delete", "id", "False"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestSecurity.test_user_model_view_with_delete_access", "ret_exprs": [], "ret_type": "", "variables": {"client": "", "response": "", "user_to_delete": ""}, "variables_p": {"client": [["tests.utils.FakeRequest", 0.19766733153140667]], "response": [], "user_to_delete": [["Dict[str, str]", 0.23307806296415015], ["dict", 0.1859534793677775], ["str", 0.17689658685207493], ["Dict[str, Any]", 0.09066033204408601], ["tuple", 0.08647399381476811]]}}], "name": "TestSecurity", "q_name": "TestSecurity", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["__future__", "annotations", "pytest", "flask_appbuilder", "SQLA", "airflow", "settings", "airflow", "security", "permissions", "airflow", "www", "app", "application", "tests", "test_utils", "api_connexion_utils", "create_user", "delete_role", "tests", "test_utils", "www", "check_content_in_response", "check_content_not_in_response", "client_with_login"], "mod_var_ln": {"PERMISSIONS_TESTS_PARAMS": [[29, 0], [29, 24]]}, "mod_var_occur": {"PERMISSIONS_TESTS_PARAMS": []}, "no_types_annot": {"D": 0, "I": 0, "U": 33}, "session_id": "LWlX7AHDQWkXlAt5JF6OZQTRYa2nt79kJnarnS4-tQA", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"PERMISSIONS_TESTS_PARAMS": ""}, "variables_p": {"PERMISSIONS_TESTS_PARAMS": [["str", 0.3143117538908247], ["Set[str]", 0.16209581322047725], ["Optional[str]", 0.11041873817782594], ["Type[Dict[Any, Any]]", 0.06777139561677781]]}}}