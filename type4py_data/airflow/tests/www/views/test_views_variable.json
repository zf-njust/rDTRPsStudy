{"error": null, "response": {"classes": [], "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[45, 0], [47, 40]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "clear_variables", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "clear_variables", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Create User that can only read variables", "long_descr": null, "ret": null}, "fn_lc": [[51, 0], [58, 5]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "user_variable_reader", "params": {"app": ""}, "params_descr": {"app": ""}, "params_occur": {"app": [["create_user", "app", "username", "role_name", "permissions", "permissions", "ACTION_CAN_READ", "permissions", "RESOURCE_VARIABLE"]]}, "params_p": {"app": [["str", 0.1827347654106943]], "args": [], "kwargs": []}, "q_name": "user_variable_reader", "ret_exprs": ["return create_user( app, username=\"user_variable_reader\", role_name=\"role_variable_reader\", permissions=[(permissions.ACTION_CAN_READ, permissions.RESOURCE_VARIABLE)],)"], "ret_type": "", "ret_type_p": [["str", 0.2800292074980941], ["daylighdb.models.Photo", 0.1279693733081893], ["zerver.models.Realm", 0.11296617196739661], ["viewer.models.Archive", 0.09682475151456454]], "variables": {}, "variables_p": {}}, {"docstring": {"func": "Client for User that can only access the first DAG from TEST_FILTER_DAG_IDS", "long_descr": null, "ret": null}, "fn_lc": [[62, 0], [68, 5]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "client_variable_reader", "params": {"app": "", "user_variable_reader": ""}, "params_descr": {"app": "", "user_variable_reader": ""}, "params_occur": {"app": [["client_with_login", "app", "username", "password"]], "user_variable_reader": []}, "params_p": {"app": [["dict", 0.18866272736549977], ["Optional[type]", 0.11138228263715003], ["Dict[str, Any]", 0.099526835342671], ["Optional[str]", 0.09318365786282971]], "args": [], "kwargs": [], "user_variable_reader": [["bool", 0.3226779779918072], ["Optional[Callable[[Any], bool]]", 0.11091351218467028], ["dict", 0.10537096119126028], ["str", 0.0890096443048262], ["list", 0.0873684386905998], ["Iterable[str]", 0.0859482558919678]]}, "q_name": "client_variable_reader", "ret_exprs": ["return client_with_login( app, username=\"user_variable_reader\", password=\"user_variable_reader\",)"], "ret_type": "", "ret_type_p": [["str", 0.21636681216609172], ["Mapping[str, Any]", 0.19216798180867947], ["lunch_buddies.models.teams.Team", 0.08847087413506521], ["lunch_buddies.models.polls.Poll", 0.08847087413506521]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[71, 0], [88, 5]], "fn_var_ln": {"resp": [[84, 4], [84, 8]]}, "fn_var_occur": {"resp": [["resp", "admin_client", "get", "follow_redirects", "True"], ["check_content_in_response", "resp"]]}, "name": "test_can_handle_error_on_decrypt", "params": {"admin_client": "", "session": ""}, "params_descr": {"admin_client": "", "session": ""}, "params_occur": {"admin_client": [["admin_client", "post", "data", "VARIABLE", "follow_redirects", "True"], ["resp", "admin_client", "get", "follow_redirects", "True"]], "session": [["session", "query", "Variable", "filter", "Variable", "key", "VARIABLE", "update", "synchronize_session", "False"], ["session", "commit"]]}, "params_p": {"admin_client": [["aiohttp.test_utils.TestClient", 0.19280140909749566], ["core.models.Recipe", 0.12074273061443737], ["Dict[str, str]", 0.09222445868415856]], "args": [], "kwargs": [], "session": [["utils.tags.Tags", 0.10946544802208387], ["asgard.models.job.ScheduledJob", 0.09672676972416265], ["asgard.models.user.User", 0.09672676972416265], ["asgard.models.accounAccount", 0.09672676972416265]]}, "q_name": "test_can_handle_error_on_decrypt", "ret_exprs": [], "ret_type": "", "variables": {"resp": ""}, "variables_p": {"resp": [["str", 0.08709594757407084], ["dict", 0.08364183811482602]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[91, 0], [94, 90]], "fn_var_ln": {"resp": [[93, 4], [93, 8]], "xss": [[92, 4], [92, 7]]}, "fn_var_occur": {"resp": [["resp", "admin_client", "get", "xss", "follow_redirects", "True"], ["check_content_not_in_response", "resp", "resp_code"]], "xss": [["resp", "admin_client", "get", "xss", "follow_redirects", "True"]]}, "name": "test_xss_prevention", "params": {"admin_client": ""}, "params_descr": {"admin_client": ""}, "params_occur": {"admin_client": [["resp", "admin_client", "get", "xss", "follow_redirects", "True"]]}, "params_p": {"admin_client": [], "args": [], "kwargs": []}, "q_name": "test_xss_prevention", "ret_exprs": [], "ret_type": "", "variables": {"resp": "", "xss": ""}, "variables_p": {"resp": [["bytes", 0.11288588454476077], ["Dict[str, int]", 0.09250774369189878], ["telegram.utils.AsyncResult", 0.08742005429707667], ["dict", 0.0867923443499779]], "xss": [["int", 0.9170010764321618], ["Dict[int, bytes]", 0.08299892356783792]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[97, 0], [99, 68]], "fn_var_ln": {"resp": [[98, 4], [98, 8]]}, "fn_var_occur": {"resp": [["resp", "admin_client", "post", "follow_redirects", "True"], ["check_content_in_response", "resp"]]}, "name": "test_import_variables_no_file", "params": {"admin_client": ""}, "params_descr": {"admin_client": ""}, "params_occur": {"admin_client": [["resp", "admin_client", "post", "follow_redirects", "True"]]}, "params_p": {"admin_client": [], "args": [], "kwargs": []}, "q_name": "test_import_variables_no_file", "ret_exprs": [], "ret_type": "", "variables": {"resp": ""}, "variables_p": {"resp": [["dict", 0.19889174997936404], ["str", 0.0995754815671646], ["List[List[Any]]", 0.09254765587896686], ["int", 0.08414380531158404], ["Dict[str, Any]", 0.08375291303800263]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[102, 0], [114, 78]], "fn_var_ln": {"bytes_content": [[109, 8], [109, 21]], "content": [[103, 4], [103, 11]], "resp": [[111, 8], [111, 12]], "side_effect": [[106, 8], [106, 28]]}, "fn_var_occur": {"bytes_content": [["bytes_content", "io", "BytesIO", "bytes", "content", "encoding"], ["resp", "admin_client", "post", "data", "bytes_content", "follow_redirects", "True"]], "content": [["bytes_content", "io", "BytesIO", "bytes", "content", "encoding"]], "resp": [["resp", "admin_client", "post", "data", "bytes_content", "follow_redirects", "True"], ["check_content_in_response", "resp"]], "side_effect": [["set_mock", "side_effect", "UnicodeEncodeError"]]}, "name": "test_import_variables_failed", "params": {"admin_client": "", "session": ""}, "params_descr": {"admin_client": "", "session": ""}, "params_occur": {"admin_client": [["resp", "admin_client", "post", "data", "bytes_content", "follow_redirects", "True"]], "session": [["session", "query", "Variable", "count"]]}, "params_p": {"admin_client": [["bool", 0.19057671757111264], ["core.models.Recipe", 0.07948682963190441]], "args": [], "kwargs": [], "session": [["str", 0.12309930159558226], ["Dict[str, Any]", 0.09324594255080948]]}, "q_name": "test_import_variables_failed", "ret_exprs": [], "ret_type": "", "variables": {"bytes_content": "", "content": "", "resp": "", "side_effect": ""}, "variables_p": {"bytes_content": [["io.StringIO", 0.5980968076886013], ["Dict[Any, str]", 0.09046762874451983]], "content": [["str", 0.7057075444041088], ["io.BufferedWriter", 0.20463312877854245]], "resp": [["Generator[Any, None, None]", 0.14434745066076768], ["str", 0.10630150483126688], ["requests.models.Response", 0.07428565681217389]], "side_effect": [["Dict[int, Dict[str, Any]]", 0.22534638571475643], ["Tuple[Literal, Literal, Literal]", 0.20935800768538151], ["str", 0.19752931247054933], ["List[str]", 0.16641002232610663], ["property", 0.07148526777121711]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[117, 0], [127, 91]], "fn_var_ln": {"bytes_content": [[121, 4], [121, 17]], "content": [[120, 4], [120, 11]], "resp": [[123, 4], [123, 8]]}, "fn_var_occur": {"bytes_content": [["bytes_content", "io", "BytesIO", "bytes", "content", "encoding"], ["resp", "admin_client", "post", "data", "bytes_content", "follow_redirects", "True"]], "content": [["bytes_content", "io", "BytesIO", "bytes", "content", "encoding"]], "resp": [["resp", "admin_client", "post", "data", "bytes_content", "follow_redirects", "True"], ["check_content_in_response", "resp"]]}, "name": "test_import_variables_success", "params": {"admin_client": "", "session": ""}, "params_descr": {"admin_client": "", "session": ""}, "params_occur": {"admin_client": [["resp", "admin_client", "post", "data", "bytes_content", "follow_redirects", "True"]], "session": [["session", "query", "Variable", "count"], ["_check_last_log", "session", "dag_id", "None", "event", "execution_date", "None"]]}, "params_p": {"admin_client": [["bool", 0.19057671757111264], ["core.models.Recipe", 0.07948682963190441]], "args": [], "kwargs": [], "session": [["app.models.user.User.InDB", 0.10132930617776635], ["Optional[core.models.User]", 0.09577324915460299], ["models.User", 0.0861014852123711], ["models.RepoInterface", 0.0861014852123711], ["zerver.models.UserProfile", 0.08454270974883582]]}, "q_name": "test_import_variables_success", "ret_exprs": [], "ret_type": "", "variables": {"bytes_content": "", "content": "", "resp": ""}, "variables_p": {"bytes_content": [["io.StringIO", 0.5980968076886013], ["Dict[Any, str]", 0.09046762874451983]], "content": [["str", 0.7057075444041088], ["io.BufferedWriter", 0.20463312877854245]], "resp": [["Generator[Any, None, None]", 0.14434745066076768], ["str", 0.10630150483126688], ["requests.models.Response", 0.07428565681217389]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[130, 0], [140, 46]], "fn_var_ln": {"bytes_content": [[134, 4], [134, 17]], "content": [[133, 4], [133, 11]], "resp": [[136, 4], [136, 8]]}, "fn_var_occur": {"bytes_content": [["bytes_content", "io", "BytesIO", "bytes", "content", "encoding"], ["resp", "app", "test_client", "post", "data", "bytes_content", "follow_redirects", "True"]], "content": [["bytes_content", "io", "BytesIO", "bytes", "content", "encoding"]], "resp": [["resp", "app", "test_client", "post", "data", "bytes_content", "follow_redirects", "True"], ["check_content_not_in_response", "resp"], ["check_content_in_response", "resp"]]}, "name": "test_import_variables_anon", "params": {"app": "", "session": ""}, "params_descr": {"app": "", "session": ""}, "params_occur": {"app": [["resp", "app", "test_client", "post", "data", "bytes_content", "follow_redirects", "True"]], "session": [["session", "query", "Variable", "count"]]}, "params_p": {"app": [], "args": [], "kwargs": [], "session": [["Callable[[Any, Any], Any]", 0.10282476568657917], ["str", 0.08529105007548278]]}, "q_name": "test_import_variables_anon", "ret_exprs": [], "ret_type": "", "variables": {"bytes_content": "", "content": "", "resp": ""}, "variables_p": {"bytes_content": [["io.StringIO", 0.3044849503756286], ["Dict[Any, str]", 0.09430497991100768], ["io.TextIOWrapper", 0.08953699842759284]], "content": [["str", 0.7057075444041088], ["io.BufferedWriter", 0.20463312877854245]], "resp": [["test_utils.FakeSession", 0.2762789960665279], ["Dict[str, Dict[str, Any]]", 0.11365236388360682], ["RuntimeError", 0.09355506191187332]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[143, 0], [145, 55]], "fn_var_ln": {"resp": [[144, 4], [144, 8]]}, "fn_var_occur": {"resp": [["resp", "admin_client", "get"], ["check_content_in_response", "resp"]]}, "name": "test_import_variables_form_shown", "params": {"admin_client": "", "app": ""}, "params_descr": {"admin_client": "", "app": ""}, "params_occur": {"admin_client": [["resp", "admin_client", "get"]], "app": []}, "params_p": {"admin_client": [], "app": [], "args": [], "kwargs": []}, "q_name": "test_import_variables_form_shown", "ret_exprs": [], "ret_type": "", "variables": {"resp": ""}, "variables_p": {"resp": [["bytes", 0.10157802984019915], ["Dict[str, Union[bytes, str]]", 0.09993710946252578], ["dict", 0.09510213962934812], ["str", 0.08916156643103082]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[148, 0], [150, 59]], "fn_var_ln": {"resp": [[149, 4], [149, 8]]}, "fn_var_occur": {"resp": [["resp", "client_variable_reader", "get"], ["check_content_not_in_response", "resp"]]}, "name": "test_import_variables_form_hidden", "params": {"app": "", "client_variable_reader": ""}, "params_descr": {"app": "", "client_variable_reader": ""}, "params_occur": {"app": [], "client_variable_reader": [["resp", "client_variable_reader", "get"]]}, "params_p": {"app": [["cli_ui.tests.MessageRecorder", 0.08218355188536731]], "args": [], "client_variable_reader": [["str", 0.2875101974071449]], "kwargs": []}, "q_name": "test_import_variables_form_hidden", "ret_exprs": [], "ret_type": "", "variables": {"resp": ""}, "variables_p": {"resp": [["dict", 0.2743319906466857], ["Dict[str, str]", 0.19475622911671786], ["Dict[str, Any]", 0.1219137754039936], ["Pattern[str]", 0.11747902715143212], ["Dict[str, int]", 0.09717299256039028], ["Type[Dict[int, Any]]", 0.09717299256039028], ["Dict[str, Union[Any, Any, Any]]", 0.09717299256039028]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[153, 0], [158, 74]], "fn_var_ln": {"row": [[157, 4], [157, 7]]}, "fn_var_occur": {"row": [["row", "session", "query", "Variable", "key", "Variable", "description", "first"], ["row", "key", "row", "description"]]}, "name": "test_description_retrieval", "params": {"admin_client": "", "session": ""}, "params_descr": {"admin_client": "", "session": ""}, "params_occur": {"admin_client": [["admin_client", "post", "data", "VARIABLE", "follow_redirects", "True"]], "session": [["row", "session", "query", "Variable", "key", "Variable", "description", "first"]]}, "params_p": {"admin_client": [["utils.clienClient", 0.11633261314492556], ["aiohttp.test_utils.TestClient", 0.09664954954077519], ["bool", 0.08240566373105451]], "args": [], "kwargs": [], "session": [["set", 0.10187894099603487], ["asgard.models.user.User", 0.10062162251195879], ["asgard.models.accounAccount", 0.10062162251195879], ["sqlalchemy.orm.session.Session", 0.09180948803817253]]}, "q_name": "test_description_retrieval", "ret_exprs": [], "ret_type": "", "variables": {"row": ""}, "variables_p": {"row": [["list", 0.30318716789987654], ["Dict[Any, str]", 0.14568188663344406], ["defaultdict", 0.11662752311765807], ["Dict[Type[Any], Union[Any, Any]]", 0.10410944558872774], ["set", 0.08260291306058037], ["dict", 0.08015510239137001]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[162, 0], [172, 20]], "fn_var_ln": {"variable": [[163, 4], [163, 12]]}, "fn_var_occur": {"variable": [["variable", "Variable", "key", "VARIABLE", "val", "VARIABLE", "description", "VARIABLE"], ["session", "add", "variable"]]}, "name": "variable", "params": {"session": ""}, "params_descr": {"session": ""}, "params_occur": {"session": [["session", "add", "variable"], ["session", "commit"], ["session", "query", "Variable", "filter", "Variable", "key", "VARIABLE", "delete"], ["session", "commit"]]}, "params_p": {"args": [], "kwargs": [], "session": [["purplship.providers.purolator.utils.Settings", 0.11749139032752776], ["grouper.models.base.session.Session", 0.10513983972314823], ["sqlalchemy.orm.session.Session", 0.10286807569383336], ["dict", 0.09675921226451803], ["Optional[Mapping]", 0.08906780309153658]]}, "q_name": "variable", "ret_exprs": [], "ret_type": "", "variables": {"variable": ""}, "variables_p": {"variable": [["dict", 0.20929055650161005], ["set", 0.2044047206476184], ["Dict[Variable[_KT], Variable[_VT]]", 0.19904244248191702]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[175, 0], [183, 48]], "fn_var_ln": {"resp": [[176, 4], [176, 8]]}, "fn_var_occur": {"resp": [["resp", "admin_client", "post", "data", "variable", "id"], ["resp", "status_code"], ["resp", "headers"], ["resp", "headers"], ["resp", "json"]]}, "name": "test_action_export", "params": {"admin_client": "", "variable": ""}, "params_descr": {"admin_client": "", "variable": ""}, "params_occur": {"admin_client": [["resp", "admin_client", "post", "data", "variable", "id"]], "variable": [["resp", "admin_client", "post", "data", "variable", "id"]]}, "params_p": {"admin_client": [["core.models.Recipe", 0.10852914322004852], ["str", 0.09153925308297502]], "args": [], "kwargs": [], "variable": [["core.models.Recipe", 0.10852914322004852], ["str", 0.09153925308297502]]}, "q_name": "test_action_export", "ret_exprs": [], "ret_type": "", "variables": {"resp": ""}, "variables_p": {"resp": [["Dict[str, Union[Any, Any]]", 0.08550412237585338], ["dict", 0.08283252207327003], ["Dict[str, str]", 0.08187654472234658], ["Generator[Any, None, None]", 0.08180686297911742]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[186, 0], [194, 77]], "fn_var_ln": {"resp": [[188, 4], [188, 8]], "var_id": [[187, 4], [187, 10]]}, "fn_var_occur": {"resp": [["resp", "admin_client", "post", "data", "var_id", "follow_redirects", "True"], ["resp", "status_code"]], "var_id": [["var_id", "variable", "id"], ["resp", "admin_client", "post", "data", "var_id", "follow_redirects", "True"], ["session", "query", "Variable", "filter", "Variable", "id", "var_id", "count"]]}, "name": "test_action_muldelete", "params": {"admin_client": "", "session": "", "variable": ""}, "params_descr": {"admin_client": "", "session": "", "variable": ""}, "params_occur": {"admin_client": [["resp", "admin_client", "post", "data", "var_id", "follow_redirects", "True"]], "session": [["session", "query", "Variable", "filter", "Variable", "id", "var_id", "count"]], "variable": [["var_id", "variable", "id"]]}, "params_p": {"admin_client": [["str", 0.2728873060107144]], "args": [], "kwargs": [], "session": [["int", 0.07740337213653774]], "variable": [["str", 0.9074343514245254]]}, "q_name": "test_action_muldelete", "ret_exprs": [], "ret_type": "", "variables": {"resp": "", "var_id": ""}, "variables_p": {"resp": [["str", 0.3648762768229689], ["Pattern[str]", 0.12526310398657506], ["Dict[str, Union[bool, str]]", 0.11202686593239208], ["tests.infra.assert_mixin.DSSAssertResponse", 0.101602125629561]], "var_id": [["str", 0.9048022341539115], ["int", 0.09519776584608852]]}}], "imports": ["__future__", "annotations", "io", "unittest", "mock", "pytest", "airflow", "models", "Variable", "airflow", "security", "permissions", "airflow", "utils", "session", "create_session", "tests", "test_utils", "api_connexion_utils", "create_user", "tests", "test_utils", "www", "_check_last_log", "check_content_in_response", "check_content_not_in_response", "client_with_login"], "mod_var_ln": {"VARIABLE": [[36, 0], [36, 8]]}, "mod_var_occur": {"VARIABLE": [["admin_client", "post", "data", "VARIABLE", "follow_redirects", "True"], ["session", "query", "Variable", "filter", "Variable", "key", "VARIABLE", "update", "synchronize_session", "False"], ["admin_client", "post", "data", "VARIABLE", "follow_redirects", "True"], ["variable", "Variable", "key", "VARIABLE", "val", "VARIABLE", "description", "VARIABLE"], ["session", "query", "Variable", "filter", "Variable", "key", "VARIABLE", "delete"]]}, "no_types_annot": {"D": 0, "I": 0, "U": 62}, "session_id": "0WDJugYHa-qsKXgt-4qhz-ophxNwlENksA2MYBpI7Ig", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"VARIABLE": ""}, "variables_p": {"VARIABLE": [["DefaultDict[Any, dict]", 0.38390111318667813], ["set", 0.20389778513547477], ["Dict[Variable[_KT], Variable[_VT]]", 0.1114195605968477], ["Dict[Any, Type[Any]]", 0.10669399491124382], ["dict", 0.09607042374153554]]}}}