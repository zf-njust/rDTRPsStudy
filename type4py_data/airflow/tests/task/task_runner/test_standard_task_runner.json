{"error": null, "response": {"classes": [{"cls_lc": [[81, 0], [420, 20]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": "This fixture sets up logging to have a different setup on the way in", "long_descr": "(as the test environment does not have enough context for the normal\nway to run) and ensures they reset back to normal on the way out.", "ret": null}, "fn_lc": [[82, 4], [92, 38]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "setup_class", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestStandardTaskRunner.setup_class", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[95, 4], [128, 52]], "fn_var_ln": {"Job": [[97, 8], [97, 11]], "job_runner": [[109, 8], [109, 18]], "job_type": [[98, 8], [98, 20]], "processes": [[122, 8], [122, 17]], "return_value": [[96, 8], [96, 30]], "runner_pgid": [[115, 16], [115, 27]], "task_instance": [[99, 8], [99, 25]], "task_runner": [[110, 8], [110, 19]]}, "fn_var_occur": {"Job": [["Job", "mock", "Mock"], ["Job", "job_type", "None"], ["Job", "task_instance", "mock", "MagicMock"], ["Job", "task_instance", "run_as_user", "None"], ["Job", "task_instance", "command_as_list", "return_value"], ["job_runner", "LocalTaskJobRunner", "job", "Job", "task_instance", "Job", "task_instance"]], "job_runner": [["job_runner", "LocalTaskJobRunner", "job", "Job", "task_instance", "Job", "task_instance"], ["task_runner", "StandardTaskRunner", "job_runner"]], "job_type": [["Job", "job_type", "None"]], "processes": [["processes", "list", "self", "_procs_in_pgroup", "runner_pgid"]], "return_value": [["mock_init", "return_value"], ["Job", "task_instance", "command_as_list", "return_value"]], "runner_pgid": [["runner_pgid", "os", "getpgid", "task_runner", "process", "pid"], ["runner_pgid", "task_runner", "process", "pid"], ["runner_pgid", "os", "getpgid"], ["processes", "list", "self", "_procs_in_pgroup", "runner_pgid"]], "task_instance": [["Job", "task_instance", "mock", "MagicMock"], ["Job", "task_instance", "run_as_user", "None"], ["Job", "task_instance", "command_as_list", "return_value"], ["job_runner", "LocalTaskJobRunner", "job", "Job", "task_instance", "Job", "task_instance"]], "task_runner": [["task_runner", "StandardTaskRunner", "job_runner"], ["task_runner", "start"], ["runner_pgid", "os", "getpgid", "task_runner", "process", "pid"], ["runner_pgid", "task_runner", "process", "pid"], ["task_runner", "terminate"], ["task_runner", "return_code", "None"]]}, "name": "test_start_and_terminate", "params": {"mock_init": "", "self": ""}, "params_descr": {"mock_init": "", "self": ""}, "params_occur": {"mock_init": [["mock_init", "return_value"]], "self": [["processes", "list", "self", "_procs_in_pgroup", "runner_pgid"]]}, "params_p": {"args": [], "kwargs": [], "mock_init": [], "self": []}, "q_name": "TestStandardTaskRunner.test_start_and_terminate", "ret_exprs": [], "ret_type": "", "variables": {"Job": "", "job_runner": "", "job_type": "", "processes": "", "return_value": "", "runner_pgid": "", "task_instance": "", "task_runner": ""}, "variables_p": {"Job": [], "job_runner": [["list", 0.1713740670914894], ["int", 0.16430510335745396]], "job_type": [["list", 0.20087797525292458], ["Type[bytes]", 0.12162804872459772], ["Set[str]", 0.11811719563458975], ["Pattern[str]", 0.11805623587212476], ["Dict[str, List[str]]", 0.09682490555953348], ["str", 0.0891582003656376], ["Dict[str, str]", 0.08797768239819787], ["Type[Pattern[str]]", 0.08450528435062864], ["Dict[Any, str]", 0.08285447184176564]], "processes": [["Dict[int, List[str]]", 0.2311120167135696], ["str", 0.08396744960801876], ["dict", 0.0818133165462174], ["Dict[str, str]", 0.08162736371332421], ["Type[object]", 0.079166920553815]], "return_value": [["str", 0.3131980989431433], ["list", 0.11500521177713878], ["List[Tuple[str, str, str, str]]", 0.0962180561058879], ["Dict[str, int]", 0.08774654662473702], ["List[bytes]", 0.08526398186020287], ["List[Tuple[bytes, bytes]]", 0.08372173120901925], ["Dict[str, Any]", 0.07971340620086721]], "runner_pgid": [["int", 0.2776809277136516], ["list", 0.21660828794288334], ["Tuple[Any, Any, Any]", 0.10957206639458658], ["staticmethod", 0.10227174801612593]], "task_instance": [["mock.MagicMock", 0.16878751913667914]], "task_runner": [["List[Dict[str, Any]]", 0.09498285438624139], ["Dict[str, Type[Any]]", 0.09465563245067692]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[130, 4], [172, 54]], "fn_var_ln": {"dag": [[144, 8], [144, 11]], "dagbag": [[140, 8], [140, 14]], "job": [[153, 8], [153, 11]], "job_runner": [[154, 8], [154, 18]], "lm": [[137, 8], [137, 10]], "path_listener_writer": [[131, 8], [131, 28]], "runner_pgid": [[161, 16], [161, 27]], "task": [[145, 8], [145, 12]], "task_runner": [[155, 8], [155, 19]], "ti": [[152, 8], [152, 10]]}, "fn_var_occur": {"dag": [["dag", "dagbag", "dags", "get"], ["task", "dag", "get_task"], ["dag", "create_dagrun", "run_id", "data_interval", "DEFAULT_DATE", "DEFAULT_DATE", "state", "State", "RUNNING", "start_date", "DEFAULT_DATE"]], "dagbag": [["dagbag", "DagBag", "dag_folder", "TEST_DAG_FOLDER", "include_examples", "False"], ["dag", "dagbag", "dags", "get"]], "job": [["job", "Job", "dag_id", "ti", "dag_id"], ["job_runner", "LocalTaskJobRunner", "job", "job", "task_instance", "ti", "ignore_ti_state", "True"]], "job_runner": [["job_runner", "LocalTaskJobRunner", "job", "job", "task_instance", "ti", "ignore_ti_state", "True"], ["task_runner", "StandardTaskRunner", "job_runner"]], "lm": [["lm", "get_listener_manager"], ["lm", "add_listener", "FileWriteListener", "path_listener_writer"]], "path_listener_writer": [["os", "unlink", "path_listener_writer"], ["lm", "add_listener", "FileWriteListener", "path_listener_writer"], ["open", "path_listener_writer", "f"]], "runner_pgid": [["runner_pgid", "os", "getpgid", "task_runner", "process", "pid"], ["runner_pgid", "task_runner", "process", "pid"]], "task": [["task", "dag", "get_task"], ["ti", "TaskInstance", "task", "task", "run_id"]], "task_runner": [["task_runner", "StandardTaskRunner", "job_runner"], ["task_runner", "start"], ["runner_pgid", "os", "getpgid", "task_runner", "process", "pid"], ["runner_pgid", "task_runner", "process", "pid"], ["task_runner", "return_code", "timeout", "None"]], "ti": [["ti", "TaskInstance", "task", "task", "run_id"], ["job", "Job", "dag_id", "ti", "dag_id"], ["job_runner", "LocalTaskJobRunner", "job", "job", "task_instance", "ti", "ignore_ti_state", "True"]]}, "name": "test_notifies_about_start_and_stop", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestStandardTaskRunner.test_notifies_about_start_and_stop", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dagbag": "", "job": "", "job_runner": "", "lm": "", "path_listener_writer": "", "runner_pgid": "", "task": "", "task_runner": "", "ti": ""}, "variables_p": {"dag": [["golem.task.taskstate.SubtaskState", 0.1391548687601134], ["apps.wasm.task.WasmTaskOptions", 0.13818479727450309], ["DefaultDict[Any, None]", 0.09540630014938584], ["golem.task.taskcomputer.TaskComputation", 0.09512517937048036], ["tuple", 0.09489839263180883], ["apps.blender.task.blenderrendertask.BlenderRenderTask", 0.08962679248191885], ["golem.task.taskcomputer.TaskComputer", 0.08830336164793098], ["Dict[str, dict]", 0.08809830629516034], ["apps.core.task.coretaskstate.TaskDefinition", 0.085739904299314]], "dagbag": [["str", 0.22227635005981122], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.19101443881760258], ["bool", 0.09093590305738242]], "job": [["int", 0.5294683898853817], ["Dict[str, Any]", 0.1289849769648748], ["str", 0.10669804600129602], ["list", 0.08943999004391878]], "job_runner": [["str", 0.33436892245607497], ["dict", 0.10823419353167633], ["Mapping", 0.08272425354795726]], "lm": [], "path_listener_writer": [["str", 0.39940827213589875], ["pathlib.Path", 0.2503432290892025], ["dict", 0.1656781821269405]], "runner_pgid": [["Dict[int, Any]", 0.22757738307595968], ["str", 0.17485515681559627], ["int", 0.10995631731549838], ["list", 0.10995631731549838], ["deque[str]", 0.10271479747679337], ["Dict[str, int]", 0.09507264962370358]], "task": [["golem.task.taskbase.Task", 0.31323123829090865], ["apps.core.task.coretaskstate.TaskDefinition", 0.12528325576257626], ["khetha.models.Task", 0.11096986896581523], ["golem.task.taskcomputer.TaskComputer", 0.10276826023199334], ["reminders.task.Task", 0.08948550883015774], ["zero.domain.task.Task", 0.06544005186698564], ["golem.task.task_api.EnvironmentTaskApiService", 0.06036547301198046]], "task_runner": [["List[Dict[str, Any]]", 0.09498285438624139], ["Dict[str, Type[Any]]", 0.09465563245067692]], "ti": [["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.11796509630174465], ["golem.task.taskstate.SubtaskState", 0.10581740629013432], ["pydynasync.models.Changes", 0.10345095470141658], ["Optional[List[Any]]", 0.09112869427381029], ["golem.task.taskcomputer.TaskComputer", 0.08278191510820736], ["viewer.models.Gallery", 0.0806152030524521]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[174, 4], [216, 54]], "fn_var_ln": {"dag": [[188, 8], [188, 11]], "dagbag": [[184, 8], [184, 14]], "job": [[197, 8], [197, 11]], "job_runner": [[198, 8], [198, 18]], "lm": [[181, 8], [181, 10]], "path_listener_writer": [[175, 8], [175, 28]], "runner_pgid": [[205, 16], [205, 27]], "task": [[189, 8], [189, 12]], "task_runner": [[199, 8], [199, 19]], "ti": [[196, 8], [196, 10]]}, "fn_var_occur": {"dag": [["dag", "dagbag", "dags", "get"], ["task", "dag", "get_task"], ["dag", "create_dagrun", "run_id", "data_interval", "DEFAULT_DATE", "DEFAULT_DATE", "state", "State", "RUNNING", "start_date", "DEFAULT_DATE"]], "dagbag": [["dagbag", "DagBag", "dag_folder", "TEST_DAG_FOLDER", "include_examples", "False"], ["dag", "dagbag", "dags", "get"]], "job": [["job", "Job", "dag_id", "ti", "dag_id"], ["job_runner", "LocalTaskJobRunner", "job", "job", "task_instance", "ti", "ignore_ti_state", "True"]], "job_runner": [["job_runner", "LocalTaskJobRunner", "job", "job", "task_instance", "ti", "ignore_ti_state", "True"], ["task_runner", "StandardTaskRunner", "job_runner"]], "lm": [["lm", "get_listener_manager"], ["lm", "add_listener", "FileWriteListener", "path_listener_writer"]], "path_listener_writer": [["os", "unlink", "path_listener_writer"], ["lm", "add_listener", "FileWriteListener", "path_listener_writer"], ["open", "path_listener_writer", "f"]], "runner_pgid": [["runner_pgid", "os", "getpgid", "task_runner", "process", "pid"], ["runner_pgid", "task_runner", "process", "pid"]], "task": [["task", "dag", "get_task"], ["ti", "TaskInstance", "task", "task", "run_id"]], "task_runner": [["task_runner", "StandardTaskRunner", "job_runner"], ["task_runner", "start"], ["runner_pgid", "os", "getpgid", "task_runner", "process", "pid"], ["runner_pgid", "task_runner", "process", "pid"], ["task_runner", "return_code", "timeout", "None"]], "ti": [["ti", "TaskInstance", "task", "task", "run_id"], ["job", "Job", "dag_id", "ti", "dag_id"], ["job_runner", "LocalTaskJobRunner", "job", "job", "task_instance", "ti", "ignore_ti_state", "True"]]}, "name": "test_notifies_about_fail", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestStandardTaskRunner.test_notifies_about_fail", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dagbag": "", "job": "", "job_runner": "", "lm": "", "path_listener_writer": "", "runner_pgid": "", "task": "", "task_runner": "", "ti": ""}, "variables_p": {"dag": [["golem.task.taskstate.SubtaskState", 0.1391548687601134], ["apps.wasm.task.WasmTaskOptions", 0.13818479727450309], ["DefaultDict[Any, None]", 0.09540630014938584], ["golem.task.taskcomputer.TaskComputation", 0.09512517937048036], ["tuple", 0.09489839263180883], ["apps.blender.task.blenderrendertask.BlenderRenderTask", 0.08962679248191885], ["golem.task.taskcomputer.TaskComputer", 0.08830336164793098], ["Dict[str, dict]", 0.08809830629516034], ["apps.core.task.coretaskstate.TaskDefinition", 0.085739904299314]], "dagbag": [["str", 0.22227635005981122], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.19101443881760258], ["bool", 0.09093590305738242]], "job": [["int", 0.5294683898853817], ["Dict[str, Any]", 0.1289849769648748], ["str", 0.10669804600129602], ["list", 0.08943999004391878]], "job_runner": [["str", 0.33436892245607497], ["dict", 0.10823419353167633], ["Mapping", 0.08272425354795726]], "lm": [], "path_listener_writer": [["str", 0.39940827213589875], ["pathlib.Path", 0.2503432290892025], ["dict", 0.1656781821269405]], "runner_pgid": [["Dict[int, Any]", 0.22757738307595968], ["str", 0.17485515681559627], ["int", 0.10995631731549838], ["list", 0.10995631731549838], ["deque[str]", 0.10271479747679337], ["Dict[str, int]", 0.09507264962370358]], "task": [["golem.task.taskbase.Task", 0.31323123829090865], ["apps.core.task.coretaskstate.TaskDefinition", 0.12528325576257626], ["khetha.models.Task", 0.11096986896581523], ["golem.task.taskcomputer.TaskComputer", 0.10276826023199334], ["reminders.task.Task", 0.08948550883015774], ["zero.domain.task.Task", 0.06544005186698564], ["golem.task.task_api.EnvironmentTaskApiService", 0.06036547301198046]], "task_runner": [["List[Dict[str, Any]]", 0.09498285438624139], ["Dict[str, Type[Any]]", 0.09465563245067692]], "ti": [["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.11796509630174465], ["golem.task.taskstate.SubtaskState", 0.10581740629013432], ["pydynasync.models.Changes", 0.10345095470141658], ["Optional[List[Any]]", 0.09112869427381029], ["golem.task.taskcomputer.TaskComputer", 0.08278191510820736], ["viewer.models.Gallery", 0.0806152030524521]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[219, 4], [253, 52]], "fn_var_ln": {"Job": [[221, 8], [221, 11]], "job_runner": [[235, 8], [235, 18]], "job_type": [[222, 8], [222, 20]], "pgid": [[242, 12], [242, 16]], "processes": [[246, 12], [246, 21]], "return_value": [[220, 8], [220, 30]], "task_instance": [[223, 8], [223, 25]], "task_runner": [[236, 8], [236, 19]]}, "fn_var_occur": {"Job": [["Job", "mock", "Mock"], ["Job", "job_type", "None"], ["Job", "task_instance", "mock", "MagicMock"], ["Job", "task_instance", "task_id"], ["Job", "task_instance", "dag_id"], ["Job", "task_instance", "run_as_user", "getuser"], ["Job", "task_instance", "command_as_list", "return_value"], ["job_runner", "LocalTaskJobRunner", "job", "Job", "task_instance", "Job", "task_instance"]], "job_runner": [["job_runner", "LocalTaskJobRunner", "job", "Job", "task_instance", "Job", "task_instance"], ["task_runner", "StandardTaskRunner", "job_runner"]], "job_type": [["Job", "job_type", "None"]], "pgid": [["pgid", "os", "getpgid", "task_runner", "process", "pid"], ["pgid", "os", "getpgid"], ["processes", "list", "self", "_procs_in_pgroup", "pgid"]], "processes": [["processes", "list", "self", "_procs_in_pgroup", "pgid"]], "return_value": [["mock_init", "return_value"], ["Job", "task_instance", "command_as_list", "return_value"]], "task_instance": [["Job", "task_instance", "mock", "MagicMock"], ["Job", "task_instance", "task_id"], ["Job", "task_instance", "dag_id"], ["Job", "task_instance", "run_as_user", "getuser"], ["Job", "task_instance", "command_as_list", "return_value"], ["job_runner", "LocalTaskJobRunner", "job", "Job", "task_instance", "Job", "task_instance"]], "task_runner": [["task_runner", "StandardTaskRunner", "job_runner"], ["task_runner", "start"], ["pgid", "os", "getpgid", "task_runner", "process", "pid"], ["task_runner", "terminate"], ["task_runner", "return_code", "None"]]}, "name": "test_start_and_terminate_run_as_user", "params": {"mock_init": "", "self": ""}, "params_descr": {"mock_init": "", "self": ""}, "params_occur": {"mock_init": [["mock_init", "return_value"]], "self": [["processes", "list", "self", "_procs_in_pgroup", "pgid"]]}, "params_p": {"args": [], "kwargs": [], "mock_init": [], "self": []}, "q_name": "TestStandardTaskRunner.test_start_and_terminate_run_as_user", "ret_exprs": [], "ret_type": "", "variables": {"Job": "", "job_runner": "", "job_type": "", "pgid": "", "processes": "", "return_value": "", "task_instance": "", "task_runner": ""}, "variables_p": {"Job": [["mode.utils.mocks.Mock", 0.6264891825361404], ["mock.MagicMock", 0.28372624109074884]], "job_runner": [["list", 0.1713740670914894], ["int", 0.16430510335745396]], "job_type": [["list", 0.20087797525292458], ["Type[bytes]", 0.12162804872459772], ["Set[str]", 0.11811719563458975], ["Pattern[str]", 0.11805623587212476], ["Dict[str, List[str]]", 0.09682490555953348], ["str", 0.0891582003656376], ["Dict[str, str]", 0.08797768239819787], ["Type[Pattern[str]]", 0.08450528435062864], ["Dict[Any, str]", 0.08285447184176564]], "pgid": [["int", 0.12747516477821882], ["deque[str]", 0.10973354226536775], ["float", 0.09924191993148952], ["list", 0.09557713226629676], ["dict", 0.09513803050343576], ["List[Tuple[str, Any]]", 0.08989334803055643]], "processes": [["Dict[int, List[str]]", 0.2311120167135696], ["str", 0.08396744960801876], ["dict", 0.0818133165462174], ["Dict[str, str]", 0.08162736371332421], ["Type[object]", 0.079166920553815]], "return_value": [["str", 0.3131980989431433], ["list", 0.11500521177713878], ["List[Tuple[str, str, str, str]]", 0.0962180561058879], ["Dict[str, int]", 0.08774654662473702], ["List[bytes]", 0.08526398186020287], ["List[Tuple[bytes, bytes]]", 0.08372173120901925], ["Dict[str, Any]", 0.07971340620086721]], "task_instance": [["mock.MagicMock", 0.27117340590406525]], "task_runner": []}}, {"docstring": {"func": "Tests that when a child process running a task is killed externally", "long_descr": "(e.g. by an OOM error, which we fake here), then we get return code\n-9 and a log message.", "ret": null}, "fn_lc": [[257, 4], [296, 53]], "fn_var_ln": {"Job": [[264, 8], [264, 11]], "job_runner": [[278, 8], [278, 18]], "job_type": [[265, 8], [265, 20]], "pgid": [[289, 8], [289, 12]], "return_value": [[263, 8], [263, 30]], "task_instance": [[266, 8], [266, 25]], "task_runner": [[281, 8], [281, 19]]}, "fn_var_occur": {"Job": [["Job", "mock", "Mock"], ["Job", "job_type", "None"], ["Job", "task_instance", "mock", "MagicMock"], ["Job", "task_instance", "task_id"], ["Job", "task_instance", "dag_id"], ["Job", "task_instance", "run_as_user", "getuser"], ["Job", "task_instance", "command_as_list", "return_value"], ["job_runner", "LocalTaskJobRunner", "job", "Job", "task_instance", "Job", "task_instance"]], "job_runner": [["job_runner", "LocalTaskJobRunner", "job", "Job", "task_instance", "Job", "task_instance"], ["task_runner", "StandardTaskRunner", "job_runner"]], "job_type": [["Job", "job_type", "None"]], "pgid": [["pgid", "os", "getpgid", "task_runner", "process", "pid"], ["os", "system", "pgid"]], "return_value": [["mock_init", "return_value"], ["Job", "task_instance", "command_as_list", "return_value"]], "task_instance": [["Job", "task_instance", "mock", "MagicMock"], ["Job", "task_instance", "task_id"], ["Job", "task_instance", "dag_id"], ["Job", "task_instance", "run_as_user", "getuser"], ["Job", "task_instance", "command_as_list", "return_value"], ["job_runner", "LocalTaskJobRunner", "job", "Job", "task_instance", "Job", "task_instance"]], "task_runner": [["task_runner", "StandardTaskRunner", "job_runner"], ["task_runner", "start"], ["pgid", "os", "getpgid", "task_runner", "process", "pid"], ["task_runner", "terminate"], ["task_runner", "return_code"]]}, "name": "test_early_reap_exit", "params": {"caplog": "", "mock_init": "", "self": ""}, "params_descr": {"caplog": "", "mock_init": "", "self": ""}, "params_occur": {"caplog": [["caplog", "text"]], "mock_init": [["mock_init", "return_value"]], "self": []}, "params_p": {"args": [], "caplog": [], "kwargs": [], "mock_init": [], "self": []}, "q_name": "TestStandardTaskRunner.test_early_reap_exit", "ret_exprs": [], "ret_type": "", "variables": {"Job": "", "job_runner": "", "job_type": "", "pgid": "", "return_value": "", "task_instance": "", "task_runner": ""}, "variables_p": {"Job": [["mode.utils.mocks.Mock", 0.6264891825361404], ["mock.MagicMock", 0.28372624109074884]], "job_runner": [["list", 0.1713740670914894], ["int", 0.16430510335745396]], "job_type": [["list", 0.20087797525292458], ["Type[bytes]", 0.12162804872459772], ["Set[str]", 0.11811719563458975], ["Pattern[str]", 0.11805623587212476], ["Dict[str, List[str]]", 0.09682490555953348], ["str", 0.0891582003656376], ["Dict[str, str]", 0.08797768239819787], ["Type[Pattern[str]]", 0.08450528435062864], ["Dict[Any, str]", 0.08285447184176564]], "pgid": [["int", 0.6844794015028646], ["bytes", 0.07875281227655158], ["Tuple[Any, Any, Any, Any]", 0.07636326017821202]], "return_value": [["str", 0.3131980989431433], ["list", 0.11500521177713878], ["List[Tuple[str, str, str, str]]", 0.0962180561058879], ["Dict[str, int]", 0.08774654662473702], ["List[bytes]", 0.08526398186020287], ["List[Tuple[bytes, bytes]]", 0.08372173120901925], ["Dict[str, Any]", 0.07971340620086721]], "task_instance": [["mock.MagicMock", 0.27117340590406525]], "task_runner": []}}, {"docstring": {"func": "Test that ensures that clearing in the UI SIGTERMS", "long_descr": "the task", "ret": null}, "fn_lc": [[298, 4], [364, 82]], "fn_var_ln": {"dag": [[318, 8], [318, 11]], "dagbag": [[314, 8], [314, 14]], "job": [[327, 8], [327, 11]], "job_runner": [[328, 8], [328, 18]], "path_on_kill_killed": [[304, 8], [304, 27]], "path_on_kill_running": [[303, 8], [303, 28]], "processes": [[339, 8], [339, 17]], "runner_pgid": [[334, 16], [334, 27]], "task": [[319, 8], [319, 12]], "task_runner": [[329, 8], [329, 19]], "ti": [[326, 8], [326, 10]]}, "fn_var_occur": {"dag": [["dag", "dagbag", "dags", "get"], ["task", "dag", "get_task"], ["dag", "create_dagrun", "run_id", "data_interval", "DEFAULT_DATE", "DEFAULT_DATE", "state", "State", "RUNNING", "start_date", "DEFAULT_DATE"]], "dagbag": [["dagbag", "DagBag", "dag_folder", "TEST_DAG_FOLDER", "include_examples", "False"], ["dag", "dagbag", "dags", "get"]], "job": [["job", "Job", "dag_id", "ti", "dag_id"], ["job_runner", "LocalTaskJobRunner", "job", "job", "task_instance", "ti", "ignore_ti_state", "True"]], "job_runner": [["job_runner", "LocalTaskJobRunner", "job", "job", "task_instance", "ti", "ignore_ti_state", "True"], ["task_runner", "StandardTaskRunner", "job_runner"]], "path_on_kill_killed": [["os", "unlink", "path_on_kill_killed"], ["os", "path", "exists", "path_on_kill_killed"], ["open", "path_on_kill_killed", "f"]], "path_on_kill_running": [["os", "unlink", "path_on_kill_running"], ["os", "path", "exists", "path_on_kill_running"]], "processes": [["processes", "list", "self", "_procs_in_pgroup", "runner_pgid"], ["logging", "info", "processes", "runner_pgid"]], "runner_pgid": [["runner_pgid", "os", "getpgid", "task_runner", "process", "pid"], ["runner_pgid", "task_runner", "process", "pid"], ["processes", "list", "self", "_procs_in_pgroup", "runner_pgid"], ["logging", "info", "processes", "runner_pgid"]], "task": [["task", "dag", "get_task"], ["ti", "TaskInstance", "task", "task", "run_id"]], "task_runner": [["task_runner", "StandardTaskRunner", "job_runner"], ["task_runner", "start"], ["runner_pgid", "os", "getpgid", "task_runner", "process", "pid"], ["runner_pgid", "task_runner", "process", "pid"], ["task_runner", "terminate"]], "ti": [["ti", "TaskInstance", "task", "task", "run_id"], ["job", "Job", "dag_id", "ti", "dag_id"], ["job_runner", "LocalTaskJobRunner", "job", "job", "task_instance", "ti", "ignore_ti_state", "True"]]}, "name": "test_on_kill", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["processes", "list", "self", "_procs_in_pgroup", "runner_pgid"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestStandardTaskRunner.test_on_kill", "ret_exprs": [], "ret_type": "", "variables": {"dag": "", "dagbag": "", "job": "", "job_runner": "", "path_on_kill_killed": "", "path_on_kill_running": "", "processes": "", "runner_pgid": "", "task": "", "task_runner": "", "ti": ""}, "variables_p": {"dag": [["golem.task.taskstate.SubtaskState", 0.1391548687601134], ["apps.wasm.task.WasmTaskOptions", 0.13818479727450309], ["DefaultDict[Any, None]", 0.09540630014938584], ["golem.task.taskcomputer.TaskComputation", 0.09512517937048036], ["tuple", 0.09489839263180883], ["apps.blender.task.blenderrendertask.BlenderRenderTask", 0.08962679248191885], ["golem.task.taskcomputer.TaskComputer", 0.08830336164793098], ["Dict[str, dict]", 0.08809830629516034], ["apps.core.task.coretaskstate.TaskDefinition", 0.085739904299314]], "dagbag": [["str", 0.22227635005981122], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.19101443881760258], ["bool", 0.09093590305738242]], "job": [["int", 0.5294683898853817], ["Dict[str, Any]", 0.1289849769648748], ["str", 0.10669804600129602], ["list", 0.08943999004391878]], "job_runner": [["str", 0.33436892245607497], ["dict", 0.10823419353167633], ["Mapping", 0.08272425354795726]], "path_on_kill_killed": [["str", 1.0]], "path_on_kill_running": [["str", 0.9999999999999998]], "processes": [["list", 0.31390309330030186], ["DefaultDict[Any, List[Any]]", 0.19107316341574931], ["int", 0.08936087055095199]], "runner_pgid": [["int", 0.3662336960578666], ["list", 0.13629013793114128], ["staticmethod", 0.10980717706863527], ["Tuple[Any, Any, Any]", 0.08718455440853953], ["alerta.models.alerAlert", 0.0825892741537247]], "task": [["golem.task.taskbase.Task", 0.31323123829090865], ["apps.core.task.coretaskstate.TaskDefinition", 0.12528325576257626], ["khetha.models.Task", 0.11096986896581523], ["golem.task.taskcomputer.TaskComputer", 0.10276826023199334], ["reminders.task.Task", 0.08948550883015774], ["zero.domain.task.Task", 0.06544005186698564], ["golem.task.task_api.EnvironmentTaskApiService", 0.06036547301198046]], "task_runner": [["List[Dict[str, Any]]", 0.09498285438624139], ["Dict[str, Type[Any]]", 0.09465563245067692]], "ti": [["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.11796509630174465], ["golem.task.taskstate.SubtaskState", 0.10581740629013432], ["pydynasync.models.Changes", 0.10345095470141658], ["Optional[List[Any]]", 0.09112869427381029], ["golem.task.taskcomputer.TaskComputer", 0.08278191510820736], ["viewer.models.Gallery", 0.0806152030524521]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[366, 4], [411, 9]], "fn_var_ln": {"context_file": [[367, 8], [367, 20]], "dag": [[376, 8], [376, 11]], "dagbag": [[372, 8], [372, 14]], "job": [[386, 8], [386, 11]], "job_runner": [[387, 8], [387, 18]], "processes": [[401, 8], [401, 17]], "runner_pgid": [[394, 16], [394, 27]], "task": [[377, 8], [377, 12]], "task_runner": [[388, 8], [388, 19]], "text": [[407, 8], [407, 12]], "ti": [[385, 8], [385, 10]]}, "fn_var_occur": {"context_file": [["context_file", "Path"], ["context_file", "unlink"], ["text", "context_file", "read_text"]], "dag": [["dag", "dagbag", "dags", "get"], ["task", "dag", "get_task"], ["dag", "create_dagrun", "run_id", "data_interval", "DEFAULT_DATE", "DEFAULT_DATE", "state", "State", "RUNNING", "start_date", "DEFAULT_DATE"]], "dagbag": [["dagbag", "DagBag", "dag_folder", "TEST_DAG_FOLDER", "include_examples", "False"], ["dag", "dagbag", "dags", "get"]], "job": [["job", "Job", "dag_id", "ti", "dag_id"], ["job_runner", "LocalTaskJobRunner", "job", "job", "task_instance", "ti", "ignore_ti_state", "True"]], "job_runner": [["job_runner", "LocalTaskJobRunner", "job", "job", "task_instance", "ti", "ignore_ti_state", "True"], ["task_runner", "StandardTaskRunner", "job_runner"]], "processes": [["processes", "list", "self", "_procs_in_pgroup", "runner_pgid"]], "runner_pgid": [["runner_pgid", "os", "getpgid", "task_runner", "process", "pid"], ["runner_pgid", "task_runner", "process", "pid"], ["runner_pgid", "os", "getpgid"], ["processes", "list", "self", "_procs_in_pgroup", "runner_pgid"]], "task": [["task", "dag", "get_task"], ["ti", "TaskInstance", "task", "task", "run_id"]], "task_runner": [["task_runner", "StandardTaskRunner", "job_runner"], ["task_runner", "start"], ["runner_pgid", "os", "getpgid", "task_runner", "process", "pid"], ["runner_pgid", "task_runner", "process", "pid"], ["psutil", "wait_procs", "task_runner", "process"], ["task_runner", "return_code"]], "text": [["text", "context_file", "read_text"]], "ti": [["ti", "TaskInstance", "task", "task", "run_id"], ["job", "Job", "dag_id", "ti", "dag_id"], ["job_runner", "LocalTaskJobRunner", "job", "job", "task_instance", "ti", "ignore_ti_state", "True"]]}, "name": "test_parsing_context", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["processes", "list", "self", "_procs_in_pgroup", "runner_pgid"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "TestStandardTaskRunner.test_parsing_context", "ret_exprs": [], "ret_type": "", "variables": {"context_file": "", "dag": "", "dagbag": "", "job": "", "job_runner": "", "processes": "", "runner_pgid": "", "task": "", "task_runner": "", "text": "", "ti": ""}, "variables_p": {"context_file": [["List[str]", 0.33322983886067725], ["pathlib.Path", 0.29332083401491466], ["Optional[str]", 0.13805278664104353], ["str", 0.07598729661733333]], "dag": [["golem.task.taskstate.SubtaskState", 0.1391548687601134], ["apps.wasm.task.WasmTaskOptions", 0.13818479727450309], ["DefaultDict[Any, None]", 0.09540630014938584], ["golem.task.taskcomputer.TaskComputation", 0.09512517937048036], ["tuple", 0.09489839263180883], ["apps.blender.task.blenderrendertask.BlenderRenderTask", 0.08962679248191885], ["golem.task.taskcomputer.TaskComputer", 0.08830336164793098], ["Dict[str, dict]", 0.08809830629516034], ["apps.core.task.coretaskstate.TaskDefinition", 0.085739904299314]], "dagbag": [["str", 0.22227635005981122], ["libsoundtouch.tests.test_libsoundtouch.MockDevice", 0.19101443881760258], ["bool", 0.09093590305738242]], "job": [["int", 0.5294683898853817], ["Dict[str, Any]", 0.1289849769648748], ["str", 0.10669804600129602], ["list", 0.08943999004391878]], "job_runner": [["str", 0.33436892245607497], ["dict", 0.10823419353167633], ["Mapping", 0.08272425354795726]], "processes": [["Dict[int, List[str]]", 0.2311120167135696], ["str", 0.08396744960801876], ["dict", 0.0818133165462174], ["Dict[str, str]", 0.08162736371332421], ["Type[object]", 0.079166920553815]], "runner_pgid": [["int", 0.2776809277136516], ["list", 0.21660828794288334], ["Tuple[Any, Any, Any]", 0.10957206639458658], ["staticmethod", 0.10227174801612593]], "task": [["golem.task.taskbase.Task", 0.31323123829090865], ["apps.core.task.coretaskstate.TaskDefinition", 0.12528325576257626], ["khetha.models.Task", 0.11096986896581523], ["golem.task.taskcomputer.TaskComputer", 0.10276826023199334], ["reminders.task.Task", 0.08948550883015774], ["zero.domain.task.Task", 0.06544005186698564], ["golem.task.task_api.EnvironmentTaskApiService", 0.06036547301198046]], "task_runner": [["List[Dict[str, Any]]", 0.09498285438624139], ["Dict[str, Type[Any]]", 0.09465563245067692]], "text": [["str", 0.9033477878784317], ["Set[str]", 0.09665221212156819]], "ti": [["rotkehlchen.tests.utils.rotkehlchen.BalancesTestSetup", 0.11796509630174465], ["golem.task.taskstate.SubtaskState", 0.10581740629013432], ["pydynasync.models.Changes", 0.10345095470141658], ["Optional[List[Any]]", 0.09112869427381029], ["golem.task.taskcomputer.TaskComputer", 0.08278191510820736], ["viewer.models.Gallery", 0.0806152030524521]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[414, 4], [420, 20]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "_procs_in_pgroup", "params": {"pgid": ""}, "params_descr": {"pgid": ""}, "params_occur": {"pgid": [["os", "getpgid", "proc", "pid", "pgid", "proc", "pid"]]}, "params_p": {"args": [], "kwargs": [], "pgid": [["Iterable[str]", 0.6666666657125097], ["str", 0.33333333307628477], ["int", 2.2002992800397408e-10], ["Dict[str, str]", 1.1105583879278964e-10]], "self": []}, "q_name": "TestStandardTaskRunner._procs_in_pgroup", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}], "name": "TestStandardTaskRunner", "q_name": "TestStandardTaskRunner", "variables": {}, "variables_p": {}}], "funcs": [{"docstring": {"func": "Set `airflow.task` logger to propagate.", "long_descr": "Apparently, caplog doesn't work if you don't propagate messages to root.\n\nBut the normal behavior of the `airflow.task` logger is not to propagate.\n\nWhen freshly configured, the logger is set to propagate.  However,\nordinarily when set_context is called, this is set to False.\n\nTo override this behavior, so that the messages make it to caplog, we\nmust tell the handler to maintain its current setting.", "ret": null}, "fn_lc": [[53, 0], [77, 45]], "fn_var_ln": {"_propagate": [[70, 4], [70, 14]], "h": [[68, 4], [68, 5]], "logger": [[67, 4], [67, 10]], "maintain_propagate": [[77, 12], [77, 32]]}, "fn_var_occur": {"_propagate": [["_propagate", "h", "maintain_propagate"], ["_propagate", "False"], ["_propagate", "False"], ["h", "maintain_propagate", "_propagate"]], "h": [["h", "logger", "handlers"], ["isinstance", "h", "FileTaskHandler"], ["_propagate", "h", "maintain_propagate"], ["h", "maintain_propagate", "True"], ["h", "maintain_propagate", "_propagate"]], "logger": [["logger", "logging", "getLogger"], ["h", "logger", "handlers"]], "maintain_propagate": [["_propagate", "h", "maintain_propagate"], ["h", "maintain_propagate", "True"], ["h", "maintain_propagate", "_propagate"]]}, "name": "propagate_task_logger", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "propagate_task_logger", "ret_exprs": [], "ret_type": "", "variables": {"_propagate": "", "h": "", "logger": "", "maintain_propagate": ""}, "variables_p": {"_propagate": [["str", 0.5831280924015468], ["bool", 0.19868748393321067], ["Dict[str, Union[bool, str]]", 0.09847286123266469]], "h": [["logging.Handler", 0.4001528506417684], ["str", 0.11254687182666218], ["logging.handlers.TimedRotatingFileHandler", 0.09256489758397012], ["logging.handlers.RotatingFileHandler", 0.08569674739906362], ["logging.Logger", 0.07148295494615955]], "logger": [["logging.Logger", 1.0]], "maintain_propagate": [["Tuple[Literal, int, Literal, int]", 0.49999999980574283], ["bool", 6.54970043533008e-11], ["str", 5.091417218770261e-11], ["Iterator[Tuple[int, Any]]", 3.453041884369511e-11], ["Tuple[str]", 2.790147344806078e-11], ["Dict[str, str]", 2.790147344806078e-11]]}}], "imports": ["__future__", "annotations", "logging", "os", "time", "contextlib", "contextmanager", "pathlib", "Path", "unittest", "mock", "unittest", "mock", "patch", "psutil", "pytest", "airflow", "jobs", "job", "Job", "airflow", "jobs", "local_task_job_runner", "LocalTaskJobRunner", "airflow", "listeners", "listener", "get_listener_manager", "airflow", "models", "dagbag", "DagBag", "airflow", "models", "taskinstance", "TaskInstance", "airflow", "task", "task_runner", "standard_task_runner", "StandardTaskRunner", "airflow", "utils", "timezone", "airflow", "utils", "log", "file_task_handler", "FileTaskHandler", "airflow", "utils", "platform", "getuser", "airflow", "utils", "state", "State", "airflow", "utils", "timeout", "timeout", "tests", "listeners", "file_write_listener", "FileWriteListener", "tests", "test_utils", "db", "clear_db_runs"], "mod_var_ln": {"DEFAULT_DATE": [[47, 0], [47, 12]], "TASK_FORMAT": [[49, 0], [49, 11]], "TEST_DAG_FOLDER": [[45, 0], [45, 15]]}, "mod_var_occur": {"DEFAULT_DATE": [["dag", "create_dagrun", "run_id", "data_interval", "DEFAULT_DATE", "DEFAULT_DATE", "state", "State", "RUNNING", "start_date", "DEFAULT_DATE"], ["dag", "create_dagrun", "run_id", "data_interval", "DEFAULT_DATE", "DEFAULT_DATE", "state", "State", "RUNNING", "start_date", "DEFAULT_DATE"], ["dag", "create_dagrun", "run_id", "data_interval", "DEFAULT_DATE", "DEFAULT_DATE", "state", "State", "RUNNING", "start_date", "DEFAULT_DATE"], ["dag", "create_dagrun", "run_id", "data_interval", "DEFAULT_DATE", "DEFAULT_DATE", "state", "State", "RUNNING", "start_date", "DEFAULT_DATE"]], "TASK_FORMAT": [], "TEST_DAG_FOLDER": [["dagbag", "DagBag", "dag_folder", "TEST_DAG_FOLDER", "include_examples", "False"], ["dagbag", "DagBag", "dag_folder", "TEST_DAG_FOLDER", "include_examples", "False"], ["dagbag", "DagBag", "dag_folder", "TEST_DAG_FOLDER", "include_examples", "False"], ["dagbag", "DagBag", "dag_folder", "TEST_DAG_FOLDER", "include_examples", "False"]]}, "no_types_annot": {"D": 0, "I": 0, "U": 87}, "session_id": "lbYHjcEq9Tuk4A8lvPLNu9hHBBwogxAZjS6J2uqPi4E", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"DEFAULT_DATE": "", "TASK_FORMAT": "", "TEST_DAG_FOLDER": ""}, "variables_p": {"DEFAULT_DATE": [["str", 0.3768943771513504], ["dict", 0.10888585699748772], ["list", 0.10422492481141225]], "TASK_FORMAT": [["str", 0.8959529197615166], ["Optional[str]", 0.10404708023848361]], "TEST_DAG_FOLDER": [["str", 0.3417954497507254], ["pathlib.Path", 0.09633705688665525]]}}}