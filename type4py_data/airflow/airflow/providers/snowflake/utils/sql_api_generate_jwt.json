{"error": null, "response": {"classes": [{"cls_lc": [[42, 0], [178, 28]], "cls_var_ln": {"ALGORITHM": [[63, 4], [63, 13]], "LIFETIME": [[61, 4], [61, 12]], "RENEWAL_DELTA": [[62, 4], [62, 17]]}, "cls_var_occur": {"ALGORITHM": [["token", "jwt", "encode", "payload", "key", "self", "private_key", "algorithm", "JWTGenerator", "ALGORITHM"]], "LIFETIME": [], "RENEWAL_DELTA": []}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[65, 4], [91, 37]], "fn_var_ln": {"account": [[83, 8], [83, 20]], "lifetime": [[87, 8], [87, 21]], "private_key": [[89, 8], [89, 24]], "qualified_username": [[85, 8], [85, 31]], "renew_time": [[90, 8], [90, 23]], "renewal_delay": [[88, 8], [88, 26]], "token": [[91, 8], [91, 18]], "user": [[84, 8], [84, 17]]}, "fn_var_occur": {"account": [["logger", "info", "account", "user", "lifetime", "renewal_delay"], ["self", "account", "self", "prepare_account_name_for_jwt", "account"], ["self", "qualified_username", "self", "account", "self", "user"]], "lifetime": [["logger", "info", "account", "user", "lifetime", "renewal_delay"], ["self", "lifetime", "lifetime"]], "private_key": [["self", "private_key", "private_key"]], "qualified_username": [["self", "qualified_username", "self", "account", "self", "user"]], "renew_time": [["self", "renew_time", "datetime", "now", "timezone", "utc"]], "renewal_delay": [["logger", "info", "account", "user", "lifetime", "renewal_delay"], ["self", "renewal_delay", "renewal_delay"]], "token": [["self", "token", "str", "None", "None"]], "user": [["logger", "info", "account", "user", "lifetime", "renewal_delay"], ["self", "user", "user", "upper"], ["self", "qualified_username", "self", "account", "self", "user"]]}, "name": "__init__", "params": {"account": "builtins.str", "lifetime": "datetime.timedelta", "private_key": "typing.Any", "renewal_delay": "datetime.timedelta", "self": "", "user": "builtins.str"}, "params_descr": {"account": "", "lifetime": "", "private_key": "", "renewal_delay": "", "self": "", "user": ""}, "params_occur": {"account": [["logger", "info", "account", "user", "lifetime", "renewal_delay"], ["self", "account", "self", "prepare_account_name_for_jwt", "account"], ["self", "qualified_username", "self", "account", "self", "user"]], "lifetime": [["logger", "info", "account", "user", "lifetime", "renewal_delay"], ["self", "lifetime", "lifetime"]], "private_key": [["self", "private_key", "private_key"]], "renewal_delay": [["logger", "info", "account", "user", "lifetime", "renewal_delay"], ["self", "renewal_delay", "renewal_delay"]], "self": [["self", "account", "self", "prepare_account_name_for_jwt", "account"], ["self", "user", "user", "upper"], ["self", "qualified_username", "self", "account", "self", "user"], ["self", "lifetime", "lifetime"], ["self", "renewal_delay", "renewal_delay"], ["self", "private_key", "private_key"], ["self", "renew_time", "datetime", "now", "timezone", "utc"], ["self", "token", "str", "None", "None"]], "user": [["logger", "info", "account", "user", "lifetime", "renewal_delay"], ["self", "user", "user", "upper"], ["self", "qualified_username", "self", "account", "self", "user"]]}, "params_p": {"account": [["str", 0.25719101885769524], ["Optional[str]", 0.12483618024255286], ["int", 0.08570299660075484], ["logging.Logger", 0.08313431264133066]], "args": [], "kwargs": [], "lifetime": [["str", 0.6924286404231308], ["logging.Logger", 0.2129654041837294]], "private_key": [["List[List[str]]", 0.1913902936621246], ["Union[List[str], List[int]]", 0.12153119867947502], ["List[Tuple[int, int]]", 0.1069032368646626], ["str", 0.10688377763323775], ["Dict[str, int]", 0.09620760499093359], ["List[dict]", 0.0960128664539753], ["int", 0.09376852542600383], ["Callable", 0.09353397086358348]], "renewal_delay": [["str", 0.6924286404231308], ["logging.Logger", 0.2129654041837294]], "self": [], "user": [["str", 0.3062021073006343], ["Optional[str]", 0.1382712144877702], ["logging.Logger", 0.07780818926777876]]}, "q_name": "JWTGenerator.__init__", "ret_exprs": [], "ret_type": "", "variables": {"account": "", "lifetime": "", "private_key": "", "qualified_username": "", "renew_time": "", "renewal_delay": "", "token": "str | None", "user": ""}, "variables_p": {"account": [["str", 0.6087043660879283], ["Set[Optional[str]]", 0.10271743010974585], ["Type[str]", 0.09626601562631948], ["int", 0.09147353296959926]], "lifetime": [["float", 0.3023163308458549], ["int", 0.28706890092574217], ["Dict[Any, Dict[str, str]]", 0.09249442115315176], ["dict", 0.08317110627583564], ["Dict[str, Any]", 0.08295395566604628], ["str", 0.08182595505466207], ["Dict[str, str]", 0.07016933007870721]], "private_key": [["str", 0.6759191991290052], ["List[str]", 0.08228762502997228], ["bytes", 0.07980006819897666]], "qualified_username": [["int", 0.4179975539716885], ["str", 0.19400081534277047], ["Tuple[int, int, int, int]", 0.09700040767138524], ["dict", 0.09700040767138524], ["List[str]", 0.09700040767138524]], "renew_time": [["datetime.timedelta", 0.32804607254029605], ["datetime.datetime", 0.2991470196279741], ["datetime.datetime.timedelta", 0.1781632844572104], ["datetime.datetime.datetime", 0.10527250898149203], ["datetime", 0.0893711143930273]], "renewal_delay": [["float", 0.3023163308458549], ["int", 0.28706890092574217], ["Dict[Any, Dict[str, str]]", 0.09249442115315176], ["dict", 0.08317110627583564], ["Dict[str, Any]", 0.08295395566604628], ["str", 0.08182595505466207], ["Dict[str, str]", 0.07016933007870721]], "token": [["Optional[str]", 0.5276699638888379], ["str", 0.3094298302756393], ["Optional[Dict[str, str]]", 0.1629002058355229]], "user": [["str", 0.6167686381653819], ["Dict[str, str]", 0.11538415046433022], ["int", 0.08880328435180533], ["Generator[str, None, None]", 0.08861192011839228]]}}, {"docstring": {"func": "Prepare the account identifier for use in the JWT.", "long_descr": "For the JWT, the account identifier must not include the subdomain or any region or cloud provider\ninformation.", "ret": null}, "fn_lc": [[93, 4], [114, 30]], "fn_var_ln": {"account": [[112, 16], [112, 23]], "idx": [[110, 12], [110, 15]]}, "fn_var_occur": {"account": [["account", "raw_account"], ["idx", "account", "find"], ["account", "account", "idx"], ["idx", "account", "find"], ["account", "account", "idx"], ["account", "upper"]], "idx": [["idx", "account", "find"], ["account", "account", "idx"], ["idx", "account", "find"], ["account", "account", "idx"]]}, "name": "prepare_account_name_for_jwt", "params": {"raw_account": "builtins.str", "self": ""}, "params_descr": {"raw_account": "The specified account identifier.", "self": ""}, "params_occur": {"raw_account": [["account", "raw_account"]], "self": []}, "params_p": {"args": [], "kwargs": [], "raw_account": [["bytes", 0.2592249737511964], ["IO[bytes]", 0.09481532367979958], ["Optional[str]", 0.09333267037581487], ["str", 0.09168383004113106], ["Sequence[Sequence[Any]]", 0.08942302631823845], ["Dict[str, Any]", 0.08504467483514468]], "self": []}, "q_name": "JWTGenerator.prepare_account_name_for_jwt", "ret_exprs": ["return account.upper()"], "ret_type": "builtins.str", "ret_type_p": [["str", 0.3733564710593753], ["bool", 0.15405567240906454], ["Dict[str, Any]", 0.1049496452990657], ["Dict[str, Dict[str, str]]", 0.09603528050482754], ["Dict[str, Dict[str, Any]]", 0.08619189694269568], ["List[Tuple[str, str, int]]", 0.08371516267012898]], "variables": {"account": "", "idx": ""}, "variables_p": {"account": [["str", 0.9999999999999999]], "idx": [["int", 0.3417354458523377], ["Tuple[int, int]", 0.27172251036645895]]}}, {"docstring": {"func": "Generates a new JWT.", "long_descr": "If a JWT has been already been generated earlier, return the previously\ngenerated token unless the specified renewal time has passed.", "ret": null}, "fn_lc": [[116, 4], [158, 25]], "fn_var_ln": {"now": [[123, 8], [123, 11]], "payload": [[140, 12], [140, 19]], "public_key_fp": [[137, 12], [137, 25]], "renew_time": [[133, 12], [133, 27]], "token": [[156, 12], [156, 22]]}, "fn_var_occur": {"now": [["now", "datetime", "now", "timezone", "utc"], ["self", "token", "None", "self", "renew_time", "now"], ["logger", "info", "now", "self", "renew_time"], ["self", "renew_time", "now", "self", "renewal_delay"], ["payload", "ISSUER", "self", "qualified_username", "public_key_fp", "SUBJECT", "self", "qualified_username", "ISSUE_TIME", "now", "EXPIRE_TIME", "now", "self", "lifetime"]], "payload": [["payload", "ISSUER", "self", "qualified_username", "public_key_fp", "SUBJECT", "self", "qualified_username", "ISSUE_TIME", "now", "EXPIRE_TIME", "now", "self", "lifetime"], ["token", "jwt", "encode", "payload", "key", "self", "private_key", "algorithm", "JWTGenerator", "ALGORITHM"]], "public_key_fp": [["public_key_fp", "self", "calculate_public_key_fingerprint", "self", "private_key"], ["payload", "ISSUER", "self", "qualified_username", "public_key_fp", "SUBJECT", "self", "qualified_username", "ISSUE_TIME", "now", "EXPIRE_TIME", "now", "self", "lifetime"]], "renew_time": [["self", "token", "None", "self", "renew_time", "now"], ["logger", "info", "now", "self", "renew_time"], ["self", "renew_time", "now", "self", "renewal_delay"]], "token": [["self", "token", "None", "self", "renew_time", "now"], ["token", "jwt", "encode", "payload", "key", "self", "private_key", "algorithm", "JWTGenerator", "ALGORITHM"], ["isinstance", "token", "bytes"], ["token", "token", "decode"], ["self", "token", "token"], ["self", "token"]]}, "name": "get_token", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "token", "None", "self", "renew_time", "now"], ["logger", "info", "now", "self", "renew_time"], ["self", "renew_time", "now", "self", "renewal_delay"], ["public_key_fp", "self", "calculate_public_key_fingerprint", "self", "private_key"], ["payload", "ISSUER", "self", "qualified_username", "public_key_fp", "SUBJECT", "self", "qualified_username", "ISSUE_TIME", "now", "EXPIRE_TIME", "now", "self", "lifetime"], ["token", "jwt", "encode", "payload", "key", "self", "private_key", "algorithm", "JWTGenerator", "ALGORITHM"], ["self", "token", "token"], ["self", "token"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "JWTGenerator.get_token", "ret_exprs": ["return self.token"], "ret_type": "str | None", "ret_type_p": [["str", 0.6071435105906935], ["int", 0.10022648827115664], ["float", 0.10022648827115664]], "variables": {"now": "", "payload": "", "public_key_fp": "", "renew_time": "", "token": ""}, "variables_p": {"now": [["Union[None, datetime.date, datetime.datetime, str]", 0.43758174993765975], ["datetime.datetime.datetime", 0.19163295960967494], ["Optional[datetime.datetime]", 0.09648563545217376], ["List[str]", 0.09022713047790555], ["datetime.datetime", 0.08898419293460938]], "payload": [["int", 0.2083217704967254], ["Tuple[Literal, Literal, Literal]", 0.1173461951861485], ["Type[Dict[str, Any]]", 0.10746841355655139], ["bytes", 0.09749580003097519], ["Dict[Tuple[str, str], int]", 0.09484757756815577], ["bool", 0.09373207499482948], ["Dict[str, int]", 0.09106821938532823]], "public_key_fp": [["bytes", 0.41759416816986067], ["str", 0.394464493045099]], "renew_time": [["int", 0.3941826298999165], ["str", 0.21127307861617142], ["set", 0.10563653930808571]], "token": [["bytes", 0.34774187654561906], ["Dict[int, bytes]", 0.1827075108247784], ["Optional[bytes]", 0.17816789395938495], ["int", 0.10925767121048872], ["tuple", 0.09095463050280356]]}}, {"docstring": {"func": "Given a private key in PEM format, return the public key fingerprint.", "long_descr": null, "ret": null}, "fn_lc": [[160, 4], [178, 28]], "fn_var_ln": {"public_key_fp": [[176, 8], [176, 21]], "public_key_raw": [[167, 8], [167, 22]], "sha256hash": [[172, 8], [172, 18]]}, "fn_var_occur": {"public_key_fp": [["public_key_fp", "base64", "b64encode", "sha256hash", "digest", "decode"]], "public_key_raw": [["public_key_raw", "private_key", "public_key", "public_bytes", "Encoding", "DER", "PublicFormat", "SubjectPublicKeyInfo"], ["sha256hash", "update", "public_key_raw"]], "sha256hash": [["sha256hash", "hashlib", "sha256"], ["sha256hash", "update", "public_key_raw"], ["public_key_fp", "base64", "b64encode", "sha256hash", "digest", "decode"]]}, "name": "calculate_public_key_fingerprint", "params": {"private_key": "typing.Any", "self": ""}, "params_descr": {"private_key": "private key", "self": ""}, "params_occur": {"private_key": [["public_key_raw", "private_key", "public_key", "public_bytes", "Encoding", "DER", "PublicFormat", "SubjectPublicKeyInfo"]], "self": []}, "params_p": {"args": [], "kwargs": [], "private_key": [["str", 0.6171588868909296], ["bytes", 0.10764317667889917]], "self": []}, "q_name": "JWTGenerator.calculate_public_key_fingerprint", "ret_exprs": ["return public_key_fp"], "ret_type": "builtins.str", "ret_type_p": [["str", 0.6087176054520268], ["bool", 0.10757645380771234], ["Sequence[Sequence[Any]]", 0.09529499807479871], ["Optional[str]", 0.09420547133273108], ["bytes", 0.09420547133273108]], "variables": {"public_key_fp": "", "public_key_raw": "", "sha256hash": ""}, "variables_p": {"public_key_fp": [["int", 0.19566914387970522], ["Iterator[Any]", 0.16182140948713414], ["Optional[bytes]", 0.10387386473242623], ["bytes", 0.07975496826598413]], "public_key_raw": [["str", 0.5433759901930211], ["Dict[str, str]", 0.12211825394411484], ["frozenset[str]", 0.08880881105991502]], "sha256hash": [["cryptography.hazmaprimitives.hashes.Hash", 0.3897378230550565], ["dict", 0.1632842822578617], ["list", 0.09009476173141491], ["str", 0.08318035997760335], ["hashlib._Hash", 0.08223249635943566]]}}], "name": "JWTGenerator", "q_name": "JWTGenerator", "variables": {"ALGORITHM": "", "LIFETIME": "", "RENEWAL_DELTA": ""}, "variables_p": {"ALGORITHM": [["str", 0.785404996629752]], "LIFETIME": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "RENEWAL_DELTA": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]]}}], "funcs": [], "imports": ["__future__", "annotations", "base64", "hashlib", "logging", "datetime", "datetime", "timedelta", "timezone", "typing", "Any", "jwt", "cryptography", "hazmat", "primitives", "serialization", "Encoding", "PublicFormat"], "mod_var_ln": {"EXPIRE_TIME": [[33, 0], [33, 11]], "ISSUER": [[32, 0], [32, 6]], "ISSUE_TIME": [[34, 0], [34, 10]], "SUBJECT": [[35, 0], [35, 7]], "logger": [[29, 0], [29, 6]]}, "mod_var_occur": {"EXPIRE_TIME": [["payload", "ISSUER", "self", "qualified_username", "public_key_fp", "SUBJECT", "self", "qualified_username", "ISSUE_TIME", "now", "EXPIRE_TIME", "now", "self", "lifetime"]], "ISSUER": [["payload", "ISSUER", "self", "qualified_username", "public_key_fp", "SUBJECT", "self", "qualified_username", "ISSUE_TIME", "now", "EXPIRE_TIME", "now", "self", "lifetime"]], "ISSUE_TIME": [["payload", "ISSUER", "self", "qualified_username", "public_key_fp", "SUBJECT", "self", "qualified_username", "ISSUE_TIME", "now", "EXPIRE_TIME", "now", "self", "lifetime"]], "SUBJECT": [["payload", "ISSUER", "self", "qualified_username", "public_key_fp", "SUBJECT", "self", "qualified_username", "ISSUE_TIME", "now", "EXPIRE_TIME", "now", "self", "lifetime"]], "logger": [["logger", "info", "account", "user", "lifetime", "renewal_delay"], ["logger", "info", "now", "self", "renew_time"]]}, "no_types_annot": {"D": 6, "I": 0, "U": 26}, "session_id": "ODyHShkOMZUujW4cXeSSf8MIdsOcVP62fd3ERPXmB3o", "set": null, "tc": [false, null], "type_annot_cove": 0.19, "typed_seq": "", "untyped_seq": "", "variables": {"EXPIRE_TIME": "", "ISSUER": "", "ISSUE_TIME": "", "SUBJECT": "", "logger": ""}, "variables_p": {"EXPIRE_TIME": [["int", 0.31905571244290853], ["float", 0.1907830774413305], ["List[int]", 0.0926553451443339], ["Dict[str, int]", 0.0894171101052201], ["List[Optional[float]]", 0.08661988072652883]], "ISSUER": [["Dict[str, int]", 0.18641965442347563], ["Type[Dict[str, Any]]", 0.11264924707521529], ["Dict[Tuple[str, str], int]", 0.09950838997167191], ["Tuple[Literal, Literal, Literal]", 0.09793435655376125], ["bool", 0.0973860653027086], ["bytes", 0.0955014399902868], ["datetime.timedelta", 0.09368885348669691]], "ISSUE_TIME": [["int", 0.31905571244290853], ["float", 0.1907830774413305], ["List[int]", 0.0926553451443339], ["Dict[str, int]", 0.0894171101052201], ["List[Optional[float]]", 0.08661988072652883]], "SUBJECT": [["Dict[str, int]", 0.18641965442347563], ["Type[Dict[str, Any]]", 0.11264924707521529], ["Dict[Tuple[str, str], int]", 0.09950838997167191], ["Tuple[Literal, Literal, Literal]", 0.09793435655376125], ["bool", 0.0973860653027086], ["bytes", 0.0955014399902868], ["datetime.timedelta", 0.09368885348669691]], "logger": [["logging.Logger", 1.0000000000000002]]}}}