{"error": null, "response": {"classes": [{"cls_lc": [[37, 0], [42, 25]], "cls_var_ln": {"CSV": [[40, 4], [40, 7]], "JSON": [[41, 4], [41, 8]], "PARQUET": [[42, 4], [42, 11]]}, "cls_var_occur": {"CSV": [], "JSON": [], "PARQUET": []}, "funcs": [], "name": "FILE_FORMAT", "q_name": "FILE_FORMAT", "variables": {"CSV": "", "JSON": "", "PARQUET": ""}, "variables_p": {"CSV": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1], ["numpy.array", 0.1]], "JSON": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1], ["numpy.array", 0.1]], "PARQUET": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["raiden.utils.WithdrawAmount", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1], ["numpy.array", 0.1]]}}, {"cls_lc": [[54, 0], [208, 19]], "cls_var_ln": {"template_ext": [[90, 4], [90, 16]], "template_fields": [[84, 4], [84, 19]], "template_fields_renderers": [[91, 4], [91, 29]]}, "cls_var_occur": {"template_ext": [], "template_fields": [], "template_fields_renderers": []}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[96, 4], [130, 100]], "fn_var_ln": {"aws_conn_id": [[117, 8], [117, 24]], "file_format": [[128, 12], [128, 28]], "groupby_kwargs": [[122, 8], [122, 27]], "parameters": [[121, 8], [121, 23]], "pd_kwargs": [[120, 8], [120, 22]], "query": [[113, 8], [113, 18]], "replace": [[119, 8], [119, 20]], "s3_bucket": [[114, 8], [114, 22]], "s3_key": [[115, 8], [115, 19]], "sql_conn_id": [[116, 8], [116, 24]], "verify": [[118, 8], [118, 19]]}, "fn_var_occur": {"aws_conn_id": [["self", "aws_conn_id", "aws_conn_id"]], "file_format": [["self", "file_format", "FILE_FORMAT", "file_format", "upper"], ["AirflowException", "file_format"]], "groupby_kwargs": [["self", "groupby_kwargs", "groupby_kwargs"]], "parameters": [["self", "parameters", "parameters"]], "pd_kwargs": [["self", "pd_kwargs", "pd_kwargs"], ["self", "pd_kwargs"]], "query": [["self", "query", "query"]], "replace": [["self", "replace", "replace"]], "s3_bucket": [["self", "s3_bucket", "s3_bucket"]], "s3_key": [["self", "s3_key", "s3_key"]], "sql_conn_id": [["self", "sql_conn_id", "sql_conn_id"]], "verify": [["self", "verify", "verify"]]}, "name": "__init__", "params": {"aws_conn_id": "builtins.str", "file_format": "typing.Literal[\"csv\", \"json\", \"parquet\"]", "groupby_kwargs": "dict | None", "kwargs": "", "parameters": "None | Mapping | Iterable", "pd_kwargs": "dict | None", "query": "builtins.str", "replace": "builtins.bool", "s3_bucket": "builtins.str", "s3_key": "builtins.str", "self": "", "sql_conn_id": "builtins.str", "verify": "bool | str | None"}, "params_descr": {"aws_conn_id": "", "file_format": "", "groupby_kwargs": "", "kwargs": "", "parameters": "", "pd_kwargs": "", "query": "", "replace": "", "s3_bucket": "", "s3_key": "", "self": "", "sql_conn_id": "", "verify": ""}, "params_occur": {"aws_conn_id": [["self", "aws_conn_id", "aws_conn_id"]], "file_format": [["self", "file_format", "FILE_FORMAT", "file_format", "upper"], ["AirflowException", "file_format"]], "groupby_kwargs": [["self", "groupby_kwargs", "groupby_kwargs"]], "kwargs": [["super", "__init__", "kwargs"]], "parameters": [["self", "parameters", "parameters"]], "pd_kwargs": [["self", "pd_kwargs", "pd_kwargs"], ["self", "pd_kwargs"]], "query": [["self", "query", "query"]], "replace": [["self", "replace", "replace"]], "s3_bucket": [["self", "s3_bucket", "s3_bucket"]], "s3_key": [["self", "s3_key", "s3_key"]], "self": [["self", "query", "query"], ["self", "s3_bucket", "s3_bucket"], ["self", "s3_key", "s3_key"], ["self", "sql_conn_id", "sql_conn_id"], ["self", "aws_conn_id", "aws_conn_id"], ["self", "verify", "verify"], ["self", "replace", "replace"], ["self", "pd_kwargs", "pd_kwargs"], ["self", "parameters", "parameters"], ["self", "groupby_kwargs", "groupby_kwargs"], ["self", "pd_kwargs"], ["self", "file_format", "FILE_FORMAT", "file_format", "upper"]], "sql_conn_id": [["self", "sql_conn_id", "sql_conn_id"]], "verify": [["self", "verify", "verify"]]}, "params_p": {"args": [], "aws_conn_id": [["Optional[str]", 0.2446834379596728], ["str", 0.21634338688130864], ["int", 0.19071866412787297], ["Union[str, int]", 0.09535933206393649]], "file_format": [["str", 0.2954785349591202], ["bool", 0.21954837466098004], ["int", 0.19776671142365929], ["common.MechanismState", 0.0957255707101663]], "groupby_kwargs": [["int", 0.5435038170656643], ["str", 0.2725005102304252], ["List[int]", 0.08536130215429728]], "kwargs": [], "parameters": [["int", 0.5435038170656643], ["str", 0.2725005102304252], ["List[int]", 0.08536130215429728]], "pd_kwargs": [["int", 0.5435038170656643], ["str", 0.2725005102304252], ["List[int]", 0.08536130215429728]], "query": [["int", 0.5435038170656643], ["str", 0.2725005102304252], ["List[int]", 0.08536130215429728]], "replace": [["int", 0.5435038170656643], ["str", 0.2725005102304252], ["List[int]", 0.08536130215429728]], "s3_bucket": [["int", 0.5435038170656643], ["str", 0.2725005102304252], ["List[int]", 0.08536130215429728]], "s3_key": [["str", 0.31633637228597783], ["List[numpy.ndarray]", 0.13877394248450522], ["dict", 0.10526536370156403], ["T", 0.09461121401252025], ["Union[str, List[str]]", 0.08554611369575015]], "self": [], "sql_conn_id": [["int", 0.5213554896809725], ["str", 0.1652649480234551], ["Optional[List[str]]", 0.07613900876353444]], "verify": [["int", 0.5435038170656643], ["str", 0.2725005102304252], ["List[int]", 0.08536130215429728]]}, "q_name": "SqlToS3Operator.__init__", "ret_exprs": [], "ret_type": "None", "variables": {"aws_conn_id": "", "file_format": "", "groupby_kwargs": "", "parameters": "", "pd_kwargs": "", "query": "", "replace": "", "s3_bucket": "", "s3_key": "", "sql_conn_id": "", "verify": ""}, "variables_p": {"aws_conn_id": [["str", 0.8232331810796996], ["int", 0.10529550689191934], ["list", 0.07147131202838086]], "file_format": [["str", 0.7051562381936738], ["Optional[str]", 0.10252735317321117], ["int", 0.09742636019165424], ["bool", 0.09489004844146075]], "groupby_kwargs": [["List[str]", 0.2538128805801462], ["Dict[str, dict]", 0.20902357243906336], ["str", 0.12336843878678105], ["Set[str]", 0.09524705405817503], ["int", 0.08097926173708023], ["DefaultDict[Any, List[Any]]", 0.0719535814564497], ["float", 0.07036815688412944]], "parameters": [["list", 0.12130307829792868], ["nevergrad.common.Set[str]", 0.10706194863035855], ["List[str]", 0.09928533420659624], ["dict", 0.09867389592693705]], "pd_kwargs": [["List[str]", 0.24668735915364529], ["Dict[str, dict]", 0.14758605302681435], ["str", 0.12154433363842397], ["int", 0.10610274811975846], ["Set[str]", 0.10505488734624888], ["float", 0.09519859985288512], ["DefaultDict[Any, List[Any]]", 0.07277113151597502]], "query": [["str", 0.5701555690938328], ["Union[str, int]", 0.08650245059585229], ["int", 0.07833938978374952]], "replace": [["str", 0.46333460665121595], ["bool", 0.1708073538972319], ["int", 0.10220989444834963], ["Optional[int]", 0.09200931786845166], ["Dict[str, str]", 0.08629894322565541], ["List[str]", 0.0853398839090954]], "s3_bucket": [["str", 0.8199488656435532], ["Optional[str]", 0.09181426674007255]], "s3_key": [["str", 0.706534015047574], ["VT", 0.09289358421585563], ["KT", 0.09289358421585563]], "sql_conn_id": [["int", 0.5314096773347922], ["str", 0.0976297101878023], ["transfer.models.ShopID", 0.0927401531193514], ["transfer.models.StorefronID", 0.0927401531193514], ["transfer.models.ArticleID", 0.0927401531193514]], "verify": [["str", 0.30000000000000004], ["Dict[str, Any]", 0.1], ["dict", 0.1], ["int", 0.1]]}}, {"docstring": {"func": "Mutate DataFrame to set dtypes for float columns containing NaN values.", "long_descr": "Set dtype of object to str to allow for downstream transformations.", "ret": null}, "fn_lc": [[133, 4], [168, 60]], "fn_var_ln": {"notna_series": [[156, 16], [156, 28]]}, "fn_var_occur": {"notna_series": [["notna_series", "df", "col", "dropna", "values"], ["np", "equal", "notna_series", "notna_series", "astype", "int", "all"], ["np", "isclose", "notna_series", "notna_series", "astype", "int", "all"]]}, "name": "_fix_dtypes", "params": {"df": "pandas.DataFrame", "file_format": "FILE_FORMAT"}, "params_descr": {"df": "", "file_format": ""}, "params_occur": {"df": [["df", "col", "dtype", "name", "file_format"], ["df", "col", "df", "col", "astype", "str"], ["df", "col", "dtype", "name", "df", "col", "hasnans"], ["notna_series", "df", "col", "dropna", "values"], ["df", "col", "np", "where", "df", "col", "isnull", "None", "df", "col"], ["df", "col", "df", "col", "astype", "Int64Dtype"], ["df", "col", "np", "where", "df", "col", "isnull", "None", "df", "col"], ["df", "col", "df", "col", "astype", "Float64Dtype"]], "file_format": [["df", "col", "dtype", "name", "file_format"]]}, "params_p": {"args": [], "df": [["str", 0.6180524594765273], ["lightbus.transports.base.RpcMessage", 0.09108232385494983], ["models.combaai_impl.AIType", 0.09018136503176083]], "file_format": [["str", 0.7948340396871626]], "kwargs": [], "self": []}, "q_name": "SqlToS3Operator._fix_dtypes", "ret_exprs": [], "ret_type": "None", "variables": {"notna_series": ""}, "variables_p": {"notna_series": [["int", 0.20812752420701564], ["str", 0.10075411610185067], ["numpy.ndarray", 0.10064133808843188], ["float", 0.08915700224584235]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[170, 4], [189, 17]], "fn_var_ln": {"data_df": [[173, 8], [173, 15]], "file_options": [[177, 8], [177, 20]], "object_key": [[186, 16], [186, 26]], "s3_conn": [[172, 8], [172, 15]], "sql_hook": [[171, 8], [171, 16]]}, "fn_var_occur": {"data_df": [["data_df", "sql_hook", "get_pandas_df", "sql", "self", "query", "parameters", "self", "parameters"], ["self", "_fix_dtypes", "data_df", "self", "file_format"], ["self", "_partition_dataframe", "df", "data_df"]], "file_options": [["file_options", "FILE_OPTIONS_MAP", "self", "file_format"], ["NamedTemporaryFile", "mode", "file_options", "mode", "suffix", "file_options", "suffix", "tmp_file"], ["getattr", "df", "file_options", "function", "tmp_file", "name", "self", "pd_kwargs"]], "object_key": [["object_key", "self", "s3_key", "group_name", "group_name", "self", "s3_key"], ["s3_conn", "load_file", "filename", "tmp_file", "name", "key", "object_key", "bucket_name", "self", "s3_bucket", "replace", "self", "replace"]], "s3_conn": [["s3_conn", "S3Hook", "aws_conn_id", "self", "aws_conn_id", "verify", "self", "verify"], ["s3_conn", "load_file", "filename", "tmp_file", "name", "key", "object_key", "bucket_name", "self", "s3_bucket", "replace", "self", "replace"]], "sql_hook": [["sql_hook", "self", "_get_hook"], ["data_df", "sql_hook", "get_pandas_df", "sql", "self", "query", "parameters", "self", "parameters"]]}, "name": "execute", "params": {"context": "airflow.utils.context.Context", "self": ""}, "params_descr": {"context": "", "self": ""}, "params_occur": {"context": [], "self": [["sql_hook", "self", "_get_hook"], ["s3_conn", "S3Hook", "aws_conn_id", "self", "aws_conn_id", "verify", "self", "verify"], ["data_df", "sql_hook", "get_pandas_df", "sql", "self", "query", "parameters", "self", "parameters"], ["self", "log", "info"], ["self", "_fix_dtypes", "data_df", "self", "file_format"], ["file_options", "FILE_OPTIONS_MAP", "self", "file_format"], ["self", "_partition_dataframe", "df", "data_df"], ["self", "log", "info"], ["getattr", "df", "file_options", "function", "tmp_file", "name", "self", "pd_kwargs"], ["self", "log", "info"], ["object_key", "self", "s3_key", "group_name", "group_name", "self", "s3_key"], ["s3_conn", "load_file", "filename", "tmp_file", "name", "key", "object_key", "bucket_name", "self", "s3_bucket", "replace", "self", "replace"]]}, "params_p": {"args": [], "context": [["int", 0.19999999999999998], ["str", 0.19999999999999998], ["Iterable['Context']", 0.09999999999999999], ["dict", 0.09999999999999999], ["bool", 0.09999999999999999]], "kwargs": [], "self": []}, "q_name": "SqlToS3Operator.execute", "ret_exprs": [], "ret_type": "None", "variables": {"data_df": "", "file_options": "", "object_key": "", "s3_conn": "", "sql_hook": ""}, "variables_p": {"data_df": [["cmk.utils.rulesets.ruleset_matcher.RulesetMatchObject", 0.12081032638089788], ["str", 0.09777408162216594], ["List[decksite.data.models.person.Person]", 0.09227747701950335]], "file_options": [["str", 0.5975306593588856], ["Tuple[str, str, str]", 0.0990295567788609], ["list", 0.09719056923524781], ["List[str]", 0.09696993102074974]], "object_key": [["str", 0.9010123976863179], ["Set[str]", 0.09898760231368194]], "s3_conn": [["str", 0.7053741690017246], ["pendanaws.s3.S3Uri", 0.1012992958769609], ["Optional[str]", 0.09732383815135695]], "sql_hook": [["float", 0.27350376353527334], ["int", 0.2301671503751194], ["raiden.utils.Any", 0.12333061930576229]]}}, {"docstring": {"func": "Partition dataframe using pandas groupby() method.", "long_descr": null, "ret": null}, "fn_lc": [[191, 4], [198, 91]], "fn_var_ln": {"grouped_df": [[196, 12], [196, 22]]}, "fn_var_occur": {"grouped_df": [["grouped_df", "df", "groupby", "self", "groupby_kwargs"], ["grouped_df", "groups", "keys"], ["group_label", "grouped_df", "get_group", "group_label", "reset_index", "drop", "True"]]}, "name": "_partition_dataframe", "params": {"df": "pandas.DataFrame", "self": ""}, "params_descr": {"df": "", "self": ""}, "params_occur": {"df": [["grouped_df", "df", "groupby", "self", "groupby_kwargs"]], "self": [["self", "groupby_kwargs"], ["grouped_df", "df", "groupby", "self", "groupby_kwargs"]]}, "params_p": {"args": [], "df": [["int", 0.30000000000000004], ["Callable", 0.2], ["models.Question", 0.1], ["str", 0.1]], "kwargs": [], "self": []}, "q_name": "SqlToS3Operator._partition_dataframe", "ret_exprs": [], "ret_type": "typing.Iterable[builtins.tuple[builtins.str, pandas.DataFrame]]", "variables": {"grouped_df": ""}, "variables_p": {"grouped_df": []}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[200, 4], [208, 19]], "fn_var_ln": {"conn": [[202, 8], [202, 12]], "hook": [[203, 8], [203, 12]]}, "fn_var_occur": {"conn": [["conn", "BaseHook", "get_connection", "self", "sql_conn_id"], ["hook", "conn", "get_hook"]], "hook": [["hook", "conn", "get_hook"], ["callable", "getattr", "hook", "None"]]}, "name": "_get_hook", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "log", "debug", "self", "sql_conn_id"], ["conn", "BaseHook", "get_connection", "self", "sql_conn_id"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "SqlToS3Operator._get_hook", "ret_exprs": ["return hook"], "ret_type": "airflow.providers.common.sql.hooks.sql.DbApiHook", "ret_type_p": [["str", 0.19999999999999998], ["bool", 0.09999999999999999], ["pyspark.sql.SparkSession", 0.09999999999999999]], "variables": {"conn": "", "hook": ""}, "variables_p": {"conn": [["int", 0.33550163649302756], ["float", 0.18693726183239517]], "hook": [["grpy.core.models.Grouping", 0.33527779309613115], ["List[str]", 0.10054127136600911], ["List[Tuple[Any, Any]]", 0.1004484526825735]]}}], "name": "SqlToS3Operator", "q_name": "SqlToS3Operator", "variables": {"template_ext": "typing.Sequence[builtins.str]", "template_fields": "typing.Sequence[builtins.str]", "template_fields_renderers": ""}, "variables_p": {"template_ext": [["str", 0.9999999999999999]], "template_fields": [["Tuple[str, str, str, str, str, str]", 0.2857142856828355], ["Tuple[str, str, str]", 0.2857142856828355], ["Tuple[str, str, str, str]", 0.2857142856828355], ["Tuple[str, str, str, str, str]", 0.14285714284141776], ["Dict[str, str]", 7.42502725571635e-11]], "template_fields_renderers": [["Tuple[str, str, str, str, str, str]", 0.2857142856828355], ["Tuple[str, str, str]", 0.2857142856828355], ["Tuple[str, str, str, str]", 0.2857142856828355], ["Tuple[str, str, str, str, str]", 0.14285714284141776], ["Dict[str, str]", 7.42502725571635e-11]]}}], "funcs": [], "imports": ["__future__", "annotations", "enum", "collections", "namedtuple", "tempfile", "NamedTemporaryFile", "typing", "TYPE_CHECKING", "Iterable", "Literal", "Mapping", "Sequence", "airflow", "exceptions", "AirflowException", "airflow", "hooks", "base", "BaseHook", "airflow", "models", "BaseOperator", "airflow", "providers", "amazon", "aws", "hooks", "s3", "S3Hook", "airflow", "providers", "common", "sql", "hooks", "sql", "DbApiHook", "pandas", "DataFrame", "airflow", "utils", "context", "Context", "numpy", "np", "pandas", "Float64Dtype", "Int64Dtype", "airflow", "exceptions", "AirflowOptionalProviderFeatureException"], "mod_var_ln": {"FILE_OPTIONS_MAP": [[47, 0], [47, 16]], "FileOptions": [[45, 0], [45, 11]]}, "mod_var_occur": {"FILE_OPTIONS_MAP": [["file_options", "FILE_OPTIONS_MAP", "self", "file_format"]], "FileOptions": [["FILE_OPTIONS_MAP", "FILE_FORMAT", "CSV", "FileOptions", "FILE_FORMAT", "JSON", "FileOptions", "FILE_FORMAT", "PARQUET", "FileOptions"]]}, "no_types_annot": {"D": 11, "I": 0, "U": 27}, "session_id": "8fBDJnJVoyT-hPCDuUTzv08HlSzxcPi6r4xRDK9t2dM", "set": null, "tc": [false, null], "type_annot_cove": 0.29, "typed_seq": "", "untyped_seq": "", "variables": {"FILE_OPTIONS_MAP": "", "FileOptions": ""}, "variables_p": {"FILE_OPTIONS_MAP": [["str", 0.4319987979895386]], "FileOptions": [["str", 0.28206560846417106], ["bytes", 0.11770311802830682], ["int", 0.10498472561706017], ["List[str]", 0.09761954580080719]]}}}