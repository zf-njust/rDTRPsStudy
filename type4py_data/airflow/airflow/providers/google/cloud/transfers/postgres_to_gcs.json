{"error": null, "response": {"classes": [{"cls_lc": [[33, 0], [65, 38]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[42, 4], [45, 32]], "fn_var_ln": {"cursor": [[43, 8], [43, 19]], "initialized": [[45, 8], [45, 24]], "rows": [[44, 8], [44, 17]]}, "fn_var_occur": {"cursor": [["self", "cursor", "cursor"]], "initialized": [["self", "initialized", "False"]], "rows": [["self", "rows"]]}, "name": "__init__", "params": {"cursor": "", "self": ""}, "params_descr": {"cursor": "", "self": ""}, "params_occur": {"cursor": [["self", "cursor", "cursor"]], "self": [["self", "cursor", "cursor"], ["self", "rows"], ["self", "initialized", "False"]]}, "params_p": {"args": [], "cursor": [["int", 0.3], ["bool", 0.09999999999999999], ["float", 0.09999999999999999]], "kwargs": [], "self": []}, "q_name": "_PostgresServerSideCursorDecorator.__init__", "ret_exprs": [], "ret_type": "", "variables": {"cursor": "", "initialized": "", "rows": ""}, "variables_p": {"cursor": [["str", 0.30000000000000004], ["Dict[str, Any]", 0.1], ["dict", 0.1], ["int", 0.1]], "initialized": [["int", 0.6258564750569569], ["float", 0.1953714877468058]], "rows": [["List[str]", 4.6225720831502505e-11], ["float", 4.436233715006637e-11], ["int", 3.327178269945953e-11], ["\"Point\"", 2.1217797438964094e-11], ["str", 1.8996202213563427e-11]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[47, 4], [48, 19]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "__iter__", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": []}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "_PostgresServerSideCursorDecorator.__iter__", "ret_exprs": ["return self"], "ret_type": "", "ret_type_p": [["int", 6.496596076798185e-09], ["Iterable[str]", 1.299319215359637e-09], ["float", 1.299319215359637e-09]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[50, 4], [55, 36]], "fn_var_ln": {"initialized": [[54, 12], [54, 28]]}, "fn_var_occur": {"initialized": [["self", "initialized", "True"]]}, "name": "__next__", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "rows"], ["self", "rows", "pop"], ["self", "initialized", "True"], ["next", "self", "cursor"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "_PostgresServerSideCursorDecorator.__next__", "ret_exprs": ["return self.rows.pop()", "return next(self.cursor)"], "ret_type": "", "ret_type_p": [["Tuple[int, int]", 0.23507628086387827], ["float", 0.1062388548311885], ["bool", 0.10595641083070122], ["int", 0.08012237045411395]], "variables": {"initialized": ""}, "variables_p": {"initialized": [["str", 0.7702907856156962], ["bool", 0.15357069239239746]]}}, {"docstring": {"func": "Fetch first row to initialize cursor description when using server side cursor.", "long_descr": null, "ret": null}, "fn_lc": [[58, 4], [65, 38]], "fn_var_ln": {"element": [[61, 12], [61, 19]], "initialized": [[64, 12], [64, 28]]}, "fn_var_occur": {"element": [["element", "self", "cursor", "fetchone"], ["element", "None"], ["self", "rows", "append", "element"]], "initialized": [["self", "initialized"], ["self", "initialized", "True"]]}, "name": "description", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "initialized"], ["element", "self", "cursor", "fetchone"], ["self", "rows", "append", "element"], ["self", "initialized", "True"], ["self", "cursor", "description"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "_PostgresServerSideCursorDecorator.description", "ret_exprs": ["return self.cursor.description"], "ret_type": "", "ret_type_p": [["bool", 0.28729301727287565], ["int", 0.17043015436054632], ["str", 0.15485490183895723]], "variables": {"element": "", "initialized": ""}, "variables_p": {"element": [["list", 0.3052808342810773], ["List[List[Any]]", 0.09530985589307862], ["dict", 0.08955308198013524], ["Dict[str, Any]", 0.0893070938129404]], "initialized": [["Type[str]", 0.38811083392145734], ["str", 0.18381092860989895], ["List[str]", 0.09605156895167588], ["float", 0.08994759178906274]]}}], "name": "_PostgresServerSideCursorDecorator", "q_name": "_PostgresServerSideCursorDecorator", "variables": {}, "variables_p": {}}, {"cls_lc": [[68, 0], [160, 20]], "cls_var_ln": {"type_map": [[80, 4], [80, 12]], "ui_color": [[78, 4], [78, 12]]}, "cls_var_occur": {"type_map": [], "ui_color": []}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[97, 4], [108, 46]], "fn_var_ln": {"cursor_itersize": [[108, 8], [108, 28]], "postgres_conn_id": [[106, 8], [106, 29]], "use_server_side_cursor": [[107, 8], [107, 35]]}, "fn_var_occur": {"cursor_itersize": [["self", "cursor_itersize", "cursor_itersize"]], "postgres_conn_id": [["self", "postgres_conn_id", "postgres_conn_id"]], "use_server_side_cursor": [["self", "use_server_side_cursor", "use_server_side_cursor"]]}, "name": "__init__", "params": {"cursor_itersize": "", "kwargs": "", "postgres_conn_id": "", "self": "", "use_server_side_cursor": ""}, "params_descr": {"cursor_itersize": "", "kwargs": "", "postgres_conn_id": "", "self": "", "use_server_side_cursor": ""}, "params_occur": {"cursor_itersize": [["self", "cursor_itersize", "cursor_itersize"]], "kwargs": [["super", "__init__", "kwargs"]], "postgres_conn_id": [["self", "postgres_conn_id", "postgres_conn_id"]], "self": [["self", "postgres_conn_id", "postgres_conn_id"], ["self", "use_server_side_cursor", "use_server_side_cursor"], ["self", "cursor_itersize", "cursor_itersize"]], "use_server_side_cursor": [["self", "use_server_side_cursor", "use_server_side_cursor"]]}, "params_p": {"args": [], "cursor_itersize": [["str", 0.5107354128672262], ["dict", 0.09405471414503018], ["Dict[str, str]", 0.07977727138348212], ["bool", 0.07522607446108971]], "kwargs": [], "postgres_conn_id": [["Set[str]", 0.282003802506978], ["int", 0.21568535477729622], ["str", 0.18675221715195336], ["dict", 0.08835756532733277]], "self": [], "use_server_side_cursor": [["bool", 0.5249865754502335], ["str", 0.19320769433210505], ["Optional[bool]", 0.1878704868117743]]}, "q_name": "PostgresToGCSOperator.__init__", "ret_exprs": [], "ret_type": "", "variables": {"cursor_itersize": "", "postgres_conn_id": "", "use_server_side_cursor": ""}, "variables_p": {"cursor_itersize": [["str", 0.30000000000000004], ["Dict[str, Any]", 0.1], ["dict", 0.1], ["int", 0.1]], "postgres_conn_id": [["int", 0.5314096773347922], ["str", 0.0976297101878023]], "use_server_side_cursor": [["bool", 0.25706771226117897], ["dict", 0.11171164126399073], ["int", 0.0975648704546976], ["bytes", 0.09402661299766313], ["Dict[str, Any]", 0.08265205992648555], ["str", 0.08076660915810278]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[110, 4], [111, 104]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "_unique_name", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "dag_id", "self", "task_id", "uuid", "uuid4", "self", "use_server_side_cursor", "None"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "PostgresToGCSOperator._unique_name", "ret_exprs": ["return f\"{self.dag_id}__{self.task_id}__{uuid.uuid4()}\" if self.use_server_side_cursor else None"], "ret_type": "", "ret_type_p": [["str", 0.6939299462237793], ["int", 0.10176229278513274], ["Optional[str]", 0.0989924816807526]], "variables": {}, "variables_p": {}}, {"docstring": {"func": "Queries Postgres and returns a cursor to the results.", "long_descr": null, "ret": null}, "fn_lc": [[113, 4], [122, 21]], "fn_var_ln": {"conn": [[116, 8], [116, 12]], "cursor": [[117, 8], [117, 14]], "hook": [[115, 8], [115, 12]], "itersize": [[120, 12], [120, 27]]}, "fn_var_occur": {"conn": [["conn", "hook", "get_conn"], ["cursor", "conn", "cursor", "name", "self", "_unique_name"]], "cursor": [["cursor", "conn", "cursor", "name", "self", "_unique_name"], ["cursor", "execute", "self", "sql", "self", "parameters"], ["cursor", "itersize", "self", "cursor_itersize"], ["_PostgresServerSideCursorDecorator", "cursor"]], "hook": [["hook", "PostgresHook", "postgres_conn_id", "self", "postgres_conn_id"], ["conn", "hook", "get_conn"]], "itersize": [["cursor", "itersize", "self", "cursor_itersize"]]}, "name": "query", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["hook", "PostgresHook", "postgres_conn_id", "self", "postgres_conn_id"], ["cursor", "conn", "cursor", "name", "self", "_unique_name"], ["cursor", "execute", "self", "sql", "self", "parameters"], ["self", "use_server_side_cursor"], ["cursor", "itersize", "self", "cursor_itersize"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "PostgresToGCSOperator.query", "ret_exprs": ["return _PostgresServerSideCursorDecorator(cursor)", "return cursor"], "ret_type": "", "ret_type_p": [["str", 0.3999999998159836], ["int", 0.19999999999874016], ["Optional[str]", 0.1999999999079918], ["tuple", 9.114063092712005e-11], ["List[str]", 9.074835278534413e-11]], "variables": {"conn": "", "cursor": "", "hook": "", "itersize": ""}, "variables_p": {"conn": [["Dict[str, str]", 0.30351755345360387], ["str", 0.08993589595438867]], "cursor": [["Dict[str, str]", 0.4154022266691697], ["List[str]", 0.11226235946199922], ["List[Tuple[Any, Any]]", 0.10443143057163375], ["Tuple[Literal, Literal, Literal, Literal, Literal]", 0.09922779084462433], ["Dict[str, Tuple[str, Any]]", 0.0885433982426035]], "hook": [["dict", 0.2351502245983807], ["List[tuple]", 0.11878538430824558]], "itersize": [["Dict[str, str]", 0.19999999999999998], ["List[Tuple[str, str, Any]]", 0.19999999999999998], ["str", 0.19999999999999998], ["Dict[str, Union[dict, Any]]", 0.09999999999999999], ["int", 0.09999999999999999], ["List[str]", 0.09999999999999999]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[124, 4], [129, 9]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "field_to_bigquery", "params": {"field": "", "self": ""}, "params_descr": {"field": "", "self": ""}, "params_occur": {"field": [["field", "self", "type_map", "get", "field", "field"]], "self": [["field", "self", "type_map", "get", "field", "field"]]}, "params_p": {"args": [], "field": [["str", 0.09674435187199006], ["bool", 0.09121801928006755]], "kwargs": [], "self": []}, "q_name": "PostgresToGCSOperator.field_to_bigquery", "ret_exprs": ["return { \"name\": field[0], \"type\": self.type_map.get(field[1], \"STRING\"), \"mode\": \"REPEATED\" if field[1] in (1009, 1005, 1007, 1016) else \"NULLABLE\",}"], "ret_type": "builtins.dict[builtins.str, builtins.str]", "ret_type_p": [["type", 0.17071181218993808], ["Union[type, Tuple[type, ...]]", 0.15815351408700093], ["Dict[str, Any]", 0.1258720937280369], ["Mapping[str, Any]", 0.10937454738239612], ["Optional[Match]", 0.08941204181179319], ["Dict[str, Iterable[Any]]", 0.08613731075075463], ["Union[int, bytes]", 0.08475285511543666]], "variables": {}, "variables_p": {}}, {"docstring": {"func": "Takes a value from Postgres, and converts it to a value that's safe for", "long_descr": "JSON/Google Cloud Storage/BigQuery.\nTimezone aware Datetime are converted to UTC seconds.\nUnaware Datetime, Date and Time are converted to ISO formatted strings.\nDecimals are converted to floats.", "ret": null}, "fn_lc": [[131, 4], [160, 20]], "fn_var_ln": {"formatted_time": [[151, 12], [151, 26]], "iso_format_value": [[144, 12], [144, 28]], "time_delta": [[152, 12], [152, 22]]}, "fn_var_occur": {"formatted_time": [["formatted_time", "time", "strptime", "str", "value"], ["time_delta", "datetime", "timedelta", "hours", "formatted_time", "tm_hour", "minutes", "formatted_time", "tm_min", "seconds", "formatted_time", "tm_sec"]], "iso_format_value": [["iso_format_value", "value", "isoformat"], ["pendulum", "parse", "iso_format_value", "float_timestamp"]], "time_delta": [["time_delta", "datetime", "timedelta", "hours", "formatted_time", "tm_hour", "minutes", "formatted_time", "tm_min", "seconds", "formatted_time", "tm_sec"], ["str", "time_delta"]]}, "name": "convert_type", "params": {"schema_type": "", "self": "", "stringify_dict": "", "value": ""}, "params_descr": {"schema_type": "BigQuery data type.", "self": "", "stringify_dict": "Specify whether to convert dict to string.", "value": "Postgres column value."}, "params_occur": {"schema_type": [], "self": [], "stringify_dict": [["stringify_dict", "isinstance", "value", "dict"]], "value": [["isinstance", "value", "datetime", "datetime"], ["iso_format_value", "value", "isoformat"], ["value", "tzinfo", "None"], ["isinstance", "value", "datetime", "date"], ["value", "isoformat"], ["isinstance", "value", "datetime", "time"], ["formatted_time", "time", "strptime", "str", "value"], ["stringify_dict", "isinstance", "value", "dict"], ["json", "dumps", "value"], ["isinstance", "value", "Decimal"], ["float", "value"]]}, "params_p": {"args": [], "kwargs": [], "schema_type": [["Union[bool, Iterable[str]]", 0.30000000000000004], ["Iterable[str]", 0.2], ["bool", 0.1]], "self": [], "stringify_dict": [["Optional[str]", 0.20151216917413972], ["Dict[str, str]", 0.11302791341303516], ["int", 0.10359809165470074], ["str", 0.10231510495531329], ["Dict[str, Any]", 0.09026041954231634], ["Type", 0.0876199388540443], ["Type[T]", 0.08467951497350412]], "value": [["datetime.date", 0.18129339877671766], ["datetime.datetime", 0.17805460961065483], ["int", 0.133240654221251], ["datetime.tzinfo", 0.09567546190324226], ["Optional[datetime.tzinfo]", 0.09567546190324226], ["Optional[datetime.datetime]", 0.07776851191192594], ["AnyStr", 0.07607099555594125]]}, "q_name": "PostgresToGCSOperator.convert_type", "ret_exprs": ["return iso_format_value", "return pendulum.parse(iso_format_value).float_timestamp", "return value.isoformat()", "return str(time_delta)", "return json.dumps(value)", "return float(value)", "return value"], "ret_type": "", "ret_type_p": [["str", 0.7173392780089662], ["int", 0.18681066183245687], ["Exception", 0.09585006015857706]], "variables": {"formatted_time": "", "iso_format_value": "", "time_delta": ""}, "variables_p": {"formatted_time": [["datetime.datetime", 0.5162629152043954], ["datetime.timedelta", 0.2961987280569006], ["int", 0.18753835673870412]], "iso_format_value": [["str", 0.6771262796954338], ["dict", 0.1493694562535308], ["Dict[str, str]", 0.08742240840659748], ["Dict[str, Union[Any, Any]]", 0.08608185564443777]], "time_delta": [["datetime.timedelta", 0.8711514144129692], ["Dict[str, datetime.timedelta]", 0.06536723040665642], ["datetime.datetime.datetime", 0.06348135518037437]]}}], "name": "PostgresToGCSOperator", "q_name": "PostgresToGCSOperator", "variables": {"type_map": "", "ui_color": ""}, "variables_p": {"type_map": [["str", 0.7999999999999999], ["int", 0.09999999999999999], ["property", 0.09999999999999999]], "ui_color": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]]}}], "funcs": [], "imports": ["__future__", "annotations", "datetime", "json", "time", "uuid", "decimal", "Decimal", "pendulum", "airflow", "providers", "google", "cloud", "transfers", "sql_to_gcs", "BaseSQLToGCSOperator", "airflow", "providers", "postgres", "hooks", "postgres", "PostgresHook"], "mod_var_ln": {}, "mod_var_occur": {}, "no_types_annot": {"D": 1, "I": 0, "U": 31}, "session_id": "pMiJD-7ygc4uIjdpatlbhYA-wuV_P0Ran79vSG6d9q0", "set": null, "tc": [false, null], "type_annot_cove": 0.03, "typed_seq": "", "untyped_seq": "", "variables": {}, "variables_p": {}}}