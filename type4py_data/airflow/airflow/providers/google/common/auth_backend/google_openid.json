{"error": null, "response": {"classes": [], "funcs": [{"docstring": {"func": "Create a HTTP authorized client.", "long_descr": null, "ret": null}, "fn_lc": [[42, 0], [51, 62]], "fn_var_ln": {"id_token_credentials": [[50, 8], [50, 28]], "service_account_path": [[44, 4], [44, 24]]}, "fn_var_occur": {"id_token_credentials": [["id_token_credentials", "service_account", "IDTokenCredentials", "from_service_account_file", "service_account_path"], ["id_token_credentials", "get_default_id_token_credentials", "target_audience", "AUDIENCE"], ["AuthorizedSession", "credentials", "id_token_credentials"]], "service_account_path": [["service_account_path", "conf", "get"], ["id_token_credentials", "service_account", "IDTokenCredentials", "from_service_account_file", "service_account_path"]]}, "name": "create_client_session", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "create_client_session", "ret_exprs": ["return AuthorizedSession(credentials=id_token_credentials)"], "ret_type": "", "ret_type_p": [["str", 0.5323429678227268], ["int", 0.09541467798223698], ["List[Dict[str, Any]]", 0.09221871909621494], ["List[str]", 0.09221871909621494]], "variables": {"id_token_credentials": "", "service_account_path": ""}, "variables_p": {"id_token_credentials": [["str", 0.6062241993644006], ["Optional[str]", 0.1950464836308449], ["int", 0.09352093695466585]], "service_account_path": [["str", 0.8160786738405208], ["Dict[str, Optional[str]]", 0.09624289985880162], ["List[str]", 0.08767842630067746]]}}, {"docstring": {"func": "Initializes authentication.", "long_descr": null, "ret": null}, "fn_lc": [[54, 0], [55, 37]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "init_app", "params": {"_": ""}, "params_descr": {"_": ""}, "params_occur": {"_": []}, "params_p": {"_": [["int", 1.0922926244888866e-10], ["logging.Logger", 1.0922926244888866e-10]], "args": [], "kwargs": []}, "q_name": "init_app", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[58, 0], [70, 19]], "fn_var_ln": {"authorization_header": [[59, 4], [59, 24]], "authorization_header_parts": [[64, 4], [64, 30]], "id_token": [[69, 4], [69, 12]]}, "fn_var_occur": {"authorization_header": [["authorization_header", "request", "headers", "get"], ["authorization_header_parts", "authorization_header", "split"]], "authorization_header_parts": [["authorization_header_parts", "authorization_header", "split"], ["len", "authorization_header_parts", "authorization_header_parts", "lower"], ["id_token", "authorization_header_parts"]], "id_token": [["id_token", "authorization_header_parts"]]}, "name": "_get_id_token_from_request", "params": {"request": ""}, "params_descr": {"request": ""}, "params_occur": {"request": [["authorization_header", "request", "headers", "get"]]}, "params_p": {"args": [], "kwargs": [], "request": [["starlette.requests.Request", 0.07860736125148737], ["jj.requests.Request", 0.07551848984801277]]}, "q_name": "_get_id_token_from_request", "ret_exprs": ["return None", "return None", "return id_token"], "ret_type": "str | None", "ret_type_p": [["Dict[str, Any]", 0.18887482235449046], ["Optional[dict]", 0.12558472344871094], ["Dict[Any, bool]", 0.10539146867610392], ["Optional[str]", 0.08928448363573768]], "variables": {"authorization_header": "", "authorization_header_parts": "", "id_token": ""}, "variables_p": {"authorization_header": [["Dict[str, str]", 0.6615999107512538], ["str", 0.18053500886881135]], "authorization_header_parts": [["str", 0.3835647179836822], ["Dict[str, str]", 0.2887270392841256], ["Set[str]", 0.21631945446069975], ["List[str]", 0.11138878827149258]], "id_token": [["str", 0.6769047943493137], ["List[str]", 0.10250947152293194], ["int", 0.0938113186177765]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[73, 0], [89, 31]], "fn_var_ln": {"id_info": [[76, 8], [76, 15]], "request_adapter": [[75, 8], [75, 23]]}, "fn_var_occur": {"id_info": [["id_info", "google", "oauth2", "id_token", "verify_token", "id_token", "request_adapter", "AUDIENCE"], ["id_info", "get", "_GOOGLE_ISSUERS"], ["id_info", "get", "False"], ["id_info", "get"]], "request_adapter": [["request_adapter", "google", "auth", "transport", "requests", "Request"], ["id_info", "google", "oauth2", "id_token", "verify_token", "id_token", "request_adapter", "AUDIENCE"]]}, "name": "_verify_id_token", "params": {"id_token": "builtins.str"}, "params_descr": {"id_token": ""}, "params_occur": {"id_token": [["id_info", "google", "oauth2", "id_token", "verify_token", "id_token", "request_adapter", "AUDIENCE"]]}, "params_p": {"args": [], "id_token": [["str", 0.6237619253566191], ["int", 0.0976219911769871], ["Optional[str]", 0.083004444509994]], "kwargs": []}, "q_name": "_verify_id_token", "ret_exprs": ["return None", "return None", "return None", "return id_info.get(\"email\")"], "ret_type": "str | None", "ret_type_p": [["int", 0.18455214741446696], ["Iterable[T]", 0.11169354193411221], ["Dict[str, Any]", 0.10105177179265437], ["dict", 0.09400279537472124], ["Optional[Dict[str, Any]]", 0.08971861871335891]], "variables": {"id_info": "", "request_adapter": ""}, "variables_p": {"id_info": [["str", 0.29250941898753136], ["Dict[Optional[str], Any]", 0.11708998090239164], ["rtv.extractors.common.Extractor", 0.10727389749303054], ["Dict[str, Any]", 0.09517475812835083], ["Dict[str, int]", 0.09321637329426438], ["List[Tuple[str, bytes]]", 0.0926946901481851]], "request_adapter": [["Optional[Dict[str, Any]]", 0.28074319099179246], ["Dict[str, Any]", 0.18889750070628245], ["int", 0.0952715954114252]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[92, 0], [102, 15]], "fn_var_ln": {"security_manager": [[93, 4], [93, 20]], "user": [[94, 4], [94, 8]]}, "fn_var_occur": {"security_manager": [["security_manager", "current_app", "appbuilder", "sm"], ["user", "security_manager", "find_user", "email", "user_email"]], "user": [["user", "security_manager", "find_user", "email", "user_email"], ["user", "is_active"]]}, "name": "_lookup_user", "params": {"user_email": "builtins.str"}, "params_descr": {"user_email": ""}, "params_occur": {"user_email": [["user", "security_manager", "find_user", "email", "user_email"]]}, "params_p": {"args": [], "kwargs": [], "user_email": [["str", 0.596351113195702], ["Optional[str]", 0.09643040280640693]]}, "q_name": "_lookup_user", "ret_exprs": ["return None", "return None", "return user"], "ret_type": "", "ret_type_p": [["Optional[bool]", 0.2233059855227817], ["Optional[int]", 0.19233385948596152], ["Optional[str]", 0.19121722717726453], ["Optional[float]", 0.09080831888273475]], "variables": {"security_manager": "", "user": ""}, "variables_p": {"security_manager": [["str", 0.5647396992465314], ["raiden.utils.PaymentID", 0.17430367509217048]], "user": [["Dict[str, Union[int, str]]", 0.09659122008359651], ["Dict[str, Dict[str, Any]]", 0.09485672360044393]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[105, 0], [106, 77]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "_set_current_user", "params": {"user": ""}, "params_descr": {"user": ""}, "params_occur": {"user": [["current_app", "appbuilder", "sm", "lm", "_update_request_context_with_user", "user", "user"]]}, "params_p": {"args": [], "kwargs": [], "user": [["List[int]", 0.12058515403630515]]}, "q_name": "_set_current_user", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[116, 4], [137, 40]], "fn_var_ln": {"access_token": [[117, 8], [117, 20]], "user": [[129, 8], [129, 12]], "userid": [[122, 8], [122, 14]]}, "fn_var_occur": {"access_token": [["access_token", "_get_id_token_from_request", "flask_request"], ["userid", "_verify_id_token", "access_token"]], "user": [["user", "_lookup_user", "userid"], ["log", "debug", "user"], ["_set_current_user", "user"]], "userid": [["userid", "_verify_id_token", "access_token"], ["log", "debug", "userid"], ["user", "_lookup_user", "userid"]]}, "name": "decorated", "params": {"args": "", "kwargs": ""}, "params_descr": {"args": "", "kwargs": ""}, "params_occur": {"args": [["function", "args", "kwargs"]], "kwargs": [["function", "args", "kwargs"]]}, "params_p": {"args": [], "kwargs": []}, "q_name": "requires_authentication.<locals>.decorated", "ret_exprs": ["return Response(\"Forbidden\", 403)", "return Response(\"Forbidden\", 403)", "return Response(\"Forbidden\", 403)", "return function(*args, **kwargs)"], "ret_type": "", "ret_type_p": [["Dict[str, Any]", 0.1952520244005227], ["str", 0.10614925281755991], ["int", 0.09778855294003329], ["dict", 0.09752756094030433]], "variables": {"access_token": "", "user": "", "userid": ""}, "variables_p": {"access_token": [["str", 0.5289918078137866], ["Optional[str]", 0.19763392173101477], ["int", 0.11124025045126013], ["raiden.utils.TokenAddress", 0.08601291351893815]], "user": [["Dict[str, str]", 0.2506824764546719], ["int", 0.09997610394196461]], "userid": [["dict", 0.2364278803671931], ["list", 0.08644981729882396]]}}, {"docstring": {"func": "Decorator for functions that require authentication.", "long_descr": null, "ret": null}, "fn_lc": [[112, 0], [139, 29]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "requires_authentication", "params": {"function": "T"}, "params_descr": {"function": ""}, "params_occur": {"function": []}, "params_p": {"args": [], "function": [["Callable", 0.2], ["bool", 0.1], ["vimiv.utils.customtypes.FuncT", 0.1], ["Callable[[T], Any]", 0.1]], "kwargs": []}, "q_name": "requires_authentication", "ret_exprs": ["return cast(T, decorated)"], "ret_type": "", "ret_type_p": [["str", 0.09030972048965474]], "variables": {}, "variables_p": {}}], "imports": ["__future__", "annotations", "logging", "functools", "wraps", "typing", "Callable", "TypeVar", "cast", "google", "google.auth.transport.requests", "google.oauth2.id_token", "flask", "Response", "current_app", "request", "flask_request", "google", "auth", "exceptions", "google", "auth", "transport", "requests", "AuthorizedSession", "google", "oauth2", "service_account", "airflow", "configuration", "conf", "airflow", "providers", "google", "common", "utils", "id_token_credentials", "get_default_id_token_credentials"], "mod_var_ln": {"AUDIENCE": [[39, 0], [39, 8]], "T": [[109, 0], [109, 1]], "_GOOGLE_ISSUERS": [[38, 0], [38, 15]], "log": [[36, 0], [36, 3]]}, "mod_var_occur": {"AUDIENCE": [["id_token_credentials", "get_default_id_token_credentials", "target_audience", "AUDIENCE"], ["id_info", "google", "oauth2", "id_token", "verify_token", "id_token", "request_adapter", "AUDIENCE"]], "T": [["cast", "T", "decorated"]], "_GOOGLE_ISSUERS": [["id_info", "get", "_GOOGLE_ISSUERS"]], "log": [["log", "debug"], ["log", "debug"], ["log", "debug", "userid"], ["log", "debug", "user"]]}, "no_types_annot": {"D": 5, "I": 0, "U": 27}, "session_id": "1cDTztIaSOkwSLGUj2wSqS1UcLr769PVHaUR6rgTCpo", "set": null, "tc": [false, null], "type_annot_cove": 0.16, "typed_seq": "", "untyped_seq": "", "variables": {"AUDIENCE": "", "T": "", "_GOOGLE_ISSUERS": "", "log": ""}, "variables_p": {"AUDIENCE": [["Optional[dict]", 0.36684988604341906]], "T": [["str", 0.5979074089625228], ["float", 0.13184430808531328], ["Pattern[str]", 0.08921733463801028]], "_GOOGLE_ISSUERS": [["frozenset[str]", 0.9999999997440364], ["str", 8.269983915792773e-11], ["Dict[str, str]", 5.425967770706501e-11], ["Dict[str, Union[Any, Any, Any, Any]]", 3.195303574281044e-11], ["int", 2.993813089642844e-11], ["dict", 2.768944205661231e-11]], "log": [["logging.Logger", 1.0000000000000002]]}}}