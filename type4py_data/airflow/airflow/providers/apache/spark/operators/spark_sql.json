{"error": null, "response": {"classes": [{"cls_lc": [[29, 0], [120, 9]], "cls_var_ln": {"template_ext": [[56, 4], [56, 16]], "template_fields": [[55, 4], [55, 19]], "template_fields_renderers": [[57, 4], [57, 29]]}, "cls_var_occur": {"template_ext": [], "template_fields": [], "template_fields_renderers": []}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[59, 4], [91, 46]], "fn_var_ln": {"_conf": [[79, 8], [79, 18]], "_conn_id": [[80, 8], [80, 21]], "_executor_cores": [[82, 8], [82, 28]], "_executor_memory": [[83, 8], [83, 29]], "_hook": [[91, 8], [91, 18]], "_keytab": [[84, 8], [84, 20]], "_master": [[86, 8], [86, 20]], "_name": [[87, 8], [87, 18]], "_num_executors": [[88, 8], [88, 27]], "_principal": [[85, 8], [85, 23]], "_sql": [[78, 8], [78, 17]], "_total_executor_cores": [[81, 8], [81, 34]], "_verbose": [[89, 8], [89, 21]], "_yarn_queue": [[90, 8], [90, 24]]}, "fn_var_occur": {"_conf": [["self", "_conf", "conf"]], "_conn_id": [["self", "_conn_id", "conn_id"]], "_executor_cores": [["self", "_executor_cores", "executor_cores"]], "_executor_memory": [["self", "_executor_memory", "executor_memory"]], "_hook": [["self", "_hook", "SparkSqlHook", "None", "None"]], "_keytab": [["self", "_keytab", "keytab"]], "_master": [["self", "_master", "master"]], "_name": [["self", "_name", "name"]], "_num_executors": [["self", "_num_executors", "num_executors"]], "_principal": [["self", "_principal", "principal"]], "_sql": [["self", "_sql", "sql"]], "_total_executor_cores": [["self", "_total_executor_cores", "total_executor_cores"]], "_verbose": [["self", "_verbose", "verbose"]], "_yarn_queue": [["self", "_yarn_queue", "yarn_queue"]]}, "name": "__init__", "params": {"conf": "str | None", "conn_id": "builtins.str", "executor_cores": "int | None", "executor_memory": "str | None", "keytab": "str | None", "kwargs": "typing.Any", "master": "str | None", "name": "builtins.str", "num_executors": "int | None", "principal": "str | None", "self": "", "sql": "builtins.str", "total_executor_cores": "int | None", "verbose": "builtins.bool", "yarn_queue": "str | None"}, "params_descr": {"conf": "", "conn_id": "", "executor_cores": "", "executor_memory": "", "keytab": "", "kwargs": "", "master": "", "name": "", "num_executors": "", "principal": "", "self": "", "sql": "", "total_executor_cores": "", "verbose": "", "yarn_queue": ""}, "params_occur": {"conf": [["self", "_conf", "conf"]], "conn_id": [["self", "_conn_id", "conn_id"]], "executor_cores": [["self", "_executor_cores", "executor_cores"]], "executor_memory": [["self", "_executor_memory", "executor_memory"]], "keytab": [["self", "_keytab", "keytab"]], "kwargs": [["super", "__init__", "kwargs"]], "master": [["self", "_master", "master"]], "name": [["self", "_name", "name"]], "num_executors": [["self", "_num_executors", "num_executors"]], "principal": [["self", "_principal", "principal"]], "self": [["self", "_sql", "sql"], ["self", "_conf", "conf"], ["self", "_conn_id", "conn_id"], ["self", "_total_executor_cores", "total_executor_cores"], ["self", "_executor_cores", "executor_cores"], ["self", "_executor_memory", "executor_memory"], ["self", "_keytab", "keytab"], ["self", "_principal", "principal"], ["self", "_master", "master"], ["self", "_name", "name"], ["self", "_num_executors", "num_executors"], ["self", "_verbose", "verbose"], ["self", "_yarn_queue", "yarn_queue"], ["self", "_hook", "SparkSqlHook", "None", "None"]], "sql": [["self", "_sql", "sql"]], "total_executor_cores": [["self", "_total_executor_cores", "total_executor_cores"]], "verbose": [["self", "_verbose", "verbose"]], "yarn_queue": [["self", "_yarn_queue", "yarn_queue"]]}, "params_p": {"args": [], "conf": [["str", 0.5041136359259604], ["Dict[str, str]", 0.25231738015924393], ["int", 0.06145495206482888]], "conn_id": [["str", 0.567399686597869], ["Set[int]", 0.17125345339089737], ["int", 0.13165218376808602], ["Optional[int]", 0.07382678691200646]], "executor_cores": [["str", 0.6034229198509071], ["int", 0.2079082169858063]], "executor_memory": [["str", 0.6034229198509071], ["int", 0.2079082169858063]], "keytab": [["str", 0.5041136359259604], ["Dict[str, str]", 0.25231738015924393], ["int", 0.06145495206482888]], "kwargs": [], "master": [["str", 0.5041136359259604], ["Dict[str, str]", 0.25231738015924393], ["int", 0.06145495206482888]], "name": [["bool", 0.3815613615939374], ["str", 0.2069043406172515], ["float", 0.10820943404464158], ["List[Dict]", 0.0930148618813372]], "num_executors": [["int", 0.5606081188344241], ["str", 0.12815100567203036], ["Optional[int]", 0.11280409335318575]], "principal": [["str", 0.5041136359259604], ["Dict[str, str]", 0.25231738015924393], ["int", 0.06145495206482888]], "self": [], "sql": [["str", 0.5041136359259604], ["Dict[str, str]", 0.25231738015924393], ["int", 0.06145495206482888]], "total_executor_cores": [["str", 0.5041136359259604], ["Dict[str, str]", 0.25231738015924393], ["int", 0.06145495206482888]], "verbose": [["str", 0.5041136359259604], ["Dict[str, str]", 0.25231738015924393], ["int", 0.06145495206482888]], "yarn_queue": [["str", 0.3996873462556446], ["Optional[Exception]", 0.11023681234794783], ["List[Tuple[str, ...]]", 0.08931631584573851], ["Dict[str, str]", 0.08791609982639828]]}, "q_name": "SparkSqlOperator.__init__", "ret_exprs": [], "ret_type": "None", "variables": {"_conf": "", "_conn_id": "", "_executor_cores": "", "_executor_memory": "", "_hook": "SparkSqlHook | None", "_keytab": "", "_master": "", "_name": "", "_num_executors": "", "_principal": "", "_sql": "", "_total_executor_cores": "", "_verbose": "", "_yarn_queue": ""}, "variables_p": {"_conf": [["str", 0.30000000000000004], ["Dict[str, Any]", 0.1], ["dict", 0.1], ["int", 0.1]], "_conn_id": [["str", 0.47047988680775443], ["int", 0.33625919028958395], ["transfer.models.ShopID", 0.0880659743786638]], "_executor_cores": [["int", 0.6922190101077176], ["str", 0.3077809898922824]], "_executor_memory": [["int", 0.6922190101077176], ["str", 0.3077809898922824]], "_hook": [["Tuple[str, str, str, str, str]", 0.1318155759179803], ["Tuple[str, str, str]", 0.1318155759179803], ["list", 0.08777539339322782], ["Tuple[int]", 0.08644030632165049], ["int", 0.08585005294732836]], "_keytab": [["str", 0.30000000000000004], ["Dict[str, Any]", 0.1], ["dict", 0.1], ["int", 0.1]], "_master": [["str", 0.30000000000000004], ["Dict[str, Any]", 0.1], ["dict", 0.1], ["int", 0.1]], "_name": [["str", 0.9999999999637337], ["Dict[str, str]", 3.626623568486625e-11]], "_num_executors": [["int", 0.7896996488643415], ["float", 0.1104000621244321], ["Dict[float, float]", 0.09990028901122668]], "_principal": [["str", 0.30000000000000004], ["Dict[str, Any]", 0.1], ["dict", 0.1], ["int", 0.1]], "_sql": [["str", 0.30000000000000004], ["Dict[str, Any]", 0.1], ["dict", 0.1], ["int", 0.1]], "_total_executor_cores": [["str", 0.30000000000000004], ["Dict[str, Any]", 0.1], ["dict", 0.1], ["int", 0.1]], "_verbose": [["bool", 0.4273429380360943], ["List[bool]", 0.12317236579973947], ["list", 0.09048816066553682], ["int", 0.09037484399750441]], "_yarn_queue": [["str", 3.5753637405843682e-12], ["TextIO", 2.0905421602266784e-12]]}}, {"docstring": {"func": "Call the SparkSqlHook to run the provided sql query.", "long_descr": null, "ret": null}, "fn_lc": [[93, 4], [97, 30]], "fn_var_ln": {"_hook": [[96, 12], [96, 22]]}, "fn_var_occur": {"_hook": [["self", "_hook", "None"], ["self", "_hook", "self", "_get_hook"], ["self", "_hook", "run_query"]]}, "name": "execute", "params": {"context": "airflow.utils.context.Context", "self": ""}, "params_descr": {"context": "", "self": ""}, "params_occur": {"context": [], "self": [["self", "_hook", "None"], ["self", "_hook", "self", "_get_hook"], ["self", "_hook", "run_query"]]}, "params_p": {"args": [], "context": [["int", 0.19999999999999998], ["str", 0.19999999999999998], ["Iterable['Context']", 0.09999999999999999], ["dict", 0.09999999999999999], ["bool", 0.09999999999999999]], "kwargs": [], "self": []}, "q_name": "SparkSqlOperator.execute", "ret_exprs": [], "ret_type": "None", "variables": {"_hook": ""}, "variables_p": {"_hook": [["dict", 0.18792598909616384], ["Coroutine[Any, Any, Any]", 0.161746893302874]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[99, 4], [102, 25]], "fn_var_ln": {"_hook": [[101, 12], [101, 22]]}, "fn_var_occur": {"_hook": [["self", "_hook", "None"], ["self", "_hook", "self", "_get_hook"], ["self", "_hook", "kill"]]}, "name": "on_kill", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "_hook", "None"], ["self", "_hook", "self", "_get_hook"], ["self", "_hook", "kill"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "SparkSqlOperator.on_kill", "ret_exprs": [], "ret_type": "None", "variables": {"_hook": ""}, "variables_p": {"_hook": [["int", 0.45849463054758494], ["float", 0.11308770631356528]]}}, {"docstring": {"func": "Get SparkSqlHook.", "long_descr": null, "ret": null}, "fn_lc": [[104, 4], [120, 9]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "_get_hook", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["SparkSqlHook", "sql", "self", "_sql", "conf", "self", "_conf", "conn_id", "self", "_conn_id", "total_executor_cores", "self", "_total_executor_cores", "executor_cores", "self", "_executor_cores", "executor_memory", "self", "_executor_memory", "keytab", "self", "_keytab", "principal", "self", "_principal", "name", "self", "_name", "num_executors", "self", "_num_executors", "master", "self", "_master", "verbose", "self", "_verbose", "yarn_queue", "self", "_yarn_queue"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "SparkSqlOperator._get_hook", "ret_exprs": ["return SparkSqlHook( sql=self._sql, conf=self._conf, conn_id=self._conn_id, total_executor_cores=self._total_executor_cores, executor_cores=self._executor_cores, executor_memory=self._executor_memory, keytab=self._keytab, principal=self._principal, name=self._name, num_executors=self._num_executors, master=self._master, verbose=self._verbose, yarn_queue=self._yarn_queue,)"], "ret_type": "airflow.providers.apache.spark.hooks.spark_sql.SparkSqlHook", "ret_type_p": [["str", 0.19999999999999998], ["bool", 0.09999999999999999]], "variables": {}, "variables_p": {}}], "name": "SparkSqlOperator", "q_name": "SparkSqlOperator", "variables": {"template_ext": "typing.Sequence[builtins.str]", "template_fields": "typing.Sequence[builtins.str]", "template_fields_renderers": ""}, "variables_p": {"template_ext": [["str", 0.9999999999999999]], "template_fields": [["Tuple[str, str, str, str, str, str]", 0.2857142856828355], ["Tuple[str, str, str]", 0.2857142856828355], ["Tuple[str, str, str, str]", 0.2857142856828355], ["Tuple[str, str, str, str, str]", 0.14285714284141776], ["Dict[str, str]", 7.42502725571635e-11]], "template_fields_renderers": [["Tuple[str, str, str, str, str, str]", 0.2857142856828355], ["Tuple[str, str, str]", 0.2857142856828355], ["Tuple[str, str, str, str]", 0.2857142856828355], ["Tuple[str, str, str, str, str]", 0.14285714284141776], ["Dict[str, str]", 7.42502725571635e-11]]}}], "funcs": [], "imports": ["__future__", "annotations", "typing", "TYPE_CHECKING", "Any", "Sequence", "airflow", "models", "BaseOperator", "airflow", "providers", "apache", "spark", "hooks", "spark_sql", "SparkSqlHook", "airflow", "utils", "context", "Context"], "mod_var_ln": {}, "mod_var_occur": {}, "no_types_annot": {"D": 22, "I": 0, "U": 16}, "session_id": "EnI5MgXVRDvQSHE5PVx9DoVeMKcRQvX150PUDH2mBBg", "set": null, "tc": [false, null], "type_annot_cove": 0.58, "typed_seq": "", "untyped_seq": "", "variables": {}, "variables_p": {}}}