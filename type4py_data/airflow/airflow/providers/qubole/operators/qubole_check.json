{"error": null, "response": {"classes": [{"cls_lc": [[28, 0], [54, 9]], "cls_var_ln": {"kwargs": [[31, 4], [31, 10]], "results_parser_callable": [[32, 4], [32, 27]]}, "cls_var_occur": {"kwargs": [], "results_parser_callable": []}, "funcs": [{"docstring": {"func": "Execute a check operation against Qubole.", "long_descr": null, "ret": null}, "fn_lc": [[34, 4], [40, 56]], "fn_var_ln": {"_hook_context": [[37, 12], [37, 30]]}, "fn_var_occur": {"_hook_context": [["self", "_hook_context", "context"]]}, "name": "execute", "params": {"context": "", "self": ""}, "params_descr": {"context": "", "self": ""}, "params_occur": {"context": [["self", "_hook_context", "context"], ["super", "execute", "context", "context"]], "self": [["self", "_hook_context", "context"], ["handle_airflow_exception", "e", "self", "get_hook"]]}, "params_p": {"args": [], "context": [], "kwargs": [], "self": []}, "q_name": "_QuboleCheckOperatorMixin.execute", "ret_exprs": [], "ret_type": "None", "variables": {"_hook_context": ""}, "variables_p": {"_hook_context": []}}, {"docstring": {"func": "Get QuboleCheckHook.", "long_descr": null, "ret": null}, "fn_lc": [[42, 4], [44, 30]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "get_db_hook", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "get_hook"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "_QuboleCheckOperatorMixin.get_db_hook", "ret_exprs": ["return self.get_hook()"], "ret_type": "airflow.providers.qubole.hooks.qubole_check.QuboleCheckHook", "ret_type_p": [["bool", 0.4877507543990785], ["str", 0.12208523564660587]], "variables": {}, "variables_p": {}}, {"docstring": {"func": "Reinitialising the hook, as some template fields might have changed.", "long_descr": "This method overwrites the original QuboleOperator.get_hook() which returns a QuboleHook.", "ret": null}, "fn_lc": [[46, 4], [54, 9]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "get_hook", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["QuboleCheckHook", "context", "self", "_hook_context", "results_parser_callable", "self", "results_parser_callable", "self", "kwargs"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "_QuboleCheckOperatorMixin.get_hook", "ret_exprs": ["return QuboleCheckHook( context=self._hook_context, results_parser_callable=self.results_parser_callable, **self.kwargs)"], "ret_type": "airflow.providers.qubole.hooks.qubole_check.QuboleCheckHook", "ret_type_p": [["int", 0.1724502779771154], ["bytes", 0.15576025099631852]], "variables": {}, "variables_p": {}}], "name": "_QuboleCheckOperatorMixin", "q_name": "_QuboleCheckOperatorMixin", "variables": {"kwargs": "builtins.dict", "results_parser_callable": "Callable | None"}, "variables_p": {"kwargs": [["dict", 0.30000000000000004], ["Mapping", 0.2], ["Mapping[str, Any]", 0.1], ["Dict[str, int]", 0.1], ["Dict[str, Any]", 0.1], ["Mapping[Any, Any]", 0.1], ["Dict[str, Literal]", 0.1]], "results_parser_callable": [["str", 0.2544426953105654], ["bool", 0.08481423177018847], ["int", 0.08481423177018847]]}}, {"cls_lc": [[57, 0], [125, 33]], "cls_var_ln": {"template_ext": [[109, 4], [109, 16]], "template_fields": [[106, 4], [106, 19]], "ui_fgcolor": [[110, 4], [110, 14]]}, "cls_var_occur": {"template_ext": [], "template_fields": [], "ui_fgcolor": []}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[112, 4], [125, 33]], "fn_var_ln": {"_hook_context": [[125, 8], [125, 26]], "on_failure_callback": [[123, 8], [123, 32]], "on_retry_callback": [[124, 8], [124, 30]], "results_parser_callable": [[122, 8], [122, 36]], "sql": [[119, 8], [119, 11]]}, "fn_var_occur": {"_hook_context": [["self", "_hook_context", "None"]], "on_failure_callback": [["self", "on_failure_callback", "QuboleCheckHook", "handle_failure_retry"]], "on_retry_callback": [["self", "on_retry_callback", "QuboleCheckHook", "handle_failure_retry"]], "results_parser_callable": [["self", "results_parser_callable", "results_parser_callable"]], "sql": [["sql", "get_sql_from_qbol_cmd", "kwargs"], ["super", "__init__", "qubole_conn_id", "qubole_conn_id", "sql", "sql", "kwargs"]]}, "name": "__init__", "params": {"kwargs": "", "qubole_conn_id": "builtins.str", "results_parser_callable": "Callable | None", "self": ""}, "params_descr": {"kwargs": "", "qubole_conn_id": "", "results_parser_callable": "", "self": ""}, "params_occur": {"kwargs": [["sql", "get_sql_from_qbol_cmd", "kwargs"], ["kwargs", "pop", "None"], ["super", "__init__", "qubole_conn_id", "qubole_conn_id", "sql", "sql", "kwargs"]], "qubole_conn_id": [["super", "__init__", "qubole_conn_id", "qubole_conn_id", "sql", "sql", "kwargs"]], "results_parser_callable": [["self", "results_parser_callable", "results_parser_callable"]], "self": [["self", "results_parser_callable", "results_parser_callable"], ["self", "on_failure_callback", "QuboleCheckHook", "handle_failure_retry"], ["self", "on_retry_callback", "QuboleCheckHook", "handle_failure_retry"], ["self", "_hook_context", "None"]]}, "params_p": {"args": [], "kwargs": [], "qubole_conn_id": [["str", 0.29803935893746686], ["Optional[str]", 0.20024815793236864], ["bool", 0.1003424966260329], ["dict", 0.1003424966260329]], "results_parser_callable": [["Callable[[Optional, Optional, str], None]", 0.19103821995195647], ["Optional[Callable[[Dict], Any]]", 0.1271250377057431]], "self": []}, "q_name": "QuboleCheckOperator.__init__", "ret_exprs": [], "ret_type": "None", "variables": {"_hook_context": "", "on_failure_callback": "", "on_retry_callback": "", "results_parser_callable": "", "sql": ""}, "variables_p": {"_hook_context": [["Callable", 0.18819020031990213], ["Optional[str]", 0.18077895504420288], ["thonny.common.CommandToBackend", 0.09120743460917065]], "on_failure_callback": [["str", 0.30000000000000004], ["Dict[str, Any]", 0.1], ["dict", 0.1], ["int", 0.1]], "on_retry_callback": [["str", 0.30000000000000004], ["Dict[str, Any]", 0.1], ["dict", 0.1], ["int", 0.1]], "results_parser_callable": [["Dict[str, str]", 0.21994219089244116], ["str", 0.21134059449891307], ["List[str]", 0.20198527585631215], ["Dict[str, List[str]]", 0.10168482418438742], ["bool", 0.07987732901921973]], "sql": [["int", 0.10575562912575606], ["Tuple[int]", 0.09725507662441295], ["float", 0.09162505288920661]]}}], "name": "QuboleCheckOperator", "q_name": "QuboleCheckOperator", "variables": {"template_ext": "", "template_fields": "typing.Sequence[builtins.str]", "ui_fgcolor": ""}, "variables_p": {"template_ext": [["str", 0.9999999999999999]], "template_fields": [["Tuple[str, str, str, str, str, str]", 0.2857142856828355], ["Tuple[str, str, str]", 0.2857142856828355], ["Tuple[str, str, str, str]", 0.2857142856828355], ["Tuple[str, str, str, str, str]", 0.14285714284141776], ["Dict[str, str]", 7.42502725571635e-11]], "ui_fgcolor": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]]}}, {"cls_lc": [[131, 0], [179, 33]], "cls_var_ln": {"template_ext": [[159, 4], [159, 16]], "template_fields": [[158, 4], [158, 19]], "ui_fgcolor": [[160, 4], [160, 14]]}, "cls_var_occur": {"template_ext": [], "template_fields": [], "ui_fgcolor": []}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[162, 4], [179, 33]], "fn_var_ln": {"_hook_context": [[179, 8], [179, 26]], "on_failure_callback": [[177, 8], [177, 32]], "on_retry_callback": [[178, 8], [178, 30]], "results_parser_callable": [[176, 8], [176, 36]], "sql": [[171, 8], [171, 11]]}, "fn_var_occur": {"_hook_context": [["self", "_hook_context", "None"]], "on_failure_callback": [["self", "on_failure_callback", "QuboleCheckHook", "handle_failure_retry"]], "on_retry_callback": [["self", "on_retry_callback", "QuboleCheckHook", "handle_failure_retry"]], "results_parser_callable": [["self", "results_parser_callable", "results_parser_callable"]], "sql": [["sql", "get_sql_from_qbol_cmd", "kwargs"], ["super", "__init__", "qubole_conn_id", "qubole_conn_id", "sql", "sql", "pass_value", "pass_value", "tolerance", "tolerance", "kwargs"]]}, "name": "__init__", "params": {"kwargs": "", "pass_value": "str | int | float", "qubole_conn_id": "builtins.str", "results_parser_callable": "Callable | None", "self": "", "tolerance": "int | float | None"}, "params_descr": {"kwargs": "", "pass_value": "", "qubole_conn_id": "", "results_parser_callable": "", "self": "", "tolerance": ""}, "params_occur": {"kwargs": [["sql", "get_sql_from_qbol_cmd", "kwargs"], ["kwargs", "pop", "None"], ["super", "__init__", "qubole_conn_id", "qubole_conn_id", "sql", "sql", "pass_value", "pass_value", "tolerance", "tolerance", "kwargs"]], "pass_value": [["super", "__init__", "qubole_conn_id", "qubole_conn_id", "sql", "sql", "pass_value", "pass_value", "tolerance", "tolerance", "kwargs"]], "qubole_conn_id": [["super", "__init__", "qubole_conn_id", "qubole_conn_id", "sql", "sql", "pass_value", "pass_value", "tolerance", "tolerance", "kwargs"]], "results_parser_callable": [["self", "results_parser_callable", "results_parser_callable"]], "self": [["self", "results_parser_callable", "results_parser_callable"], ["self", "on_failure_callback", "QuboleCheckHook", "handle_failure_retry"], ["self", "on_retry_callback", "QuboleCheckHook", "handle_failure_retry"], ["self", "_hook_context", "None"]], "tolerance": [["super", "__init__", "qubole_conn_id", "qubole_conn_id", "sql", "sql", "pass_value", "pass_value", "tolerance", "tolerance", "kwargs"]]}, "params_p": {"args": [], "kwargs": [], "pass_value": [["Optional[str]", 0.2014592593538515], ["nevergrad.common.Optional[str]", 0.09621357311741285]], "qubole_conn_id": [["Optional[str]", 0.2014592593538515], ["nevergrad.common.Optional[str]", 0.09621357311741285]], "results_parser_callable": [["bool", 0.39006836494473673], ["Dict[str, Any]", 0.10647881445864293], ["Optional[Iterable]", 0.10319357499639217], ["Optional[Dict[str, Any]]", 0.10319357499639217], ["str", 0.09424960969065578]], "self": [], "tolerance": [["Optional[str]", 0.2014592593538515], ["nevergrad.common.Optional[str]", 0.09621357311741285]]}, "q_name": "QuboleValueCheckOperator.__init__", "ret_exprs": [], "ret_type": "None", "variables": {"_hook_context": "", "on_failure_callback": "", "on_retry_callback": "", "results_parser_callable": "", "sql": ""}, "variables_p": {"_hook_context": [["Callable", 0.18819020031990213], ["Optional[str]", 0.18077895504420288], ["thonny.common.CommandToBackend", 0.09120743460917065]], "on_failure_callback": [["str", 0.30000000000000004], ["Dict[str, Any]", 0.1], ["dict", 0.1], ["int", 0.1]], "on_retry_callback": [["str", 0.30000000000000004], ["Dict[str, Any]", 0.1], ["dict", 0.1], ["int", 0.1]], "results_parser_callable": [["Dict[str, str]", 0.21994219089244116], ["str", 0.21134059449891307], ["List[str]", 0.20198527585631215], ["Dict[str, List[str]]", 0.10168482418438742], ["bool", 0.07987732901921973]], "sql": [["int", 0.31427697514494096], ["List[Dict[str, Any]]", 0.10934129029942107], ["OrderedDict", 0.09623528698999077], ["float", 0.08599592300733874]]}}], "name": "QuboleValueCheckOperator", "q_name": "QuboleValueCheckOperator", "variables": {"template_ext": "", "template_fields": "", "ui_fgcolor": ""}, "variables_p": {"template_ext": [["str", 0.9999999999999999]], "template_fields": [["Tuple[str, str, str, str, str, str]", 0.2857142856828355], ["Tuple[str, str, str]", 0.2857142856828355], ["Tuple[str, str, str, str]", 0.2857142856828355], ["Tuple[str, str, str, str, str]", 0.14285714284141776], ["Dict[str, str]", 7.42502725571635e-11]], "ui_fgcolor": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]]}}], "funcs": [{"docstring": {"func": "Get Qubole sql from Qubole command.", "long_descr": null, "ret": null}, "fn_lc": [[182, 0], [189, 14]], "fn_var_ln": {"sql": [[188, 8], [188, 11]]}, "fn_var_occur": {"sql": [["sql", "params"], ["sql", "params"]]}, "name": "get_sql_from_qbol_cmd", "params": {"params": ""}, "params_descr": {"params": ""}, "params_occur": {"params": [["sql", "params"], ["sql", "params"]]}, "params_p": {"args": [], "kwargs": [], "params": [["str", 0.7154925037689773], ["Dict[str, str]", 0.28450749623102267]]}, "q_name": "get_sql_from_qbol_cmd", "ret_exprs": ["return sql"], "ret_type": "builtins.str", "ret_type_p": [["str", 0.3999999999041128], ["bytes", 0.19999999986498648], ["int", 2.4414862119903426e-10]], "variables": {"sql": ""}, "variables_p": {"sql": [["str", 0.200000000014412], ["Dict[str, str]", 0.19999999999239113], ["Dict[str, float]", 0.19999999999239113], ["bool", 1.0162789888016678e-11], ["int", 5.860681224095067e-12]]}}, {"docstring": {"func": "Qubole check handle Airflow exception.", "long_descr": null, "ret": null}, "fn_lc": [[192, 0], [203, 50]], "fn_var_ln": {"cmd": [[194, 4], [194, 7]], "exception_message": [[199, 12], [199, 29]], "qubole_command_id": [[198, 12], [198, 29]], "qubole_command_results": [[197, 12], [197, 34]]}, "fn_var_occur": {"cmd": [["cmd", "hook", "cmd"], ["cmd", "None"], ["cmd", "is_success", "cmd", "status"], ["qubole_command_id", "cmd", "id"]], "exception_message": [["exception_message", "qubole_command_id", "qubole_command_results"], ["AirflowException", "str", "airflow_exception", "exception_message"]], "qubole_command_id": [["qubole_command_id", "cmd", "id"], ["exception_message", "qubole_command_id", "qubole_command_results"]], "qubole_command_results": [["qubole_command_results", "hook", "get_query_results"], ["exception_message", "qubole_command_id", "qubole_command_results"]]}, "name": "handle_airflow_exception", "params": {"airflow_exception": "", "hook": "airflow.providers.qubole.hooks.qubole_check.QuboleCheckHook"}, "params_descr": {"airflow_exception": "", "hook": ""}, "params_occur": {"airflow_exception": [["AirflowException", "str", "airflow_exception", "exception_message"], ["AirflowException", "str", "airflow_exception"]], "hook": [["cmd", "hook", "cmd"], ["qubole_command_results", "hook", "get_query_results"]]}, "params_p": {"airflow_exception": [["float", 0.2131224364224889], ["str", 0.09131365289665562], ["Optional[Union[str, Any]]", 0.08764173201378167]], "args": [], "hook": [["float", 0.25653829714649007], ["Optional[List[str]]", 0.0899534612137734], ["Optional[Callable]", 0.08805750864128158], ["List[Union[\"PipeChain\", str]]", 0.08473393866688533]], "kwargs": []}, "q_name": "handle_airflow_exception", "ret_exprs": [], "ret_type": "", "variables": {"cmd": "", "exception_message": "", "qubole_command_id": "", "qubole_command_results": ""}, "variables_p": {"cmd": [["Optional[str]", 0.11934828525838644], ["str", 0.08782547891130929], ["List[str]", 0.08678229740693769]], "exception_message": [["Dict[str, Any]", 0.20108227256522448], ["werkzeug.exceptions.InternalServerError", 0.11816952288809507], ["rtv.extractors.common.Extractor", 0.11347534424950252], ["str", 0.09967144267298213], ["dict", 0.09483858781326152], ["Dict[str, Tuple[str, int]]", 0.09015903888724508]], "qubole_command_id": [["int", 0.30902183042346254], ["str", 0.17043866643410932], ["Optional[int]", 0.13503942778152295], ["List[Optional[int]]", 0.07525010212360582]], "qubole_command_results": [["int", 0.29183214695474896], ["Dict[int, List[Any]]", 0.11635391947517493], ["list", 0.1023327579095316], ["Pattern[str]", 0.09535736659405909]]}}], "imports": ["__future__", "annotations", "typing", "Callable", "Sequence", "airflow", "exceptions", "AirflowException", "airflow", "providers", "common", "sql", "operators", "sql", "SQLCheckOperator", "SQLValueCheckOperator", "airflow", "providers", "qubole", "hooks", "qubole_check", "QuboleCheckHook", "airflow", "providers", "qubole", "operators", "qubole", "QuboleOperator"], "mod_var_ln": {}, "mod_var_occur": {}, "no_types_annot": {"D": 14, "I": 0, "U": 27}, "session_id": "zeMgWnBzp5SUgc24iYAWpHwBKOcZ10w6l30VxEHWhS0", "set": null, "tc": [false, null], "type_annot_cove": 0.34, "typed_seq": "", "untyped_seq": "", "variables": {}, "variables_p": {}}}