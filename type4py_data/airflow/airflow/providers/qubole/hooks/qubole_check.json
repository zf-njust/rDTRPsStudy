{"error": null, "response": {"classes": [{"cls_lc": [[78, 0], [122, 23]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[81, 4], [88, 30]], "fn_var_ln": {"context": [[88, 8], [88, 20]], "results_parser_callable": [[87, 12], [87, 40]]}, "fn_var_occur": {"context": [["self", "context", "context"]], "results_parser_callable": [["self", "results_parser_callable", "parse_first_row"], ["self", "results_parser_callable", "kwargs"]]}, "name": "__init__", "params": {"args": "", "context": "", "kwargs": "", "self": ""}, "params_descr": {"args": "", "context": "", "kwargs": "", "self": ""}, "params_occur": {"args": [["super", "__init__", "args", "kwargs"]], "context": [["self", "context", "context"]], "kwargs": [["super", "__init__", "args", "kwargs"], ["kwargs", "kwargs", "None"], ["callable", "kwargs"], ["self", "results_parser_callable", "kwargs"]], "self": [["self", "results_parser_callable", "parse_first_row"], ["self", "results_parser_callable", "kwargs"], ["self", "context", "context"]]}, "params_p": {"args": [], "context": [["int", 0.3], ["bool", 0.09999999999999999], ["float", 0.09999999999999999]], "kwargs": [], "self": []}, "q_name": "QuboleCheckHook.__init__", "ret_exprs": [], "ret_type": "None", "variables": {"context": "", "results_parser_callable": ""}, "variables_p": {"context": [["int", 0.2602696514647737], ["bytes", 0.09842961784785026]], "results_parser_callable": [["str", 0.2895876725194486], ["int", 0.2292329464428951], ["Dict[str, List[str]]", 0.09457599100951605], ["Dict[str, Dict[str, Any]]", 0.08965119613869126]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[91, 4], [100, 32]], "fn_var_ln": {"cmd": [[96, 12], [96, 15]], "cmd_id": [[93, 8], [93, 14]], "ti": [[92, 8], [92, 10]]}, "fn_var_occur": {"cmd": [["cmd", "Command", "find", "cmd_id"], ["cmd", "None"], ["cmd", "status"], ["cmd", "cancel"]], "cmd_id": [["cmd_id", "ti", "xcom_pull", "key", "task_ids", "ti", "task_id"], ["cmd_id", "None"], ["cmd", "Command", "find", "cmd_id"], ["log", "info", "cmd_id"]], "ti": [["ti", "context"], ["cmd_id", "ti", "xcom_pull", "key", "task_ids", "ti", "task_id"]]}, "name": "handle_failure_retry", "params": {"context": ""}, "params_descr": {"context": ""}, "params_occur": {"context": [["ti", "context"]]}, "params_p": {"args": [], "context": [["int", 0.30000000000000004], ["Callable", 0.2], ["str", 0.1]], "kwargs": [], "self": []}, "q_name": "QuboleCheckHook.handle_failure_retry", "ret_exprs": [], "ret_type": "None", "variables": {"cmd": "", "cmd_id": "", "ti": ""}, "variables_p": {"cmd": [["str", 0.6446539018671541], ["io.TextIOWrapper", 0.27282337815272323], ["int", 0.08252271998012244]], "cmd_id": [["str", 0.3760535824946231], ["int", 0.1134286356667368], ["list", 0.09490095215928716], ["List[str]", 0.0865384723662904]], "ti": [["str", 0.3300402105959246], ["List[str]", 0.2516672096429429], ["int", 0.08477824621541419], ["Tuple[str, str, str, str, str, str, str]", 0.08311405826890299], ["Pattern[str]", 0.08163228136166271]]}}, {"docstring": {"func": "Get Qubole query first record list.", "long_descr": null, "ret": null}, "fn_lc": [[102, 4], [108, 26]], "fn_var_ln": {"query_result": [[105, 8], [105, 20]], "record_list": [[107, 8], [107, 19]], "row_list": [[106, 8], [106, 16]]}, "fn_var_occur": {"query_result": [["query_result", "self", "get_query_results"], ["row_list", "list", "filter", "None", "query_result", "split", "ROW_DELIM"]], "record_list": [["record_list", "self", "results_parser_callable", "row_list"]], "row_list": [["row_list", "list", "filter", "None", "query_result", "split", "ROW_DELIM"], ["record_list", "self", "results_parser_callable", "row_list"]]}, "name": "get_first", "params": {"self": "", "sql": ""}, "params_descr": {"self": "", "sql": ""}, "params_occur": {"self": [["self", "execute", "context", "self", "context"], ["query_result", "self", "get_query_results"], ["record_list", "self", "results_parser_callable", "row_list"]], "sql": []}, "params_p": {"args": [], "kwargs": [], "self": [], "sql": [["bool", 0.39999999999999997], ["str", 0.39999999999999997], ["T", 0.09999999999999999], ["dict", 0.09999999999999999]]}, "q_name": "QuboleCheckHook.get_first", "ret_exprs": ["return record_list"], "ret_type": "", "ret_type_p": [["bytes", 0.2592969411602046], ["List[str]", 0.1713649311687909], ["List[Dict]", 0.1534532024963257], ["str", 0.11832173660523762], ["Union[str, List[Any]]", 0.09219011645380175], ["List[List[Any]]", 0.08705133551040185]], "variables": {"query_result": "", "record_list": "", "row_list": ""}, "variables_p": {"query_result": [["list", 0.31046179617241043], ["dict", 0.09929371215606304]], "record_list": [["list", 0.38123616088467305], ["List[Union[int, str]]", 0.12265218432897572], ["Dict[str, List[str]]", 0.11727261470418562], ["Dict[str, str]", 0.11727261470418562], ["List[str]", 0.09046065409973894], ["List[Union[Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any]]", 0.08697688172840592]], "row_list": [["list", 0.6228955045669216], ["List[str]", 0.11310897456401027], ["List[int]", 0.08750650219965005]]}}, {"docstring": {"func": "Get Qubole query result.", "long_descr": null, "ret": null}, "fn_lc": [[110, 4], [122, 23]], "fn_var_ln": {"cmd_id": [[113, 12], [113, 18]], "query_result": [[117, 12], [117, 24]], "query_result_buffer": [[115, 12], [115, 31]]}, "fn_var_occur": {"cmd_id": [["cmd_id", "self", "cmd", "id"], ["self", "log", "info", "cmd_id"]], "query_result": [["query_result", "query_result_buffer", "getvalue"]], "query_result_buffer": [["query_result_buffer", "StringIO"], ["self", "cmd", "get_results", "fp", "query_result_buffer", "inline", "True", "delim", "COL_DELIM", "arguments"], ["query_result", "query_result_buffer", "getvalue"], ["query_result_buffer", "close"]]}, "name": "get_query_results", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "cmd", "None"], ["cmd_id", "self", "cmd", "id"], ["self", "log", "info", "cmd_id"], ["self", "cmd", "get_results", "fp", "query_result_buffer", "inline", "True", "delim", "COL_DELIM", "arguments"], ["self", "log", "error"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "QuboleCheckHook.get_query_results", "ret_exprs": ["return query_result", "return None"], "ret_type": "str | None", "ret_type_p": [["str", 0.18454071277702766], ["int", 0.11670577069040841], ["Tuple[int, int]", 0.1134037990949742]], "variables": {"cmd_id": "", "query_result": "", "query_result_buffer": ""}, "variables_p": {"cmd_id": [["int", 0.9191452298336589], ["List[str]", 0.08085477016634106]], "query_result": [["List[Union[Any, Any, Any, Any, Any, Any, Any, Any]]", 0.19897592302620615], ["Dict[str, Any]", 0.18993220873223718], ["Tuple[str, str, str]", 0.12314662640649289], ["List[str]", 0.09966954019017454], ["Pattern[str]", 0.09292295056543068]], "query_result_buffer": [["DefaultDict[Any, int]", 0.0934903849906648]]}}], "name": "QuboleCheckHook", "q_name": "QuboleCheckHook", "variables": {}, "variables_p": {}}], "funcs": [{"docstring": {"func": "Whether Qubole column are integer.", "long_descr": null, "ret": null}, "fn_lc": [[35, 0], [41, 20]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "isint", "params": {"value": ""}, "params_descr": {"value": ""}, "params_occur": {"value": [["int", "value"]]}, "params_p": {"args": [], "kwargs": [], "value": [["str", 0.39999999999999997], ["List[float]", 0.19999999999999998], ["T", 0.09999999999999999], ["Union[bool, Any]", 0.09999999999999999], ["float", 0.09999999999999999]]}, "q_name": "isint", "ret_exprs": ["return True", "return False"], "ret_type": "builtins.bool", "ret_type_p": [["bool", 1.0]], "variables": {}, "variables_p": {}}, {"docstring": {"func": "Whether Qubole column are float.", "long_descr": null, "ret": null}, "fn_lc": [[44, 0], [50, 20]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "isfloat", "params": {"value": ""}, "params_descr": {"value": ""}, "params_occur": {"value": [["float", "value"]]}, "params_p": {"args": [], "kwargs": [], "value": [["str", 0.39999999999999997], ["List[float]", 0.19999999999999998], ["T", 0.09999999999999999], ["Union[bool, Any]", 0.09999999999999999], ["float", 0.09999999999999999]]}, "q_name": "isfloat", "ret_exprs": ["return True", "return False"], "ret_type": "builtins.bool", "ret_type_p": [["bool", 1.0]], "variables": {}, "variables_p": {}}, {"docstring": {"func": "Whether Qubole column are boolean.", "long_descr": null, "ret": null}, "fn_lc": [[53, 0], [58, 20]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "isbool", "params": {"value": ""}, "params_descr": {"value": ""}, "params_occur": {"value": [["value", "lower"]]}, "params_p": {"args": [], "kwargs": [], "value": [["str", 0.4], ["T", 0.2], ["int", 0.1], ["bytes", 0.1]]}, "q_name": "isbool", "ret_exprs": ["return value.lower() in [\"true\", \"false\"]", "return False"], "ret_type": "builtins.bool", "ret_type_p": [["bool", 0.6151833289462353], ["Iterable", 0.10074449348530798], ["str", 0.10074449348530798], ["List[str]", 0.09287314833067314], ["list", 0.09045453575247568]], "variables": {}, "variables_p": {}}, {"docstring": {"func": "Parse Qubole first record list.", "long_descr": null, "ret": null}, "fn_lc": [[61, 0], [75, 22]], "fn_var_ln": {"col_value": [[72, 12], [72, 21]], "first_row": [[64, 4], [64, 13]], "record_list": [[63, 4], [63, 15]]}, "fn_var_occur": {"col_value": [["isint", "col_value"], ["col_value", "int", "col_value"], ["isfloat", "col_value"], ["col_value", "float", "col_value"], ["isbool", "col_value"], ["col_value", "col_value", "lower"], ["record_list", "append", "col_value"]], "first_row": [["first_row", "row_list", "row_list"], ["first_row", "split", "COL_DELIM"]], "record_list": [["record_list", "append", "col_value"]]}, "name": "parse_first_row", "params": {"row_list": ""}, "params_descr": {"row_list": ""}, "params_occur": {"row_list": [["first_row", "row_list", "row_list"]]}, "params_p": {"args": [], "kwargs": [], "row_list": [["int", 0.579326653777168], ["Sequence[int]", 0.12068586571691006], ["bool", 0.10609180379199654], ["Dict[str, Dict[str, Any]]", 0.08922887425340444]]}, "q_name": "parse_first_row", "ret_exprs": ["return record_list"], "ret_type": "builtins.list[bool | float | int | str]", "ret_type_p": [["List[Dict]", 0.4114439540626412], ["List[str]", 0.2381626750533533], ["str", 0.10385153460033429], ["List[int]", 0.07842879783094439], ["List[List[Any]]", 0.0566750768319947], ["float", 0.05475018982380299]], "variables": {"col_value": "", "first_row": "", "record_list": ""}, "variables_p": {"col_value": [["List[Tuple[Any, Any]]", 0.22218655001843482], ["list", 0.12145304783673536], ["List[int]", 0.10295606272079424], ["int", 0.08448871485150852], ["List[float]", 0.08388789314187521]], "first_row": [["str", 0.19949922054623173], ["bytes", 0.18613232200474472], ["Tuple[int]", 0.12621244038575985], ["Tuple[int, int, int, int]", 0.12621244038575985], ["list", 0.09389663639273692], ["Type[List[Any]]", 0.08676763979868683]], "record_list": [["list", 0.99999999999172], ["List[float]", 4.139903245981006e-12], ["str", 4.139903245981006e-12]]}}], "imports": ["__future__", "annotations", "logging", "io", "StringIO", "qds_sdk", "commands", "Command", "airflow", "exceptions", "AirflowException", "airflow", "providers", "common", "sql", "hooks", "sql", "DbApiHook", "airflow", "providers", "qubole", "hooks", "qubole", "QuboleHook"], "mod_var_ln": {"COL_DELIM": [[31, 0], [31, 9]], "ROW_DELIM": [[32, 0], [32, 9]], "log": [[29, 0], [29, 3]]}, "mod_var_occur": {"COL_DELIM": [["first_row", "split", "COL_DELIM"], ["self", "cmd", "get_results", "fp", "query_result_buffer", "inline", "True", "delim", "COL_DELIM", "arguments"]], "ROW_DELIM": [["row_list", "list", "filter", "None", "query_result", "split", "ROW_DELIM"]], "log": [["log", "info", "cmd_id"], ["self", "log", "info", "cmd_id"], ["self", "log", "error"]]}, "no_types_annot": {"D": 7, "I": 0, "U": 26}, "session_id": "-e9wfq5LmL820flO1P610s6G0Hb9I7pSux1vCmHuJlw", "set": null, "tc": [false, null], "type_annot_cove": 0.21, "typed_seq": "", "untyped_seq": "", "variables": {"COL_DELIM": "", "ROW_DELIM": "", "log": ""}, "variables_p": {"COL_DELIM": [["str", 0.21533769244253048], ["tuple", 0.19513779956692945], ["io.TextIOWrapper", 0.11720753662931317], ["List[str]", 0.09508776947323355]], "ROW_DELIM": [["List[str]", 0.33098645855657516], ["Dict[str, str]", 0.1933265662257897], ["str", 0.17395595993599478], ["Optional[List[Any]]", 0.1142168625025388], ["list", 0.09651811558002109], ["List[Optional[str]]", 0.09099603719908059]], "log": [["logging.Logger", 1.0]]}}}