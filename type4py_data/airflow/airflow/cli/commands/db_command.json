{"error": null, "response": {"classes": [], "funcs": [{"docstring": {"func": "Initializes the metadata database.", "long_descr": null, "ret": null}, "fn_lc": [[38, 0], [42, 32]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "initdb", "params": {"args": ""}, "params_descr": {"args": ""}, "params_occur": {"args": []}, "params_p": {"args": [], "kwargs": []}, "q_name": "initdb", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Resets the metadata database.", "long_descr": null, "ret": null}, "fn_lc": [[45, 0], [50, 40]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "resetdb", "params": {"args": ""}, "params_descr": {"args": ""}, "params_occur": {"args": [["args", "yes", "input", "upper"], ["db", "resetdb", "skip_init", "args", "skip_init"]]}, "params_p": {"args": [], "kwargs": []}, "q_name": "resetdb", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Upgrades the metadata database.", "long_descr": null, "ret": null}, "fn_lc": [[54, 0], [95, 30]], "fn_var_ln": {"from_revision": [[72, 8], [72, 21]], "to_revision": [[81, 8], [81, 19]]}, "fn_var_occur": {"from_revision": [["args", "from_version", "args", "from_revision"], ["args", "from_revision", "args", "from_version", "args", "show_sql_only"], ["from_revision", "None"], ["args", "from_revision"], ["from_revision", "args", "from_revision"], ["from_revision", "REVISION_HEADS_MAP", "get", "args", "from_version"], ["db", "upgradedb", "to_revision", "to_revision", "from_revision", "from_revision", "show_sql_only", "args", "show_sql_only", "reserialize_dags", "args", "reserialize_dags"]], "to_revision": [["args", "to_revision", "args", "to_version"], ["to_revision", "None"], ["to_revision", "REVISION_HEADS_MAP", "get", "args", "to_version"], ["args", "to_revision"], ["to_revision", "args", "to_revision"], ["db", "upgradedb", "to_revision", "to_revision", "from_revision", "from_revision", "show_sql_only", "args", "show_sql_only", "reserialize_dags", "args", "reserialize_dags"]]}, "name": "upgradedb", "params": {"args": ""}, "params_descr": {"args": ""}, "params_occur": {"args": [["args", "to_revision", "args", "to_version"], ["args", "from_version", "args", "from_revision"], ["args", "from_revision", "args", "from_version", "args", "show_sql_only"], ["args", "from_revision"], ["from_revision", "args", "from_revision"], ["args", "from_version"], ["parse_version", "args", "from_version", "parse_version"], ["from_revision", "REVISION_HEADS_MAP", "get", "args", "from_version"], ["SystemExit", "args", "from_version"], ["args", "to_version"], ["to_revision", "REVISION_HEADS_MAP", "get", "args", "to_version"], ["SystemExit", "args", "to_version"], ["args", "to_revision"], ["to_revision", "args", "to_revision"], ["args", "show_sql_only"], ["db", "upgradedb", "to_revision", "to_revision", "from_revision", "from_revision", "show_sql_only", "args", "show_sql_only", "reserialize_dags", "args", "reserialize_dags"], ["args", "show_sql_only"]]}, "params_p": {"args": [], "kwargs": []}, "q_name": "upgradedb", "ret_exprs": [], "ret_type": "", "variables": {"from_revision": "", "to_revision": ""}, "variables_p": {"from_revision": [["Sequence", 0.0917633093050096]], "to_revision": [["int", 0.2722193953361667], ["str", 0.23405969350780687], ["Dict[str, Any]", 0.21158443524336362], ["bool", 0.09401646804696379]]}}, {"docstring": {"func": "Downgrades the metadata database.", "long_descr": null, "ret": null}, "fn_lc": [[99, 0], [142, 37]], "fn_var_ln": {"from_revision": [[115, 8], [115, 21]], "to_revision": [[123, 8], [123, 19]]}, "fn_var_occur": {"from_revision": [["args", "from_version", "args", "from_revision"], ["args", "from_revision", "args", "from_version", "args", "show_sql_only"], ["from_revision", "None"], ["args", "from_revision"], ["from_revision", "args", "from_revision"], ["from_revision", "REVISION_HEADS_MAP", "get", "args", "from_version"], ["db", "downgrade", "to_revision", "to_revision", "from_revision", "from_revision", "show_sql_only", "args", "show_sql_only"]], "to_revision": [["args", "to_revision", "args", "to_version"], ["args", "to_version", "args", "to_revision"], ["to_revision", "REVISION_HEADS_MAP", "get", "args", "to_version"], ["args", "to_revision"], ["to_revision", "args", "to_revision"], ["db", "downgrade", "to_revision", "to_revision", "from_revision", "from_revision", "show_sql_only", "args", "show_sql_only"]]}, "name": "downgrade", "params": {"args": ""}, "params_descr": {"args": ""}, "params_occur": {"args": [["args", "to_revision", "args", "to_version"], ["args", "from_version", "args", "from_revision"], ["args", "from_revision", "args", "from_version", "args", "show_sql_only"], ["args", "to_version", "args", "to_revision"], ["args", "from_revision"], ["from_revision", "args", "from_revision"], ["args", "from_version"], ["from_revision", "REVISION_HEADS_MAP", "get", "args", "from_version"], ["SystemExit", "args", "from_version"], ["args", "to_version"], ["to_revision", "REVISION_HEADS_MAP", "get", "args", "to_version"], ["SystemExit", "args", "to_version"], ["args", "to_revision"], ["to_revision", "args", "to_revision"], ["args", "show_sql_only"], ["args", "show_sql_only", "args", "yes", "input", "upper"], ["db", "downgrade", "to_revision", "to_revision", "from_revision", "from_revision", "show_sql_only", "args", "show_sql_only"], ["args", "show_sql_only"]]}, "params_p": {"args": [], "kwargs": []}, "q_name": "downgrade", "ret_exprs": [], "ret_type": "", "variables": {"from_revision": "", "to_revision": ""}, "variables_p": {"from_revision": [["Sequence", 0.0917633093050096]], "to_revision": [["List[str]", 0.09460540693628863], ["str", 0.09159813674444861], ["Dict[int, Any]", 0.09060553593529667]]}}, {"docstring": {"func": "Function to wait for all airflow migrations to complete. Used for launching airflow in k8s.", "long_descr": null, "ret": null}, "fn_lc": [[145, 0], [147, 60]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "check_migrations", "params": {"args": ""}, "params_descr": {"args": ""}, "params_occur": {"args": [["db", "check_migrations", "timeout", "args", "migration_wait_timeout"]]}, "params_p": {"args": [], "kwargs": []}, "q_name": "check_migrations", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Run a shell that allows to access metadata database.", "long_descr": null, "ret": null}, "fn_lc": [[151, 0], [190, 67]], "fn_var_ln": {"content": [[158, 12], [158, 19]], "env": [[183, 8], [183, 11]], "url": [[153, 4], [153, 7]]}, "fn_var_occur": {"content": [["content", "textwrap", "dedent", "url", "host", "url", "username", "url", "password", "url", "port", "url", "database", "strip"], ["f", "write", "content", "encode"]], "env": [["env", "os", "environ", "copy"], ["env", "url", "host"], ["env", "str", "url", "port"], ["env", "url", "username"], ["env", "url", "password"], ["env", "url", "database"], ["execute_interactive", "env", "env"], ["env", "os", "environ", "copy"], ["env", "url", "host"], ["env", "url", "database"], ["env", "url", "username"], ["env", "url", "password"], ["execute_interactive", "env", "env"]], "url": [["url", "settings", "engine", "url"], ["print", "repr", "url"], ["url", "get_backend_name"], ["content", "textwrap", "dedent", "url", "host", "url", "username", "url", "password", "url", "port", "url", "database", "strip"], ["url", "get_backend_name"], ["execute_interactive", "url", "database"], ["url", "get_backend_name"], ["env", "url", "host"], ["env", "str", "url", "port"], ["env", "url", "username"], ["env", "url", "password"], ["env", "url", "database"], ["url", "get_backend_name"], ["env", "url", "host"], ["env", "url", "database"], ["env", "url", "username"], ["env", "url", "password"], ["AirflowException", "url", "drivername"]]}, "name": "shell", "params": {"args": ""}, "params_descr": {"args": ""}, "params_occur": {"args": []}, "params_p": {"args": [], "kwargs": []}, "q_name": "shell", "ret_exprs": [], "ret_type": "", "variables": {"content": "", "env": "", "url": ""}, "variables_p": {"content": [["urllib.parse.SplitResult", 0.6860198226434822], ["urllib.parse.ParseResult", 0.31398017735651773]], "env": [["str", 0.4757226072645939], ["Dict[str, str]", 0.2570550300419093], ["os._Environ[str]", 0.0879949769949388]], "url": [["str", 0.17003665612794888], ["Dict[str, Any]", 0.0927844091837225], ["List[str]", 0.08649104681687222], ["OrderedDict[str, Any]", 0.07950519728501594]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[199, 4], [201, 87]], "fn_var_ln": {"remain": [[200, 8], [200, 14]]}, "fn_var_occur": {"remain": [["remain", "retries", "retrystate", "attempt_number"], ["log", "warning", "remain", "retry_delay"]]}, "name": "_warn_remaining_retries", "params": {"retrystate": "tenacity.RetryCallState"}, "params_descr": {"retrystate": ""}, "params_occur": {"retrystate": [["remain", "retries", "retrystate", "attempt_number"]]}, "params_p": {"args": [], "kwargs": [], "retrystate": [["str", 0.34523182752277237], ["int", 0.18941550014508285], ["Dict[str, Any]", 0.09510832487457462]]}, "q_name": "check.<locals>._warn_remaining_retries", "ret_exprs": [], "ret_type": "", "variables": {"remain": ""}, "variables_p": {"remain": [["str", 0.7032598156632877], ["list", 0.08053315219703323]]}}, {"docstring": {"func": "Runs a check command that checks if db is available.", "long_descr": null, "ret": null}, "fn_lc": [[194, 0], [210, 22]], "fn_var_ln": {"retries": [[196, 4], [196, 11]], "retry_delay": [[197, 4], [197, 15]]}, "fn_var_occur": {"retries": [["Retrying", "stop", "stop_after_attempt", "retries", "wait", "wait_fixed", "retry_delay", "reraise", "True", "before_sleep", "_warn_remaining_retries"]], "retry_delay": [["Retrying", "stop", "stop_after_attempt", "retries", "wait", "wait_fixed", "retry_delay", "reraise", "True", "before_sleep", "_warn_remaining_retries"]]}, "name": "check", "params": {"args": ""}, "params_descr": {"args": ""}, "params_occur": {"args": []}, "params_p": {"args": [], "kwargs": []}, "q_name": "check", "ret_exprs": [], "ret_type": "", "variables": {"retries": "builtins.int", "retry_delay": "builtins.int"}, "variables_p": {"retries": [["Tuple[int, int, int]", 0.15356681619949636], ["int", 0.13078013307503633], ["str", 0.07844271534988993]], "retry_delay": [["Tuple[int, int, int]", 0.15356681619949636], ["int", 0.13078013307503633], ["str", 0.07844271534988993]]}}, {"docstring": {"func": "Purges old records in metadata database.", "long_descr": null, "ret": null}, "fn_lc": [[218, 0], [227, 5]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "cleanup_tables", "params": {"args": ""}, "params_descr": {"args": ""}, "params_occur": {"args": [["run_cleanup", "table_names", "args", "tables", "dry_run", "args", "dry_run", "clean_before_timestamp", "args", "clean_before_timestamp", "verbose", "args", "verbose", "confirm", "args", "yes", "skip_archive", "args", "skip_archive"]]}, "params_p": {"args": [], "kwargs": []}, "q_name": "cleanup_tables", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Exports archived records from metadata database.", "long_descr": null, "ret": null}, "fn_lc": [[231, 0], [239, 5]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "export_archived", "params": {"args": ""}, "params_descr": {"args": ""}, "params_occur": {"args": [["export_archived_records", "export_format", "args", "export_format", "output_path", "args", "output_path", "table_names", "args", "tables", "drop_archives", "args", "drop_archives", "needs_confirm", "args", "yes"]]}, "params_p": {"args": [], "kwargs": []}, "q_name": "export_archived", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Drops archived tables from metadata database.", "long_descr": null, "ret": null}, "fn_lc": [[243, 0], [248, 5]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "drop_archived", "params": {"args": ""}, "params_descr": {"args": ""}, "params_occur": {"args": [["drop_archived_tables", "table_names", "args", "tables", "needs_confirm", "args", "yes"]]}, "params_p": {"args": [], "kwargs": []}, "q_name": "drop_archived", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}], "imports": ["__future__", "annotations", "logging", "os", "textwrap", "tempfile", "NamedTemporaryFile", "packaging", "version", "parse", "parse_version", "tenacity", "RetryCallState", "Retrying", "stop_after_attempt", "wait_fixed", "airflow", "settings", "airflow", "exceptions", "AirflowException", "airflow", "utils", "cli", "cli_utils", "db", "airflow", "utils", "db", "REVISION_HEADS_MAP", "airflow", "utils", "db_cleanup", "config_dict", "drop_archived_tables", "export_archived_records", "run_cleanup", "airflow", "utils", "process_utils", "execute_interactive"], "mod_var_ln": {"all_tables": [[214, 0], [214, 10]], "log": [[35, 0], [35, 3]]}, "mod_var_occur": {"all_tables": [], "log": [["log", "warning", "remain", "retry_delay"]]}, "no_types_annot": {"D": 3, "I": 0, "U": 31}, "session_id": "NxzF8Qk2IUUkG5RD9GBQ_C67XX-BAJLTFYOopm97U-g", "set": null, "tc": [false, null], "type_annot_cove": 0.09, "typed_seq": "", "untyped_seq": "", "variables": {"all_tables": "", "log": ""}, "variables_p": {"all_tables": [["str", 0.33333333364452294], ["Dict[str, List[str]]", 0.3333333331777385], ["List[str]", 0.3333333331777385]], "log": [["logging.Logger", 0.9999999999999999]]}}}