{"error": null, "response": {"classes": [], "funcs": [{"docstring": {"func": "Generates yaml files for each task in the DAG. Used for testing output of KubernetesExecutor.", "long_descr": null, "ret": null}, "fn_lc": [[38, 0], [69, 81]], "fn_var_ln": {"api_client": [[62, 8], [62, 18]], "dag": [[41, 4], [41, 7]], "dag_run": [[47, 8], [47, 18]], "date_string": [[63, 8], [63, 19]], "dr": [[43, 4], [43, 6]], "execution_date": [[40, 4], [40, 18]], "kube_config": [[44, 4], [44, 15]], "pod": [[48, 8], [48, 11]], "sanitized_pod": [[67, 12], [67, 25]], "ti": [[46, 8], [46, 10]], "yaml_file_name": [[64, 8], [64, 22]], "yaml_output_path": [[42, 4], [42, 20]]}, "fn_var_occur": {"api_client": [["api_client", "ApiClient"], ["sanitized_pod", "api_client", "sanitize_for_serialization", "pod"]], "dag": [["dag", "get_dag", "subdir", "args", "subdir", "dag_id", "args", "dag_id"], ["dr", "DagRun", "dag", "dag_id", "execution_date", "execution_date"], ["dag", "tasks"]], "dag_run": [["ti", "dag_run", "dr"]], "date_string": [["date_string", "pod_generator", "datetime_to_label_safe_datestring", "execution_date"], ["yaml_file_name", "args", "dag_id", "ti", "task_id", "date_string"]], "dr": [["dr", "DagRun", "dag", "dag_id", "execution_date", "execution_date"], ["ti", "dag_run", "dr"]], "execution_date": [["execution_date", "args", "execution_date"], ["dr", "DagRun", "dag", "dag_id", "execution_date", "execution_date"], ["pod", "PodGenerator", "construct_pod", "dag_id", "args", "dag_id", "task_id", "ti", "task_id", "pod_id", "create_pod_id", "args", "dag_id", "ti", "task_id", "try_number", "ti", "try_number", "kube_image", "kube_config", "kube_image", "date", "ti", "execution_date", "args", "ti", "command_as_list", "pod_override_object", "PodGenerator", "from_obj", "ti", "executor_config", "scheduler_job_id", "namespace", "kube_config", "executor_namespace", "base_worker_pod", "PodGenerator", "deserialize_model_file", "kube_config", "pod_template_file", "with_mutation_hook", "True"], ["date_string", "pod_generator", "datetime_to_label_safe_datestring", "execution_date"]], "kube_config": [["kube_config", "KubeConfig"], ["pod", "PodGenerator", "construct_pod", "dag_id", "args", "dag_id", "task_id", "ti", "task_id", "pod_id", "create_pod_id", "args", "dag_id", "ti", "task_id", "try_number", "ti", "try_number", "kube_image", "kube_config", "kube_image", "date", "ti", "execution_date", "args", "ti", "command_as_list", "pod_override_object", "PodGenerator", "from_obj", "ti", "executor_config", "scheduler_job_id", "namespace", "kube_config", "executor_namespace", "base_worker_pod", "PodGenerator", "deserialize_model_file", "kube_config", "pod_template_file", "with_mutation_hook", "True"]], "pod": [["pod", "PodGenerator", "construct_pod", "dag_id", "args", "dag_id", "task_id", "ti", "task_id", "pod_id", "create_pod_id", "args", "dag_id", "ti", "task_id", "try_number", "ti", "try_number", "kube_image", "kube_config", "kube_image", "date", "ti", "execution_date", "args", "ti", "command_as_list", "pod_override_object", "PodGenerator", "from_obj", "ti", "executor_config", "scheduler_job_id", "namespace", "kube_config", "executor_namespace", "base_worker_pod", "PodGenerator", "deserialize_model_file", "kube_config", "pod_template_file", "with_mutation_hook", "True"], ["sanitized_pod", "api_client", "sanitize_for_serialization", "pod"]], "sanitized_pod": [["sanitized_pod", "api_client", "sanitize_for_serialization", "pod"], ["output", "write", "yaml", "dump", "sanitized_pod"]], "ti": [["ti", "TaskInstance", "task", "None"], ["ti", "dag_run", "dr"], ["pod", "PodGenerator", "construct_pod", "dag_id", "args", "dag_id", "task_id", "ti", "task_id", "pod_id", "create_pod_id", "args", "dag_id", "ti", "task_id", "try_number", "ti", "try_number", "kube_image", "kube_config", "kube_image", "date", "ti", "execution_date", "args", "ti", "command_as_list", "pod_override_object", "PodGenerator", "from_obj", "ti", "executor_config", "scheduler_job_id", "namespace", "kube_config", "executor_namespace", "base_worker_pod", "PodGenerator", "deserialize_model_file", "kube_config", "pod_template_file", "with_mutation_hook", "True"], ["yaml_file_name", "args", "dag_id", "ti", "task_id", "date_string"]], "yaml_file_name": [["yaml_file_name", "args", "dag_id", "ti", "task_id", "date_string"], ["open", "yaml_output_path", "yaml_file_name", "output"]], "yaml_output_path": [["yaml_output_path", "args", "output_path"], ["os", "makedirs", "os", "path", "dirname", "yaml_output_path", "exist_ok", "True"], ["open", "yaml_output_path", "yaml_file_name", "output"], ["print", "yaml_output_path"]]}, "name": "generate_pod_yaml", "params": {"args": ""}, "params_descr": {"args": ""}, "params_occur": {"args": [["execution_date", "args", "execution_date"], ["dag", "get_dag", "subdir", "args", "subdir", "dag_id", "args", "dag_id"], ["yaml_output_path", "args", "output_path"], ["pod", "PodGenerator", "construct_pod", "dag_id", "args", "dag_id", "task_id", "ti", "task_id", "pod_id", "create_pod_id", "args", "dag_id", "ti", "task_id", "try_number", "ti", "try_number", "kube_image", "kube_config", "kube_image", "date", "ti", "execution_date", "args", "ti", "command_as_list", "pod_override_object", "PodGenerator", "from_obj", "ti", "executor_config", "scheduler_job_id", "namespace", "kube_config", "executor_namespace", "base_worker_pod", "PodGenerator", "deserialize_model_file", "kube_config", "pod_template_file", "with_mutation_hook", "True"], ["yaml_file_name", "args", "dag_id", "ti", "task_id", "date_string"]]}, "params_p": {"args": [], "kwargs": []}, "q_name": "generate_pod_yaml", "ret_exprs": [], "ret_type": "", "variables": {"api_client": "", "dag": "", "dag_run": "", "date_string": "", "dr": "", "execution_date": "", "kube_config": "", "pod": "", "sanitized_pod": "", "ti": "", "yaml_file_name": "", "yaml_output_path": ""}, "variables_p": {"api_client": [], "dag": [["str", 0.10641191498844725], ["List[Union[Any, Any, Any, Any]]", 0.10081070277311058], ["float", 0.09874387210660664], ["int", 0.09581447663681665], ["Dict[str, Any]", 0.09131757614207407]], "dag_run": [["str", 0.9999999999999999]], "date_string": [["str", 0.27193348397722455], ["int", 0.0961268871160599], ["List[Union[Any, Any, Any]]", 0.09020141590025417], ["myia.utils.misc.Named", 0.0894829108484325], ["List[Tuple[str, str]]", 0.08692618396206787], ["dict", 0.08443620692673788], ["List[Tuple[Any, str, int]]", 0.08102421075203568]], "dr": [["str", 0.3797514255046971], ["datetime.datetime", 0.1440968674264423], ["dict", 0.13164610827712483], ["Dict[str, Any]", 0.09086893750268156]], "execution_date": [["Optional[str]", 0.18292933070186068], ["str", 0.16664733930930803], ["int", 0.11714058247544858], ["datetime.datetime.date", 0.1007641441941779], ["datetime.timedelta", 0.09668765189243361], ["Dict[str, str]", 0.08487751068426816], ["Pattern[str]", 0.0807966588079395], ["datetime.date", 0.07696863523441438]], "kube_config": [["List[Tuple[None, Any, str]]", 0.1121504223889729], ["Dict[str, Union[float, str]]", 0.10616856252243917], ["str", 0.09826726360948228], ["Dict[str, Union[bool, str]]", 0.09363803234528638], ["OrderedDict[str, Any]", 0.09264175061633466], ["ChainMap[Any, Any]", 0.08882301447136146], ["Dict[str, Any]", 0.08881822331700039]], "pod": [], "sanitized_pod": [], "ti": [["int", 0.21040307721381374], ["str", 0.09661246204995616], ["Dict[str, str]", 0.08922612191362511], ["dict", 0.08489953652669671]], "yaml_file_name": [["str", 0.6139782268407903], ["Optional[str]", 0.09538944932500379]], "yaml_output_path": [["str", 0.4485671745661893], ["List[str]", 0.09971099306529058], ["Tuple[str, str, str, str]", 0.08919705532514752]]}}, {"docstring": {"func": "Clean up k8s pods in evicted/failed/succeeded/pending states.", "long_descr": null, "ret": null}, "fn_lc": [[73, 0], [146, 49]], "fn_var_ln": {"airflow_pod_labels": [[105, 4], [105, 22]], "continue_token": [[143, 8], [143, 22]], "current_time": [[121, 12], [121, 24]], "kube_client": [[103, 4], [103, 15]], "list_kwargs": [[111, 4], [111, 15]], "min_pending_minutes": [[80, 8], [80, 27]], "namespace": [[75, 4], [75, 13]], "pod_failed": [[92, 4], [92, 14]], "pod_list": [[114, 8], [114, 16]], "pod_name": [[116, 12], [116, 20]], "pod_pending": [[88, 4], [88, 15]], "pod_phase": [[118, 12], [118, 21]], "pod_reason": [[119, 12], [119, 22]], "pod_reason_evicted": [[95, 4], [95, 22]], "pod_restart_policy": [[120, 12], [120, 30]], "pod_restart_policy_never": [[100, 4], [100, 28]], "pod_succeeded": [[84, 4], [84, 17]]}, "fn_var_occur": {"airflow_pod_labels": [["list_kwargs", "namespace", "join", "airflow_pod_labels"]], "continue_token": [["continue_token", "pod_list", "metadata", "_continue"], ["list_kwargs", "continue_token"]], "current_time": [["current_time", "datetime", "now", "pod", "metadata", "creation_timestamp", "tzinfo"], ["pod_phase", "pod_succeeded", "pod_phase", "pod_failed", "pod_restart_policy", "pod_restart_policy_never", "pod_reason", "pod_reason_evicted", "pod_phase", "pod_pending", "current_time", "pod", "metadata", "creation_timestamp", "timedelta", "minutes", "min_pending_minutes"]], "kube_client": [["kube_client", "get_kube_client"], ["pod_list", "kube_client", "list_namespaced_pod", "list_kwargs"]], "list_kwargs": [["list_kwargs", "namespace", "join", "airflow_pod_labels"], ["pod_list", "kube_client", "list_namespaced_pod", "list_kwargs"], ["list_kwargs", "continue_token"]], "min_pending_minutes": [["min_pending_minutes", "args", "min_pending_minutes"], ["pod_phase", "pod_succeeded", "pod_phase", "pod_failed", "pod_restart_policy", "pod_restart_policy_never", "pod_reason", "pod_reason_evicted", "pod_phase", "pod_pending", "current_time", "pod", "metadata", "creation_timestamp", "timedelta", "minutes", "min_pending_minutes"]], "namespace": [["namespace", "args", "namespace"], ["print", "namespace"], ["list_kwargs", "namespace", "join", "airflow_pod_labels"], ["_delete_pod", "pod", "metadata", "name", "namespace"]], "pod_failed": [["pod_phase", "pod_succeeded", "pod_phase", "pod_failed", "pod_restart_policy", "pod_restart_policy_never", "pod_reason", "pod_reason_evicted", "pod_phase", "pod_pending", "current_time", "pod", "metadata", "creation_timestamp", "timedelta", "minutes", "min_pending_minutes"]], "pod_list": [["pod_list", "kube_client", "list_namespaced_pod", "list_kwargs"], ["pod_list", "items"], ["continue_token", "pod_list", "metadata", "_continue"]], "pod_name": [["pod_name", "pod", "metadata", "name"], ["print", "pod_name"], ["print", "pod_name", "pod_phase", "pod_reason", "pod_restart_policy"], ["print", "pod_name"]], "pod_pending": [["pod_phase", "pod_succeeded", "pod_phase", "pod_failed", "pod_restart_policy", "pod_restart_policy_never", "pod_reason", "pod_reason_evicted", "pod_phase", "pod_pending", "current_time", "pod", "metadata", "creation_timestamp", "timedelta", "minutes", "min_pending_minutes"]], "pod_phase": [["pod_phase", "pod", "status", "phase", "lower"], ["pod_phase", "pod_succeeded", "pod_phase", "pod_failed", "pod_restart_policy", "pod_restart_policy_never", "pod_reason", "pod_reason_evicted", "pod_phase", "pod_pending", "current_time", "pod", "metadata", "creation_timestamp", "timedelta", "minutes", "min_pending_minutes"], ["print", "pod_name", "pod_phase", "pod_reason", "pod_restart_policy"]], "pod_reason": [["pod_reason", "pod", "status", "reason", "lower", "pod", "status", "reason"], ["pod_phase", "pod_succeeded", "pod_phase", "pod_failed", "pod_restart_policy", "pod_restart_policy_never", "pod_reason", "pod_reason_evicted", "pod_phase", "pod_pending", "current_time", "pod", "metadata", "creation_timestamp", "timedelta", "minutes", "min_pending_minutes"], ["print", "pod_name", "pod_phase", "pod_reason", "pod_restart_policy"]], "pod_reason_evicted": [["pod_phase", "pod_succeeded", "pod_phase", "pod_failed", "pod_restart_policy", "pod_restart_policy_never", "pod_reason", "pod_reason_evicted", "pod_phase", "pod_pending", "current_time", "pod", "metadata", "creation_timestamp", "timedelta", "minutes", "min_pending_minutes"]], "pod_restart_policy": [["pod_restart_policy", "pod", "spec", "restart_policy", "lower"], ["pod_phase", "pod_succeeded", "pod_phase", "pod_failed", "pod_restart_policy", "pod_restart_policy_never", "pod_reason", "pod_reason_evicted", "pod_phase", "pod_pending", "current_time", "pod", "metadata", "creation_timestamp", "timedelta", "minutes", "min_pending_minutes"], ["print", "pod_name", "pod_phase", "pod_reason", "pod_restart_policy"]], "pod_restart_policy_never": [["pod_phase", "pod_succeeded", "pod_phase", "pod_failed", "pod_restart_policy", "pod_restart_policy_never", "pod_reason", "pod_reason_evicted", "pod_phase", "pod_pending", "current_time", "pod", "metadata", "creation_timestamp", "timedelta", "minutes", "min_pending_minutes"]], "pod_succeeded": [["pod_phase", "pod_succeeded", "pod_phase", "pod_failed", "pod_restart_policy", "pod_restart_policy_never", "pod_reason", "pod_reason_evicted", "pod_phase", "pod_pending", "current_time", "pod", "metadata", "creation_timestamp", "timedelta", "minutes", "min_pending_minutes"]]}, "name": "cleanup_pods", "params": {"args": ""}, "params_descr": {"args": ""}, "params_occur": {"args": [["namespace", "args", "namespace"], ["min_pending_minutes", "args", "min_pending_minutes"]]}, "params_p": {"args": [], "kwargs": []}, "q_name": "cleanup_pods", "ret_exprs": [], "ret_type": "", "variables": {"airflow_pod_labels": "", "continue_token": "", "current_time": "", "kube_client": "", "list_kwargs": "", "min_pending_minutes": "", "namespace": "", "pod_failed": "", "pod_list": "", "pod_name": "", "pod_pending": "", "pod_phase": "", "pod_reason": "", "pod_reason_evicted": "", "pod_restart_policy": "", "pod_restart_policy_never": "", "pod_succeeded": ""}, "variables_p": {"airflow_pod_labels": [["str", 1.0000000000000002]], "continue_token": [["list", 0.7272834362332276], ["int", 0.17624668819645342], ["List[float]", 0.09646987557031884]], "current_time": [["datetime.date.time.datetime", 0.3595969413470382], ["datetime.datetime.datetime", 0.2973755772461596], ["datetime.datetime.timedelta", 0.19464355887390838], ["datetime.timedelta", 0.14838392253289368]], "kube_client": [], "list_kwargs": [["str", 0.6422823378036138], ["List[str]", 0.25633840951203357]], "min_pending_minutes": [["bool", 0.4999999999158804], ["Dict[Any, int]", 2.592400417411367e-11], ["str", 2.2566867569373487e-11], ["Dict[str, Union[Any, Any]]", 1.8503575025177697e-11], ["int", 1.573492888365336e-11]], "namespace": [["tuple", 0.3986436638670843], ["str", 0.19095340077658202], ["bool", 0.09021788401800603], ["int", 0.0813281561554341], ["List[str]", 0.0659295670643627]], "pod_failed": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "pod_list": [["Dict[str, Union[Any, Any, Any]]", 0.19241107678252206], ["Dict[str, Union[Any, bool, str]]", 0.09620553839126103], ["Dict[str, Literal[False]]", 0.09152639245320202]], "pod_name": [["dict", 0.3181002735421866], ["Tuple[str]", 0.1778889618470286], ["Dict[int, str]", 0.08909769001486248], ["str", 0.08871370190556012]], "pod_pending": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "pod_phase": [["int", 0.493426204739165], ["float", 0.3215213932165897], ["Type[jazmin_leon_llc.fluent_pages.models.db.UrlNode]", 0.1110143746876226], ["str", 0.07403802735662268]], "pod_reason": [["str", 0.5923115029158731], ["int", 0.2534887774935574], ["Type[apps.blog.models.Post]", 0.15419971959056958]], "pod_reason_evicted": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "pod_restart_policy": [["str", 0.1744786104061876], ["List[int]", 0.10125472190368774], ["Dict[str, Union[Any, Any, Any, Any, str]]", 0.09334968636863246]], "pod_restart_policy_never": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]], "pod_succeeded": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1], ["datetime.timedelta", 0.1]]}}, {"docstring": {"func": "Helper Function for cleanup_pods.", "long_descr": null, "ret": null}, "fn_lc": [[149, 0], [155, 23]], "fn_var_ln": {"api_response": [[154, 4], [154, 16]], "delete_options": [[152, 4], [152, 18]], "kube_client": [[151, 4], [151, 15]]}, "fn_var_occur": {"api_response": [["api_response", "kube_client", "delete_namespaced_pod", "name", "name", "namespace", "namespace", "body", "delete_options"], ["print", "api_response"]], "delete_options": [["delete_options", "client", "V1DeleteOptions"], ["api_response", "kube_client", "delete_namespaced_pod", "name", "name", "namespace", "namespace", "body", "delete_options"]], "kube_client": [["kube_client", "get_kube_client"], ["api_response", "kube_client", "delete_namespaced_pod", "name", "name", "namespace", "namespace", "body", "delete_options"]]}, "name": "_delete_pod", "params": {"name": "", "namespace": ""}, "params_descr": {"name": "", "namespace": ""}, "params_occur": {"name": [["print", "name", "namespace"], ["api_response", "kube_client", "delete_namespaced_pod", "name", "name", "namespace", "namespace", "body", "delete_options"]], "namespace": [["print", "name", "namespace"], ["api_response", "kube_client", "delete_namespaced_pod", "name", "name", "namespace", "namespace", "body", "delete_options"]]}, "params_p": {"args": [], "kwargs": [], "name": [["str", 0.8988910987221488], ["Dict[str, str]", 0.1011089012778512]], "namespace": [["str", 0.8988910987221488], ["Dict[str, str]", 0.1011089012778512]]}, "q_name": "_delete_pod", "ret_exprs": [], "ret_type": "", "variables": {"api_response": "", "delete_options": "", "kube_client": ""}, "variables_p": {"api_response": [["str", 0.3801273158409866], ["Dict[str, str]", 0.18148187594812906], ["Optional[str]", 0.15242994927012007]], "delete_options": [["botocore.client", 0.17787256633331366], ["list", 0.12885461184922695], ["Dict[str, str]", 0.09925806773203628], ["Dict[str, Any]", 0.08969205921031118]], "kube_client": []}}], "imports": ["__future__", "annotations", "os", "sys", "datetime", "datetime", "timedelta", "kubernetes", "client", "kubernetes", "client", "api_client", "ApiClient", "kubernetes", "client", "rest", "ApiException", "airflow", "executors", "kubernetes_executor", "KubeConfig", "create_pod_id", "airflow", "kubernetes", "pod_generator", "airflow", "kubernetes", "kube_client", "get_kube_client", "airflow", "kubernetes", "pod_generator", "PodGenerator", "airflow", "models", "DagRun", "TaskInstance", "airflow", "utils", "cli", "cli_utils", "yaml", "airflow", "utils", "cli", "get_dag"], "mod_var_ln": {}, "mod_var_occur": {}, "no_types_annot": {"D": 0, "I": 0, "U": 39}, "session_id": "f1TAKCsQ6118d6pbh_KvBI2YiRO_ZxDFOd3soN8Xriw", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {}, "variables_p": {}}}