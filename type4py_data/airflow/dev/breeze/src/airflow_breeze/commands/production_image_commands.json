{"error": null, "response": {"classes": [], "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[98, 0], [131, 5]], "fn_var_ln": {"all_params": [[108, 8], [108, 18]], "results": [[115, 12], [115, 19]]}, "fn_var_occur": {"all_params": [["all_params", "image_params", "python", "image_params", "image_params_list"], ["run_with_pool", "parallelism", "parallelism", "all_params", "all_params", "debug_resources", "debug_resources", "progress_matcher", "DockerBuildxProgressMatcher", "pool", "outputs"]], "results": [["results", "pool", "apply_async", "run_build_production_image", "kwds", "image_params", "outputs", "index", "index", "image_params", "enumerate", "image_params_list"], ["check_async_run_results", "results", "results", "success", "outputs", "outputs", "include_success_outputs", "include_success_outputs", "skip_cleanup", "skip_cleanup"]]}, "name": "run_build_in_parallel", "params": {"debug_resources": "builtins.bool", "image_params_list": "builtins.list[airflow_breeze.params.build_prod_params.BuildProdParams]", "include_success_outputs": "builtins.bool", "parallelism": "builtins.int", "python_version_list": "builtins.list[builtins.str]", "skip_cleanup": "builtins.bool"}, "params_descr": {"debug_resources": "", "image_params_list": "", "include_success_outputs": "", "parallelism": "", "python_version_list": "", "skip_cleanup": ""}, "params_occur": {"debug_resources": [["run_with_pool", "parallelism", "parallelism", "all_params", "all_params", "debug_resources", "debug_resources", "progress_matcher", "DockerBuildxProgressMatcher", "pool", "outputs"]], "image_params_list": [["warm_up_docker_builder", "image_params_list"], ["all_params", "image_params", "python", "image_params", "image_params_list"], ["results", "pool", "apply_async", "run_build_production_image", "kwds", "image_params", "outputs", "index", "index", "image_params", "enumerate", "image_params_list"]], "include_success_outputs": [["check_async_run_results", "results", "results", "success", "outputs", "outputs", "include_success_outputs", "include_success_outputs", "skip_cleanup", "skip_cleanup"]], "parallelism": [["run_with_pool", "parallelism", "parallelism", "all_params", "all_params", "debug_resources", "debug_resources", "progress_matcher", "DockerBuildxProgressMatcher", "pool", "outputs"]], "python_version_list": [["ci_group", "python_version_list"]], "skip_cleanup": [["check_async_run_results", "results", "results", "success", "outputs", "outputs", "include_success_outputs", "include_success_outputs", "skip_cleanup", "skip_cleanup"]]}, "params_p": {"args": [], "debug_resources": [["bool", 0.42015319520935185], ["Iterable[int]", 0.11326409964102284], ["int", 0.09100962626729425], ["str", 0.0884064671999182], ["List[str]", 0.0884064671999182]], "image_params_list": [["bool", 0.5746544650471727], ["int", 0.17220525410674636], ["str", 0.14279938691574287], ["Exception", 0.11034089393033791]], "include_success_outputs": [["bool", 0.3985409766824061], ["Optional[bool]", 0.11894681911709443], ["bytes", 0.10526214703626482], ["Tuple[Any, int, Dict[str, str]]", 0.09651431372053307], ["str", 0.09358418285635407], ["Dict[str, Any]", 0.09357578029367371]], "kwargs": [], "parallelism": [["bool", 0.42015319520935185], ["Iterable[int]", 0.11326409964102284], ["int", 0.09100962626729425], ["str", 0.0884064671999182], ["List[str]", 0.0884064671999182]], "python_version_list": [["bool", 0.6058933234840209], ["List[str]", 0.0923300770729608], ["str", 0.09120395116159889]], "skip_cleanup": [["bool", 0.3985409766824061], ["Optional[bool]", 0.11894681911709443], ["bytes", 0.10526214703626482], ["Tuple[Any, int, Dict[str, str]]", 0.09651431372053307], ["str", 0.09358418285635407], ["Dict[str, Any]", 0.09357578029367371]]}, "q_name": "run_build_in_parallel", "ret_exprs": [], "ret_type": "None", "variables": {"all_params": "", "results": ""}, "variables_p": {"all_params": [["List[str]", 0.7318623103114406], ["list", 0.09794050968380028], ["set", 0.08170851359440162]], "results": [["Dict[str, Any]", 0.23927819466596145], ["List[str]", 0.18163941839209374], ["List[Tuple[int, float]]", 0.11225883852926427], ["List[Dict[str, str]]", 0.09263115222422391]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[134, 0], [142, 5]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "prepare_for_building_prod_image", "params": {"prod_image_params": "airflow_breeze.params.build_prod_params.BuildProdParams"}, "params_descr": {"prod_image_params": ""}, "params_occur": {"prod_image_params": [["make_sure_builder_configured", "params", "prod_image_params"], ["prod_image_params", "cleanup_context"], ["check_docker_context_files", "prod_image_params", "install_packages_from_context"], ["login_to_github_docker_registry", "github_token", "prod_image_params", "github_token", "output", "None"]]}, "params_p": {"args": [], "kwargs": [], "prod_image_params": [["type", 0.36861305296567554], ["Optional[List[int]]", 0.08827700563423968]]}, "q_name": "prepare_for_building_prod_image", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[148, 0], [149, 8]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "prod_image", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "prod_image", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[241, 4], [245, 33]], "fn_var_ln": {"info": [[242, 21], [242, 25]], "return_code": [[242, 8], [242, 19]]}, "fn_var_occur": {"info": [["return_code", "info", "run_build_production_image", "output", "None", "prod_image_params", "prod_image_params"], ["get_console", "print", "info"]], "return_code": [["return_code", "info", "run_build_production_image", "output", "None", "prod_image_params", "prod_image_params"], ["sys", "exit", "return_code"]]}, "name": "run_build", "params": {"prod_image_params": "airflow_breeze.params.build_prod_params.BuildProdParams"}, "params_descr": {"prod_image_params": ""}, "params_occur": {"prod_image_params": [["return_code", "info", "run_build_production_image", "output", "None", "prod_image_params", "prod_image_params"]]}, "params_p": {"args": [], "kwargs": [], "prod_image_params": [["bytes", 0.09018697598219018]]}, "q_name": "build.<locals>.run_build", "ret_exprs": [], "ret_type": "None", "variables": {"info": "", "return_code": ""}, "variables_p": {"info": [["List[Hashable]", 0.10067487941264236]], "return_code": [["Tuple[Literal, Literal]", 0.2833237756618414], ["int", 0.20044572377412442], ["str", 0.1186016396275212], ["os.terminal_size", 0.10606243164619919]]}}, {"docstring": {"func": "Build Production image. Include building multiple images for all or selected Python versions sequentially.", "long_descr": null, "ret": null}, "fn_lc": [[228, 0], [271, 43]], "fn_var_ln": {"parameters_passed": [[249, 4], [249, 21]], "params": [[269, 8], [269, 14]], "params_list": [[254, 8], [254, 19]], "python": [[257, 12], [257, 25]], "python_version_list": [[253, 8], [253, 27]]}, "fn_var_occur": {"parameters_passed": [["parameters_passed", "filter_out_none", "kwargs"], ["params", "BuildProdParams", "parameters_passed"], ["params", "BuildProdParams", "parameters_passed"]], "params": [["params_list", "builtins", "list", "airflow_breeze", "params", "build_prod_params", "BuildProdParams"], ["params", "BuildProdParams", "parameters_passed"], ["params", "python", "python"], ["params_list", "append", "params"], ["params", "BuildProdParams", "parameters_passed"], ["prepare_for_building_prod_image", "prod_image_params", "params"], ["run_build", "prod_image_params", "params"]], "params_list": [["params_list", "builtins", "list", "airflow_breeze", "params", "build_prod_params", "BuildProdParams"], ["params_list", "append", "params"], ["prepare_for_building_prod_image", "prod_image_params", "params_list"], ["run_build_in_parallel", "image_params_list", "params_list", "python_version_list", "python_version_list", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs"]], "python": [["params", "python", "python"]], "python_version_list": [["python_version_list", "get_python_version_list", "python_versions"], ["run_build_in_parallel", "image_params_list", "params_list", "python_version_list", "python_version_list", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs"]]}, "name": "build", "params": {"debug_resources": "builtins.bool", "include_success_outputs": "builtins.bool", "kwargs": "builtins.dict[builtins.str, typing.Any]", "parallelism": "builtins.int", "python_versions": "builtins.str", "run_in_parallel": "builtins.bool", "skip_cleanup": "builtins.bool"}, "params_descr": {"debug_resources": "", "include_success_outputs": "", "kwargs": "", "parallelism": "", "python_versions": "", "run_in_parallel": "", "skip_cleanup": ""}, "params_occur": {"debug_resources": [["run_build_in_parallel", "image_params_list", "params_list", "python_version_list", "python_version_list", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs"]], "include_success_outputs": [["run_build_in_parallel", "image_params_list", "params_list", "python_version_list", "python_version_list", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs"]], "kwargs": [["parameters_passed", "filter_out_none", "kwargs"]], "parallelism": [["run_build_in_parallel", "image_params_list", "params_list", "python_version_list", "python_version_list", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs"]], "python_versions": [["python_version_list", "get_python_version_list", "python_versions"]], "run_in_parallel": [], "skip_cleanup": [["run_build_in_parallel", "image_params_list", "params_list", "python_version_list", "python_version_list", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs"]]}, "params_p": {"args": [], "debug_resources": [["List[str]", 0.5705625547718443], ["str", 0.23456971595377016], ["int", 0.09378527493975107]], "include_success_outputs": [["List[str]", 0.5705625547718443], ["str", 0.23456971595377016], ["int", 0.09378527493975107]], "kwargs": [], "parallelism": [["List[str]", 0.5705625547718443], ["str", 0.23456971595377016], ["int", 0.09378527493975107]], "python_versions": [["Optional[float]", 0.6414966803074088], ["bool", 0.1328773937294059]], "run_in_parallel": [["List[str]", 0.2045683619277792], ["bool", 0.1670636308303288], ["List[int]", 0.11068429278498772], ["str", 0.08546348570781527], ["int", 0.08279652443119476], ["float", 0.0799183343466322]], "skip_cleanup": [["List[str]", 0.5705625547718443], ["str", 0.23456971595377016], ["int", 0.09378527493975107]]}, "q_name": "build", "ret_exprs": [], "ret_type": "", "variables": {"parameters_passed": "", "params": "", "params_list": "builtins.list[airflow_breeze.params.build_prod_params.BuildProdParams]", "python": "", "python_version_list": ""}, "variables_p": {"parameters_passed": [["Dict[str, Any]", 0.19718404732659736], ["Generator[Any, None, None]", 0.19400062133486912], ["Dict[str, Union[None, Any, Any, str]]", 0.11175751476672866], ["Dict[str, Literal]", 0.10618983053784177], ["list", 0.10350583303237455], ["dict", 0.09589665547812068], ["List[str]", 0.09133712464617838]], "params": [["list", 1.0]], "params_list": [["list", 1.0]], "python": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1]], "python_version_list": [["list", 0.5806134737069226], ["List[str]", 0.14395512192309978], ["List[Tuple[str, Any]]", 0.09571895232630806], ["Type[List[int]]", 0.09143059227727174], ["Pattern[str]", 0.0882818597663978]]}}, {"docstring": {"func": "Pull and optionally verify Production images - possibly in parallel for all Python versions.", "long_descr": null, "ret": null}, "fn_lc": [[291, 0], [350, 33]], "fn_var_ln": {"image_params": [[338, 8], [338, 20]], "info": [[341, 21], [341, 25]], "prod_image_params_list": [[316, 8], [316, 30]], "python_version_list": [[315, 8], [315, 27]], "return_code": [[341, 8], [341, 19]]}, "fn_var_occur": {"image_params": [["image_params", "BuildProdParams", "image_tag", "image_tag", "python", "python", "github_repository", "github_repository", "github_token", "github_token"], ["return_code", "info", "run_pull_image", "image_params", "image_params", "output", "None", "wait_for_image", "wait_for_image", "tag_as_latest", "tag_as_latest", "poll_time_seconds"]], "info": [["return_code", "info", "run_pull_image", "image_params", "image_params", "output", "None", "wait_for_image", "wait_for_image", "tag_as_latest", "tag_as_latest", "poll_time_seconds"], ["get_console", "print", "info"]], "prod_image_params_list": [["prod_image_params_list", "BuildProdParams", "image_tag", "image_tag", "python", "python", "github_repository", "github_repository", "github_token", "github_token", "python", "python_version_list"], ["run_pull_in_parallel", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs", "image_params_list", "prod_image_params_list", "python_version_list", "python_version_list", "verify", "verify", "wait_for_image", "wait_for_image", "tag_as_latest", "tag_as_latest", "extra_pytest_args", "extra_pytest_args", "extra_pytest_args", "None"]], "python_version_list": [["python_version_list", "get_python_version_list", "python_versions"], ["prod_image_params_list", "BuildProdParams", "image_tag", "image_tag", "python", "python", "github_repository", "github_repository", "github_token", "github_token", "python", "python_version_list"], ["run_pull_in_parallel", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs", "image_params_list", "prod_image_params_list", "python_version_list", "python_version_list", "verify", "verify", "wait_for_image", "wait_for_image", "tag_as_latest", "tag_as_latest", "extra_pytest_args", "extra_pytest_args", "extra_pytest_args", "None"]], "return_code": [["return_code", "info", "run_pull_image", "image_params", "image_params", "output", "None", "wait_for_image", "wait_for_image", "tag_as_latest", "tag_as_latest", "poll_time_seconds"], ["sys", "exit", "return_code"]]}, "name": "pull_prod_image", "params": {"debug_resources": "builtins.bool", "extra_pytest_args": "builtins.tuple", "github_repository": "builtins.str", "github_token": "builtins.str", "image_tag": "builtins.str", "include_success_outputs": "", "parallelism": "builtins.int", "python": "builtins.str", "python_versions": "builtins.str", "run_in_parallel": "builtins.bool", "skip_cleanup": "builtins.bool", "tag_as_latest": "builtins.bool", "verify": "builtins.bool", "wait_for_image": "builtins.bool"}, "params_descr": {"debug_resources": "", "extra_pytest_args": "", "github_repository": "", "github_token": "", "image_tag": "", "include_success_outputs": "", "parallelism": "", "python": "", "python_versions": "", "run_in_parallel": "", "skip_cleanup": "", "tag_as_latest": "", "verify": "", "wait_for_image": ""}, "params_occur": {"debug_resources": [["run_pull_in_parallel", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs", "image_params_list", "prod_image_params_list", "python_version_list", "python_version_list", "verify", "verify", "wait_for_image", "wait_for_image", "tag_as_latest", "tag_as_latest", "extra_pytest_args", "extra_pytest_args", "extra_pytest_args", "None"]], "extra_pytest_args": [["run_pull_in_parallel", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs", "image_params_list", "prod_image_params_list", "python_version_list", "python_version_list", "verify", "verify", "wait_for_image", "wait_for_image", "tag_as_latest", "tag_as_latest", "extra_pytest_args", "extra_pytest_args", "extra_pytest_args", "None"]], "github_repository": [["prod_image_params_list", "BuildProdParams", "image_tag", "image_tag", "python", "python", "github_repository", "github_repository", "github_token", "github_token", "python", "python_version_list"], ["image_params", "BuildProdParams", "image_tag", "image_tag", "python", "python", "github_repository", "github_repository", "github_token", "github_token"]], "github_token": [["login_to_github_docker_registry", "github_token", "github_token", "output", "None"], ["prod_image_params_list", "BuildProdParams", "image_tag", "image_tag", "python", "python", "github_repository", "github_repository", "github_token", "github_token", "python", "python_version_list"], ["image_params", "BuildProdParams", "image_tag", "image_tag", "python", "python", "github_repository", "github_repository", "github_token", "github_token"]], "image_tag": [["prod_image_params_list", "BuildProdParams", "image_tag", "image_tag", "python", "python", "github_repository", "github_repository", "github_token", "github_token", "python", "python_version_list"], ["image_params", "BuildProdParams", "image_tag", "image_tag", "python", "python", "github_repository", "github_repository", "github_token", "github_token"]], "include_success_outputs": [["run_pull_in_parallel", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs", "image_params_list", "prod_image_params_list", "python_version_list", "python_version_list", "verify", "verify", "wait_for_image", "wait_for_image", "tag_as_latest", "tag_as_latest", "extra_pytest_args", "extra_pytest_args", "extra_pytest_args", "None"]], "parallelism": [["run_pull_in_parallel", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs", "image_params_list", "prod_image_params_list", "python_version_list", "python_version_list", "verify", "verify", "wait_for_image", "wait_for_image", "tag_as_latest", "tag_as_latest", "extra_pytest_args", "extra_pytest_args", "extra_pytest_args", "None"]], "python": [["prod_image_params_list", "BuildProdParams", "image_tag", "image_tag", "python", "python", "github_repository", "github_repository", "github_token", "github_token", "python", "python_version_list"], ["image_params", "BuildProdParams", "image_tag", "image_tag", "python", "python", "github_repository", "github_repository", "github_token", "github_token"]], "python_versions": [["python_version_list", "get_python_version_list", "python_versions"]], "run_in_parallel": [], "skip_cleanup": [["run_pull_in_parallel", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs", "image_params_list", "prod_image_params_list", "python_version_list", "python_version_list", "verify", "verify", "wait_for_image", "wait_for_image", "tag_as_latest", "tag_as_latest", "extra_pytest_args", "extra_pytest_args", "extra_pytest_args", "None"]], "tag_as_latest": [["run_pull_in_parallel", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs", "image_params_list", "prod_image_params_list", "python_version_list", "python_version_list", "verify", "verify", "wait_for_image", "wait_for_image", "tag_as_latest", "tag_as_latest", "extra_pytest_args", "extra_pytest_args", "extra_pytest_args", "None"], ["return_code", "info", "run_pull_image", "image_params", "image_params", "output", "None", "wait_for_image", "wait_for_image", "tag_as_latest", "tag_as_latest", "poll_time_seconds"]], "verify": [["run_pull_in_parallel", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs", "image_params_list", "prod_image_params_list", "python_version_list", "python_version_list", "verify", "verify", "wait_for_image", "wait_for_image", "tag_as_latest", "tag_as_latest", "extra_pytest_args", "extra_pytest_args", "extra_pytest_args", "None"]], "wait_for_image": [["run_pull_in_parallel", "parallelism", "parallelism", "skip_cleanup", "skip_cleanup", "debug_resources", "debug_resources", "include_success_outputs", "include_success_outputs", "image_params_list", "prod_image_params_list", "python_version_list", "python_version_list", "verify", "verify", "wait_for_image", "wait_for_image", "tag_as_latest", "tag_as_latest", "extra_pytest_args", "extra_pytest_args", "extra_pytest_args", "None"], ["return_code", "info", "run_pull_image", "image_params", "image_params", "output", "None", "wait_for_image", "wait_for_image", "tag_as_latest", "tag_as_latest", "poll_time_seconds"]]}, "params_p": {"args": [], "debug_resources": [["bool", 0.40677665308814676], ["int", 0.09879292677197733]], "extra_pytest_args": [["bool", 0.40677665308814676], ["int", 0.09879292677197733]], "github_repository": [["bool", 0.5522467518620099], ["Dict[str, Union[str, int]]", 0.16309717053445047], ["cmk.utils.type_defs.ServiceCheckResult", 0.09798338777606878]], "github_token": [["Exception", 0.11428877210118574], ["str", 0.09809123078560383], ["bool", 0.095611256290643], ["Optional[Dict[str, str]]", 0.09215854806183083], ["Callable", 0.09123047334446759]], "image_tag": [["bool", 0.5522467518620099], ["Dict[str, Union[str, int]]", 0.16309717053445047], ["cmk.utils.type_defs.ServiceCheckResult", 0.09798338777606878]], "include_success_outputs": [["bool", 0.40677665308814676], ["int", 0.09879292677197733]], "kwargs": [], "parallelism": [["bool", 0.40677665308814676], ["int", 0.09879292677197733]], "python": [["bool", 0.5522467518620099], ["Dict[str, Union[str, int]]", 0.16309717053445047], ["cmk.utils.type_defs.ServiceCheckResult", 0.09798338777606878]], "python_versions": [["Optional[float]", 0.6711805652010145], ["bool", 0.19007446422520105], ["Sequence[object]", 0.06935986097669203]], "run_in_parallel": [["bool", 0.5762085792718944], ["Optional[bool]", 0.19967701859173384], ["List[int]", 0.13648572408877027], ["str", 0.08762867804760137]], "skip_cleanup": [["bool", 0.40677665308814676], ["int", 0.09879292677197733]], "tag_as_latest": [["bool", 0.40677665308814676], ["int", 0.09879292677197733]], "verify": [["bool", 0.40677665308814676], ["int", 0.09879292677197733]], "wait_for_image": [["bool", 0.40677665308814676], ["int", 0.09879292677197733]]}, "q_name": "pull_prod_image", "ret_exprs": [], "ret_type": "", "variables": {"image_params": "", "info": "", "prod_image_params_list": "", "python_version_list": "", "return_code": ""}, "variables_p": {"image_params": [["str", 0.5760230426478028], ["Counter[str]", 0.17225113199854936], ["Set[str]", 0.08884741715104826]], "info": [["Tuple[Dict[str, Any], Dict[Any, Any], Dict[Any, Any]]", 0.30426845507997025], ["Generator[Dict[str, Any], None, None]", 0.20637028866052987], ["Tuple[Dict[str, Any], Dict[Any, Any], Dict[Any, Any], Dict[Any, Any], Dict[Any, Any]]", 0.18648840210527165], ["List[List[str]]", 0.11707775505466163], ["int", 0.0930503694935423], ["Dict[str, List[Any]]", 0.09274472960602427]], "prod_image_params_list": [["str", 0.8101868878516699], ["List[str]", 0.18981311214832983]], "python_version_list": [["List[str]", 0.2765141995253755], ["Type[List[int]]", 0.09352239082410749]], "return_code": [["int", 0.8132013039226224], ["Final", 0.09202816036224629]]}}, {"docstring": {"func": "Verify Production image.", "long_descr": null, "ret": null}, "fn_lc": [[374, 0], [410, 25]], "fn_var_ln": {"build_params": [[391, 8], [391, 20]], "command_to_run": [[400, 8], [400, 22]], "image_name": [[397, 8], [397, 18]], "info": [[403, 17], [403, 21]], "return_code": [[403, 4], [403, 15]]}, "fn_var_occur": {"build_params": [["build_params", "BuildProdParams", "python", "python", "image_tag", "image_tag", "github_repository", "github_repository", "github_token", "github_token"], ["image_name", "build_params", "airflow_image_name_with_tag"]], "command_to_run": [["command_to_run", "image_name"], ["run_command", "command_to_run", "check", "True"]], "image_name": [["image_name", "None"], ["image_name", "build_params", "airflow_image_name_with_tag"], ["command_to_run", "image_name"], ["get_console", "print", "image_name"], ["return_code", "info", "verify_an_image", "image_name", "image_name", "output", "None", "image_type", "extra_pytest_args", "extra_pytest_args", "slim_image", "slim_image"]], "info": [["return_code", "info", "verify_an_image", "image_name", "image_name", "output", "None", "image_type", "extra_pytest_args", "extra_pytest_args", "slim_image", "slim_image"]], "return_code": [["return_code", "info", "verify_an_image", "image_name", "image_name", "output", "None", "image_type", "extra_pytest_args", "extra_pytest_args", "slim_image", "slim_image"], ["sys", "exit", "return_code"]]}, "name": "verify", "params": {"extra_pytest_args": "builtins.tuple", "github_repository": "builtins.str", "github_token": "builtins.str", "image_name": "builtins.str", "image_tag": "str | None", "pull": "builtins.bool", "python": "builtins.str", "slim_image": "builtins.bool"}, "params_descr": {"extra_pytest_args": "", "github_repository": "", "github_token": "", "image_name": "", "image_tag": "", "pull": "", "python": "", "slim_image": ""}, "params_occur": {"extra_pytest_args": [["return_code", "info", "verify_an_image", "image_name", "image_name", "output", "None", "image_type", "extra_pytest_args", "extra_pytest_args", "slim_image", "slim_image"]], "github_repository": [["build_params", "BuildProdParams", "python", "python", "image_tag", "image_tag", "github_repository", "github_repository", "github_token", "github_token"]], "github_token": [["login_to_github_docker_registry", "github_token", "github_token", "output", "None"], ["build_params", "BuildProdParams", "python", "python", "image_tag", "image_tag", "github_repository", "github_repository", "github_token", "github_token"]], "image_name": [["image_name", "None"], ["image_name", "build_params", "airflow_image_name_with_tag"], ["command_to_run", "image_name"], ["get_console", "print", "image_name"], ["return_code", "info", "verify_an_image", "image_name", "image_name", "output", "None", "image_type", "extra_pytest_args", "extra_pytest_args", "slim_image", "slim_image"]], "image_tag": [["build_params", "BuildProdParams", "python", "python", "image_tag", "image_tag", "github_repository", "github_repository", "github_token", "github_token"]], "pull": [], "python": [["build_params", "BuildProdParams", "python", "python", "image_tag", "image_tag", "github_repository", "github_repository", "github_token", "github_token"]], "slim_image": [["return_code", "info", "verify_an_image", "image_name", "image_name", "output", "None", "image_type", "extra_pytest_args", "extra_pytest_args", "slim_image", "slim_image"]]}, "params_p": {"args": [], "extra_pytest_args": [["bool", 0.2922293237144175], ["Dict[str, str]", 0.2817965836315114], ["dict", 0.21761082920697783], ["Optional[str]", 0.11350264925719367], ["str", 0.09486061418989951]], "github_repository": [["str", 0.31934944228951784], ["List[str]", 0.2789942370662193], ["bool", 0.10543692740963587], ["Optional[Sequence[str]]", 0.09697390088317204], ["Optional[bytes]", 0.09459789074673983]], "github_token": [["str", 0.2187719426928298], ["Optional[List[str]]", 0.19748739102289847], ["Optional[str]", 0.17828284550937873], ["Optional[Dict[str, Any]]", 0.12580463494327213], ["bool", 0.10166644170281966]], "image_name": [["Optional[str]", 0.39046120071432977], ["Optional[List[str]]", 0.18908503465517063], ["Dict[str, str]", 0.13566366995019388], ["Optional[List[Any]]", 0.09276562589075188], ["Optional[Union[str, Any]]", 0.09276562589075188]], "image_tag": [["str", 0.31934944228951784], ["List[str]", 0.2789942370662193], ["bool", 0.10543692740963587], ["Optional[Sequence[str]]", 0.09697390088317204], ["Optional[bytes]", 0.09459789074673983]], "kwargs": [], "pull": [["bool", 0.3953143652226214], ["str", 0.3189773504349158], ["int", 0.10823672144582906], ["List[str]", 0.09086920288174605], ["Optional[Any]", 0.08660236001488755]], "python": [["str", 0.31934944228951784], ["List[str]", 0.2789942370662193], ["bool", 0.10543692740963587], ["Optional[Sequence[str]]", 0.09697390088317204], ["Optional[bytes]", 0.09459789074673983]], "slim_image": [["bool", 0.2922293237144175], ["Dict[str, str]", 0.2817965836315114], ["dict", 0.21761082920697783], ["Optional[str]", 0.11350264925719367], ["str", 0.09486061418989951]]}, "q_name": "verify", "ret_exprs": [], "ret_type": "", "variables": {"build_params": "", "command_to_run": "", "image_name": "", "info": "", "return_code": ""}, "variables_p": {"build_params": [["str", 0.3916499616835839], ["bool", 0.22156254716047702], ["dict", 0.07516181164707905], ["Dict[str, Any]", 0.07403013865238854]], "command_to_run": [["str", 0.2771367679209827], ["List[str]", 0.1907509088212594], ["Dict[str, Any]", 0.11885404071323213], ["Dict[str, List[Any]]", 0.10889575679018364], ["Set[str]", 0.10790981831985114]], "image_name": [["str", 0.3949713210025942], ["List[str]", 0.22738120181434934], ["Set[str]", 0.1885868893739575], ["list", 0.09865356900402544]], "info": [["Dict[str, str]", 0.1793517363674561], ["List[str]", 0.16934982079802738], ["dict", 0.1511577231134068], ["Dict[str, Union[Any, Any, Any, Any]]", 0.1339211373377333], ["Dict[str, List[str]]", 0.1096487613507423], ["Dict[str, Any]", 0.08799325049989341], ["Dict[str, Union[Any, Any]]", 0.0836653239871269]], "return_code": [["str", 0.696962005558678], ["int", 0.11432942453763523], ["Optional[str]", 0.09954640766308373], ["Type[str]", 0.0891621622406029]]}}, {"docstring": {"func": "Cleans up docker context files folder - leaving only .README.md there.", "long_descr": null, "ret": null}, "fn_lc": [[413, 0], [425, 39]], "fn_var_ln": {"context_files_to_delete": [[422, 8], [422, 31]]}, "fn_var_occur": {"context_files_to_delete": [["context_files_to_delete", "DOCKER_CONTEXT_DIR", "glob"]]}, "name": "clean_docker_context_files", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": []}, "q_name": "clean_docker_context_files", "ret_exprs": ["return"], "ret_type": "", "ret_type_p": [["Iterator[object]", 0.18154572071096392], ["bool", 0.09607579868124394], ["str", 0.09204782253654473]], "variables": {"context_files_to_delete": ""}, "variables_p": {"context_files_to_delete": [["str", 0.7743284586227616], ["List[List[int]]", 0.14538491855493704], ["Tuple[str, str, str]", 0.08028662282230138]]}}, {"docstring": {"func": "Quick check - if we want to install from docker-context-files we expect some packages there but if", "long_descr": "we don't - we don't expect them, and they might invalidate Docker cache.\n\nThis method exits with an error if what we see is unexpected for given operation.", "ret": null}, "fn_lc": [[428, 0], [456, 23]], "fn_var_ln": {"context_file": [[437, 4], [437, 16]], "number_of_context_files": [[438, 4], [438, 27]]}, "fn_var_occur": {"context_file": [["context_file", "DOCKER_CONTEXT_DIR", "glob"], ["number_of_context_files", "len", "context", "context", "context_file", "context", "is_file", "context", "name"]], "number_of_context_files": [["number_of_context_files", "len", "context", "context", "context_file", "context", "is_file", "context", "name"]]}, "name": "check_docker_context_files", "params": {"install_packages_from_context": "builtins.bool"}, "params_descr": {"install_packages_from_context": "whether we want to install from docker-context-files"}, "params_occur": {"install_packages_from_context": []}, "params_p": {"args": [], "install_packages_from_context": [["bool", 0.3064081158509785], ["str", 0.19009315805341973], ["int", 0.1054159051177443], ["Optional[str]", 0.09555835206095761]], "kwargs": []}, "q_name": "check_docker_context_files", "ret_exprs": [], "ret_type": "", "variables": {"context_file": "", "number_of_context_files": ""}, "variables_p": {"context_file": [["str", 0.3171030870199995]], "number_of_context_files": [["str", 0.22344613234898678], ["List[int]", 0.18220162788777777], ["int", 0.12263127564266003], ["Set[str]", 0.10176655119651112], ["Dict[int, str]", 0.10141429582472267], ["List[str]", 0.09110081394388889], ["list", 0.08899069919236992], ["Dict[str, str]", 0.08844860396308293]]}}, {"docstring": {"func": "Builds PROD image:", "long_descr": "* fixes group permissions for files (to improve caching when umask is 002)\n  * converts all the parameters received via kwargs into BuildProdParams (including cache)\n  * prints info about the image to build\n  * removes docker-context-files if requested\n  * performs quick check if the files are present in docker-context-files if expected\n  * logs int to docker registry on CI if build cache is being executed\n  * removes \"tag\" for previously build image so that inline cache uses only remote image\n  * constructs docker-compose command to run based on parameters passed\n  * run the build command\n  * update cached information that the build completed and saves checksums of all files\n    for quick future check if the build is needed", "ret": null}, "fn_lc": [[459, 0], [545, 86]], "fn_var_ln": {"build_command_result": [[544, 20], [544, 40]], "env": [[497, 8], [497, 11]], "upgrade_to_newer_dependencies": [[528, 16], [528, 63]]}, "fn_var_occur": {"build_command_result": [["build_command_result", "build_cache", "image_params", "prod_image_params", "output", "output"], ["build_command_result", "run_command", "prepare_docker_build_from_input", "image_params", "prod_image_params", "input", "cwd", "AIRFLOW_SOURCES_ROOT", "check", "False", "text", "True", "env", "env", "output", "output"], ["build_command_result", "run_command", "prepare_docker_build_command", "image_params", "prod_image_params", "cwd", "AIRFLOW_SOURCES_ROOT", "check", "False", "env", "env", "text", "True", "output", "output"], ["build_command_result", "returncode", "prod_image_params", "upgrade_on_failure", "prod_image_params", "upgrade_to_newer_dependencies"], ["build_command_result", "run_command", "prepare_docker_build_command", "image_params", "prod_image_params", "cwd", "AIRFLOW_SOURCES_ROOT", "check", "False", "text", "True", "env", "env", "output", "output"], ["build_command_result", "returncode"], ["build_command_result", "tag_image_as_latest", "image_params", "prod_image_params", "output", "output"], ["build_command_result", "returncode", "prod_image_params", "python"]], "env": [["env", "os", "environ", "copy"], ["build_command_result", "run_command", "prepare_docker_build_from_input", "image_params", "prod_image_params", "input", "cwd", "AIRFLOW_SOURCES_ROOT", "check", "False", "text", "True", "env", "env", "output", "output"], ["build_command_result", "run_command", "prepare_docker_build_command", "image_params", "prod_image_params", "cwd", "AIRFLOW_SOURCES_ROOT", "check", "False", "env", "env", "text", "True", "output", "output"], ["build_command_result", "run_command", "prepare_docker_build_command", "image_params", "prod_image_params", "cwd", "AIRFLOW_SOURCES_ROOT", "check", "False", "text", "True", "env", "env", "output", "output"]], "upgrade_to_newer_dependencies": [["build_command_result", "returncode", "prod_image_params", "upgrade_on_failure", "prod_image_params", "upgrade_to_newer_dependencies"], ["prod_image_params", "upgrade_to_newer_dependencies", "True"]]}, "name": "run_build_production_image", "params": {"output": "Output | None", "prod_image_params": "airflow_breeze.params.build_prod_params.BuildProdParams"}, "params_descr": {"output": "output redirection", "prod_image_params": "PROD image parameters"}, "params_occur": {"output": [["get_console", "output", "output", "print"], ["get_console", "output", "output", "print", "prod_image_params", "python"], ["build_command_result", "build_cache", "image_params", "prod_image_params", "output", "output"], ["get_console", "output", "output", "print", "prod_image_params", "python"], ["build_command_result", "run_command", "prepare_docker_build_from_input", "image_params", "prod_image_params", "input", "cwd", "AIRFLOW_SOURCES_ROOT", "check", "False", "text", "True", "env", "env", "output", "output"], ["build_command_result", "run_command", "prepare_docker_build_command", "image_params", "prod_image_params", "cwd", "AIRFLOW_SOURCES_ROOT", "check", "False", "env", "env", "text", "True", "output", "output"], ["build_command_result", "run_command", "prepare_docker_build_command", "image_params", "prod_image_params", "cwd", "AIRFLOW_SOURCES_ROOT", "check", "False", "text", "True", "env", "env", "output", "output"], ["build_command_result", "tag_image_as_latest", "image_params", "prod_image_params", "output", "output"]], "prod_image_params": [["prod_image_params", "is_multi_platform", "prod_image_params", "push", "prod_image_params", "prepare_buildx_cache"], ["get_console", "output", "output", "print", "prod_image_params", "python"], ["prod_image_params", "prepare_buildx_cache"], ["build_command_result", "build_cache", "image_params", "prod_image_params", "output", "output"], ["prod_image_params", "empty_image"], ["get_console", "output", "output", "print", "prod_image_params", "python"], ["build_command_result", "run_command", "prepare_docker_build_from_input", "image_params", "prod_image_params", "input", "cwd", "AIRFLOW_SOURCES_ROOT", "check", "False", "text", "True", "env", "env", "output", "output"], ["build_command_result", "run_command", "prepare_docker_build_command", "image_params", "prod_image_params", "cwd", "AIRFLOW_SOURCES_ROOT", "check", "False", "env", "env", "text", "True", "output", "output"], ["build_command_result", "returncode", "prod_image_params", "upgrade_on_failure", "prod_image_params", "upgrade_to_newer_dependencies"], ["prod_image_params", "upgrade_to_newer_dependencies", "True"], ["build_command_result", "run_command", "prepare_docker_build_command", "image_params", "prod_image_params", "cwd", "AIRFLOW_SOURCES_ROOT", "check", "False", "text", "True", "env", "env", "output", "output"], ["prod_image_params", "tag_as_latest"], ["build_command_result", "tag_image_as_latest", "image_params", "prod_image_params", "output", "output"], ["build_command_result", "returncode", "prod_image_params", "python"]]}, "params_p": {"args": [], "kwargs": [], "output": [["str", 0.18979106035806156], ["List[str]", 0.13847350887630996], ["Sequence[str]", 0.10192429708252868], ["Callable[[Dict], Any]", 0.09053474007841379], ["Exception", 0.08670297971942983]], "prod_image_params": [["Union[str, IO[bytes]]", 0.26496974150552915], ["bool", 0.10338827768339509], ["int", 0.1005785472738162], ["str", 0.08837582417312047], ["float", 0.08837582417312047]]}, "q_name": "run_build_production_image", "ret_exprs": ["return 1, \"Error: building multi-platform image without --push.\"", "return build_command_result.returncode, f\"Image build: {prod_image_params.python}\""], "ret_type": "builtins.tuple[builtins.int, builtins.str]", "ret_type_p": [["str", 0.5600496256460529], ["Type[T]", 0.339470845291598]], "variables": {"build_command_result": "", "env": "", "upgrade_to_newer_dependencies": ""}, "variables_p": {"build_command_result": [["Dict[str, str]", 0.27218189996347575], ["str", 0.22064556292132953], ["List[str]", 0.1186079363944482], ["int", 0.10339666512352236]], "env": [["str", 0.18944612038041103], ["Dict[str, Dict[str, Any]]", 0.09625657193510002], ["int", 0.08888246289172341], ["Dict[str, str]", 0.08275489578297014], ["Dict[str, Union[Any, str]]", 0.08035377049470066]], "upgrade_to_newer_dependencies": [["int", 0.27908287755231764], ["Dict[str, Union[bool, str]]", 0.11401855822838877], ["DefaultDict[Any, List[Any]]", 0.10758580179932914], ["set", 0.09720396468264965], ["Final", 0.0913347074270455], ["Dict[str, str]", 0.0912666827031919]]}}], "imports": ["__future__", "annotations", "contextlib", "os", "sys", "typing", "Any", "click", "airflow_breeze", "global_constants", "ALLOWED_INSTALLATION_METHODS", "DEFAULT_EXTRAS", "airflow_breeze", "params", "build_prod_params", "BuildProdParams", "airflow_breeze", "utils", "ci_group", "ci_group", "airflow_breeze", "utils", "click_utils", "BreezeGroup", "airflow_breeze", "utils", "common_options", "option_additional_dev_apt_command", "option_additional_dev_apt_deps", "option_additional_dev_apt_env", "option_additional_extras", "option_additional_pip_install_flags", "option_additional_python_deps", "option_additional_runtime_apt_command", "option_additional_runtime_apt_deps", "option_additional_runtime_apt_env", "option_airflow_constraints_location", "option_airflow_constraints_mode_prod", "option_airflow_constraints_reference_build", "option_builder", "option_debug_resources", "option_dev_apt_command", "option_dev_apt_deps", "option_docker_cache", "option_dry_run", "option_empty_image", "option_github_repository", "option_github_token", "option_image_name", "option_image_tag_for_building", "option_image_tag_for_pulling", "option_image_tag_for_verifying", "option_include_success_outputs", "option_install_providers_from_sources", "option_parallelism", "option_platform_multiple", "option_prepare_buildx_cache", "option_pull", "option_push", "option_python", "option_python_image", "option_python_versions", "option_run_in_parallel", "option_runtime_apt_command", "option_runtime_apt_deps", "option_skip_cleanup", "option_tag_as_latest", "option_upgrade_on_failure", "option_upgrade_to_newer_dependencies", "option_verbose", "option_verify", "option_wait_for_image", "airflow_breeze", "utils", "console", "Output", "get_console", "airflow_breeze", "utils", "custom_param_types", "BetterChoice", "airflow_breeze", "utils", "docker_command_utils", "build_cache", "check_remote_ghcr_io_commands", "make_sure_builder_configured", "perform_environment_checks", "prepare_docker_build_command", "prepare_docker_build_from_input", "warm_up_docker_builder", "airflow_breeze", "utils", "image", "run_pull_image", "run_pull_in_parallel", "tag_image_as_latest", "airflow_breeze", "utils", "parallel", "DockerBuildxProgressMatcher", "check_async_run_results", "run_with_pool", "airflow_breeze", "utils", "path_utils", "AIRFLOW_SOURCES_ROOT", "DOCKER_CONTEXT_DIR", "airflow_breeze", "utils", "python_versions", "get_python_version_list", "airflow_breeze", "utils", "registry", "login_to_github_docker_registry", "airflow_breeze", "utils", "run_tests", "verify_an_image", "airflow_breeze", "utils", "run_utils", "filter_out_none", "fix_group_permissions", "run_command", "airflow_breeze", "utils", "shared_options", "get_dry_run", "get_verbose"], "mod_var_ln": {}, "mod_var_occur": {}, "no_types_annot": {"D": 42, "I": 0, "U": 32}, "session_id": "AX1Ihfr41poPo-UrKB2iInHcy1qrkEjeKr9UqL734jw", "set": null, "tc": [false, null], "type_annot_cove": 0.57, "typed_seq": "", "untyped_seq": "", "variables": {}, "variables_p": {}}}