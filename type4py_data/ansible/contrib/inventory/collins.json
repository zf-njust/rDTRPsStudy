{"error": null, "response": {"classes": [{"cls_lc": [[88, 0], [96, 45]], "cls_var_ln": {"ASSETS_API_ENDPOINT": [[89, 4], [89, 23]], "LOG_FORMAT": [[96, 4], [96, 14]], "SPECIAL_ATTRIBUTES": [[90, 4], [90, 22]]}, "cls_var_occur": {"ASSETS_API_ENDPOINT": [], "LOG_FORMAT": [], "SPECIAL_ATTRIBUTES": []}, "funcs": [], "name": "CollinsDefaults", "q_name": "CollinsDefaults", "variables": {"ASSETS_API_ENDPOINT": "", "LOG_FORMAT": "", "SPECIAL_ATTRIBUTES": ""}, "variables_p": {"ASSETS_API_ENDPOINT": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]], "LOG_FORMAT": [["str", 0.9999999999999999]], "SPECIAL_ATTRIBUTES": [["str", 0.4], ["List[str]", 0.1], ["int", 0.1], ["Dict[str, List[Any]]", 0.1], ["Tuple[str, str, str, str, str, str, str, str]", 0.1]]}}, {"cls_lc": [[99, 0], [100, 8]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [], "name": "Error", "q_name": "Error", "variables": {}, "variables_p": {}}, {"cls_lc": [[103, 0], [104, 8]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [], "name": "MaxRetriesError", "q_name": "MaxRetriesError", "variables": {}, "variables_p": {}}, {"cls_lc": [[107, 0], [444, 35]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": "Constructs CollinsInventory object and reads all configuration. ", "long_descr": null, "ret": null}, "fn_lc": [[109, 4], [121, 56]], "fn_var_ln": {"cache": [[113, 8], [113, 18]], "inventory": [[112, 8], [112, 22]], "log": [[121, 8], [121, 16]]}, "fn_var_occur": {"cache": [["self", "cache", "dict"]], "inventory": [["self", "inventory", "dict"]], "log": [["self", "log", "logging", "getLogger"]]}, "name": "__init__", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "inventory", "dict"], ["self", "cache", "dict"], ["self", "read_settings"], ["self", "parse_cli_args"], ["logging", "basicConfig", "format", "CollinsDefaults", "LOG_FORMAT", "filename", "self", "log_location"], ["self", "log", "logging", "getLogger"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "CollinsInventory.__init__", "ret_exprs": [], "ret_type": "", "variables": {"cache": "", "inventory": "", "log": ""}, "variables_p": {"cache": [["Callable[[], None]", 0.12066282968725606], ["List[int]", 0.11112276757776104], ["set", 0.09972356382353528], ["Set[str]", 0.09972356382353528], ["int", 0.08587677220640601]], "inventory": [["str", 0.30000000000000004], ["Dict[str, Any]", 0.1], ["dict", 0.1], ["int", 0.1]], "log": [["logging.Logger", 0.5968779424016031], ["logging.Formatter", 0.31718583760997154], ["rotkehlchen.logging.RotkehlchenLogsAdapter", 0.08593621998842534]]}}, {"docstring": {"func": "Returns a user-defined attribute from an asset if it exists; otherwise,", "long_descr": "returns None.", "ret": null}, "fn_lc": [[123, 4], [131, 19]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "_asset_get_attribute", "params": {"asset": "", "attrib": "", "self": ""}, "params_descr": {"asset": "", "attrib": "", "self": ""}, "params_occur": {"asset": [["asset", "keys"], ["attrib", "asset", "attrib_block"], ["asset", "attrib_block", "attrib"]], "attrib": [["attrib", "asset", "attrib_block"], ["asset", "attrib_block", "attrib"]], "self": []}, "params_p": {"args": [], "asset": [["bool", 0.28141638467434277], ["int", 0.1818382352266637], ["dict", 0.12750367662978732]], "attrib": [["int", 0.49543922407354557], ["float", 0.2949614845654042], ["bool", 0.09832049485513474]], "kwargs": [], "self": []}, "q_name": "CollinsInventory._asset_get_attribute", "ret_exprs": ["return asset['ATTRIBS'][attrib_block][attrib]", "return None"], "ret_type": "", "ret_type_p": [["int", 0.11897793053577978], ["Callable", 0.09349511524878508], ["Iterable[str]", 0.0825919196977389]], "variables": {}, "variables_p": {}}, {"docstring": {"func": "Returns whether a user-defined attribute is present on an asset. ", "long_descr": null, "ret": null}, "fn_lc": [[133, 4], [140, 20]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "_asset_has_attribute", "params": {"asset": "", "attrib": "", "self": ""}, "params_descr": {"asset": "", "attrib": "", "self": ""}, "params_occur": {"asset": [["asset", "keys"], ["attrib", "asset", "attrib_block"]], "attrib": [["attrib", "asset", "attrib_block"]], "self": []}, "params_p": {"args": [], "asset": [["float", 0.5486475461289733], ["bool", 0.09008167469541094], ["int", 0.09008167469541094]], "attrib": [["str", 0.14256132840913066]], "kwargs": [], "self": []}, "q_name": "CollinsInventory._asset_has_attribute", "ret_exprs": ["return True", "return False"], "ret_type": "", "ret_type_p": [["bool", 1.0]], "variables": {}, "variables_p": {}}, {"docstring": {"func": "Main execution path ", "long_descr": null, "ret": null}, "fn_lc": [[142, 4], [169, 25]], "fn_var_ln": {"data_to_print": [[166, 12], [166, 25]], "successful": [[152, 12], [152, 22]]}, "fn_var_occur": {"data_to_print": [["data_to_print", "self", "get_host_info"], ["data_to_print", "self", "json_format_dict", "self", "inventory", "self", "args", "pretty"], ["data_to_print", "self", "json_format_dict", "self", "inventory", "self", "args", "pretty"], ["print", "data_to_print"]], "successful": [["successful", "True"], ["successful", "self", "update_cache"], ["successful", "self", "update_cache"], ["successful", "self", "load_inventory_from_cache"], ["successful", "self", "load_cache_from_cache"]]}, "name": "run", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "args", "refresh_cache"], ["successful", "self", "update_cache"], ["self", "is_cache_valid"], ["successful", "self", "update_cache"], ["successful", "self", "load_inventory_from_cache"], ["successful", "self", "load_cache_from_cache"], ["self", "args", "host"], ["data_to_print", "self", "get_host_info"], ["self", "args", "list"], ["data_to_print", "self", "json_format_dict", "self", "inventory", "self", "args", "pretty"], ["data_to_print", "self", "json_format_dict", "self", "inventory", "self", "args", "pretty"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "CollinsInventory.run", "ret_exprs": ["return successful"], "ret_type": "", "ret_type_p": [["str", 0.2], ["int", 0.1], ["bool", 0.1], ["list", 0.1]], "variables": {"data_to_print": "", "successful": ""}, "variables_p": {"data_to_print": [["str", 0.1794376509717519], ["Dict[str, int]", 0.14349938633553805], ["list", 0.11179056220184481], ["Type[str]", 0.10141433145790515], ["List[Tuple[str, str, str, str]]", 0.09642913116856167], ["List[str]", 0.09181445187697772], ["set", 0.09009397082929198], ["Dict[str, str]", 0.08949325167159042]], "successful": [["str", 1.0]]}}, {"docstring": {"func": "Obtains Collins assets matching the provided attributes. ", "long_descr": null, "ret": null}, "fn_lc": [[171, 4], [217, 21]], "fn_var_ln": {"assets": [[187, 8], [187, 14]], "attributes_query": [[177, 8], [177, 24]], "cur_page": [[188, 8], [188, 16]], "json_response": [[205, 16], [205, 29]], "num_retries": [[212, 16], [212, 27]], "query_parameters": [[179, 8], [179, 24]], "query_url": [[196, 12], [196, 21]], "response": [[201, 16], [201, 24]]}, "fn_var_occur": {"assets": [["assets", "json_response"]], "attributes_query": [["attributes_query", "join", "attr_pair", "attr_pair", "iteritems", "attributes"], ["query_parameters", "operation", "attributes_query", "str", "self", "query_remote_dcs", "self", "results_per_query", "self", "collins_asset_type"]], "cur_page": [["query_parameters", "cur_page"]], "json_response": [["json_response", "json", "loads", "response", "read"], ["assets", "json_response"], ["len", "json_response"]], "num_retries": [["num_retries", "self", "collins_max_retries"]], "query_parameters": [["query_parameters", "operation", "attributes_query", "str", "self", "query_remote_dcs", "self", "results_per_query", "self", "collins_asset_type"], ["query_parameters", "cur_page"], ["query_url", "CollinsDefaults", "ASSETS_API_ENDPOINT", "self", "collins_host", "urllib", "urlencode", "query_parameters", "doseq", "True"]], "query_url": [["query_url", "CollinsDefaults", "ASSETS_API_ENDPOINT", "self", "collins_host", "urllib", "urlencode", "query_parameters", "doseq", "True"], ["response", "open_url", "query_url", "timeout", "self", "collins_timeout_secs", "url_username", "self", "collins_username", "url_password", "self", "collins_password"]], "response": [["response", "open_url", "query_url", "timeout", "self", "collins_timeout_secs", "url_username", "self", "collins_username", "url_password", "self", "collins_password"], ["json_response", "json", "loads", "response", "read"]]}, "name": "find_assets", "params": {"attributes": "", "operation": "", "self": ""}, "params_descr": {"attributes": "", "operation": "", "self": ""}, "params_occur": {"attributes": [["attributes_query", "join", "attr_pair", "attr_pair", "iteritems", "attributes"]], "operation": [["query_parameters", "operation", "attributes_query", "str", "self", "query_remote_dcs", "self", "results_per_query", "self", "collins_asset_type"]], "self": [["query_parameters", "operation", "attributes_query", "str", "self", "query_remote_dcs", "self", "results_per_query", "self", "collins_asset_type"], ["num_retries", "self", "collins_max_retries"], ["MaxRetriesError", "self", "collins_max_retries"], ["query_url", "CollinsDefaults", "ASSETS_API_ENDPOINT", "self", "collins_host", "urllib", "urlencode", "query_parameters", "doseq", "True"], ["response", "open_url", "query_url", "timeout", "self", "collins_timeout_secs", "url_username", "self", "collins_username", "url_password", "self", "collins_password"], ["self", "log", "error", "traceback", "format_exc"]]}, "params_p": {"args": [], "attributes": [["str", 0.5152361973644052], ["List[str]", 0.2096262799076145], ["int", 0.08382969677254355]], "kwargs": [], "operation": [["int", 0.20429658530838113], ["str", 0.10122781081228417], ["Union[str, float]", 0.10078178236183535], ["float", 0.09886351017184777], ["Tuple[int, int]", 0.09745783393627946], ["slice", 0.09601203464913274]], "self": []}, "q_name": "CollinsInventory.find_assets", "ret_exprs": ["return assets"], "ret_type": "", "ret_type_p": [["int", 0.1], ["set", 0.1], ["str", 0.1]], "variables": {"assets": "", "attributes_query": "", "cur_page": "", "json_response": "", "num_retries": "", "query_parameters": "", "query_url": "", "response": ""}, "variables_p": {"assets": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1]], "attributes_query": [["str", 0.6029391667969488], ["list", 0.2002059876057777], ["dict", 0.10682522751964958]], "cur_page": [["List[int]", 0.40947455768001384], ["List[str]", 0.2162092225340147], ["int", 0.12521740392800448], ["str", 0.05787470812686177], ["List[Tuple[int, int, int]]", 0.048737748134023734], ["Tuple[int, int, int, int]", 0.04615522727902314]], "json_response": [["Dict[str, str]", 0.2032664191959138], ["bytes", 0.09244962230267165], ["dict", 0.06813811759982043]], "num_retries": [["int", 0.7132298017439791], ["Dict[int, Any]", 0.21072772507353293], ["list", 0.0760424731824879]], "query_parameters": [["str", 0.18400985383987062], ["Set[str]", 0.17643305896725642], ["Dict[int, List[str]]", 0.1727815019679786], ["Tuple[Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal, Literal]", 0.12292973792934733], ["Dict[str, List[int]]", 0.09789900882384742], ["Dict[str, set]", 0.07503862299132186], ["set", 0.07291525969706135]], "query_url": [["Set[str]", 0.1882390053842405]], "response": [["str", 0.1965752798658702], ["bool", 0.11422816604338495], ["Dict[str, Any]", 0.10336867673088602], ["int", 0.10053234578811998], ["Optional[str]", 0.09937578941976916], ["OrderedDict[str, str]", 0.09787026754939357], ["Dict[str, str]", 0.09671314851967139], ["Iterator[str]", 0.09336619394163787]]}}, {"docstring": {"func": "Determines if the cache files have expired, or if it is still valid ", "long_descr": null, "ret": null}, "fn_lc": [[219, 4], [229, 20]], "fn_var_ln": {"current_time": [[224, 12], [224, 24]], "mod_time": [[223, 12], [223, 20]]}, "fn_var_occur": {"current_time": [["current_time", "time"], ["mod_time", "self", "cache_max_age", "current_time"]], "mod_time": [["mod_time", "os", "path", "getmtime", "self", "cache_path_cache"], ["mod_time", "self", "cache_max_age", "current_time"]]}, "name": "is_cache_valid", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["os", "path", "isfile", "self", "cache_path_cache"], ["mod_time", "os", "path", "getmtime", "self", "cache_path_cache"], ["mod_time", "self", "cache_max_age", "current_time"], ["os", "path", "isfile", "self", "cache_path_inventory"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "CollinsInventory.is_cache_valid", "ret_exprs": ["return True", "return False"], "ret_type": "", "ret_type_p": [["bool", 0.9999999999999999]], "variables": {"current_time": "", "mod_time": ""}, "variables_p": {"current_time": [["float", 0.4414244118914488], ["time.struct_time", 0.2930892097725718], ["Anaconda3.Lib.site-packages.astropy.time.core.TimeDelta", 0.17504724688494644]], "mod_time": [["str", 1.0]]}}, {"docstring": {"func": "Reads the settings from the collins.ini file ", "long_descr": null, "ret": null}, "fn_lc": [[231, 4], [263, 61]], "fn_var_ln": {"cache_max_age": [[260, 8], [260, 26]], "cache_path": [[255, 8], [255, 18]], "cache_path_cache": [[256, 8], [256, 29]], "cache_path_inventory": [[258, 8], [258, 33]], "collins_asset_type": [[245, 8], [245, 31]], "collins_host": [[240, 8], [240, 25]], "collins_max_retries": [[248, 8], [248, 32]], "collins_password": [[243, 8], [243, 29]], "collins_timeout_secs": [[247, 8], [247, 33]], "collins_username": [[241, 8], [241, 29]], "config": [[237, 8], [237, 14]], "config_loc": [[234, 8], [234, 18]], "ip_address_index": [[251, 8], [251, 29]], "log_location": [[263, 8], [263, 25]], "log_path": [[262, 8], [262, 16]], "prefer_hostnames": [[253, 8], [253, 29]], "query_remote_dcs": [[252, 8], [252, 29]], "results_per_query": [[250, 8], [250, 30]]}, "fn_var_occur": {"cache_max_age": [["self", "cache_max_age", "config", "getint"]], "cache_path": [["cache_path", "config", "get"], ["self", "cache_path_cache", "cache_path", "self", "collins_asset_type"], ["self", "cache_path_inventory", "cache_path", "self", "collins_asset_type"]], "cache_path_cache": [["self", "cache_path_cache", "cache_path", "self", "collins_asset_type"]], "cache_path_inventory": [["self", "cache_path_inventory", "cache_path", "self", "collins_asset_type"]], "collins_asset_type": [["self", "collins_asset_type", "os", "getenv", "config", "get"], ["self", "cache_path_cache", "cache_path", "self", "collins_asset_type"], ["self", "cache_path_inventory", "cache_path", "self", "collins_asset_type"]], "collins_host": [["self", "collins_host", "config", "get"]], "collins_max_retries": [["self", "collins_max_retries", "config", "getint"]], "collins_password": [["self", "collins_password", "os", "getenv", "config", "get"]], "collins_timeout_secs": [["self", "collins_timeout_secs", "config", "getint"]], "collins_username": [["self", "collins_username", "os", "getenv", "config", "get"]], "config": [["config", "ConfigParser", "SafeConfigParser"], ["config", "read", "os", "path", "dirname", "os", "path", "realpath", "__file__"], ["self", "collins_host", "config", "get"], ["self", "collins_username", "os", "getenv", "config", "get"], ["self", "collins_password", "os", "getenv", "config", "get"], ["self", "collins_asset_type", "os", "getenv", "config", "get"], ["self", "collins_timeout_secs", "config", "getint"], ["self", "collins_max_retries", "config", "getint"], ["self", "results_per_query", "config", "getint"], ["self", "ip_address_index", "config", "getint"], ["self", "query_remote_dcs", "config", "getboolean"], ["self", "prefer_hostnames", "config", "getboolean"], ["cache_path", "config", "get"], ["self", "cache_max_age", "config", "getint"], ["log_path", "config", "get"]], "config_loc": [["config_loc", "os", "getenv", "os", "path", "dirname", "os", "path", "realpath", "__file__"]], "ip_address_index": [["self", "ip_address_index", "config", "getint"]], "log_location": [["self", "log_location", "log_path"]], "log_path": [["log_path", "config", "get"], ["self", "log_location", "log_path"]], "prefer_hostnames": [["self", "prefer_hostnames", "config", "getboolean"]], "query_remote_dcs": [["self", "query_remote_dcs", "config", "getboolean"]], "results_per_query": [["self", "results_per_query", "config", "getint"]]}, "name": "read_settings", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "collins_host", "config", "get"], ["self", "collins_username", "os", "getenv", "config", "get"], ["self", "collins_password", "os", "getenv", "config", "get"], ["self", "collins_asset_type", "os", "getenv", "config", "get"], ["self", "collins_timeout_secs", "config", "getint"], ["self", "collins_max_retries", "config", "getint"], ["self", "results_per_query", "config", "getint"], ["self", "ip_address_index", "config", "getint"], ["self", "query_remote_dcs", "config", "getboolean"], ["self", "prefer_hostnames", "config", "getboolean"], ["self", "cache_path_cache", "cache_path", "self", "collins_asset_type"], ["self", "cache_path_inventory", "cache_path", "self", "collins_asset_type"], ["self", "cache_max_age", "config", "getint"], ["self", "log_location", "log_path"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "CollinsInventory.read_settings", "ret_exprs": [], "ret_type": "", "variables": {"cache_max_age": "", "cache_path": "", "cache_path_cache": "", "cache_path_inventory": "", "collins_asset_type": "", "collins_host": "", "collins_max_retries": "", "collins_password": "", "collins_timeout_secs": "", "collins_username": "", "config": "", "config_loc": "", "ip_address_index": "", "log_location": "", "log_path": "", "prefer_hostnames": "", "query_remote_dcs": "", "results_per_query": ""}, "variables_p": {"cache_max_age": [["classmethod", 0.4867564127831885], ["bool", 0.20274572908303556]], "cache_path": [["str", 0.6700532415545244], ["Optional[str]", 0.11262808232244248], ["tuple", 0.11184793653381071], ["List[str]", 0.10547073958922239]], "cache_path_cache": [["str", 0.91466713907822]], "cache_path_inventory": [["str", 0.91466713907822]], "collins_asset_type": [["Dict[str, str]", 0.6609297320896449], ["str", 0.3390702679103551]], "collins_host": [["classmethod", 0.5698370977858291], ["str", 0.1194514618227329]], "collins_max_retries": [["classmethod", 0.4867564127831885], ["bool", 0.20274572908303556]], "collins_password": [["str", 1.0]], "collins_timeout_secs": [["int", 0.28661111767556335], ["float", 0.19232383983079362]], "collins_username": [["str", 0.8992269447352053], ["ClassVar[str]", 0.10077305526479458]], "config": [["configparser.ConfigParser", 1.0]], "config_loc": [["configparser.ConfigParser", 0.30702213592069466], ["str", 0.24614533750991474], ["Tuple[Literal, Literal, Literal]", 0.19723770052355194], ["Dict[str, Optional[str]]", 0.09884351245328796]], "ip_address_index": [["classmethod", 0.4867564127831885], ["bool", 0.20274572908303556]], "log_location": [["str", 0.9118367088639412], ["Dict[int, str]", 0.08816329113605853]], "log_path": [["str", 1.0]], "prefer_hostnames": [["dict", 0.5040121582830748], ["int", 0.10013731000954287], ["bytes", 0.08941680777981716]], "query_remote_dcs": [["str", 0.5397603129673357], ["Dict[str, Dict[str, str]]", 0.09572352359198237], ["int", 0.08635371670381793]], "results_per_query": [["bool", 0.5676386019008403], ["int", 0.26156868411045636], ["Optional['ConvolutionalEmbeddingConfig']", 0.08914165181779363], ["list", 0.0816510621709099]]}}, {"docstring": {"func": "Command line argument processing ", "long_descr": null, "ret": null}, "fn_lc": [[265, 4], [280, 39]], "fn_var_ln": {"args": [[280, 8], [280, 17]], "parser": [[268, 8], [268, 14]]}, "fn_var_occur": {"args": [["self", "args", "parser", "parse_args"]], "parser": [["parser", "argparse", "ArgumentParser", "description"], ["parser", "add_argument", "action", "default", "True", "help"], ["parser", "add_argument", "action", "help"], ["parser", "add_argument", "action", "default", "False", "help"], ["parser", "add_argument", "action", "default", "False", "help"], ["self", "args", "parser", "parse_args"]]}, "name": "parse_cli_args", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "args", "parser", "parse_args"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "CollinsInventory.parse_cli_args", "ret_exprs": [], "ret_type": "", "variables": {"args": "", "parser": ""}, "variables_p": {"args": [["List[str]", 0.5248807964843968], ["argparse.Namespace", 0.321139793955019], ["List[Union[int, str]]", 0.07698970478029216], ["list", 0.07698970478029216]], "parser": [["argparse.ArgumentParser", 1.0]]}}, {"docstring": {"func": "Make calls to Collins and saves the output in a cache ", "long_descr": null, "ret": null}, "fn_lc": [[282, 4], [369, 19]], "fn_var_ln": {"asset_identifier": [[326, 16], [326, 32]], "attrib_key": [[348, 24], [348, 34]], "attribute_val": [[346, 20], [346, 33]], "cache": [[285, 8], [285, 18]], "inventory": [[286, 8], [286, 22]], "ip_index": [[308, 16], [308, 24]], "product": [[354, 20], [354, 27]], "product_key": [[356, 24], [356, 35]], "server_assets": [[290, 12], [290, 25]], "state_inventory_key": [[331, 16], [331, 35]]}, "fn_var_occur": {"asset_identifier": [["asset_identifier", "self", "_asset_get_attribute", "asset"], ["asset_identifier", "asset", "ip_index"], ["self", "push", "self", "inventory", "state_inventory_key", "asset_identifier"], ["self", "push", "self", "inventory", "attrib_key", "asset_identifier"], ["self", "push", "self", "inventory", "attrib_key", "asset_identifier"], ["self", "push", "self", "inventory", "product_key", "asset_identifier"], ["self", "cache", "asset_identifier", "asset"]], "attrib_key": [["attrib_key", "self", "to_safe", "attrib", "asset", "attrib_block", "attrib"], ["self", "push", "self", "inventory", "attrib_key", "asset_identifier"], ["attrib_key", "self", "to_safe", "attribute", "attribute_val"], ["self", "push", "self", "inventory", "attrib_key", "asset_identifier"]], "attribute_val": [["attribute_val", "asset", "attribute"], ["attribute_val", "None"], ["attrib_key", "self", "to_safe", "attribute", "attribute_val"]], "cache": [["self", "cache", "dict"], ["self", "cache", "asset_identifier", "asset"], ["self", "write_to_cache", "self", "cache", "self", "cache_path_cache"]], "inventory": [["self", "inventory", "dict"], ["self", "push", "self", "inventory", "state_inventory_key", "asset_identifier"], ["self", "push", "self", "inventory", "attrib_key", "asset_identifier"], ["self", "push", "self", "inventory", "attrib_key", "asset_identifier"], ["self", "push", "self", "inventory", "product_key", "asset_identifier"], ["self", "write_to_cache", "self", "inventory", "self", "cache_path_inventory"]], "ip_index": [["ip_index", "self", "_asset_get_attribute", "asset"], ["ip_index", "int", "ip_index"], ["self", "log", "error", "asset", "ip_index"], ["ip_index", "self", "ip_address_index"], ["len", "asset", "ip_index"], ["self", "log", "warning", "ip_index", "asset"], ["asset_identifier", "asset", "ip_index"]], "product": [["product", "asset"]], "product_key": [["product_key", "self", "to_safe", "asset"], ["self", "push", "self", "inventory", "product_key", "asset_identifier"]], "server_assets": [["server_assets", "self", "find_assets"]], "state_inventory_key": [["state_inventory_key", "self", "to_safe", "asset"], ["self", "push", "self", "inventory", "state_inventory_key", "asset_identifier"]]}, "name": "update_cache", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "cache", "dict"], ["self", "inventory", "dict"], ["server_assets", "self", "find_assets"], ["self", "log", "error", "traceback", "format_exc"], ["self", "_asset_has_attribute", "asset"], ["ip_index", "self", "_asset_get_attribute", "asset"], ["self", "log", "error", "asset", "ip_index"], ["ip_index", "self", "ip_address_index"], ["self", "prefer_hostnames", "self", "_asset_has_attribute", "asset"], ["asset_identifier", "self", "_asset_get_attribute", "asset"], ["self", "log", "warning", "asset"], ["self", "log", "warning", "ip_index", "asset"], ["state_inventory_key", "self", "to_safe", "asset"], ["self", "push", "self", "inventory", "state_inventory_key", "asset_identifier"], ["attrib_key", "self", "to_safe", "attrib", "asset", "attrib_block", "attrib"], ["self", "push", "self", "inventory", "attrib_key", "asset_identifier"], ["attrib_key", "self", "to_safe", "attribute", "attribute_val"], ["self", "push", "self", "inventory", "attrib_key", "asset_identifier"], ["product_key", "self", "to_safe", "asset"], ["self", "push", "self", "inventory", "product_key", "asset_identifier"], ["self", "cache", "asset_identifier", "asset"], ["self", "write_to_cache", "self", "cache", "self", "cache_path_cache"], ["self", "write_to_cache", "self", "inventory", "self", "cache_path_inventory"], ["self", "log", "error", "traceback", "format_exc"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "CollinsInventory.update_cache", "ret_exprs": ["return False", "return False", "return True"], "ret_type": "", "ret_type_p": [["bool", 0.9999999999999999]], "variables": {"asset_identifier": "", "attrib_key": "", "attribute_val": "", "cache": "", "inventory": "", "ip_index": "", "product": "", "product_key": "", "server_assets": "", "state_inventory_key": ""}, "variables_p": {"asset_identifier": [["int", 0.19068151052925686], ["Dict[str, Union[float, str]]", 0.10451416735163864], ["Dict[Any, Tuple[Any, Any]]", 0.10356594280440229]], "attrib_key": [["str", 0.6009049821215784], ["List[str]", 0.1069130280205549], ["bytes", 0.09556916007698342], ["Set[str]", 0.0933011964583163]], "attribute_val": [], "cache": [["int", 1.0]], "inventory": [["str", 0.5009190605983197], ["Dict[str, str]", 0.1017079597363726], ["Dict[str, int]", 0.09967288225093696], ["dict", 0.09150500595578988]], "ip_index": [["int", 0.7534844132841034], ["bool", 0.12325779335794824]], "product": [["List[str]", 0.24475120335932998], ["bytes", 0.13730011804609818], ["List[Tuple[bool, Any]]", 0.10040499700356334], ["List[Tuple[Any, Any, Any]]", 0.10040499700356334], ["List[List[Any]]", 0.10040499700356334], ["int", 0.10040499700356334], ["Tuple[Tuple[Any, Any], Tuple[Any, Any], Tuple[Any, Any], Tuple[Any, Any], Tuple[Any, Any]]", 0.07210956352677281]], "product_key": [["str", 0.5437180358257055], ["List[str]", 0.17253976904235857], ["dict", 0.0950180184529578], ["int", 0.09468523191394833]], "server_assets": [["int", 0.34599815595760497], ["str", 0.1671954940980967], ["Dict[str, Union[None, Any, Any]]", 0.08915612333809288], ["Pattern[str]", 0.08703148249226678], ["bool", 0.07792918147176633]], "state_inventory_key": [["bytes", 0.6102852894201124], ["IO[bytes]", 0.09622631642773395], ["Iterable[bytes]", 0.0933636573995605]]}}, {"docstring": {"func": "Adds a value to a list at a dictionary key, creating the list if it doesn't", "long_descr": "exist.", "ret": null}, "fn_lc": [[371, 4], [377, 37]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "push", "params": {"dictionary": "", "key": "", "self": "", "value": ""}, "params_descr": {"dictionary": "", "key": "", "self": "", "value": ""}, "params_occur": {"dictionary": [["key", "dictionary"], ["dictionary", "key"], ["dictionary", "key", "append", "value"]], "key": [["key", "dictionary"], ["dictionary", "key"], ["dictionary", "key", "append", "value"]], "self": [], "value": [["dictionary", "key", "append", "value"]]}, "params_p": {"args": [], "dictionary": [["str", 0.2880830676958053], ["bytes", 0.1897466062943426], ["bool", 0.10882674006554403], ["Hashable", 0.10686934874495557], ["Iterable[str]", 0.09919980678304642], ["Optional[Callable[[str], Any]]", 0.09919980678304642]], "key": [["str", 0.2880830676958053], ["bytes", 0.1897466062943426], ["bool", 0.10882674006554403], ["Hashable", 0.10686934874495557], ["Iterable[str]", 0.09919980678304642], ["Optional[Callable[[str], Any]]", 0.09919980678304642]], "kwargs": [], "self": [], "value": [["str", 0.39518734258775334], ["float", 0.11674556470321935], ["bool", 0.11202348377445119], ["list", 0.0930278175900023], ["List[int]", 0.08992291647721037], ["List[str]", 0.08992291647721037]]}, "q_name": "CollinsInventory.push", "ret_exprs": [], "ret_type": "", "variables": {}, "variables_p": {}}, {"docstring": {"func": "Get variables about a specific host. ", "long_descr": null, "ret": null}, "fn_lc": [[379, 4], [394, 82]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "get_host_info", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "cache", "len", "self", "cache"], ["self", "load_cache_from_cache"], ["self", "args", "host", "self", "cache"], ["self", "update_cache"], ["self", "args", "host", "self", "cache"], ["self", "json_format_dict", "self", "args", "pretty"], ["self", "json_format_dict", "self", "cache", "self", "args", "host", "self", "args", "pretty"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "CollinsInventory.get_host_info", "ret_exprs": ["return self.json_format_dict({}, self.args.pretty)", "return self.json_format_dict(self.cache[self.args.host], self.args.pretty)"], "ret_type": "", "ret_type_p": [["str", 1.0]], "variables": {}, "variables_p": {}}, {"docstring": {"func": "Reads the index from the cache file sets self.index ", "long_descr": null, "ret": null}, "fn_lc": [[396, 4], [408, 24]], "fn_var_ln": {"cache": [[400, 12], [400, 17]], "inventory": [[407, 12], [407, 26]], "json_inventory": [[401, 12], [401, 26]]}, "fn_var_occur": {"cache": [["cache", "open", "self", "cache_path_inventory"], ["json_inventory", "cache", "read"]], "inventory": [["self", "inventory", "json", "loads", "json_inventory"], ["self", "inventory"]], "json_inventory": [["json_inventory", "cache", "read"], ["self", "inventory", "json", "loads", "json_inventory"]]}, "name": "load_inventory_from_cache", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cache", "open", "self", "cache_path_inventory"], ["self", "inventory", "json", "loads", "json_inventory"], ["self", "log", "error", "traceback", "format_exc"], ["self", "inventory"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "CollinsInventory.load_inventory_from_cache", "ret_exprs": ["return True", "return False"], "ret_type": "", "ret_type_p": [["bool", 1.0]], "variables": {"cache": "", "inventory": "", "json_inventory": ""}, "variables_p": {"cache": [["Set[str]", 0.22138355815762392], ["str", 0.20654473159588285], ["Type[str]", 0.1899427699570657], ["Dict[str, Union[None, Any, Any]]", 0.10691792567571429], ["int", 0.0925739673623188], ["Dict[str, str]", 0.09169167668124581], ["Dict[str, Union[Any, Any]]", 0.09094537057014854]], "inventory": [["int", 0.4046327614166933], ["str", 0.26735889587344075], ["Dict[str, str]", 0.08667168749365972], ["Dict[str, int]", 0.08229880880895261]], "json_inventory": [["Type[Dict[Any, Any]]", 0.10243564499287257], ["int", 0.10243564499287257], ["dict", 0.0907569582967812], ["List[str]", 0.08555411009897325]]}}, {"docstring": {"func": "Reads the cache from the cache file sets self.cache ", "long_descr": null, "ret": null}, "fn_lc": [[410, 4], [422, 24]], "fn_var_ln": {"cache": [[421, 12], [421, 22]], "json_cache": [[415, 12], [415, 22]]}, "fn_var_occur": {"cache": [["cache", "open", "self", "cache_path_cache"], ["json_cache", "cache", "read"], ["self", "cache", "json", "loads", "json_cache"], ["self", "cache"]], "json_cache": [["json_cache", "cache", "read"], ["self", "cache", "json", "loads", "json_cache"]]}, "name": "load_cache_from_cache", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["cache", "open", "self", "cache_path_cache"], ["self", "cache", "json", "loads", "json_cache"], ["self", "log", "error", "traceback", "format_exc"], ["self", "cache"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "CollinsInventory.load_cache_from_cache", "ret_exprs": ["return True", "return False"], "ret_type": "", "ret_type_p": [["bool", 1.0]], "variables": {"cache": "", "json_cache": ""}, "variables_p": {"cache": [["str", 0.46957554445151817], ["int", 0.11605720663150766], ["Union[Literal, Literal]", 0.09270601181171921]], "json_cache": [["dict", 0.10341931543400185], ["Type[Dict[Any, Any]]", 0.09650426776920426], ["int", 0.09650426776920426], ["List[str]", 0.09281775004988252]]}}, {"docstring": {"func": "Writes data in JSON format to a specified file. ", "long_descr": null, "ret": null}, "fn_lc": [[424, 4], [430, 21]], "fn_var_ln": {"cache": [[428, 8], [428, 13]], "json_data": [[427, 8], [427, 17]]}, "fn_var_occur": {"cache": [["cache", "open", "filename"], ["cache", "write", "json_data"], ["cache", "close"]], "json_data": [["json_data", "self", "json_format_dict", "data", "self", "args", "pretty"], ["cache", "write", "json_data"]]}, "name": "write_to_cache", "params": {"data": "", "filename": "", "self": ""}, "params_descr": {"data": "", "filename": "", "self": ""}, "params_occur": {"data": [["json_data", "self", "json_format_dict", "data", "self", "args", "pretty"]], "filename": [["cache", "open", "filename"]], "self": [["json_data", "self", "json_format_dict", "data", "self", "args", "pretty"]]}, "params_p": {"args": [], "data": [["Callable", 0.12786898604222957], ["\"ks.Series\"", 0.1053732256362398], ["T", 0.09919948869996133], ["str", 0.09660990797974543], ["bytes", 0.09660990797974543], ["dict", 0.09604818422186437], ["Optional[Dict[str, Any]]", 0.09072795226603345]], "filename": [["Optional[str]", 0.18903678259087253], ["str", 0.18571710164772637], ["List[str]", 0.08916372810462261]], "kwargs": [], "self": []}, "q_name": "CollinsInventory.write_to_cache", "ret_exprs": [], "ret_type": "", "variables": {"cache": "", "json_data": ""}, "variables_p": {"cache": [["str", 0.7537160749663909]], "json_data": [["Dict[str, Any]", 0.21827572794129946], ["Dict[str, str]", 0.18690390490617942], ["List[Optional[Any]]", 0.09916655391163803], ["dict", 0.09852060977281113], ["str", 0.09762060403475337], ["Dict[str, Union[None, Any, Any, Any]]", 0.0929111514421738]]}}, {"docstring": {"func": "Converts 'bad' characters in a string to underscores so they", "long_descr": "can be used as Ansible groups", "ret": null}, "fn_lc": [[432, 4], [436, 50]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "to_safe", "params": {"self": "", "word": ""}, "params_descr": {"self": "", "word": ""}, "params_occur": {"self": [], "word": [["re", "sub", "word"]]}, "params_p": {"args": [], "kwargs": [], "self": [], "word": [["str", 0.28659172677262185], ["int", 0.14507370181453486], ["List[str]", 0.07253685090726743], ["Tuple[float, float]", 0.0609685608712239]]}, "q_name": "CollinsInventory.to_safe", "ret_exprs": ["return re.sub(\"[^A-Za-z0-9-]\", \"_\", word)"], "ret_type": "", "ret_type_p": [["int", 0.4036086645864207], ["List[int]", 0.18871399263354283], ["type", 0.0996423078531519], ["List[dict]", 0.09798325440699783]], "variables": {}, "variables_p": {}}, {"docstring": {"func": "Converts a dict to a JSON object and dumps it as a formatted string ", "long_descr": null, "ret": null}, "fn_lc": [[438, 4], [444, 35]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "json_format_dict", "params": {"data": "", "pretty": "", "self": ""}, "params_descr": {"data": "", "pretty": "", "self": ""}, "params_occur": {"data": [["json", "dumps", "data", "sort_keys", "True", "indent"], ["json", "dumps", "data"]], "pretty": [], "self": []}, "params_p": {"args": [], "data": [["Dict[str, Any]", 0.40562182824604287], ["dict", 0.2773897086518541], ["Dict[str, str]", 0.07693258776240822]], "kwargs": [], "pretty": [["bool", 0.5015884337915886], ["Optional[bool]", 0.09901312741733721], ["list", 0.0914913735618803], ["memoryview", 0.0914913735618803], ["Iterable[bytes]", 0.07072926212961732], ["List[Dict]", 0.04741910158716508]], "self": []}, "q_name": "CollinsInventory.json_format_dict", "ret_exprs": ["return json.dumps(data, sort_keys=True, indent=2)", "return json.dumps(data)"], "ret_type": "", "ret_type_p": [["bool", 0.19546575095163893], ["Dict[str, Any]", 0.10633191385761122], ["int", 0.10598869280065575], ["str", 0.09622176781879022], ["Dict[str, str]", 0.09617744638246765]], "variables": {}, "variables_p": {}}], "name": "CollinsInventory", "q_name": "CollinsInventory", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["argparse", "ConfigParser", "logging", "os", "re", "sys", "time", "time", "traceback", "urllib", "json", "simplejson", "json", "six", "iteritems", "ansible", "module_utils", "urls", "open_url"], "mod_var_ln": {"inventory": [[448, 4], [448, 13]]}, "mod_var_occur": {"inventory": [["inventory", "run"]]}, "no_types_annot": {"D": 0, "I": 0, "U": 86}, "session_id": "wlRUorDkB87272qltB_gt_nM1bMuN5caxWHBaGQRVSM", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"inventory": ""}, "variables_p": {"inventory": [["int", 0.2], ["dict", 0.1], ["List[int]", 0.1], ["List[List[int]]", 0.1], ["str", 0.1]]}}}