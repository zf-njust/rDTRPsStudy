{"error": null, "response": {"classes": [{"cls_lc": [[90, 0], [289, 35]], "cls_var_ln": {}, "cls_var_occur": {}, "funcs": [{"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[91, 4], [111, 19]], "fn_var_ln": {"args": [[93, 8], [93, 17]], "driver": [[94, 8], [94, 19]]}, "fn_var_occur": {"args": [["self", "args", "self", "parse_cli_args"], ["self", "args", "host"], ["print", "self", "json_format_dict", "self", "node_to_dict", "self", "get_instance", "self", "args", "host", "pretty", "self", "args", "pretty"], ["print", "self", "json_format_dict", "data", "self", "group_instances", "pretty", "self", "args", "pretty"]], "driver": [["self", "driver", "self", "get_ovirt_driver"]]}, "name": "__init__", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "args", "self", "parse_cli_args"], ["self", "driver", "self", "get_ovirt_driver"], ["self", "args", "host"], ["print", "self", "json_format_dict", "self", "node_to_dict", "self", "get_instance", "self", "args", "host", "pretty", "self", "args", "pretty"], ["print", "self", "json_format_dict", "data", "self", "group_instances", "pretty", "self", "args", "pretty"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "OVirtInventory.__init__", "ret_exprs": [], "ret_type": "", "variables": {"args": "", "driver": ""}, "variables_p": {"args": [["argparse.Namespace", 0.55827213100819], ["tuple", 0.44172786899181]], "driver": [["str", 0.4943895778884297], ["Exception", 0.2123426408089362], ["bool", 0.10322485749554362]]}}, {"docstring": {"func": "Determine the ovirt authorization settings and return a ovirt_sdk driver.", "long_descr": null, "ret": null}, "fn_lc": [[114, 4], [180, 43]], "fn_var_ln": {"config": [[130, 8], [130, 14]], "err": [[155, 16], [155, 19]], "kwargs": [[167, 12], [167, 18]], "ovirt_ini_default_path": [[122, 8], [122, 30]], "ovirt_ini_path": [[124, 8], [124, 22]], "secrets_found": [[149, 12], [149, 25]], "secrets_path": [[142, 8], [142, 20]]}, "fn_var_occur": {"config": [["config", "ConfigParser", "SafeConfigParser", "defaults"], ["config", "sections"], ["config", "add_section"], ["config", "read", "ovirt_ini_path"], ["secrets_path", "config", "get"], ["kwargs", "config", "get", "config", "get", "config", "get"]], "err": [["print", "err"]], "kwargs": [["kwargs", "getattr", "secrets"], ["kwargs", "getattr", "secrets"], ["kwargs", "config", "get", "config", "get", "config", "get"], ["kwargs", "os", "environ", "get", "kwargs"], ["kwargs", "next", "val", "val", "os", "environ", "get", "os", "environ", "get", "kwargs", "val", "None"], ["kwargs", "next", "val", "val", "os", "environ", "get", "os", "environ", "get", "kwargs", "val", "None"], ["API", "insecure", "True", "kwargs"]], "ovirt_ini_default_path": [["ovirt_ini_default_path", "os", "path", "join", "os", "path", "dirname", "os", "path", "realpath", "__file__"], ["ovirt_ini_path", "os", "environ", "get", "ovirt_ini_default_path"]], "ovirt_ini_path": [["ovirt_ini_path", "os", "environ", "get", "ovirt_ini_default_path"], ["config", "read", "ovirt_ini_path"]], "secrets_found": [["secrets_found", "False"], ["secrets_found", "True"], ["secrets_found", "secrets_path"]], "secrets_path": [["secrets_path", "config", "get"], ["secrets_found", "secrets_path"], ["secrets_path", "endswith"], ["sys", "path", "append", "os", "path", "dirname", "secrets_path"]]}, "name": "get_ovirt_driver", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "OVirtInventory.get_ovirt_driver", "ret_exprs": ["return API(insecure=True, **kwargs)"], "ret_type": "", "ret_type_p": [["bool", 0.9999999999999999]], "variables": {"config": "", "err": "", "kwargs": "", "ovirt_ini_default_path": "", "ovirt_ini_path": "", "secrets_found": "", "secrets_path": ""}, "variables_p": {"config": [["configparser.ConfigParser", 1.0000000000000002]], "err": [["str", 0.5], ["Tuple[str, str, str, str]", 0.1], ["float", 0.1], ["Tuple[str]", 0.1], ["Counter[str]", 0.1], ["List[int]", 0.1]], "kwargs": [["str", 0.3773076589268014], ["OrderedDict[str, Any]", 0.20932491471033976], ["Dict[str, Any]", 0.10602923264535714], ["list", 0.10537529382462912]], "ovirt_ini_default_path": [["str", 1.0]], "ovirt_ini_path": [["str", 0.5711882769062625], ["List[str]", 0.18362977229914307]], "secrets_found": [["str", 0.7970961911906072], ["List[str]", 0.10934674728838753]], "secrets_path": [["str", 0.6073623998886775], ["list", 0.09462035742687074]]}}, {"docstring": {"func": "Command line argument processing", "long_descr": null, "ret": null}, "fn_lc": [[183, 4], [194, 34]], "fn_var_ln": {"parser": [[190, 8], [190, 14]]}, "fn_var_occur": {"parser": [["parser", "argparse", "ArgumentParser", "description"], ["parser", "add_argument", "action", "default", "True", "help"], ["parser", "add_argument", "action", "help"], ["parser", "add_argument", "action", "default", "False", "help"], ["parser", "parse_args"]]}, "name": "parse_cli_args", "params": {}, "params_descr": {}, "params_occur": {}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "OVirtInventory.parse_cli_args", "ret_exprs": ["return parser.parse_args()"], "ret_type": "", "ret_type_p": [["argparse.Namespace", 0.157930432952765], ["argparse.ArgumentParser", 0.08782214191669678]], "variables": {"parser": ""}, "variables_p": {"parser": [["argparse.ArgumentParser", 1.0]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[196, 4], [224, 9]], "fn_var_ln": {"ips": [[204, 8], [204, 11]], "stats": [[206, 8], [206, 13]]}, "fn_var_occur": {"ips": [["ips", "ip", "get_address", "ip", "inst", "get_guest_info", "get_ips", "get_ip", "inst", "get_guest_info", "None"], ["inst", "get_id", "inst", "get_id", "inst", "get_os", "get_type", "self", "get_machine_type", "inst", "ips", "inst", "get_name", "inst", "get_description", "inst", "get_status", "get_state", "inst", "get_cluster", "get_id", "self", "get_tags", "inst", "stats", "ips", "len", "ips", "None"]], "stats": [["stats", "stat", "get_name", "stat", "get_values", "get_value", "get_datum"], ["inst", "get_id", "inst", "get_id", "inst", "get_os", "get_type", "self", "get_machine_type", "inst", "ips", "inst", "get_name", "inst", "get_description", "inst", "get_status", "get_state", "inst", "get_cluster", "get_id", "self", "get_tags", "inst", "stats", "ips", "len", "ips", "None"]]}, "name": "node_to_dict", "params": {"inst": "", "self": ""}, "params_descr": {"inst": "", "self": ""}, "params_occur": {"inst": [["inst", "None"], ["inst", "get_custom_properties"], ["ips", "ip", "get_address", "ip", "inst", "get_guest_info", "get_ips", "get_ip", "inst", "get_guest_info", "None"], ["inst", "get_statistics", "list"], ["inst", "get_id", "inst", "get_id", "inst", "get_os", "get_type", "self", "get_machine_type", "inst", "ips", "inst", "get_name", "inst", "get_description", "inst", "get_status", "get_state", "inst", "get_cluster", "get_id", "self", "get_tags", "inst", "stats", "ips", "len", "ips", "None"]], "self": [["inst", "get_id", "inst", "get_id", "inst", "get_os", "get_type", "self", "get_machine_type", "inst", "ips", "inst", "get_name", "inst", "get_description", "inst", "get_status", "get_state", "inst", "get_cluster", "get_id", "self", "get_tags", "inst", "stats", "ips", "len", "ips", "None"]]}, "params_p": {"args": [], "inst": [["bool", 0.07810356318732642], ["Optional[str]", 0.07723034589736531]], "kwargs": [], "self": []}, "q_name": "OVirtInventory.node_to_dict", "ret_exprs": ["return {}", "return { 'ovirt_uuid': inst.get_id(), 'ovirt_id': inst.get_id(), 'ovirt_image': inst.get_os().get_type(), 'ovirt_machine_type': self.get_machine_type(inst), 'ovirt_ips': ips, 'ovirt_name': inst.get_name(), 'ovirt_description': inst.get_description(), 'ovirt_status': inst.get_status().get_state(), 'ovirt_zone': inst.get_cluster().get_id(), 'ovirt_tags': self.get_tags(inst), 'ovirt_stats': stats, # Hosts don't have a public name, so we add an IP 'ansible_ssh_host': ips[0] if len(ips) > 0 else None}"], "ret_type": "", "ret_type_p": [["Dict[str, Any]", 0.2817555604018903], ["Iterable['Notification']", 0.10947274414380241], ["bool", 0.10513245438649081], ["List[str]", 0.09348940197453853]], "variables": {"ips": "", "stats": ""}, "variables_p": {"ips": [["str", 0.322921412279319], ["Dict[str, Any]", 0.13000756184131498], ["List[Union[Any, Any]]", 0.10706316543540971], ["list", 0.09620517170682556], ["int", 0.0897930940720629]], "stats": [["str", 0.7129015114809341], ["bool", 0.09814603051596267]]}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[227, 4], [231, 61]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "get_tags", "params": {"inst": ""}, "params_descr": {"inst": ""}, "params_occur": {"inst": [["x", "get_name", "x", "inst", "get_tags", "list"]]}, "params_p": {"args": [], "inst": [["os.DirEntry", 0.08749467368922517], ["Dict[str, Any]", 0.0778442005195638], ["int", 0.07413187779216114], ["str", 0.07301153176430739]], "kwargs": [], "self": []}, "q_name": "OVirtInventory.get_tags", "ret_exprs": ["return [x.get_name() for x in inst.get_tags().list()]"], "ret_type": "", "ret_type_p": [["List[str]", 0.5566556182397983], ["Iterable[str]", 0.13110956710793603], ["List[Tuple[str, Any]]", 0.11368852920407212], ["str", 0.10139465856896603], ["bool", 0.09715162687922779]], "variables": {}, "variables_p": {}}, {"docstring": {"func": null, "long_descr": null, "ret": null}, "fn_lc": [[233, 4], [236, 70]], "fn_var_ln": {"inst_type": [[234, 8], [234, 17]]}, "fn_var_occur": {"inst_type": [["inst_type", "inst", "get_instance_type"], ["self", "driver", "instancetypes", "get", "id", "inst_type", "id", "name"]]}, "name": "get_machine_type", "params": {"inst": "", "self": ""}, "params_descr": {"inst": "", "self": ""}, "params_occur": {"inst": [["inst_type", "inst", "get_instance_type"]], "self": [["self", "driver", "instancetypes", "get", "id", "inst_type", "id", "name"]]}, "params_p": {"args": [], "inst": [["bool", 0.1556680337813071], ["Optional[str]", 0.12360639342318762], ["str", 0.084082375144875]], "kwargs": [], "self": []}, "q_name": "OVirtInventory.get_machine_type", "ret_exprs": ["return self.driver.instancetypes.get(id=inst_type.id).name"], "ret_type": "", "ret_type_p": [["Mapping[str, Any]", 0.5002325096678096], ["type", 0.09064121059145086]], "variables": {"inst_type": ""}, "variables_p": {"inst_type": [["Dict[str, str]", 0.11544889141913049], ["Dict[str, float]", 0.09436119274081672], ["dict", 0.0943380589638686], ["Dict[str, Optional[str]]", 0.09030873916669556], ["KeysView[str]", 0.08996041557162651]]}}, {"docstring": {"func": "Gets details about a specific instance ", "long_descr": null, "ret": null}, "fn_lc": [[239, 4], [244, 23]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "get_instance", "params": {"instance_name": "", "self": ""}, "params_descr": {"instance_name": "", "self": ""}, "params_occur": {"instance_name": [["self", "driver", "vms", "get", "name", "instance_name"]], "self": [["self", "driver", "vms", "get", "name", "instance_name"]]}, "params_p": {"args": [], "instance_name": [["str", 0.47134571994399144], ["Optional[Mapping[str, Any]]", 0.12879922899069657], ["cmk.base.api.agent_based.type_defs.RuleSetName", 0.12013112239154868]], "kwargs": [], "self": []}, "q_name": "OVirtInventory.get_instance", "ret_exprs": ["return self.driver.vms.get(name=instance_name)", "return None"], "ret_type": "", "ret_type_p": [["Optional[str]", 0.5885866163079061], ["str", 0.3223893344451768], ["List[Dict[str, Any]]", 0.08902404924691691]], "variables": {}, "variables_p": {}}, {"docstring": {"func": "Group all instances", "long_descr": null, "ret": null}, "fn_lc": [[246, 4], [279, 21]], "fn_var_ln": {"groups": [[248, 8], [248, 14]], "meta": [[249, 8], [249, 12]], "name": [[253, 12], [253, 16]], "net": [[267, 16], [267, 19]], "nets": [[265, 12], [265, 16]], "stat": [[271, 12], [271, 16]], "status": [[270, 12], [270, 18]], "tag": [[262, 16], [262, 19]], "tags": [[260, 12], [260, 16]], "zone": [[257, 12], [257, 16]]}, "fn_var_occur": {"groups": [["groups", "defaultdict", "list"], ["groups", "zone", "append", "name"], ["groups", "tag", "append", "name"], ["groups", "net", "append", "name"], ["stat", "groups"], ["groups", "stat", "append", "name"], ["groups", "stat", "name"], ["groups", "meta"]], "meta": [["meta", "name", "self", "node_to_dict", "node"], ["groups", "meta"]], "name": [["name", "node", "get_name"], ["meta", "name", "self", "node_to_dict", "node"], ["groups", "zone", "append", "name"], ["groups", "tag", "append", "name"], ["groups", "net", "append", "name"], ["groups", "stat", "append", "name"], ["groups", "stat", "name"]], "net": [["net", "net"], ["groups", "net", "append", "name"]], "nets": [["nets", "x", "get_name", "x", "node", "get_nics", "list"]], "stat": [["stat", "status", "lower"], ["stat", "groups"], ["groups", "stat", "append", "name"], ["groups", "stat", "name"]], "status": [["status", "node", "get_status", "get_state"], ["stat", "status", "lower"]], "tag": [["tag", "t"], ["groups", "tag", "append", "name"]], "tags": [["tags", "self", "get_tags", "node"]], "zone": [["zone", "node", "get_cluster", "get_name"], ["groups", "zone", "append", "name"]]}, "name": "group_instances", "params": {"self": ""}, "params_descr": {"self": ""}, "params_occur": {"self": [["self", "driver", "vms", "list"], ["meta", "name", "self", "node_to_dict", "node"], ["tags", "self", "get_tags", "node"]]}, "params_p": {"args": [], "kwargs": [], "self": []}, "q_name": "OVirtInventory.group_instances", "ret_exprs": ["return groups"], "ret_type": "", "ret_type_p": [["int", 0.30000000000000004], ["Callable", 0.2], ["str", 0.1]], "variables": {"groups": "", "meta": "", "name": "", "net": "", "nets": "", "stat": "", "status": "", "tag": "", "tags": "", "zone": ""}, "variables_p": {"groups": [["list", 0.7046338656150339]], "meta": [["str", 0.21892765690804045], ["dict", 0.1818583991266324], ["Pattern[str]", 0.0992491135551868], ["Dict[str, Any]", 0.09122237323272817], ["int", 0.0869732039624781]], "name": [["list", 0.597085082025313], ["str", 0.29169259417886206], ["Pattern[str]", 0.11122232379582507]], "net": [["str", 0.3130980840500534], ["list", 0.13890075270499855], ["Set[str]", 0.09389143751002631], ["Dict[Any, Union[int, str]]", 0.09389143751002631], ["Dict[Any, float]", 0.09389143751002631], ["Type[str]", 0.09202713879677364]], "nets": [["str", 0.31258330656988553], ["dict", 0.1753936983099752], ["bool", 0.12284811425814436], ["Pattern[str]", 0.09241522331863447]], "stat": [["Dict[str, Any]", 0.20963692127746547], ["bytes", 0.19543415375460085], ["str", 0.10616738399715084], ["list", 0.10419966267171467], ["Dict[str, Union[int, str]]", 0.09764453646479862]], "status": [["int", 0.5907024168906029], ["Dict[str, str]", 0.22166740619898676], ["Type[Tuple[str, Any]]", 0.1876301769104105]], "tag": [["list", 0.6084404034924603], ["str", 0.11596944838964537], ["List[str]", 0.09224253296718447], ["List[int]", 0.09224253296718447], ["int", 0.09110508218352541]], "tags": [["Set[str]", 0.47083201105053024], ["int", 0.21763351985787127], ["List[str]", 0.13167621592035952], ["dict", 0.09327002353913232], ["Dict[str, int]", 0.08658822963210645]], "zone": [["dict", 0.18686114976297566], ["List[str]", 0.1568970458598274], ["Dict[str, Dict[str, str]]", 0.09475383238948115], ["int", 0.07033694782150889], ["Dict[str, Union[Any, Any, Any, Any]]", 0.06997465057035919]]}}, {"docstring": {"func": "Converts a dict to a JSON object and dumps it as a formatted", "long_descr": "string", "ret": null}, "fn_lc": [[282, 4], [289, 35]], "fn_var_ln": {}, "fn_var_occur": {}, "name": "json_format_dict", "params": {"data": "", "pretty": ""}, "params_descr": {"data": "", "pretty": ""}, "params_occur": {"data": [["json", "dumps", "data", "sort_keys", "True", "indent"], ["json", "dumps", "data"]], "pretty": []}, "params_p": {"args": [], "data": [["Dict[str, Any]", 0.40562182824604287], ["dict", 0.2773897086518541], ["Dict[str, str]", 0.07693258776240822]], "kwargs": [], "pretty": [["bool", 0.5015884337915886], ["Optional[bool]", 0.09901312741733721], ["list", 0.0914913735618803], ["memoryview", 0.0914913735618803], ["Iterable[bytes]", 0.07072926212961732], ["List[Dict]", 0.04741910158716508]], "self": []}, "q_name": "OVirtInventory.json_format_dict", "ret_exprs": ["return json.dumps(data, sort_keys=True, indent=2)", "return json.dumps(data)"], "ret_type": "", "ret_type_p": [["bool", 0.19546575095163893], ["Dict[str, Any]", 0.10633191385761122], ["int", 0.10598869280065575], ["str", 0.09622176781879022], ["Dict[str, str]", 0.09617744638246765]], "variables": {}, "variables_p": {}}], "name": "OVirtInventory", "q_name": "OVirtInventory", "variables": {}, "variables_p": {}}], "funcs": [], "imports": ["sys", "os", "argparse", "ConfigParser", "collections", "defaultdict", "json", "simplejson", "json", "ovirtsdk", "api", "API", "ovirtsdk", "xml", "params", "secrets", "secrets"], "mod_var_ln": {"USER_AGENT_PRODUCT": [[65, 0], [65, 18]], "USER_AGENT_VERSION": [[66, 0], [66, 18]]}, "mod_var_occur": {"USER_AGENT_PRODUCT": [], "USER_AGENT_VERSION": []}, "no_types_annot": {"D": 0, "I": 0, "U": 40}, "session_id": "UNQHAOGRVczkrIdmT4zgyrrOqI122zvTCVqRk7OPvLg", "set": null, "tc": [false, null], "type_annot_cove": 0.0, "typed_seq": "", "untyped_seq": "", "variables": {"USER_AGENT_PRODUCT": "", "USER_AGENT_VERSION": ""}, "variables_p": {"USER_AGENT_PRODUCT": [["bool", 0.5653839875195759], ["str", 0.3273446788975399], ["int", 0.1072713335828844]], "USER_AGENT_VERSION": [["str", 0.999999999432159], ["List[str]", 3.6315542687107883e-10]]}}}